import{w as m}from"./JGNRUIUO.js";import{a as O}from"./4B6UFNBQ.js";import{f as h}from"./GAV6HCJA.js";var S=t=>{let e,o=new Set,s=(n,c)=>{let i=typeof n=="function"?n(e):n;if(!Object.is(i,e)){let v=e;e=c??(typeof i!="object"||i===null)?i:Object.assign({},e,i),o.forEach(L=>L(e,v))}},l=()=>e,r={setState:s,getState:l,getInitialState:()=>a,subscribe:n=>(o.add(n),()=>o.delete(n))},a=e=t(s,l,r);return r},d=t=>t?S(t):S;var P=h(O(),1);var w=t=>t;function C(t,e=w){let o=P.default.useSyncExternalStore(t.subscribe,()=>e(t.getState()),()=>e(t.getInitialState()));return P.default.useDebugValue(o),o}var p=t=>{let e=d(t),o=s=>C(e,s);return Object.assign(o,e),o},f=t=>t?p(t):p;var b=f(t=>({onStartPolling:null,onCompletePolling:null,setOnStartPolling:e=>{t({onStartPolling:e})},setOnStopPolling:e=>{t({onCompletePolling:e})}})),I=async t=>{if(await m.isLogin())return!0;let{maxWaitTime:o=3*60*1e3,customLoginCheck:s,emitEvent:l=!1}=t||{},{onStartPolling:u,onCompletePolling:g}=b.getState();if(l)if(u)await u();else return!1;return new Promise(async r=>{let a=null,n=async c=>{if(c?.data?.event==="MAX_AI_CONNECT_ACCOUNT"&&c.data.type==="COMPLETE"){window.removeEventListener("message",n),a&&clearTimeout(a);let i=s?await s():await m.isLogin();l&&g&&await g(i),r(i)}};a=setTimeout(()=>{r(!1)},o),window.addEventListener("message",n)})},F=t=>{b.getState().setOnStartPolling(t)};export{d as a,C as b,f as c,I as d,F as e};
