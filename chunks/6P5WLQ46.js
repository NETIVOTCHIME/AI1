import{a as ky}from"./CSTNV3XX.js";import{a as Ny}from"./2IHYRZVS.js";import{a as Fy,d as Dy}from"./A2MG455G.js";import{a as Ky}from"./JNDXNXE7.js";import{a as cM}from"./S44E2XQG.js";import{a as tb}from"./2UXEOAF5.js";import{b as eb,c as Rm}from"./BLOJHRJ5.js";import{A as $m,B as Ga,C as Dr,D as ub,E as mb,F as Vl,G as db,H as fb,I as Kh,J as oa,K as hb,L as gb,N as Rl,O as Xm,P as cp,Q as un,R as zn,S as pp,U as uM,V as mM,W as Ym,X as Zm,Y as _b,a as Ms,b as Nn,c as Ly,d as Oy,e as Uh,f as Va,g as Bi,h as By,i as Et,j as Xy,k as Ra,l as Dl,m as Vm,n as Yy,o as ni,p as Zy,q as lM,r as Hl,s as Qy,t as Jy,u as pM,v as ob,w as lb,x as qm,y as cb,z as Km}from"./BDL4PKXN.js";import{a as ir,b as $y,e as zm}from"./AHEP7TF6.js";import{a as Ol,b as My,c as Ey,d as Ay,e as Py,f as Ts,g as fe}from"./GSZISHI6.js";import{a as aM,b as fC,d as hC,e as gC,f as xC,g as _C,h as CC,i as vy,j as Ty}from"./A3LRHSJN.js";import{a as sm,q as Or,v as nC}from"./HGYQWNXE.js";import{a as am,b as gm,d as Dh,e as wy}from"./QVFQKYNC.js";import{p as hm}from"./ALVC64AT.js";import{a as mC,b as Ml}from"./YGYPN7KU.js";import{a as dC}from"./LU2HGRXL.js";import{c as Bh}from"./W33EMW23.js";import{c as Hh,d as sM,e as Sm,f as zC,g as El,h as VC,i as RC,j as UC,k as WC,l as Nh,m as jC,n as Im,o as qC,p as Fm,q as Fr,s as kl,t as Dm,u as Ll,v as Iy,x as Na}from"./QWOIRRFI.js";import{a as tM,b as Ai}from"./SDHYMGTM.js";import{a as Br}from"./TYFNBCRN.js";import{a as ea,b as GC}from"./CR2YDKGZ.js";import{A as OC,Aa as pn,B as BC,Ba as dy,C as bm,Ca as fy,D as FC,Da as Om,E as zh,Ea as hy,F as KC,Fa as gy,G as vm,Ga as _r,H as $C,I as XC,J as YC,Ja as xy,K as eo,Ka as Rh,La as Pl,M as ZC,Ma as ze,N as wm,Na as ip,O as QC,P as JC,Pa as Bm,Q as ey,Qa as Oi,R as Xo,Ra as yy,S as ye,Sa as by,T as yt,Ta as Ze,U as ty,Ua as Sy,V as xr,W as oy,X as ue,Y as ct,Z as Pi,_ as ry,a as Y_,b as Z_,ba as iy,c as be,ca as Hn,d as vl,da as ay,ea as sy,f as wl,fa as vs,g as MC,ga as ri,ia as Tm,ja as Mm,k as ln,ka as ly,l as xm,la as cy,m as Ji,ma as co,na as ki,o as _m,oa as Am,p as np,pa as Al,q as EC,qa as Yo,r as Dn,ra as Pm,s as Cm,sa as km,t as AC,ta as Lm,u as ym,ua as Ha,v as cn,va as Li,wa as ws,x as PC,xa as py,y as kC,ya as uy,z as LC,za as my}from"./ORELMZLT.js";import{h as ti,i as J_,j as eC,l as tC,m as cm,n as $o,o as Il,p as rC}from"./AGYWA4SU.js";import{d as Em,g as Vh}from"./P3PDWRVN.js";import{b as oM,d as kh,f as rM,h as pm,i as nM,k as iM,m as Lh,p as rp,q as X}from"./MTK4R7RQ.js";import{d as Q_}from"./REGE2LR7.js";import{c as tm}from"./EB3YQT75.js";import{a as m_,c as _l,d as nt}from"./FN65SWAZ.js";import{a as ju,b as d_,c as Aa,e as Ku,g as B_,h as Mt,i as F_,j as D_}from"./DIWBTETG.js";import{a as Zr}from"./JSRZNT2O.js";import{a as $u,b as x_,c as __,d as yl,e as C_,i as sn,j as v_,k as Zu,m as bl,n as Sl,o as M_,p as ei,q as E_,r as A_,u as Co,x as L_,y as O_,z as tt}from"./ZFBUFDPC.js";import{c as ep,f as Ct}from"./TK64BITX.js";import{f as Xu,h as I_,i as Yu,l as w_,t as T_}from"./L6QQVHN6.js";import{a as ve,c as P_,d as Bn}from"./HO5BHRQK.js";import{b as On,h as Ut}from"./EOOP75QG.js";import{D as k_,E as La,G as Mi,O as em,R as Ei,X as Oa,Y as Ba,a as eM,c as Pa,h as S_,m as Mh}from"./QKB5ZQQZ.js";import{e as Qu,h as Ju,k as tp}from"./MAQUK7KH.js";import{g as ka}from"./XQ7PM33A.js";import{a as Th,b as an}from"./3VZZYPNH.js";import{a as G_}from"./ANHHJOOA.js";import{a as u_,d as q_,g as K_,k as nr}from"./7DC4JSX5.js";import{c as Ft}from"./FEEF6AYC.js";import{a as Wl}from"./IRTMCHL6.js";import{a as yC}from"./HXNEOZ6Q.js";import{a as j2}from"./3G4ATOPN.js";import{b as G2}from"./J4EQH5B4.js";import{c as y_,d as b_}from"./3EWN6U3Q.js";import{c as Ti}from"./64KAOBVU.js";import{b as f_,d as Cl,e as h_,f as g_,g as st}from"./KBLJ3VRP.js";import{c as wt}from"./MFTWCION.js";import{c as Xe}from"./XJRFS2HB.js";import{a as qu}from"./UXV3QMB6.js";import{a as Rt}from"./PMPYCEPL.js";import{b as F}from"./336CJV6T.js";import{a as z_}from"./U6L5EB2O.js";import{a as J7,b as Kc,c as d2,d as g2}from"./32NMDTIF.js";import{C as r2}from"./FME6Q7JF.js";import{a as Fn}from"./VPRCB5KD.js";import{a as a2,b as s2,c as l2,d as c2}from"./IFSZTWFO.js";import{b as N_,c as lt}from"./2FUMJN6B.js";import{a as Lr}from"./2KT44S3D.js";import{a as Ea}from"./BE2JDFDC.js";import{a as Ln}from"./TKVYX3NT.js";import{b as Pr,c as Pn}from"./T2HSSEKO.js";import{a as n2,b as i2,k as ll,l as Lu}from"./BZSZAF2C.js";import{f as Si,l as Ii,o as Kr,p as f2,r as h2}from"./YMQMZIXS.js";import{b as Ta,e as Ce}from"./ZJHYEVX5.js";import{g as cl}from"./SD5BERUU.js";import{f as m2}from"./CCHM5YNC.js";import{b as va}from"./KZ24SPAU.js";import{U as u2,a as t2,b as Z7,c as o2,d as Q7,f as Vt,ga as To,ka as g,oa as T,w as p2}from"./GZKBVB6W.js";import{a as zt}from"./PCHDBHHN.js";import{a as Cb,b as yb}from"./6PMYWRC4.js";import{a as ta,c as Wa}from"./MBTV4455.js";import{a as _y}from"./WQUO2XCP.js";import{a as Cy}from"./7OFLY6G7.js";import{a as p_}from"./KREF446R.js";import{A as pb,J as Ul,a as Um,c as rb,d as ii,e as Nl,f as nb,g as Wm,h as ib,i as ab,k as sb,l as Gm,m as Ua,n as zl,o as jm}from"./6FRVXCKT.js";import{a as lp}from"./XYLIULLK.js";import{c as TC}from"./PW2PVNG6.js";import{e as DC,f as HC,p as NC,q as Fh}from"./ZV7MSI2C.js";import{b as oC}from"./CQYOL7V5.js";import{b as j_}from"./XMSUU4RH.js";import{b as xb,d as Gl}from"./GRG36H53.js";import{I as Nm,J as Fl,a as Hy,b as Bl,c as Wh,e as Cr,f as Gh,g as zy,h as Vy,i as Ry,j as Uy,k as Wy,l as Gy,m as jh,n as jy,o as sp,q as qh,r as qy,s as Hm}from"./QCV2OUCP.js";import{c as za,d as ap}from"./454JMIH7.js";import{a as xl,b as Uu,c as Wu,d as Gu,e as iC,f as Oh,h as aC,i as sC,j as lC,k as cC,l as um,m as pC,n as mm,o as dm,p as Da,q as Tl,s as fm,t as uC}from"./OYYAJZKP.js";import{a as bC,d as SC,e as IC,g as vC,h as wC,j as Qt,n as ny}from"./XIKYOWTD.js";import{a as lm}from"./ZXP22K55.js";import{a as oi}from"./SVU5JQST.js";import{a as om}from"./OWTGYAZA.js";import{a as V_,b as R_,c as nm,d as U_,e as gr,f as W_,g as Fa,j as Is,k as im}from"./CORDBAGF.js";import{a as q2,b as Zi,c as Sh}from"./KHKEWIY7.js";import{a as $_,d as Eh,e as Ah,f as Ph,j as X_,l as op}from"./TJRJAJUH.js";import{a as rm}from"./ZF7CVWYR.js";import{a as H_}from"./FBXSHX3X.js";import{A as n_,D as i_,E as a_,F as Jc,H as Yr,I as vt,b as K2,c as $2,d as Ko,j as Y2,l as Ma,m as Ih,q as Q2,t as Ru,w as vh,y as r_}from"./JGNRUIUO.js";import{b as kr}from"./TJI4TFLZ.js";import{Ea as gl,F as fl,I as e_,Ia as s_,M as wi,Ma as l_,Na as c_,Pa as Qi,S as hl,V as wh,W as Qc,a as X2,ba as t_,c as Z2,f as Ss,l as De,r as J2,sa as o_}from"./HQXZBLYX.js";import{D as Xc,E as _h,L as Nu,M as zu,O as Vu,P as yh,R as bh,S as W2,T as Zc,d as k2,i as L2,j as $c,k as ul,q as O2,u as xh}from"./TFQXSVKK.js";import{Bb as z2,Ca as v2,Cb as V2,Da as w2,Db as R2,Ea as Xr,Eb as U2,Ga as T2,H as _2,Hb as Yc,Ib as ml,Jb as Ou,K as C2,Kb as Bu,Lb as Fu,Ob as Ue,Qb as Du,Sb as qo,T as y2,U as b2,Xb as dl,Yb as Hu,c as hh,da as S2,f as k,g as sl,i as Jn,ka as rr,kb as M2,m as Zt,ma as bs,mb as E2,n as bi,na as kn,o as ro,ob as A2,pb as P2,q as gh,qa as I2,r as wa,rb as Ch,s as $r,sb as B2,ta as pl,tb as F2,ua as vi,ub as D2,v as x2,wb as H2,xb as N2}from"./5XNCO7TL.js";import{b as dh,e as il,g as fh,h as Jx,i as e2,j as yi,k as al}from"./HFEXSQX6.js";import{a as A}from"./4B6UFNBQ.js";import{b as qr,c as uh,h as qc,i as Yx,l as nl,m as _i,n as Ci,r as Zx,u as mh}from"./6S5CCPHR.js";import{a as Qx}from"./PJ57C2TE.js";import{c as se,d as Y7,f as v,h as Xx}from"./GAV6HCJA.js";var $b=se(ad=>{"use strict";"use client";var VM=zt();Object.defineProperty(ad,"__esModule",{value:!0});ad.default=void 0;var RM=VM(Rt()),UM=Vt(),sG=ad.default=(0,RM.default)((0,UM.jsx)("path",{d:"m19 15-1.41-1.41L13 18.17V2h-2v16.17l-4.59-4.59L5 15l7 7z"}),"South")});var n4=se(sd=>{"use strict";"use client";var tE=zt();Object.defineProperty(sd,"__esModule",{value:!0});sd.default=void 0;var oE=tE(Rt()),r4=Vt(),pj=sd.default=(0,oE.default)([(0,r4.jsx)("path",{d:"m21.67 18.17-5.3-5.3h-.99l-2.54 2.54v.99l5.3 5.3c.39.39 1.02.39 1.41 0l2.12-2.12c.39-.38.39-1.02 0-1.41"},"0"),(0,r4.jsx)("path",{d:"m17.34 10.19 1.41-1.41 2.12 2.12c1.17-1.17 1.17-3.07 0-4.24l-3.54-3.54-1.41 1.41V1.71l-.7-.71-3.54 3.54.71.71h2.83l-1.41 1.41 1.06 1.06-2.89 2.89-4.13-4.13V5.06L4.83 2.04 2 4.87 5.03 7.9h1.41l4.13 4.13-.85.85H7.6l-5.3 5.3c-.39.39-.39 1.02 0 1.41l2.12 2.12c.39.39 1.02.39 1.41 0l5.3-5.3v-2.12l5.15-5.15z"},"1")],"Handyman")});var i4=se(ld=>{"use strict";"use client";var rE=zt();Object.defineProperty(ld,"__esModule",{value:!0});ld.default=void 0;var nE=rE(Rt()),iE=Vt(),mj=ld.default=(0,nE.default)((0,iE.jsx)("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m1 15h-2v-2h2zm0-4h-2V7h2z"}),"Error")});var a4=se(cd=>{"use strict";"use client";var aE=zt();Object.defineProperty(cd,"__esModule",{value:!0});cd.default=void 0;var sE=aE(Rt()),lE=Vt(),fj=cd.default=(0,sE.default)((0,lE.jsx)("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m1 15h-2v-6h2zm0-8h-2V7h2z"}),"Info")});var v4=se((Pq,I4)=>{"use strict";function y4(e){return(y4=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}function gp(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _4(e,t){for(var o=0;o<t.length;o++){var r=t[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function xp(e,t,o){return t&&_4(e.prototype,t),o&&_4(e,o),e}function bE(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&b4(e,t)}function rg(e){return(rg=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(e)}function b4(e,t){return(b4=Object.setPrototypeOf||function(o,r){return o.__proto__=r,o})(e,t)}function SE(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}function IE(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function vE(e,t){return!t||typeof t!="object"&&typeof t!="function"?IE(e):t}function wE(e){var t=SE();return function(){var o,r=rg(e);if(t){var n=rg(this).constructor;o=Reflect.construct(r,arguments,n)}else o=r.apply(this,arguments);return vE(this,o)}}function C4(e){return TE(e)||ME(e)||EE(e)||AE()}function TE(e){if(Array.isArray(e))return ng(e)}function ME(e){if(typeof Symbol<"u"&&Symbol.iterator in Object(e))return Array.from(e)}function EE(e,t){if(e){if(typeof e=="string")return ng(e,t);var o=Object.prototype.toString.call(e).slice(8,-1);return o==="Object"&&e.constructor&&(o=e.constructor.name),o==="Map"||o==="Set"?Array.from(e):o==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?ng(e,t):void 0}}function ng(e,t){(t==null||t>e.length)&&(t=e.length);for(var o=0,r=new Array(t);o<t;o++)r[o]=e[o];return r}function AE(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var ig=function(){function e(t){gp(this,e),this._listeners=[],this._mute=!1,this._accumulate=!1,this._accumulatedEvents=[],this._name=t||"",this._onListenerAdded=null,this._onFirstListenerAdded=null,this._onListenerRemoved=null,this._onLastListenerRemoved=null}return xp(e,[{key:"addListener",value:function(t,o){this._pushListener(t,o,!1)}},{key:"addOnceListener",value:function(t,o){this._pushListener(t,o,!0)}},{key:"removeListener",value:function(t,o){this._ensureListener(t);var r=this._indexOfListener(t,o);0<=r&&this._spliceListener(r)}},{key:"removeAllListeners",value:function(){for(;this.hasListeners();)this._spliceListener(0)}},{key:"hasListener",value:function(t,o){return this._ensureListener(t),0<=this._indexOfListener(t,o)}},{key:"hasListeners",value:function(){return 0<this._listeners.length}},{key:"dispatch",value:function(){for(var t=arguments.length,o=new Array(t),r=0;r<t;r++)o[r]=arguments[r];this._invokeListeners({args:o,async:!1})}},{key:"dispatchAsync",value:function(){for(var t=arguments.length,o=new Array(t),r=0;r<t;r++)o[r]=arguments[r];this._invokeListeners({args:o,async:!0})}},{key:"mute",value:function(t){var o=0<arguments.length&&t!==void 0?t:{};this._mute=!0,o.accumulate?this._accumulate=!0:(this._accumulate=!1,this._accumulatedEvents=[])}},{key:"unmute",value:function(){this._mute=!1,this._accumulate&&(this._dispatchAccumulated(),this._accumulate=!1)}},{key:"_invokeListeners",value:function(t){var o=this,r=0<arguments.length&&t!==void 0?t:{args:[],async:!1};this._mute?this._accumulate&&this._accumulatedEvents.push(r):this._listeners.slice().forEach(function(n){o._invokeListener(n,r),n.once&&o.removeListener(n.callback,n.context)})}},{key:"_invokeListener",value:function(t,o){var r,n,i=t.callback instanceof e;o.async?i?(r=t.callback).dispatchAsync.apply(r,C4(o.args)):setTimeout(function(){return t.callback.apply(t.context,o.args)},0):i?(n=t.callback).dispatch.apply(n,C4(o.args)):t.callback.apply(t.context,o.args)}},{key:"_ensureListener",value:function(t){if(!e.isValidListener(t))throw new Error("Channel "+this._name+": listener is not a function and not a Channel")}},{key:"_dispatchInnerAddEvents",value:function(){var t,o;this._onListenerAdded&&(t=this._onListenerAdded).dispatch.apply(t,arguments),this._onFirstListenerAdded&&this._listeners.length===1&&(o=this._onFirstListenerAdded).dispatch.apply(o,arguments)}},{key:"_dispatchInnerRemoveEvents",value:function(){var t,o;this._onListenerRemoved&&(t=this._onListenerRemoved).dispatch.apply(t,arguments),this._onLastListenerRemoved&&this._listeners.length===0&&(o=this._onLastListenerRemoved).dispatch.apply(o,arguments)}},{key:"_indexOfListener",value:function(t,o){for(var r=0;r<this._listeners.length;r++){var n=this._listeners[r],i=n.callback===t,a=t instanceof e,s=o===void 0&&n.context===void 0,l=o===n.context;if(i&&(a||s||l))return r}}},{key:"_dispatchAccumulated",value:function(){var t=this;this._accumulatedEvents.forEach(function(o){return t._invokeListeners(o)}),this._accumulatedEvents=[]}},{key:"_pushListener",value:function(t,o,r){this._ensureListener(t),this._checkForDuplicates(t,o),this._listeners.push({callback:t,context:o,once:r}),this._dispatchInnerAddEvents(t,o,r)}},{key:"_checkForDuplicates",value:function(t,o){if(this.hasListener(t,o))throw new Error("Channel "+this._name+": duplicating listeners")}},{key:"_spliceListener",value:function(t){var o=this._listeners[t],r=o.callback,n=o.context,i=o.once;this._listeners.splice(t,1),this._dispatchInnerRemoveEvents(r,n,i)}},{key:"onListenerAdded",get:function(){return this._onListenerAdded||(this._onListenerAdded=new e("".concat(this._name,":onListenerAdded"))),this._onListenerAdded}},{key:"onFirstListenerAdded",get:function(){return this._onFirstListenerAdded||(this._onFirstListenerAdded=new e("".concat(this._name,":onFirstListenerAdded"))),this._onFirstListenerAdded}},{key:"onListenerRemoved",get:function(){return this._onListenerRemoved||(this._onListenerRemoved=new e("".concat(this._name,":onListenerRemoved"))),this._onListenerRemoved}},{key:"onLastListenerRemoved",get:function(){return this._onLastListenerRemoved||(this._onLastListenerRemoved=new e("".concat(this._name,":onLastListenerRemoved"))),this._onLastListenerRemoved}}],[{key:"isValidListener",value:function(t){return typeof t=="function"||t instanceof e}}]),e}(),PE=function(){function e(){gp(this,e),this._channels=new Map}return xp(e,[{key:"addListener",value:function(t,o,r){this._getChannel(t).addListener(o,r)}},{key:"on",value:function(t,o,r){this.addListener(t,o,r)}},{key:"addOnceListener",value:function(t,o,r){this._getChannel(t).addOnceListener(o,r)}},{key:"once",value:function(t,o,r){this.addOnceListener(t,o,r)}},{key:"removeListener",value:function(t,o,r){this._getChannel(t).removeListener(o,r)}},{key:"off",value:function(t,o,r){this.removeListener(t,o,r)}},{key:"hasListener",value:function(t,o,r){return this._getChannel(t).hasListener(o,r)}},{key:"has",value:function(t,o,r){return this.hasListener(t,o,r)}},{key:"hasListeners",value:function(t){return this._getChannel(t).hasListeners()}},{key:"dispatch",value:function(t){for(var o,r=arguments.length,n=new Array(1<r?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];(o=this._getChannel(t)).dispatch.apply(o,n)}},{key:"emit",value:function(t){for(var o=arguments.length,r=new Array(1<o?o-1:0),n=1;n<o;n++)r[n-1]=arguments[n];this.dispatch.apply(this,[t].concat(r))}},{key:"_getChannel",value:function(t){return this._channels.has(t)||this._channels.set(t,new ig(t)),this._channels.get(t)}}]),e}(),kE=function(){function e(t){gp(this,e),this._params=t,this._isOn=!1,this._assertParams()}return xp(e,[{key:"on",value:function(){if(!this._isOn){var t=this._params.channel,o=t.addListener||t.addEventListener||t.on;this._applyMethod(o),this._isOn=!0}}},{key:"off",value:function(){if(this._isOn){var t=this._params.channel,o=t.removeListener||t.removeEventListener||t.off;this._applyMethod(o),this._isOn=!1}}},{key:"_applyMethod",value:function(t){var o=this._params,r=o.channel,n=o.event,i=o.listener,a=n?[n,i]:[i];t.apply(r,a)}},{key:"_assertParams",value:function(){var t=this._params,o=t.channel,r=t.event,n=t.listener;if(!o||y4(o)!=="object")throw new Error("Channel should be object");if(r&&typeof r!="string")throw new Error("Event should be string");if(!n||!ig.isValidListener(n))throw new Error("Listener should be function or Channel")}}]),e}(),S4=function(){function e(t){gp(this,e),this._items=t.map(function(o){return new kE(o)})}return xp(e,[{key:"on",value:function(){return this._items.forEach(function(t){return t.on()}),this}},{key:"off",value:function(){return this._items.forEach(function(t){return t.off()}),this}}]),e}(),LE=function(){bE(t,S4);var e=wE(t);function t(o,r){var n;return gp(this,t),(n=e.call(this,r))._overrideComponentCallback(o,"componentDidMount","on"),n._overrideComponentCallback(o,"componentWillUnmount","off"),n}return xp(t,[{key:"_overrideComponentCallback",value:function(o,r,n){var i=this,a=o[r];o[r]=function(){if(i[n](),typeof a=="function"){for(var s=arguments.length,l=new Array(s),c=0;c<s;c++)l[c]=arguments[c];return a.apply(o,l)}}}}]),t}(),hd=ig;hd.EventEmitter=PE,hd.Subscription=S4,hd.ReactSubscription=LE,I4.exports=hd});var T4=se((kq,w4)=>{w4.exports={timeout:0,timeoutReason:"Promise rejected by PromiseController timeout {timeout} ms.",resetReason:"Promise rejected by PromiseController reset."}});var M4=se(gd=>{gd.isPromise=function(e){return e&&typeof e.then=="function"};gd.tryCall=function(e){return typeof e=="function"?e():e};gd.createErrorType=function(e){function t(o){Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=o}return t.prototype=new Error,t.prototype.name=e,t.prototype.constructor=t,t}});var ag=se((Oq,k4)=>{var OE=T4(),{isPromise:E4,createErrorType:P4,tryCall:A4}=M4(),_p=class e{constructor(t){this._options=Object.assign({},OE,t),this._resolve=null,this._reject=null,this._isPending=!1,this._isFulfilled=!1,this._isRejected=!1,this._value=void 0,this._promise=null,this._timer=null}get promise(){return this._promise}get value(){return this._value}get isPending(){return this._isPending}get isFulfilled(){return this._isFulfilled}get isRejected(){return this._isRejected}get isSettled(){return this._isFulfilled||this._isRejected}call(t){return this._isPending||(this.reset(),this._createPromise(),this._createTimer(),this._callFn(t)),this._promise}resolve(t){this._isPending&&(E4(t)?this._tryAttachToPromise(t):(this._settle(t),this._isFulfilled=!0,this._resolve(t)))}reject(t){this._isPending&&(this._settle(t),this._isRejected=!0,this._reject(t))}reset(){if(this._isPending){let t=A4(this._options.resetReason),o=new e.ResetError(t);this.reject(o)}this._promise=null,this._isPending=!1,this._isFulfilled=!1,this._isRejected=!1,this._value=void 0,this._clearTimer()}configure(t){Object.assign(this._options,t)}_createPromise(){this._promise=new Promise((t,o)=>{this._isPending=!0,this._resolve=t,this._reject=o})}_handleTimeout(){let t=A4(this._options.timeoutReason),o=typeof t=="string"?t.replace("{timeout}",this._options.timeout):"",r=new e.TimeoutError(o);this.reject(r)}_createTimer(){this._options.timeout&&(this._timer=setTimeout(()=>this._handleTimeout(),this._options.timeout))}_clearTimer(){this._timer&&(clearTimeout(this._timer),this._timer=null)}_settle(t){this._isPending=!1,this._value=t,this._clearTimer()}_callFn(t){if(typeof t=="function")try{let o=t();this._tryAttachToPromise(o)}catch(o){this.reject(o)}}_tryAttachToPromise(t){E4(t)&&t.then(o=>this.resolve(o),o=>this.reject(o))}};_p.TimeoutError=P4("TimeoutError");_p.ResetError=P4("ResetError");k4.exports=_p});var L4=se(xd=>{"use strict";Object.defineProperty(xd,"__esModule",{value:!0});xd.PromisedMap=void 0;var BE=function(){function e(){this.map=new Map}return Object.defineProperty(e.prototype,"size",{get:function(){return this.map.size},enumerable:!1,configurable:!0}),e.prototype.set=function(t,o){var r=this.createMapItem(o);return this.map.set(t,r),r.promise},e.prototype.get=function(t){var o=this.map.get(t);return o&&o.data},e.prototype.has=function(t){return this.map.has(t)},e.prototype.delete=function(t){return this.map.delete(t)},e.prototype.resolve=function(t,o){var r=this.map.get(t);r&&(this.delete(t),r.resolve(o))},e.prototype.reject=function(t,o){var r=this.map.get(t);r&&(this.delete(t),r.reject(o))},e.prototype.resolveAll=function(t){this.map.forEach(function(o){return o.resolve(t)}),this.map.clear()},e.prototype.rejectAll=function(t){this.map.forEach(function(o){return o.reject(t)}),this.map.clear()},e.prototype.forEach=function(t){this.map.forEach(function(o,r,n){return t(o.data,r,n)})},e.prototype.clear=function(){return this.map.clear()},e.prototype.createMapItem=function(t){var o={data:t};return o.promise=new Promise(function(r,n){o.resolve=r,o.reject=n}),o},e}();xd.PromisedMap=BE});var F4=se((Fq,B4)=>{"use strict";var FE="Function.prototype.bind called on incompatible ",DE=Object.prototype.toString,HE=Math.max,NE="[object Function]",O4=function(t,o){for(var r=[],n=0;n<t.length;n+=1)r[n]=t[n];for(var i=0;i<o.length;i+=1)r[i+t.length]=o[i];return r},zE=function(t,o){for(var r=[],n=o||0,i=0;n<t.length;n+=1,i+=1)r[i]=t[n];return r},VE=function(e,t){for(var o="",r=0;r<e.length;r+=1)o+=e[r],r+1<e.length&&(o+=t);return o};B4.exports=function(t){var o=this;if(typeof o!="function"||DE.apply(o)!==NE)throw new TypeError(FE+o);for(var r=zE(arguments,1),n,i=function(){if(this instanceof n){var p=o.apply(this,O4(r,arguments));return Object(p)===p?p:this}return o.apply(t,O4(r,arguments))},a=HE(0,o.length-r.length),s=[],l=0;l<a;l++)s[l]="$"+l;if(n=Function("binder","return function ("+VE(s,",")+"){ return binder.apply(this,arguments); }")(i),o.prototype){var c=function(){};c.prototype=o.prototype,n.prototype=new c,c.prototype=null}return n}});var _d=se((Dq,D4)=>{"use strict";var RE=F4();D4.exports=Function.prototype.bind||RE});var N4=se((Hq,H4)=>{"use strict";H4.exports=Error});var V4=se((Nq,z4)=>{"use strict";z4.exports=EvalError});var U4=se((zq,R4)=>{"use strict";R4.exports=RangeError});var G4=se((Vq,W4)=>{"use strict";W4.exports=ReferenceError});var Cd=se((Rq,j4)=>{"use strict";j4.exports=SyntaxError});var mn=se((Uq,q4)=>{"use strict";q4.exports=TypeError});var $4=se((Wq,K4)=>{"use strict";K4.exports=URIError});var Y4=se((Gq,X4)=>{"use strict";X4.exports=function(){if(typeof Symbol!="function"||typeof Object.getOwnPropertySymbols!="function")return!1;if(typeof Symbol.iterator=="symbol")return!0;var t={},o=Symbol("test"),r=Object(o);if(typeof o=="string"||Object.prototype.toString.call(o)!=="[object Symbol]"||Object.prototype.toString.call(r)!=="[object Symbol]")return!1;var n=42;t[o]=n;for(o in t)return!1;if(typeof Object.keys=="function"&&Object.keys(t).length!==0||typeof Object.getOwnPropertyNames=="function"&&Object.getOwnPropertyNames(t).length!==0)return!1;var i=Object.getOwnPropertySymbols(t);if(i.length!==1||i[0]!==o||!Object.prototype.propertyIsEnumerable.call(t,o))return!1;if(typeof Object.getOwnPropertyDescriptor=="function"){var a=Object.getOwnPropertyDescriptor(t,o);if(a.value!==n||a.enumerable!==!0)return!1}return!0}});var J4=se((jq,Q4)=>{"use strict";var Z4=typeof Symbol<"u"&&Symbol,UE=Y4();Q4.exports=function(){return typeof Z4!="function"||typeof Symbol!="function"||typeof Z4("foo")!="symbol"||typeof Symbol("bar")!="symbol"?!1:UE()}});var t5=se((qq,e5)=>{"use strict";var sg={__proto__:null,foo:{}},WE=Object;e5.exports=function(){return{__proto__:sg}.foo===sg.foo&&!(sg instanceof WE)}});var Cp=se((Kq,o5)=>{"use strict";var GE=Function.prototype.call,jE=Object.prototype.hasOwnProperty,qE=_d();o5.exports=qE.call(GE,jE)});var Hi=se(($q,s5)=>{"use strict";var Ye,KE=N4(),$E=V4(),XE=U4(),YE=G4(),ec=Cd(),Jl=mn(),ZE=$4(),a5=Function,lg=function(e){try{return a5('"use strict"; return ('+e+").constructor;")()}catch{}},ks=Object.getOwnPropertyDescriptor;if(ks)try{ks({},"")}catch{ks=null}var cg=function(){throw new Jl},QE=ks?function(){try{return arguments.callee,cg}catch{try{return ks(arguments,"callee").get}catch{return cg}}}():cg,Zl=J4()(),JE=t5()(),Zo=Object.getPrototypeOf||(JE?function(e){return e.__proto__}:null),Ql={},eA=typeof Uint8Array>"u"||!Zo?Ye:Zo(Uint8Array),Ls={__proto__:null,"%AggregateError%":typeof AggregateError>"u"?Ye:AggregateError,"%Array%":Array,"%ArrayBuffer%":typeof ArrayBuffer>"u"?Ye:ArrayBuffer,"%ArrayIteratorPrototype%":Zl&&Zo?Zo([][Symbol.iterator]()):Ye,"%AsyncFromSyncIteratorPrototype%":Ye,"%AsyncFunction%":Ql,"%AsyncGenerator%":Ql,"%AsyncGeneratorFunction%":Ql,"%AsyncIteratorPrototype%":Ql,"%Atomics%":typeof Atomics>"u"?Ye:Atomics,"%BigInt%":typeof BigInt>"u"?Ye:BigInt,"%BigInt64Array%":typeof BigInt64Array>"u"?Ye:BigInt64Array,"%BigUint64Array%":typeof BigUint64Array>"u"?Ye:BigUint64Array,"%Boolean%":Boolean,"%DataView%":typeof DataView>"u"?Ye:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":KE,"%eval%":eval,"%EvalError%":$E,"%Float32Array%":typeof Float32Array>"u"?Ye:Float32Array,"%Float64Array%":typeof Float64Array>"u"?Ye:Float64Array,"%FinalizationRegistry%":typeof FinalizationRegistry>"u"?Ye:FinalizationRegistry,"%Function%":a5,"%GeneratorFunction%":Ql,"%Int8Array%":typeof Int8Array>"u"?Ye:Int8Array,"%Int16Array%":typeof Int16Array>"u"?Ye:Int16Array,"%Int32Array%":typeof Int32Array>"u"?Ye:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":Zl&&Zo?Zo(Zo([][Symbol.iterator]())):Ye,"%JSON%":typeof JSON=="object"?JSON:Ye,"%Map%":typeof Map>"u"?Ye:Map,"%MapIteratorPrototype%":typeof Map>"u"||!Zl||!Zo?Ye:Zo(new Map()[Symbol.iterator]()),"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":typeof Promise>"u"?Ye:Promise,"%Proxy%":typeof Proxy>"u"?Ye:Proxy,"%RangeError%":XE,"%ReferenceError%":YE,"%Reflect%":typeof Reflect>"u"?Ye:Reflect,"%RegExp%":RegExp,"%Set%":typeof Set>"u"?Ye:Set,"%SetIteratorPrototype%":typeof Set>"u"||!Zl||!Zo?Ye:Zo(new Set()[Symbol.iterator]()),"%SharedArrayBuffer%":typeof SharedArrayBuffer>"u"?Ye:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":Zl&&Zo?Zo(""[Symbol.iterator]()):Ye,"%Symbol%":Zl?Symbol:Ye,"%SyntaxError%":ec,"%ThrowTypeError%":QE,"%TypedArray%":eA,"%TypeError%":Jl,"%Uint8Array%":typeof Uint8Array>"u"?Ye:Uint8Array,"%Uint8ClampedArray%":typeof Uint8ClampedArray>"u"?Ye:Uint8ClampedArray,"%Uint16Array%":typeof Uint16Array>"u"?Ye:Uint16Array,"%Uint32Array%":typeof Uint32Array>"u"?Ye:Uint32Array,"%URIError%":ZE,"%WeakMap%":typeof WeakMap>"u"?Ye:WeakMap,"%WeakRef%":typeof WeakRef>"u"?Ye:WeakRef,"%WeakSet%":typeof WeakSet>"u"?Ye:WeakSet};if(Zo)try{null.error}catch(e){r5=Zo(Zo(e)),Ls["%Error.prototype%"]=r5}var r5,tA=function e(t){var o;if(t==="%AsyncFunction%")o=lg("async function () {}");else if(t==="%GeneratorFunction%")o=lg("function* () {}");else if(t==="%AsyncGeneratorFunction%")o=lg("async function* () {}");else if(t==="%AsyncGenerator%"){var r=e("%AsyncGeneratorFunction%");r&&(o=r.prototype)}else if(t==="%AsyncIteratorPrototype%"){var n=e("%AsyncGenerator%");n&&Zo&&(o=Zo(n.prototype))}return Ls[t]=o,o},n5={__proto__:null,"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},yp=_d(),yd=Cp(),oA=yp.call(Function.call,Array.prototype.concat),rA=yp.call(Function.apply,Array.prototype.splice),i5=yp.call(Function.call,String.prototype.replace),bd=yp.call(Function.call,String.prototype.slice),nA=yp.call(Function.call,RegExp.prototype.exec),iA=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,aA=/\\(\\)?/g,sA=function(t){var o=bd(t,0,1),r=bd(t,-1);if(o==="%"&&r!=="%")throw new ec("invalid intrinsic syntax, expected closing `%`");if(r==="%"&&o!=="%")throw new ec("invalid intrinsic syntax, expected opening `%`");var n=[];return i5(t,iA,function(i,a,s,l){n[n.length]=s?i5(l,aA,"$1"):a||i}),n},lA=function(t,o){var r=t,n;if(yd(n5,r)&&(n=n5[r],r="%"+n[0]+"%"),yd(Ls,r)){var i=Ls[r];if(i===Ql&&(i=tA(r)),typeof i>"u"&&!o)throw new Jl("intrinsic "+t+" exists, but is not available. Please file an issue!");return{alias:n,name:r,value:i}}throw new ec("intrinsic "+t+" does not exist!")};s5.exports=function(t,o){if(typeof t!="string"||t.length===0)throw new Jl("intrinsic name must be a non-empty string");if(arguments.length>1&&typeof o!="boolean")throw new Jl('"allowMissing" argument must be a boolean');if(nA(/^%?[^%]*%?$/,t)===null)throw new ec("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var r=sA(t),n=r.length>0?r[0]:"",i=lA("%"+n+"%",o),a=i.name,s=i.value,l=!1,c=i.alias;c&&(n=c[0],rA(r,oA([0,1],c)));for(var p=1,u=!0;p<r.length;p+=1){var m=r[p],d=bd(m,0,1),f=bd(m,-1);if((d==='"'||d==="'"||d==="`"||f==='"'||f==="'"||f==="`")&&d!==f)throw new ec("property names with quotes must have matching quotes");if((m==="constructor"||!u)&&(l=!0),n+="."+m,a="%"+n+"%",yd(Ls,a))s=Ls[a];else if(s!=null){if(!(m in s)){if(!o)throw new Jl("base intrinsic for "+t+" exists, but the property is not available.");return}if(ks&&p+1>=r.length){var h=ks(s,m);u=!!h,u&&"get"in h&&!("originalValue"in h.get)?s=h.get:s=s[m]}else u=yd(s,m),s=s[m];u&&!l&&(Ls[a]=s)}}return s}});var bp=se((Xq,l5)=>{"use strict";var cA=Hi(),Sd=cA("%Object.defineProperty%",!0)||!1;if(Sd)try{Sd({},"a",{value:1})}catch{Sd=!1}l5.exports=Sd});var pg=se((Yq,c5)=>{"use strict";var pA=Hi(),Id=pA("%Object.getOwnPropertyDescriptor%",!0);if(Id)try{Id([],"length")}catch{Id=null}c5.exports=Id});var vd=se((Zq,m5)=>{"use strict";var p5=bp(),uA=Cd(),tc=mn(),u5=pg();m5.exports=function(t,o,r){if(!t||typeof t!="object"&&typeof t!="function")throw new tc("`obj` must be an object or a function`");if(typeof o!="string"&&typeof o!="symbol")throw new tc("`property` must be a string or a symbol`");if(arguments.length>3&&typeof arguments[3]!="boolean"&&arguments[3]!==null)throw new tc("`nonEnumerable`, if provided, must be a boolean or null");if(arguments.length>4&&typeof arguments[4]!="boolean"&&arguments[4]!==null)throw new tc("`nonWritable`, if provided, must be a boolean or null");if(arguments.length>5&&typeof arguments[5]!="boolean"&&arguments[5]!==null)throw new tc("`nonConfigurable`, if provided, must be a boolean or null");if(arguments.length>6&&typeof arguments[6]!="boolean")throw new tc("`loose`, if provided, must be a boolean");var n=arguments.length>3?arguments[3]:null,i=arguments.length>4?arguments[4]:null,a=arguments.length>5?arguments[5]:null,s=arguments.length>6?arguments[6]:!1,l=!!u5&&u5(t,o);if(p5)p5(t,o,{configurable:a===null&&l?l.configurable:!a,enumerable:n===null&&l?l.enumerable:!n,value:r,writable:i===null&&l?l.writable:!i});else if(s||!n&&!i&&!a)t[o]=r;else throw new uA("This environment does not support defining a property as non-configurable, non-writable, or non-enumerable.")}});var Sp=se((Qq,f5)=>{"use strict";var ug=bp(),d5=function(){return!!ug};d5.hasArrayLengthDefineBug=function(){if(!ug)return null;try{return ug([],"length",{value:1}).length!==1}catch{return!0}};f5.exports=d5});var C5=se((Jq,_5)=>{"use strict";var mA=Hi(),h5=vd(),dA=Sp()(),g5=pg(),x5=mn(),fA=mA("%Math.floor%");_5.exports=function(t,o){if(typeof t!="function")throw new x5("`fn` is not a function");if(typeof o!="number"||o<0||o>4294967295||fA(o)!==o)throw new x5("`length` must be a positive 32-bit integer");var r=arguments.length>2&&!!arguments[2],n=!0,i=!0;if("length"in t&&g5){var a=g5(t,"length");a&&!a.configurable&&(n=!1),a&&!a.writable&&(i=!1)}return(n||i||!r)&&(dA?h5(t,"length",o,!0,!0):h5(t,"length",o)),t}});var Md=se((eK,wd)=>{"use strict";var mg=_d(),Td=Hi(),hA=C5(),gA=mn(),S5=Td("%Function.prototype.apply%"),I5=Td("%Function.prototype.call%"),v5=Td("%Reflect.apply%",!0)||mg.call(I5,S5),y5=bp(),xA=Td("%Math.max%");wd.exports=function(t){if(typeof t!="function")throw new gA("a function is required");var o=v5(mg,I5,arguments);return hA(o,1+xA(0,t.length-(arguments.length-1)),!0)};var b5=function(){return v5(mg,S5,arguments)};y5?y5(wd.exports,"apply",{value:b5}):wd.exports.apply=b5});var dg=se((tK,T5)=>{"use strict";var w5=Object.prototype.toString;T5.exports=function(t){var o=w5.call(t),r=o==="[object Arguments]";return r||(r=o!=="[object Array]"&&t!==null&&typeof t=="object"&&typeof t.length=="number"&&t.length>=0&&w5.call(t.callee)==="[object Function]"),r}});var F5=se((oK,B5)=>{"use strict";var O5;Object.keys||(Ip=Object.prototype.hasOwnProperty,fg=Object.prototype.toString,M5=dg(),hg=Object.prototype.propertyIsEnumerable,E5=!hg.call({toString:null},"toString"),A5=hg.call(function(){},"prototype"),vp=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],Ed=function(e){var t=e.constructor;return t&&t.prototype===e},P5={$applicationCache:!0,$console:!0,$external:!0,$frame:!0,$frameElement:!0,$frames:!0,$innerHeight:!0,$innerWidth:!0,$onmozfullscreenchange:!0,$onmozfullscreenerror:!0,$outerHeight:!0,$outerWidth:!0,$pageXOffset:!0,$pageYOffset:!0,$parent:!0,$scrollLeft:!0,$scrollTop:!0,$scrollX:!0,$scrollY:!0,$self:!0,$webkitIndexedDB:!0,$webkitStorageInfo:!0,$window:!0},k5=function(){if(typeof window>"u")return!1;for(var e in window)try{if(!P5["$"+e]&&Ip.call(window,e)&&window[e]!==null&&typeof window[e]=="object")try{Ed(window[e])}catch{return!0}}catch{return!0}return!1}(),L5=function(e){if(typeof window>"u"||!k5)return Ed(e);try{return Ed(e)}catch{return!1}},O5=function(t){var o=t!==null&&typeof t=="object",r=fg.call(t)==="[object Function]",n=M5(t),i=o&&fg.call(t)==="[object String]",a=[];if(!o&&!r&&!n)throw new TypeError("Object.keys called on a non-object");var s=A5&&r;if(i&&t.length>0&&!Ip.call(t,0))for(var l=0;l<t.length;++l)a.push(String(l));if(n&&t.length>0)for(var c=0;c<t.length;++c)a.push(String(c));else for(var p in t)!(s&&p==="prototype")&&Ip.call(t,p)&&a.push(String(p));if(E5)for(var u=L5(t),m=0;m<vp.length;++m)!(u&&vp[m]==="constructor")&&Ip.call(t,vp[m])&&a.push(vp[m]);return a});var Ip,fg,M5,hg,E5,A5,vp,Ed,P5,k5,L5;B5.exports=O5});var z5=se((rK,N5)=>{"use strict";var _A=Array.prototype.slice,CA=dg(),D5=Object.keys,Ad=D5?function(t){return D5(t)}:F5(),H5=Object.keys;Ad.shim=function(){if(Object.keys){var t=function(){var o=Object.keys(arguments);return o&&o.length===arguments.length}(1,2);t||(Object.keys=function(r){return CA(r)?H5(_A.call(r)):H5(r)})}else Object.keys=Ad;return Object.keys||Ad};N5.exports=Ad});var gg=se((nK,W5)=>{"use strict";var yA=z5(),bA=typeof Symbol=="function"&&typeof Symbol("foo")=="symbol",SA=Object.prototype.toString,IA=Array.prototype.concat,V5=vd(),vA=function(e){return typeof e=="function"&&SA.call(e)==="[object Function]"},R5=Sp()(),wA=function(e,t,o,r){if(t in e){if(r===!0){if(e[t]===o)return}else if(!vA(r)||!r())return}R5?V5(e,t,o,!0):V5(e,t,o)},U5=function(e,t){var o=arguments.length>2?arguments[2]:{},r=yA(t);bA&&(r=IA.call(r,Object.getOwnPropertySymbols(t)));for(var n=0;n<r.length;n+=1)wA(e,r[n],t[r[n]],o[r[n]])};U5.supportsDescriptors=!!R5;W5.exports=U5});var Pd=se((iK,G5)=>{"use strict";G5.exports=function(){if(typeof Promise!="function")throw new TypeError("`Promise.prototype.finally` requires a global `Promise` be available.")}});var $5=se((aK,K5)=>{"use strict";var TA=Hi(),MA=Md(),EA=Cd(),j5=TA("%Promise.resolve%",!0),q5=j5&&MA(j5);K5.exports=function(t,o){if(!q5)throw new EA("This environment does not support Promises.");return q5(t,o)}});var Q5=se((sK,Z5)=>{"use strict";var Y5=Function.prototype.toString,oc=typeof Reflect=="object"&&Reflect!==null&&Reflect.apply,_g,kd;if(typeof oc=="function"&&typeof Object.defineProperty=="function")try{_g=Object.defineProperty({},"length",{get:function(){throw kd}}),kd={},oc(function(){throw 42},null,_g)}catch(e){e!==kd&&(oc=null)}else oc=null;var AA=/^\s*class\b/,Cg=function(t){try{var o=Y5.call(t);return AA.test(o)}catch{return!1}},xg=function(t){try{return Cg(t)?!1:(Y5.call(t),!0)}catch{return!1}},Ld=Object.prototype.toString,PA="[object Object]",kA="[object Function]",LA="[object GeneratorFunction]",OA="[object HTMLAllCollection]",BA="[object HTML document.all class]",FA="[object HTMLCollection]",DA=typeof Symbol=="function"&&!!Symbol.toStringTag,HA=!(0 in[,]),yg=function(){return!1};typeof document=="object"&&(X5=document.all,Ld.call(X5)===Ld.call(document.all)&&(yg=function(t){if((HA||!t)&&(typeof t>"u"||typeof t=="object"))try{var o=Ld.call(t);return(o===OA||o===BA||o===FA||o===PA)&&t("")==null}catch{}return!1}));var X5;Z5.exports=oc?function(t){if(yg(t))return!0;if(!t||typeof t!="function"&&typeof t!="object")return!1;try{oc(t,null,_g)}catch(o){if(o!==kd)return!1}return!Cg(t)&&xg(t)}:function(t){if(yg(t))return!0;if(!t||typeof t!="function"&&typeof t!="object")return!1;if(DA)return xg(t);if(Cg(t))return!1;var o=Ld.call(t);return o!==kA&&o!==LA&&!/^\[object HTML/.test(o)?!1:xg(t)}});var bg=se((lK,J5)=>{"use strict";J5.exports=Q5()});var t6=se((cK,e6)=>{"use strict";e6.exports=Hi()});var Od=se((pK,o6)=>{"use strict";var NA=mn(),wp=Cp(),zA={__proto__:null,"[[Configurable]]":!0,"[[Enumerable]]":!0,"[[Get]]":!0,"[[Set]]":!0,"[[Value]]":!0,"[[Writable]]":!0};o6.exports=function(t){if(!t||typeof t!="object")return!1;for(var o in t)if(wp(t,o)&&!zA[o])return!1;var r=wp(t,"[[Value]]")||wp(t,"[[Writable]]"),n=wp(t,"[[Get]]")||wp(t,"[[Set]]");if(r&&n)throw new NA("Property Descriptors may not be both accessor and data descriptors");return!0}});var Sg=se((uK,i6)=>{"use strict";var r6=Hi(),n6=Md(),VA=n6(r6("String.prototype.indexOf"));i6.exports=function(t,o){var r=r6(t,!!o);return typeof r=="function"&&VA(t,".prototype.")>-1?n6(r):r}});var l6=se((mK,s6)=>{"use strict";var RA=Hi(),a6=RA("%Array%"),UA=!a6.isArray&&Sg()("Object.prototype.toString");s6.exports=a6.isArray||function(t){return UA(t)==="[object Array]"}});var m6=se((dK,u6)=>{"use strict";var WA=Sp(),c6=bp(),p6=WA.hasArrayLengthDefineBug(),GA=p6&&l6(),jA=Sg(),qA=jA("Object.prototype.propertyIsEnumerable");u6.exports=function(t,o,r,n,i,a){if(!c6){if(!t(a)||!a["[[Configurable]]"]||!a["[[Writable]]"]||i in n&&qA(n,i)!==!!a["[[Enumerable]]"])return!1;var s=a["[[Value]]"];return n[i]=s,o(n[i],s)}return p6&&i==="length"&&"[[Value]]"in a&&GA(n)&&n.length!==a["[[Value]]"]?(n.length=a["[[Value]]"],n.length===a["[[Value]]"]):(c6(n,i,r(a)),!0)}});var f6=se((fK,d6)=>{"use strict";d6.exports=function(t){if(typeof t>"u")return t;var o={};return"[[Value]]"in t&&(o.value=t["[[Value]]"]),"[[Writable]]"in t&&(o.writable=!!t["[[Writable]]"]),"[[Get]]"in t&&(o.get=t["[[Get]]"]),"[[Set]]"in t&&(o.set=t["[[Set]]"]),"[[Enumerable]]"in t&&(o.enumerable=!!t["[[Enumerable]]"]),"[[Configurable]]"in t&&(o.configurable=!!t["[[Configurable]]"]),o}});var g6=se((hK,h6)=>{"use strict";var KA=mn(),$A=Od(),XA=f6();h6.exports=function(t){if(typeof t<"u"&&!$A(t))throw new KA("Assertion failed: `Desc` must be a Property Descriptor");return XA(t)}});var C6=se((gK,_6)=>{"use strict";var YA=mn(),x6=Cp(),ZA=Od();_6.exports=function(t){if(typeof t>"u")return!1;if(!ZA(t))throw new YA("Assertion failed: `Desc` must be a Property Descriptor");return!(!x6(t,"[[Value]]")&&!x6(t,"[[Writable]]"))}});var b6=se((xK,y6)=>{"use strict";y6.exports=function(t){return typeof t=="string"||typeof t=="symbol"}});var I6=se((_K,S6)=>{"use strict";S6.exports=Number.isNaN||function(t){return t!==t}});var T6=se((CK,w6)=>{"use strict";var v6=I6();w6.exports=function(t,o){return t===o?t===0?1/t===1/o:!0:v6(t)&&v6(o)}});var E6=se((yK,M6)=>{"use strict";M6.exports=function(t){if(t===null)return"Null";if(typeof t>"u")return"Undefined";if(typeof t=="function"||typeof t=="object")return"Object";if(typeof t=="number")return"Number";if(typeof t=="boolean")return"Boolean";if(typeof t=="string")return"String"}});var Tp=se((bK,A6)=>{"use strict";var QA=E6();A6.exports=function(t){return typeof t=="symbol"?"Symbol":typeof t=="bigint"?"BigInt":QA(t)}});var k6=se((SK,P6)=>{"use strict";P6.exports=function(t){return!!t}});var B6=se((IK,O6)=>{"use strict";var Ni=Cp(),Bd=mn(),JA=Tp(),Ig=k6(),L6=bg();O6.exports=function(t){if(JA(t)!=="Object")throw new Bd("ToPropertyDescriptor requires an object");var o={};if(Ni(t,"enumerable")&&(o["[[Enumerable]]"]=Ig(t.enumerable)),Ni(t,"configurable")&&(o["[[Configurable]]"]=Ig(t.configurable)),Ni(t,"value")&&(o["[[Value]]"]=t.value),Ni(t,"writable")&&(o["[[Writable]]"]=Ig(t.writable)),Ni(t,"get")){var r=t.get;if(typeof r<"u"&&!L6(r))throw new Bd("getter must be a function");o["[[Get]]"]=r}if(Ni(t,"set")){var n=t.set;if(typeof n<"u"&&!L6(n))throw new Bd("setter must be a function");o["[[Set]]"]=n}if((Ni(o,"[[Get]]")||Ni(o,"[[Set]]"))&&(Ni(o,"[[Value]]")||Ni(o,"[[Writable]]")))throw new Bd("Invalid property descriptor. Cannot both specify accessors and a value or writable attribute");return o}});var H6=se((vK,D6)=>{"use strict";var vg=mn(),F6=Od(),eP=m6(),tP=g6(),oP=C6(),rP=b6(),nP=T6(),iP=B6(),aP=Tp();D6.exports=function(t,o,r){if(aP(t)!=="Object")throw new vg("Assertion failed: Type(O) is not Object");if(!rP(o))throw new vg("Assertion failed: IsPropertyKey(P) is not true");var n=F6(r)?r:iP(r);if(!F6(n))throw new vg("Assertion failed: Desc is not a valid Property Descriptor");return eP(oP,nP,tP,t,o,n)}});var z6=se((wK,Mg)=>{"use strict";var sP=t6(),N6=sP("%Reflect.construct%",!0),Fd=H6();try{Fd({},"",{"[[Get]]":function(){}})}catch{Fd=null}Fd&&N6?(wg={},Tg={},Fd(Tg,"length",{"[[Get]]":function(){throw wg},"[[Enumerable]]":!0}),Mg.exports=function(t){try{N6(t,Tg)}catch(o){return o===wg}}):Mg.exports=function(t){return typeof t=="function"&&!!t.prototype};var wg,Tg});var W6=se((TK,U6)=>{"use strict";var lP=Hi(),V6=lP("%Symbol.species%",!0),Eg=mn(),cP=z6(),R6=Tp();U6.exports=function(t,o){if(R6(t)!=="Object")throw new Eg("Assertion failed: Type(O) is not Object");var r=t.constructor;if(typeof r>"u")return o;if(R6(r)!=="Object")throw new Eg("O.constructor is not an Object");var n=V6?r[V6]:void 0;if(n==null)return o;if(cP(n))return n;throw new Eg("no constructor found")}});var j6=se((MK,G6)=>{"use strict";var Ep=function(){return typeof function(){}.name=="string"},Mp=Object.getOwnPropertyDescriptor;if(Mp)try{Mp([],"length")}catch{Mp=null}Ep.functionsHaveConfigurableNames=function(){if(!Ep()||!Mp)return!1;var t=Mp(function(){},"name");return!!t&&!!t.configurable};var pP=Function.prototype.bind;Ep.boundFunctionsHaveNames=function(){return Ep()&&typeof pP=="function"&&function(){}.bind().name!==""};G6.exports=Ep});var $6=se((EK,K6)=>{"use strict";var q6=vd(),uP=Sp()(),mP=j6().functionsHaveConfigurableNames(),dP=mn();K6.exports=function(t,o){if(typeof t!="function")throw new dP("`fn` is not a function");var r=arguments.length>2&&!!arguments[2];return(!r||mP)&&(uP?q6(t,"name",o,!0,!0):q6(t,"name",o)),t}});var Ag=se((AK,Y6)=>{"use strict";var fP=Pd();fP();var hP=mn(),X6=$5(),gP=bg(),xP=W6(),_P=Tp(),CP=$6(),yP=Promise,bP=function(t,o){return function(r){var n=o(),i=X6(t,n),a=function(){return r};return i.then(a)}},SP=function(t,o){return function(r){var n=o(),i=X6(t,n),a=function(){throw r};return i.then(a)}};Y6.exports=CP(function(t){var o=this;if(_P(o)!=="Object")throw new hP("receiver is not an Object");var r=xP(o,yP),n=t,i=t;return gP(t)&&(n=bP(r,t),i=SP(r,t)),o.then(n,i)},"finally",!0)});var Pg=se((PK,Z6)=>{"use strict";var IP=Pd(),vP=Ag();Z6.exports=function(){return IP(),typeof Promise.prototype.finally=="function"?Promise.prototype.finally:vP}});var J6=se((kK,Q6)=>{"use strict";var wP=Pd(),TP=Pg(),MP=gg();Q6.exports=function(){wP();var t=TP();return MP(Promise.prototype,{finally:t},{finally:function(){return Promise.prototype.finally!==t}}),t}});var rS=se((LK,oS)=>{"use strict";var EP=Md(),AP=gg(),PP=Ag(),eS=Pg(),kP=J6(),tS=EP(eS());AP(tS,{getPolyfill:eS,implementation:PP,shim:kP});oS.exports=tS});var iS=se((BK,nS)=>{var LP=ag(),OP=rS();nS.exports=class{constructor(){this._items=new Map}create(t,o,r){return this._rejectExistingRequest(t),this._createNewRequest(t,o,r)}resolve(t,o){t&&this._items.has(t)&&this._items.get(t).resolve(o)}rejectAll(t){this._items.forEach(o=>o.isPending?o.reject(t):null)}_rejectExistingRequest(t){let o=this._items.get(t);o&&o.isPending&&o.reject(new Error(`WebSocket request is replaced, id: ${t}`))}_createNewRequest(t,o,r){let n=new LP({timeout:r,timeoutReason:`WebSocket request was rejected by timeout (${r} ms). RequestId: ${t}`});return this._items.set(t,n),OP(n.call(o),()=>this._deleteRequest(t,n))}_deleteRequest(t,o){this._items.get(t)===o&&this._items.delete(t)}}});var sS=se((FK,aS)=>{aS.exports={createWebSocket:e=>new WebSocket(e),packMessage:null,unpackMessage:null,attachRequestId:null,extractRequestId:null,extractMessageData:e=>e.data,timeout:0,connectionTimeout:0}});var lS=se(kg=>{kg.throwIf=(e,t)=>{if(e)throw new Error(t)};kg.isPromise=e=>e&&typeof e.then=="function"});var mS=se((HK,uS)=>{var $a=v4(),cS=ag(),{PromisedMap:BP}=L4(),FP=iS(),pS=sS(),{throwIf:Dd,isPromise:DP}=lS(),Hd={CONNECTING:0,OPEN:1,CLOSING:2,CLOSED:3},Lg=class{constructor(t,o){this._assertOptions(o),this._url=t,this._options=Object.assign({},pS,o),this._requests=new FP,this._promisedMap=new BP,this._ws=null,this._wsSubscription=null,this._createOpeningController(),this._createClosingController(),this._createChannels()}get ws(){return this._ws}get url(){return this._url}get isOpening(){return!!(this._ws&&this._ws.readyState===Hd.CONNECTING)}get isOpened(){return!!(this._ws&&this._ws.readyState===Hd.OPEN)}get isClosing(){return!!(this._ws&&this._ws.readyState===Hd.CLOSING)}get isClosed(){return!this._ws||this._ws.readyState===Hd.CLOSED}get onOpen(){return this._onOpen}get onSend(){return this._onSend}get onMessage(){return this._onMessage}get onUnpackedMessage(){return this._onUnpackedMessage}get onResponse(){return this._onResponse}get onClose(){return this._onClose}get onError(){return this._onError}open(){return this.isClosing?Promise.reject(new Error("Can't open WebSocket while closing.")):this.isOpened?this._opening.promise:this._opening.call(()=>{this._opening.promise.catch(t=>this._cleanup(t)),this._createWS()})}sendRequest(t,o={}){let r=o.requestId||`${Math.random()}`,n=o.timeout!==void 0?o.timeout:this._options.timeout;return this._requests.create(r,()=>{this._assertRequestIdHandlers();let i=this._options.attachRequestId(t,r);this.sendPacked(i)},n)}sendPacked(t){this._assertPackingHandlers();let o=this._options.packMessage(t);this.send(o)}send(t){Dd(!this.isOpened,"Can't send data because WebSocket is not opened."),this._ws.send(t),this._onSend.dispatchAsync(t)}waitUnpackedMessage(t,o={}){return Dd(typeof t!="function",`Predicate must be a function, got ${typeof t}`),o.timeout&&setTimeout(()=>{if(this._promisedMap.has(t)){let r=o.timeoutError||new Error("Timeout");this._promisedMap.reject(t,r)}},o.timeout),this._promisedMap.set(t)}close(t,o){return this.isClosed?Promise.resolve(this._closing.value):this._closing.call(()=>this._ws.close(t,o))}removeAllListeners(){this._onOpen.removeAllListeners(),this._onMessage.removeAllListeners(),this._onUnpackedMessage.removeAllListeners(),this._onResponse.removeAllListeners(),this._onSend.removeAllListeners(),this._onClose.removeAllListeners(),this._onError.removeAllListeners()}_createOpeningController(){let t=this._options.connectionTimeout||this._options.timeout;this._opening=new cS({timeout:t,timeoutReason:`Can't open WebSocket within allowed timeout: ${t} ms.`})}_createClosingController(){let t=this._options.timeout;this._closing=new cS({timeout:t,timeoutReason:`Can't close WebSocket within allowed timeout: ${t} ms.`})}_createChannels(){this._onOpen=new $a,this._onMessage=new $a,this._onUnpackedMessage=new $a,this._onResponse=new $a,this._onSend=new $a,this._onClose=new $a,this._onError=new $a}_createWS(){this._ws=this._options.createWebSocket(this._url),this._wsSubscription=new $a.Subscription([{channel:this._ws,event:"open",listener:t=>this._handleOpen(t)},{channel:this._ws,event:"message",listener:t=>this._handleMessage(t)},{channel:this._ws,event:"error",listener:t=>this._handleError(t)},{channel:this._ws,event:"close",listener:t=>this._handleClose(t)}]).on()}_handleOpen(t){this._onOpen.dispatchAsync(t),this._opening.resolve(t)}_handleMessage(t){let o=this._options.extractMessageData(t);this._onMessage.dispatchAsync(o),this._tryUnpack(o)}_tryUnpack(t){this._options.unpackMessage&&(t=this._options.unpackMessage(t),DP(t)?t.then(o=>this._handleUnpackedData(o)):this._handleUnpackedData(t))}_handleUnpackedData(t){t!==void 0&&(this._onUnpackedMessage.dispatchAsync(t),this._tryHandleResponse(t)),this._tryHandleWaitingMessage(t)}_tryHandleResponse(t){if(this._options.extractRequestId){let o=this._options.extractRequestId(t);o&&(this._onResponse.dispatchAsync(t,o),this._requests.resolve(o,t))}}_tryHandleWaitingMessage(t){this._promisedMap.forEach((o,r)=>{let n=!1;try{n=r(t)}catch(i){this._promisedMap.reject(r,i);return}n&&this._promisedMap.resolve(r,t)})}_handleError(t){this._onError.dispatchAsync(t)}_handleClose(t){this._onClose.dispatchAsync(t),this._closing.resolve(t);let o=new Error(`WebSocket closed with reason: ${t.reason||t.message} (${t.code}).`);this._opening.isPending&&this._opening.reject(o),this._cleanup(o)}_cleanupWS(){this._wsSubscription&&(this._wsSubscription.off(),this._wsSubscription=null),this._ws=null}_cleanup(t){this._cleanupWS(),this._requests.rejectAll(t)}_assertOptions(t){Object.keys(t||{}).forEach(o=>{if(!pS.hasOwnProperty(o))throw new Error(`Unknown option: ${o}`)})}_assertPackingHandlers(){let{packMessage:t,unpackMessage:o}=this._options;Dd(!t||!o,"Please define 'options.packMessage / options.unpackMessage' for sending packed messages.")}_assertRequestIdHandlers(){let{attachRequestId:t,extractRequestId:o}=this._options;Dd(!t||!o,"Please define 'options.attachRequestId / options.extractRequestId' for sending requests.")}};uS.exports=Lg});var AS=se(Gd=>{"use strict";"use client";var KP=zt();Object.defineProperty(Gd,"__esModule",{value:!0});Gd.default=void 0;var $P=KP(Rt()),XP=Vt(),$$=Gd.default=(0,$P.default)((0,XP.jsx)("path",{d:"M12 14c1.66 0 3-1.34 3-3V5c0-1.66-1.34-3-3-3S9 3.34 9 5v6c0 1.66 1.34 3 3 3m-1-9c0-.55.45-1 1-1s1 .45 1 1v6c0 .55-.45 1-1 1s-1-.45-1-1zm6 6c0 2.76-2.24 5-5 5s-5-2.24-5-5H5c0 3.53 2.61 6.43 6 6.92V21h2v-3.08c3.39-.49 6-3.39 6-6.92z"}),"MicNoneOutlined")});var Ap=se(jd=>{"use strict";"use client";var ek=zt();Object.defineProperty(jd,"__esModule",{value:!0});jd.default=void 0;var tk=ek(Rt()),ok=Vt(),xX=jd.default=(0,tk.default)((0,ok.jsx)("path",{d:"M2.01 21 23 12 2.01 3 2 10l15 2-15 2z"}),"Send")});var Hg=se(qd=>{"use strict";"use client";var rk=zt();Object.defineProperty(qd,"__esModule",{value:!0});qd.default=void 0;var nk=rk(Rt()),ik=Vt(),CX=qd.default=(0,nk.default)((0,ik.jsx)("path",{d:"M6 6h12v12H6z"}),"Stop")});var NS=se(Xd=>{"use strict";"use client";var mk=zt();Object.defineProperty(Xd,"__esModule",{value:!0});Xd.default=void 0;var dk=mk(Rt()),fk=Vt(),qX=Xd.default=(0,dk.default)((0,fk.jsx)("path",{d:"M11 7h2v2h-2zm0 4h2v6h-2zm1-9C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8"}),"InfoOutlined")});var gv=se(t1=>{"use strict";"use client";var xF=zt();Object.defineProperty(t1,"__esModule",{value:!0});t1.default=void 0;var _F=xF(Rt()),CF=Vt(),W1e=t1.default=(0,_F.default)((0,CF.jsx)("path",{d:"M7.41 15.41 12 10.83l4.59 4.58L18 14l-6-6-6 6z"}),"KeyboardArrowUp")});var Tv=se(n1=>{"use strict";"use client";var kF=zt();Object.defineProperty(n1,"__esModule",{value:!0});n1.default=void 0;var LF=kF(Rt()),OF=Vt(),ege=n1.default=(0,LF.default)((0,OF.jsx)("path",{d:"m12 8-6 6 1.41 1.41L12 10.83l4.59 4.58L18 14z"}),"ExpandLess")});var Bv=se((ax,sx)=>{(function(e,t){typeof define=="function"&&define.amd?define([],t):typeof ax<"u"?t():(t(),e.FileSaver={})})(ax,function(){"use strict";function e(s,l){return typeof l>"u"?l={autoBom:!1}:typeof l!="object"&&(l={autoBom:!l}),l.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(s.type)?new Blob(["\uFEFF",s],{type:s.type}):s}function t(s,l,c){var p=new XMLHttpRequest;p.open("GET",s),p.responseType="blob",p.onload=function(){a(p.response,l,c)},p.onerror=function(){},p.send()}function o(s){var l=new XMLHttpRequest;l.open("HEAD",s,!1);try{l.send()}catch{}return 200<=l.status&&299>=l.status}function r(s){try{s.dispatchEvent(new MouseEvent("click"))}catch{var l=document.createEvent("MouseEvents");l.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),s.dispatchEvent(l)}}var n=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof global=="object"&&global.global===global?global:void 0,i=n.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),a=n.saveAs||(typeof window!="object"||window!==n?function(){}:"download"in HTMLAnchorElement.prototype&&!i?function(s,l,c){var p=n.URL||n.webkitURL,u=document.createElement("a");l=l||s.name||"download",u.download=l,u.rel="noopener",typeof s=="string"?(u.href=s,u.origin===location.origin?r(u):o(u.href)?t(s,l,c):r(u,u.target="_blank")):(u.href=p.createObjectURL(s),setTimeout(function(){p.revokeObjectURL(u.href)},4e4),setTimeout(function(){r(u)},0))}:"msSaveOrOpenBlob"in navigator?function(s,l,c){if(l=l||s.name||"download",typeof s!="string")navigator.msSaveOrOpenBlob(e(s,c),l);else if(o(s))t(s,l,c);else{var p=document.createElement("a");p.href=s,p.target="_blank",setTimeout(function(){r(p)})}}:function(s,l,c,p){if(p=p||open("","_blank"),p&&(p.document.title=p.document.body.innerText="downloading..."),typeof s=="string")return t(s,l,c);var u=s.type==="application/octet-stream",m=/constructor/i.test(n.HTMLElement)||n.safari,d=/CriOS\/[\d]+/.test(navigator.userAgent);if((d||u&&m||i)&&typeof FileReader<"u"){var f=new FileReader;f.onloadend=function(){var x=f.result;x=d?x:x.replace(/^data:[^;]*;/,"data:attachment/file;"),p?p.location.href=x:location=x,p=null},f.readAsDataURL(s)}else{var h=n.URL||n.webkitURL,C=h.createObjectURL(s);p?p.location=C:location.href=C,p=null,setTimeout(function(){h.revokeObjectURL(C)},4e4)}});n.saveAs=a.saveAs=a,typeof sx<"u"&&(sx.exports=a)})});var p1=se(c1=>{"use strict";"use client";var gD=zt();Object.defineProperty(c1,"__esModule",{value:!0});c1.default=void 0;var xD=gD(Rt()),_D=Vt(),V_e=c1.default=(0,xD.default)((0,_D.jsx)("path",{d:"M12 2C6.47 2 2 6.47 2 12s4.47 10 10 10 10-4.47 10-10S17.53 2 12 2m5 13.59L15.59 17 12 13.41 8.41 17 7 15.59 10.59 12 7 8.41 8.41 7 12 10.59 15.59 7 17 8.41 13.41 12z"}),"Cancel")});var ux=se(u1=>{"use strict";"use client";var MD=zt();Object.defineProperty(u1,"__esModule",{value:!0});u1.default=void 0;var ED=MD(Rt()),AD=Vt(),ECe=u1.default=(0,ED.default)((0,AD.jsx)("path",{d:"m19 15-6 6-1.42-1.42L15.17 16H4V4h2v10h9.17l-3.59-3.58L13 9z"}),"SubdirectoryArrowRight")});var mx=se(d1=>{"use strict";"use client";var LD=zt();Object.defineProperty(d1,"__esModule",{value:!0});d1.default=void 0;var OD=LD(Rt()),BD=Vt(),OCe=d1.default=(0,OD.default)((0,BD.jsx)("path",{d:"M11 15h2v2h-2zm0-8h2v6h-2zm.99-5C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2M12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8"}),"ErrorOutlineOutlined")});var u9=se(g1=>{"use strict";"use client";var KD=zt();Object.defineProperty(g1,"__esModule",{value:!0});g1.default=void 0;var $D=KD(Rt()),XD=Vt(),Fye=g1.default=(0,$D.default)((0,XD.jsx)("path",{d:"M9.4 16.6 4.8 12l4.6-4.6L8 6l-6 6 6 6zm5.2 0 4.6-4.6-4.6-4.6L16 6l6 6-6 6z"}),"Code")});var N9=se(S1=>{"use strict";"use client";var _H=zt();Object.defineProperty(S1,"__esModule",{value:!0});S1.default=void 0;var CH=_H(Rt()),yH=Vt(),l6e=S1.default=(0,CH.default)((0,yH.jsx)("path",{d:"M17.77 3.77 16 2 6 12l10 10 1.77-1.77L9.54 12z"}),"ArrowBackIosNew")});var z9=se(I1=>{"use strict";"use client";var bH=zt();Object.defineProperty(I1,"__esModule",{value:!0});I1.default=void 0;var SH=bH(Rt()),IH=Vt(),p6e=I1.default=(0,SH.default)((0,IH.jsx)("path",{d:"M6.23 20.23 8 22l10-10L8 2 6.23 3.77 14.46 12z"}),"ArrowForwardIos")});var Q9=se(w1=>{"use strict";"use client";var PH=zt();Object.defineProperty(w1,"__esModule",{value:!0});w1.default=void 0;var kH=PH(Rt()),LH=Vt(),tSe=w1.default=(0,kH.default)((0,LH.jsx)("path",{d:"M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20z"}),"ArrowBack")});var fw=se(M1=>{"use strict";"use client";var GH=zt();Object.defineProperty(M1,"__esModule",{value:!0});M1.default=void 0;var jH=GH(Rt()),qH=Vt(),QIe=M1.default=(0,jH.default)((0,qH.jsx)("path",{d:"M19 6H5c-1.1 0-2 .9-2 2v8c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V8c0-1.1-.9-2-2-2m0 10H5V8h14z"}),"Crop32Outlined")});var hw=se(E1=>{"use strict";"use client";var KH=zt();Object.defineProperty(E1,"__esModule",{value:!0});E1.default=void 0;var $H=KH(Rt()),XH=Vt(),e3e=E1.default=(0,$H.default)((0,XH.jsx)("path",{d:"M19 4H5c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2m0 14H5V6h14z"}),"Crop54Outlined")});var gw=se(A1=>{"use strict";"use client";var YH=zt();Object.defineProperty(A1,"__esModule",{value:!0});A1.default=void 0;var ZH=YH(Rt()),QH=Vt(),o3e=A1.default=(0,ZH.default)((0,QH.jsx)("path",{d:"M19 5H5c-1.1 0-2 .9-2 2v10c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2m0 12H5V7h14z"}),"Crop75Outlined")});var xw=se(P1=>{"use strict";"use client";var JH=zt();Object.defineProperty(P1,"__esModule",{value:!0});P1.default=void 0;var eN=JH(Rt()),tN=Vt(),n3e=P1.default=(0,eN.default)((0,tN.jsx)("path",{d:"M19 7H5c-1.1 0-2 .9-2 2v6c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V9c0-1.1-.9-2-2-2m0 8H5V9h14z"}),"Crop169Outlined")});var _w=se(k1=>{"use strict";"use client";var oN=zt();Object.defineProperty(k1,"__esModule",{value:!0});k1.default=void 0;var rN=oN(Rt()),nN=Vt(),a3e=k1.default=(0,rN.default)((0,nN.jsx)("path",{d:"M18 4H6c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2m0 14H6V6h12z"}),"CropSquareOutlined")});var kT=se(K1=>{"use strict";"use client";var wz=zt();Object.defineProperty(K1,"__esModule",{value:!0});K1.default=void 0;var Tz=wz(Rt()),Mz=Vt(),Vke=K1.default=(0,Tz.default)((0,Mz.jsx)("path",{fillRule:"evenodd",d:"M16 9V4h1c.55 0 1-.45 1-1s-.45-1-1-1H7c-.55 0-1 .45-1 1s.45 1 1 1h1v5c0 1.66-1.34 3-3 3v2h5.97v7l1 1 1-1v-7H19v-2c-1.66 0-3-1.34-3-3"}),"PushPin")});var LT=se($1=>{"use strict";"use client";var Ez=zt();Object.defineProperty($1,"__esModule",{value:!0});$1.default=void 0;var Az=Ez(Rt()),Pz=Vt(),Uke=$1.default=(0,Az.default)((0,Pz.jsx)("path",{d:"M14 4v5c0 1.12.37 2.16 1 3H9c.65-.86 1-1.9 1-3V4zm3-2H7c-.55 0-1 .45-1 1s.45 1 1 1h1v5c0 1.66-1.34 3-3 3v2h5.97v7l1 1 1-1v-7H19v-2c-1.66 0-3-1.34-3-3V4h1c.55 0 1-.45 1-1s-.45-1-1-1"}),"PushPinOutlined")});var DT=se(Y1=>{"use strict";"use client";var Lz=zt();Object.defineProperty(Y1,"__esModule",{value:!0});Y1.default=void 0;var Oz=Lz(Rt()),Bz=Vt(),Yke=Y1.default=(0,Oz.default)((0,Bz.jsx)("path",{d:"M15.61 7.41 14.2 6l-6 6 6 6 1.41-1.41L11.03 12z"}),"NavigateBeforeOutlined")});var HT=se(Z1=>{"use strict";"use client";var Fz=zt();Object.defineProperty(Z1,"__esModule",{value:!0});Z1.default=void 0;var Dz=Fz(Rt()),Hz=Vt(),Qke=Z1.default=(0,Dz.default)((0,Hz.jsx)("path",{d:"M10.02 6 8.61 7.41 13.19 12l-4.58 4.59L10.02 18l6-6z"}),"NavigateNextOutlined")});var P7=se((Tu,sh)=>{(function(e,t){"use strict";var o="1.0.38",r="",n="?",i="function",a="undefined",s="object",l="string",c="major",p="model",u="name",m="type",d="vendor",f="version",h="architecture",C="console",x="mobile",_="tablet",y="smarttv",b="wearable",S="embedded",I=500,w="Amazon",E="Apple",O="ASUS",L="BlackBerry",G="Browser",H="Chrome",V="Edge",W="Firefox",N="Google",Z="Huawei",J="LG",K="Microsoft",Q="Motorola",M="Opera",le="Samsung",ge="Sharp",P="Sony",$="Xiaomi",j="Zebra",de="Facebook",re="Chromium OS",ce="Mac OS",ut=function(z,U){var ee={};for(var D in z)U[D]&&U[D].length%2===0?ee[D]=U[D].concat(z[D]):ee[D]=z[D];return ee},Te=function(z){for(var U={},ee=0;ee<z.length;ee++)U[z[ee].toUpperCase()]=z[ee];return U},Ie=function(z,U){return typeof z===l?Pe(U).indexOf(Pe(z))!==-1:!1},Pe=function(z){return z.toLowerCase()},qe=function(z){return typeof z===l?z.replace(/[^\d\.]/g,r).split(".")[0]:t},$e=function(z,U){if(typeof z===l)return z=z.replace(/^\s\s*/,r),typeof U===a?z:z.substring(0,I)},Nt=function(z,U){for(var ee=0,D,Y,oe,me,ie,Fe;ee<U.length&&!ie;){var _t=U[ee],ae=U[ee+1];for(D=Y=0;D<_t.length&&!ie&&_t[D];)if(ie=_t[D++].exec(z),ie)for(oe=0;oe<ae.length;oe++)Fe=ie[++Y],me=ae[oe],typeof me===s&&me.length>0?me.length===2?typeof me[1]==i?this[me[0]]=me[1].call(this,Fe):this[me[0]]=me[1]:me.length===3?typeof me[1]===i&&!(me[1].exec&&me[1].test)?this[me[0]]=Fe?me[1].call(this,Fe,me[2]):t:this[me[0]]=Fe?Fe.replace(me[1],me[2]):t:me.length===4&&(this[me[0]]=Fe?me[3].call(this,Fe.replace(me[1],me[2])):t):this[me]=Fe||t;ee+=2}},Re=function(z,U){for(var ee in U)if(typeof U[ee]===s&&U[ee].length>0){for(var D=0;D<U[ee].length;D++)if(Ie(U[ee][D],z))return ee===n?t:ee}else if(Ie(U[ee],z))return ee===n?t:ee;return z},mt={"1.0":"/8","1.2":"/1","1.3":"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"},B={ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2","8.1":"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"},R={browser:[[/\b(?:crmo|crios)\/([\w\.]+)/i],[f,[u,"Chrome"]],[/edg(?:e|ios|a)?\/([\w\.]+)/i],[f,[u,"Edge"]],[/(opera mini)\/([-\w\.]+)/i,/(opera [mobiletab]{3,6})\b.+version\/([-\w\.]+)/i,/(opera)(?:.+version\/|[\/ ]+)([\w\.]+)/i],[u,f],[/opios[\/ ]+([\w\.]+)/i],[f,[u,M+" Mini"]],[/\bop(?:rg)?x\/([\w\.]+)/i],[f,[u,M+" GX"]],[/\bopr\/([\w\.]+)/i],[f,[u,M]],[/\bb[ai]*d(?:uhd|[ub]*[aekoprswx]{5,6})[\/ ]?([\w\.]+)/i],[f,[u,"Baidu"]],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/ ]?([\w\.]*)/i,/(avant|iemobile|slim)\s?(?:browser)?[\/ ]?([\w\.]*)/i,/(?:ms|\()(ie) ([\w\.]+)/i,/(flock|rockmelt|midori|epiphany|silk|skyfire|bolt|iron|vivaldi|iridium|phantomjs|bowser|quark|qupzilla|falkon|rekonq|puffin|brave|whale(?!.+naver)|qqbrowserlite|qq|duckduckgo)\/([-\w\.]+)/i,/(heytap|ovi)browser\/([\d\.]+)/i,/(weibo)__([\d\.]+)/i],[u,f],[/\bddg\/([\w\.]+)/i],[f,[u,"DuckDuckGo"]],[/(?:\buc? ?browser|(?:juc.+)ucweb)[\/ ]?([\w\.]+)/i],[f,[u,"UC"+G]],[/microm.+\bqbcore\/([\w\.]+)/i,/\bqbcore\/([\w\.]+).+microm/i,/micromessenger\/([\w\.]+)/i],[f,[u,"WeChat"]],[/konqueror\/([\w\.]+)/i],[f,[u,"Konqueror"]],[/trident.+rv[: ]([\w\.]{1,9})\b.+like gecko/i],[f,[u,"IE"]],[/ya(?:search)?browser\/([\w\.]+)/i],[f,[u,"Yandex"]],[/slbrowser\/([\w\.]+)/i],[f,[u,"Smart Lenovo "+G]],[/(avast|avg)\/([\w\.]+)/i],[[u,/(.+)/,"$1 Secure "+G],f],[/\bfocus\/([\w\.]+)/i],[f,[u,W+" Focus"]],[/\bopt\/([\w\.]+)/i],[f,[u,M+" Touch"]],[/coc_coc\w+\/([\w\.]+)/i],[f,[u,"Coc Coc"]],[/dolfin\/([\w\.]+)/i],[f,[u,"Dolphin"]],[/coast\/([\w\.]+)/i],[f,[u,M+" Coast"]],[/miuibrowser\/([\w\.]+)/i],[f,[u,"MIUI "+G]],[/fxios\/([-\w\.]+)/i],[f,[u,W]],[/\bqihu|(qi?ho?o?|360)browser/i],[[u,"360 "+G]],[/(oculus|sailfish|huawei|vivo)browser\/([\w\.]+)/i],[[u,/(.+)/,"$1 "+G],f],[/samsungbrowser\/([\w\.]+)/i],[f,[u,le+" Internet"]],[/(comodo_dragon)\/([\w\.]+)/i],[[u,/_/g," "],f],[/metasr[\/ ]?([\d\.]+)/i],[f,[u,"Sogou Explorer"]],[/(sogou)mo\w+\/([\d\.]+)/i],[[u,"Sogou Mobile"],f],[/(electron)\/([\w\.]+) safari/i,/(tesla)(?: qtcarbrowser|\/(20\d\d\.[-\w\.]+))/i,/m?(qqbrowser|2345Explorer)[\/ ]?([\w\.]+)/i],[u,f],[/(lbbrowser)/i,/\[(linkedin)app\]/i],[u],[/((?:fban\/fbios|fb_iab\/fb4a)(?!.+fbav)|;fbav\/([\w\.]+);)/i],[[u,de],f],[/(Klarna)\/([\w\.]+)/i,/(kakao(?:talk|story))[\/ ]([\w\.]+)/i,/(naver)\(.*?(\d+\.[\w\.]+).*\)/i,/safari (line)\/([\w\.]+)/i,/\b(line)\/([\w\.]+)\/iab/i,/(alipay)client\/([\w\.]+)/i,/(twitter)(?:and| f.+e\/([\w\.]+))/i,/(chromium|instagram|snapchat)[\/ ]([-\w\.]+)/i],[u,f],[/\bgsa\/([\w\.]+) .*safari\//i],[f,[u,"GSA"]],[/musical_ly(?:.+app_?version\/|_)([\w\.]+)/i],[f,[u,"TikTok"]],[/headlesschrome(?:\/([\w\.]+)| )/i],[f,[u,H+" Headless"]],[/ wv\).+(chrome)\/([\w\.]+)/i],[[u,H+" WebView"],f],[/droid.+ version\/([\w\.]+)\b.+(?:mobile safari|safari)/i],[f,[u,"Android "+G]],[/(chrome|omniweb|arora|[tizenoka]{5} ?browser)\/v?([\w\.]+)/i],[u,f],[/version\/([\w\.\,]+) .*mobile\/\w+ (safari)/i],[f,[u,"Mobile Safari"]],[/version\/([\w(\.|\,)]+) .*(mobile ?safari|safari)/i],[f,u],[/webkit.+?(mobile ?safari|safari)(\/[\w\.]+)/i],[u,[f,Re,mt]],[/(webkit|khtml)\/([\w\.]+)/i],[u,f],[/(navigator|netscape\d?)\/([-\w\.]+)/i],[[u,"Netscape"],f],[/mobile vr; rv:([\w\.]+)\).+firefox/i],[f,[u,W+" Reality"]],[/ekiohf.+(flow)\/([\w\.]+)/i,/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo browser|minimo|conkeror|klar)[\/ ]?([\w\.\+]+)/i,/(seamonkey|k-meleon|icecat|iceape|firebird|phoenix|palemoon|basilisk|waterfox)\/([-\w\.]+)$/i,/(firefox)\/([\w\.]+)/i,/(mozilla)\/([\w\.]+) .+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|sleipnir|obigo|mosaic|(?:go|ice|up)[\. ]?browser)[-\/ ]?v?([\w\.]+)/i,/(links) \(([\w\.]+)/i,/panasonic;(viera)/i],[u,f],[/(cobalt)\/([\w\.]+)/i],[u,[f,/master.|lts./,""]]],cpu:[[/(?:(amd|x(?:(?:86|64)[-_])?|wow|win)64)[;\)]/i],[[h,"amd64"]],[/(ia32(?=;))/i],[[h,Pe]],[/((?:i[346]|x)86)[;\)]/i],[[h,"ia32"]],[/\b(aarch64|arm(v?8e?l?|_?64))\b/i],[[h,"arm64"]],[/\b(arm(?:v[67])?ht?n?[fl]p?)\b/i],[[h,"armhf"]],[/windows (ce|mobile); ppc;/i],[[h,"arm"]],[/((?:ppc|powerpc)(?:64)?)(?: mac|;|\))/i],[[h,/ower/,r,Pe]],[/(sun4\w)[;\)]/i],[[h,"sparc"]],[/((?:avr32|ia64(?=;))|68k(?=\))|\barm(?=v(?:[1-7]|[5-7]1)l?|;|eabi)|(?=atmel )avr|(?:irix|mips|sparc)(?:64)?\b|pa-risc)/i],[[h,Pe]]],device:[[/\b(sch-i[89]0\d|shw-m380s|sm-[ptx]\w{2,4}|gt-[pn]\d{2,4}|sgh-t8[56]9|nexus 10)/i],[p,[d,le],[m,_]],[/\b((?:s[cgp]h|gt|sm)-\w+|sc[g-]?[\d]+a?|galaxy nexus)/i,/samsung[- ]([-\w]+)/i,/sec-(sgh\w+)/i],[p,[d,le],[m,x]],[/(?:\/|\()(ip(?:hone|od)[\w, ]*)(?:\/|;)/i],[p,[d,E],[m,x]],[/\((ipad);[-\w\),; ]+apple/i,/applecoremedia\/[\w\.]+ \((ipad)/i,/\b(ipad)\d\d?,\d\d?[;\]].+ios/i],[p,[d,E],[m,_]],[/(macintosh);/i],[p,[d,E]],[/\b(sh-?[altvz]?\d\d[a-ekm]?)/i],[p,[d,ge],[m,x]],[/\b((?:ag[rs][23]?|bah2?|sht?|btv)-a?[lw]\d{2})\b(?!.+d\/s)/i],[p,[d,Z],[m,_]],[/(?:huawei|honor)([-\w ]+)[;\)]/i,/\b(nexus 6p|\w{2,4}e?-[atu]?[ln][\dx][012359c][adn]?)\b(?!.+d\/s)/i],[p,[d,Z],[m,x]],[/\b(poco[\w ]+|m2\d{3}j\d\d[a-z]{2})(?: bui|\))/i,/\b; (\w+) build\/hm\1/i,/\b(hm[-_ ]?note?[_ ]?(?:\d\w)?) bui/i,/\b(redmi[\-_ ]?(?:note|k)?[\w_ ]+)(?: bui|\))/i,/oid[^\)]+; (m?[12][0-389][01]\w{3,6}[c-y])( bui|; wv|\))/i,/\b(mi[-_ ]?(?:a\d|one|one[_ ]plus|note lte|max|cc)?[_ ]?(?:\d?\w?)[_ ]?(?:plus|se|lite)?)(?: bui|\))/i],[[p,/_/g," "],[d,$],[m,x]],[/oid[^\)]+; (2\d{4}(283|rpbf)[cgl])( bui|\))/i,/\b(mi[-_ ]?(?:pad)(?:[\w_ ]+))(?: bui|\))/i],[[p,/_/g," "],[d,$],[m,_]],[/; (\w+) bui.+ oppo/i,/\b(cph[12]\d{3}|p(?:af|c[al]|d\w|e[ar])[mt]\d0|x9007|a101op)\b/i],[p,[d,"OPPO"],[m,x]],[/\b(opd2\d{3}a?) bui/i],[p,[d,"OPPO"],[m,_]],[/vivo (\w+)(?: bui|\))/i,/\b(v[12]\d{3}\w?[at])(?: bui|;)/i],[p,[d,"Vivo"],[m,x]],[/\b(rmx[1-3]\d{3})(?: bui|;|\))/i],[p,[d,"Realme"],[m,x]],[/\b(milestone|droid(?:[2-4x]| (?:bionic|x2|pro|razr))?:?( 4g)?)\b[\w ]+build\//i,/\bmot(?:orola)?[- ](\w*)/i,/((?:moto[\w\(\) ]+|xt\d{3,4}|nexus 6)(?= bui|\)))/i],[p,[d,Q],[m,x]],[/\b(mz60\d|xoom[2 ]{0,2}) build\//i],[p,[d,Q],[m,_]],[/((?=lg)?[vl]k\-?\d{3}) bui| 3\.[-\w; ]{10}lg?-([06cv9]{3,4})/i],[p,[d,J],[m,_]],[/(lm(?:-?f100[nv]?|-[\w\.]+)(?= bui|\))|nexus [45])/i,/\blg[-e;\/ ]+((?!browser|netcast|android tv)\w+)/i,/\blg-?([\d\w]+) bui/i],[p,[d,J],[m,x]],[/(ideatab[-\w ]+)/i,/lenovo ?(s[56]000[-\w]+|tab(?:[\w ]+)|yt[-\d\w]{6}|tb[-\d\w]{6})/i],[p,[d,"Lenovo"],[m,_]],[/(?:maemo|nokia).*(n900|lumia \d+)/i,/nokia[-_ ]?([-\w\.]*)/i],[[p,/_/g," "],[d,"Nokia"],[m,x]],[/(pixel c)\b/i],[p,[d,N],[m,_]],[/droid.+; (pixel[\daxl ]{0,6})(?: bui|\))/i],[p,[d,N],[m,x]],[/droid.+ (a?\d[0-2]{2}so|[c-g]\d{4}|so[-gl]\w+|xq-a\w[4-7][12])(?= bui|\).+chrome\/(?![1-6]{0,1}\d\.))/i],[p,[d,P],[m,x]],[/sony tablet [ps]/i,/\b(?:sony)?sgp\w+(?: bui|\))/i],[[p,"Xperia Tablet"],[d,P],[m,_]],[/ (kb2005|in20[12]5|be20[12][59])\b/i,/(?:one)?(?:plus)? (a\d0\d\d)(?: b|\))/i],[p,[d,"OnePlus"],[m,x]],[/(alexa)webm/i,/(kf[a-z]{2}wi|aeo[c-r]{2})( bui|\))/i,/(kf[a-z]+)( bui|\)).+silk\//i],[p,[d,w],[m,_]],[/((?:sd|kf)[0349hijorstuw]+)( bui|\)).+silk\//i],[[p,/(.+)/g,"Fire Phone $1"],[d,w],[m,x]],[/(playbook);[-\w\),; ]+(rim)/i],[p,d,[m,_]],[/\b((?:bb[a-f]|st[hv])100-\d)/i,/\(bb10; (\w+)/i],[p,[d,L],[m,x]],[/(?:\b|asus_)(transfo[prime ]{4,10} \w+|eeepc|slider \w+|nexus 7|padfone|p00[cj])/i],[p,[d,O],[m,_]],[/ (z[bes]6[027][012][km][ls]|zenfone \d\w?)\b/i],[p,[d,O],[m,x]],[/(nexus 9)/i],[p,[d,"HTC"],[m,_]],[/(htc)[-;_ ]{1,2}([\w ]+(?=\)| bui)|\w+)/i,/(zte)[- ]([\w ]+?)(?: bui|\/|\))/i,/(alcatel|geeksphone|nexian|panasonic(?!(?:;|\.))|sony(?!-bra))[-_ ]?([-\w]*)/i],[d,[p,/_/g," "],[m,x]],[/droid.+; ([ab][1-7]-?[0178a]\d\d?)/i],[p,[d,"Acer"],[m,_]],[/droid.+; (m[1-5] note) bui/i,/\bmz-([-\w]{2,})/i],[p,[d,"Meizu"],[m,x]],[/; ((?:power )?armor(?:[\w ]{0,8}))(?: bui|\))/i],[p,[d,"Ulefone"],[m,x]],[/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|meizu|motorola|polytron|infinix|tecno)[-_ ]?([-\w]*)/i,/(hp) ([\w ]+\w)/i,/(asus)-?(\w+)/i,/(microsoft); (lumia[\w ]+)/i,/(lenovo)[-_ ]?([-\w]+)/i,/(jolla)/i,/(oppo) ?([\w ]+) bui/i],[d,p,[m,x]],[/(kobo)\s(ereader|touch)/i,/(archos) (gamepad2?)/i,/(hp).+(touchpad(?!.+tablet)|tablet)/i,/(kindle)\/([\w\.]+)/i,/(nook)[\w ]+build\/(\w+)/i,/(dell) (strea[kpr\d ]*[\dko])/i,/(le[- ]+pan)[- ]+(\w{1,9}) bui/i,/(trinity)[- ]*(t\d{3}) bui/i,/(gigaset)[- ]+(q\w{1,9}) bui/i,/(vodafone) ([\w ]+)(?:\)| bui)/i],[d,p,[m,_]],[/(surface duo)/i],[p,[d,K],[m,_]],[/droid [\d\.]+; (fp\du?)(?: b|\))/i],[p,[d,"Fairphone"],[m,x]],[/(u304aa)/i],[p,[d,"AT&T"],[m,x]],[/\bsie-(\w*)/i],[p,[d,"Siemens"],[m,x]],[/\b(rct\w+) b/i],[p,[d,"RCA"],[m,_]],[/\b(venue[\d ]{2,7}) b/i],[p,[d,"Dell"],[m,_]],[/\b(q(?:mv|ta)\w+) b/i],[p,[d,"Verizon"],[m,_]],[/\b(?:barnes[& ]+noble |bn[rt])([\w\+ ]*) b/i],[p,[d,"Barnes & Noble"],[m,_]],[/\b(tm\d{3}\w+) b/i],[p,[d,"NuVision"],[m,_]],[/\b(k88) b/i],[p,[d,"ZTE"],[m,_]],[/\b(nx\d{3}j) b/i],[p,[d,"ZTE"],[m,x]],[/\b(gen\d{3}) b.+49h/i],[p,[d,"Swiss"],[m,x]],[/\b(zur\d{3}) b/i],[p,[d,"Swiss"],[m,_]],[/\b((zeki)?tb.*\b) b/i],[p,[d,"Zeki"],[m,_]],[/\b([yr]\d{2}) b/i,/\b(dragon[- ]+touch |dt)(\w{5}) b/i],[[d,"Dragon Touch"],p,[m,_]],[/\b(ns-?\w{0,9}) b/i],[p,[d,"Insignia"],[m,_]],[/\b((nxa|next)-?\w{0,9}) b/i],[p,[d,"NextBook"],[m,_]],[/\b(xtreme\_)?(v(1[045]|2[015]|[3469]0|7[05])) b/i],[[d,"Voice"],p,[m,x]],[/\b(lvtel\-)?(v1[12]) b/i],[[d,"LvTel"],p,[m,x]],[/\b(ph-1) /i],[p,[d,"Essential"],[m,x]],[/\b(v(100md|700na|7011|917g).*\b) b/i],[p,[d,"Envizen"],[m,_]],[/\b(trio[-\w\. ]+) b/i],[p,[d,"MachSpeed"],[m,_]],[/\btu_(1491) b/i],[p,[d,"Rotor"],[m,_]],[/(shield[\w ]+) b/i],[p,[d,"Nvidia"],[m,_]],[/(sprint) (\w+)/i],[d,p,[m,x]],[/(kin\.[onetw]{3})/i],[[p,/\./g," "],[d,K],[m,x]],[/droid.+; (cc6666?|et5[16]|mc[239][23]x?|vc8[03]x?)\)/i],[p,[d,j],[m,_]],[/droid.+; (ec30|ps20|tc[2-8]\d[kx])\)/i],[p,[d,j],[m,x]],[/smart-tv.+(samsung)/i],[d,[m,y]],[/hbbtv.+maple;(\d+)/i],[[p,/^/,"SmartTV"],[d,le],[m,y]],[/(nux; netcast.+smarttv|lg (netcast\.tv-201\d|android tv))/i],[[d,J],[m,y]],[/(apple) ?tv/i],[d,[p,E+" TV"],[m,y]],[/crkey/i],[[p,H+"cast"],[d,N],[m,y]],[/droid.+aft(\w+)( bui|\))/i],[p,[d,w],[m,y]],[/\(dtv[\);].+(aquos)/i,/(aquos-tv[\w ]+)\)/i],[p,[d,ge],[m,y]],[/(bravia[\w ]+)( bui|\))/i],[p,[d,P],[m,y]],[/(mitv-\w{5}) bui/i],[p,[d,$],[m,y]],[/Hbbtv.*(technisat) (.*);/i],[d,p,[m,y]],[/\b(roku)[\dx]*[\)\/]((?:dvp-)?[\d\.]*)/i,/hbbtv\/\d+\.\d+\.\d+ +\([\w\+ ]*; *([\w\d][^;]*);([^;]*)/i],[[d,$e],[p,$e],[m,y]],[/\b(android tv|smart[- ]?tv|opera tv|tv; rv:)\b/i],[[m,y]],[/(ouya)/i,/(nintendo) ([wids3utch]+)/i],[d,p,[m,C]],[/droid.+; (shield) bui/i],[p,[d,"Nvidia"],[m,C]],[/(playstation [345portablevi]+)/i],[p,[d,P],[m,C]],[/\b(xbox(?: one)?(?!; xbox))[\); ]/i],[p,[d,K],[m,C]],[/((pebble))app/i],[d,p,[m,b]],[/(watch)(?: ?os[,\/]|\d,\d\/)[\d\.]+/i],[p,[d,E],[m,b]],[/droid.+; (glass) \d/i],[p,[d,N],[m,b]],[/droid.+; (wt63?0{2,3})\)/i],[p,[d,j],[m,b]],[/(quest( \d| pro)?)/i],[p,[d,de],[m,b]],[/(tesla)(?: qtcarbrowser|\/[-\w\.]+)/i],[d,[m,S]],[/(aeobc)\b/i],[p,[d,w],[m,S]],[/droid .+?; ([^;]+?)(?: bui|; wv\)|\) applew).+? mobile safari/i],[p,[m,x]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+?(?! mobile) safari/i],[p,[m,_]],[/\b((tablet|tab)[;\/]|focus\/\d(?!.+mobile))/i],[[m,_]],[/(phone|mobile(?:[;\/]| [ \w\/\.]*safari)|pda(?=.+windows ce))/i],[[m,x]],[/(android[-\w\. ]{0,9});.+buil/i],[p,[d,"Generic"]]],engine:[[/windows.+ edge\/([\w\.]+)/i],[f,[u,V+"HTML"]],[/webkit\/537\.36.+chrome\/(?!27)([\w\.]+)/i],[f,[u,"Blink"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m|goanna)\/([\w\.]+)/i,/ekioh(flow)\/([\w\.]+)/i,/(khtml|tasman|links)[\/ ]\(?([\w\.]+)/i,/(icab)[\/ ]([23]\.[\d\.]+)/i,/\b(libweb)/i],[u,f],[/rv\:([\w\.]{1,9})\b.+(gecko)/i],[f,u]],os:[[/microsoft (windows) (vista|xp)/i],[u,f],[/(windows (?:phone(?: os)?|mobile))[\/ ]?([\d\.\w ]*)/i],[u,[f,Re,B]],[/windows nt 6\.2; (arm)/i,/windows[\/ ]?([ntce\d\. ]+\w)(?!.+xbox)/i,/(?:win(?=3|9|n)|win 9x )([nt\d\.]+)/i],[[f,Re,B],[u,"Windows"]],[/ip[honead]{2,4}\b(?:.*os ([\w]+) like mac|; opera)/i,/(?:ios;fbsv\/|iphone.+ios[\/ ])([\d\.]+)/i,/cfnetwork\/.+darwin/i],[[f,/_/g,"."],[u,"iOS"]],[/(mac os x) ?([\w\. ]*)/i,/(macintosh|mac_powerpc\b)(?!.+haiku)/i],[[u,ce],[f,/_/g,"."]],[/droid ([\w\.]+)\b.+(android[- ]x86|harmonyos)/i],[f,u],[/(android|webos|qnx|bada|rim tablet os|maemo|meego|sailfish)[-\/ ]?([\w\.]*)/i,/(blackberry)\w*\/([\w\.]*)/i,/(tizen|kaios)[\/ ]([\w\.]+)/i,/\((series40);/i],[u,f],[/\(bb(10);/i],[f,[u,L]],[/(?:symbian ?os|symbos|s60(?=;)|series60)[-\/ ]?([\w\.]*)/i],[f,[u,"Symbian"]],[/mozilla\/[\d\.]+ \((?:mobile|tablet|tv|mobile; [\w ]+); rv:.+ gecko\/([\w\.]+)/i],[f,[u,W+" OS"]],[/web0s;.+rt(tv)/i,/\b(?:hp)?wos(?:browser)?\/([\w\.]+)/i],[f,[u,"webOS"]],[/watch(?: ?os[,\/]|\d,\d\/)([\d\.]+)/i],[f,[u,"watchOS"]],[/crkey\/([\d\.]+)/i],[f,[u,H+"cast"]],[/(cros) [\w]+(?:\)| ([\w\.]+)\b)/i],[[u,re],f],[/panasonic;(viera)/i,/(netrange)mmh/i,/(nettv)\/(\d+\.[\w\.]+)/i,/(nintendo|playstation) ([wids345portablevuch]+)/i,/(xbox); +xbox ([^\);]+)/i,/\b(joli|palm)\b ?(?:os)?\/?([\w\.]*)/i,/(mint)[\/\(\) ]?(\w*)/i,/(mageia|vectorlinux)[; ]/i,/([kxln]?ubuntu|debian|suse|opensuse|gentoo|arch(?= linux)|slackware|fedora|mandriva|centos|pclinuxos|red ?hat|zenwalk|linpus|raspbian|plan 9|minix|risc os|contiki|deepin|manjaro|elementary os|sabayon|linspire)(?: gnu\/linux)?(?: enterprise)?(?:[- ]linux)?(?:-gnu)?[-\/ ]?(?!chrom|package)([-\w\.]*)/i,/(hurd|linux) ?([\w\.]*)/i,/(gnu) ?([\w\.]*)/i,/\b([-frentopcghs]{0,5}bsd|dragonfly)[\/ ]?(?!amd|[ix346]{1,2}86)([\w\.]*)/i,/(haiku) (\w+)/i],[u,f],[/(sunos) ?([\w\.\d]*)/i],[[u,"Solaris"],f],[/((?:open)?solaris)[-\/ ]?([\w\.]*)/i,/(aix) ((\d)(?=\.|\)| )[\w\.])*/i,/\b(beos|os\/2|amigaos|morphos|openvms|fuchsia|hp-ux|serenityos)/i,/(unix) ?([\w\.]*)/i],[u,f]]},q=function(z,U){if(typeof z===s&&(U=z,z=t),!(this instanceof q))return new q(z,U).getResult();var ee=typeof e!==a&&e.navigator?e.navigator:t,D=z||(ee&&ee.userAgent?ee.userAgent:r),Y=ee&&ee.userAgentData?ee.userAgentData:t,oe=U?ut(R,U):R,me=ee&&ee.userAgent==D;return this.getBrowser=function(){var ie={};return ie[u]=t,ie[f]=t,Nt.call(ie,D,oe.browser),ie[c]=qe(ie[f]),me&&ee&&ee.brave&&typeof ee.brave.isBrave==i&&(ie[u]="Brave"),ie},this.getCPU=function(){var ie={};return ie[h]=t,Nt.call(ie,D,oe.cpu),ie},this.getDevice=function(){var ie={};return ie[d]=t,ie[p]=t,ie[m]=t,Nt.call(ie,D,oe.device),me&&!ie[m]&&Y&&Y.mobile&&(ie[m]=x),me&&ie[p]=="Macintosh"&&ee&&typeof ee.standalone!==a&&ee.maxTouchPoints&&ee.maxTouchPoints>2&&(ie[p]="iPad",ie[m]=_),ie},this.getEngine=function(){var ie={};return ie[u]=t,ie[f]=t,Nt.call(ie,D,oe.engine),ie},this.getOS=function(){var ie={};return ie[u]=t,ie[f]=t,Nt.call(ie,D,oe.os),me&&!ie[u]&&Y&&Y.platform&&Y.platform!="Unknown"&&(ie[u]=Y.platform.replace(/chrome os/i,re).replace(/macos/i,ce)),ie},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice(),cpu:this.getCPU()}},this.getUA=function(){return D},this.setUA=function(ie){return D=typeof ie===l&&ie.length>I?$e(ie,I):ie,this},this.setUA(D),this};q.VERSION=o,q.BROWSER=Te([u,f,c]),q.CPU=Te([h]),q.DEVICE=Te([p,d,m,C,x,y,_,b,S]),q.ENGINE=q.OS=Te([u,f]),typeof Tu!==a?(typeof sh!==a&&sh.exports&&(Tu=sh.exports=q),Tu.UAParser=q):typeof define===i&&define.amd?define(function(){return q}):typeof e!==a&&(e.UAParser=q);var ne=typeof e!==a&&(e.jQuery||e.Zepto);if(ne&&!ne.ua){var te=new q;ne.ua=te.getResult(),ne.ua.get=function(){return te.getUA()},ne.ua.set=function(z){te.setUA(z);var U=te.getResult();for(var ee in U)ne.ua[ee]=U[ee]}}})(typeof window=="object"?window:Tu)});var Qm=v(A()),bb=()=>{let e=(0,Qm.useRef)(null);return(0,Qm.useEffect)(()=>{let t=async o=>{e.current?.onMouseUp(o)};return window.addEventListener("contextmenu",t),()=>{window.removeEventListener("contextmenu",t)}},[]),e};var yr=v(A()),Sb=(0,yr.forwardRef)(e=>{let{title:t,showConfirmButton:o=!0,showCancelButton:r=!0,confirmButtonText:n,cancelButtonText:i,onConfirm:a,onCancel:s,onClose:l,confirmButtonDisabled:c,cancelButtonDisabled:p,PaperProps:u,children:m,ConfirmButtonProps:d,CancelButtonProps:f,hideCloseButton:h=!1,loading:C,actionRef:x,..._}=e,[y,b]=(0,yr.useState)(!1),{t:S}=k(),I=async()=>{if(a){b(!0);try{if(!await a())return}catch{}finally{b(!1)}}l?.({},"confirm")},w=async()=>{if(s){b(!0);try{if(!await s())return}catch{}finally{b(!1)}}l?.({},"backdropClick")};return(0,yr.useImperativeHandle)(x,()=>({submit:I,cancel:w})),yr.default.createElement(Ii,{onClose:l,..._,disableScrollLock:!0},yr.default.createElement(F,{sx:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",outline:"none"}},yr.default.createElement(Kr,{...u,sx:{overflowY:"auto",maxHeight:"calc(100vh - 32px)",position:"relative",borderRadius:"8px",maxWidth:"768px!important",width:"calc(100vw - 32px)",margin:"0 auto",p:"24px",display:"flex",flexDirection:"column",gap:"24px",boxSizing:"border-box",bgcolor:E=>E.palette.mode==="dark"?"#2C2C2C":"#FFFFFF",...u?.sx}},!h&&yr.default.createElement(fe,{sx:{padding:"8px",width:"36px",height:"36px",position:"absolute",top:"8px",right:"8px"},onClick:()=>{s?.(),l?.({},"backdropClick")}},yr.default.createElement(X,{sx:{fontSize:"16px!important"},icon:"Close"})),t&&yr.default.createElement(T,{fontSize:"24px",fontWeight:700,textAlign:"left"},t),m,o||r?yr.default.createElement(g,{sx:{gap:"8px",width:"100%"}},o&&yr.default.createElement(an,{loading:y||C,variant:"contained",onClick:I,disabled:c,...d},n||S("package__features:context_menu__lite_editor__modal__common__confirm")),r&&yr.default.createElement(an,{loading:y||C,onClick:w,disabled:p,...f},i||S("package__features:context_menu__lite_editor__modal__common__cancel"))):null)))});Sb.displayName="LiteModal";var Qr=Sb;var $h=v(A()),dM=()=>{let{t:e}=k(),{groupData:t,isOpenDeleteGroupConfirm:o,closeDeleteGroupConfirm:r}=Ms(),{refetch:n}=Nn(),i=Mt();return $h.default.createElement(Qr,{container:i,PaperProps:{sx:{maxWidth:"448px"}},open:o,onClose:()=>{r()},title:e("package__features:context_menu__lite_editor__modal__delete_group__title"),confirmButtonText:e("package__features:context_menu__lite_editor__modal__delete_group__button__delete"),ConfirmButtonProps:{sx:{bgcolor:"#ED5050",color:"white","&:hover":{bgcolor:"rgba(255, 14, 39, 1)",color:"white"}}},onConfirm:async()=>(t?.prompt_id&&(await Hn.deleteContextMenuNode(t.prompt_id,t.parent_prompt_id),await n("LiteContextMenuPromptDeleteConfirm")),!0)},$h.default.createElement(T,{lineHeight:"24px",fontSize:"16px",textAlign:"left",color:"text.primary",fontWeight:400},e("package__features:context_menu__lite_editor__modal__delete_group__description")))},Ib=dM;var br=v(A()),fM=()=>{let{t:e}=k(),t=Mt(),o=(0,br.createRef)(),{groupData:r,updateGroup:n,isOpen:i,closeEditor:a}=Ms(),{changeMode:s}=co(),[l,c]=(0,br.useState)(!1),[p,u]=(0,br.useState)(!1),[m,d]=(0,br.useState)(""),{refetch:f}=Nn(),h=r?.prompt_id?e("package__features:context_menu__lite_editor__modal__edit_group__title__edit"):e("package__features:context_menu__lite_editor__modal__edit_group__title__add"),C=async()=>{try{if(c(!0),r){let x=De(r),_=await Hn.addOrUpdateContextMenuGroup(x);return _.data&&_.success?(d(""),await f("LiteContextMenuGroupEditor"),s("edit")):d(_.error),u(!_.success),_.success}return!0}catch{return!1}finally{c(!1)}};return(0,br.useEffect)(()=>{i?setTimeout(()=>{o.current&&o.current.focus()},100):(u(!1),d(""))},[i]),br.default.createElement(br.default.Fragment,null,br.default.createElement(Qr,{container:t,loading:l,title:h,open:i,onConfirm:async()=>await C(),confirmButtonDisabled:!r?.prompt_title||r?.prompt_title==="",onClose:()=>{a()}},r&&br.default.createElement(g,{gap:"8px"},br.default.createElement(T,{fontSize:"16px",fontWeight:500,textAlign:"left",color:"text.primary"},e("package__features:context_menu__lite_editor__modal__edit_group__variable_name__title")),br.default.createElement(Ut,{error:p,helperText:m,inputProps:{style:{fontSize:"16px",textAlign:"left"}},FormHelperTextProps:{sx:{fontSize:"12px"}},inputRef:o,onKeyUpCapture:x=>{x.stopPropagation()},onKeyDown:x=>{x.stopPropagation()},onKeyUp:x=>{x.stopPropagation()},onKeyPress:x=>{x.stopPropagation()},onKeyPressCapture:x=>{x.stopPropagation()},onKeyDownCapture:async x=>{x.stopPropagation(),x.key==="Enter"&&!x.shiftKey?r&&await C()&&a():x.key==="Escape"&&a()},value:r.prompt_title,onChange:x=>{n({prompt_title:x.target.value})},size:"small",placeholder:e("package__features:context_menu__lite_editor__modal__edit_group__variable_name__label")}))),br.default.createElement(Ib,null))},vb=fM;var Es=v(A()),hM=e=>{let{sx:t,groupData:o,icon:r,onChange:n}=e,{t:i}=k(),{createNewGroup:a,editGroup:s}=Ms(),{isOpen:l}=Ms(),c=(0,Es.useRef)(!1),p=o?.prompt_id?i("package__features:context_menu__lite_editor__modal__edit_group__title__edit"):i("package__features:context_menu__lite_editor__modal__edit_group__title__add"),u=async()=>{await nt({emitEvent:!0})&&(c.current=!0,o?.prompt_id?s(o):await a())};return(0,Es.useEffect)(()=>{!l&&c.current&&(c.current=!1,n?.())},[l,n]),Es.default.createElement(fe,{disabledClickEvent:!0,placement:"top-end",onClick:u,tooltipProps:{PopperProps:{disablePortal:!0},disableInteractive:!0},title:p,sx:t},Es.default.createElement(X,{icon:r||"PromptEdit"}))},wb=hM;var ra=v(A()),Xh=async e=>{let o=(await Hn.getContextMenuChildren(e)).filter(r=>r.type==="group");return q_(o,{labelKey:"prompt_title",valueKey:"prompt_id"})},gM=e=>{let{defaultValue:t,onChange:o,contextMenuPath:r,...n}=e,[i,a]=(0,ra.useState)(t||""),s=ra.default.useRef(null),{data:l,isLoading:c,refetch:p}=Q_({queryKey:[$_.GET_LITE_CONTEXT_MENU_GROUP,r],queryFn:async()=>{let u=await Xh(r);if(u.length>0)return u;let m=await Hn.getContextMenuByPath(r);if(!m)throw new Error("Parent prompt not found");return await Hn.addOrUpdateContextMenuGroup({parent_prompt_id:m.prompt_id,prompt_title:"My tools",prompt_icon:void 0,visibility_settings:{blocked_domains:[],allowed_domains:[],use_allow_list:!1},prompt_id:rr()}),await Xh(r)},enabled:!!r,initialData:[]});return(0,ra.useEffect)(()=>{if(l&&l.length>0){if(s.current){a(s.current.prompt_id),o?.(s.current.prompt_id,s.current),s.current=null;return}l.some(m=>m.value===i)||(a(l[0].value),o?.(l[0].value,l[0].origin))}},[l,i]),ra.default.createElement(ky,{value:i,onChange:(u,m)=>{a(u),o?.(u,m.origin)},sx:{padding:0},MenuProps:{slotProps:{paper:{sx:{textAlign:"left",marginTop:"8px","& > ul":{padding:"8px 0 0 0"}}}}},renderFooter:ra.default.createElement(g,{direction:"row",sx:{justifyContent:"flex-end",alignItems:"center",gap:"8px",padding:"4px",borderTop:"1px solid",borderColor:"border.main"}},ra.default.createElement(wb,{icon:"Add",onChange:async()=>{let m=(await Xh(r)).find(d=>!l.some(f=>f.value===d.value));m?.origin&&(s.current=m.origin,p())},sx:{minWidth:"26px",width:"26px",height:"26px",padding:"4px"}})),loading:c,options:l,...n})},Tb=gM;var Yh=v(A()),xM=()=>{let{t:e}=k(),{promptData:t,isOpenDeletePromptConfirm:o,closeDeletePromptConfirm:r}=Bi(),{refetch:n}=Nn(),i=Mt();return Yh.default.createElement(Qr,{container:i,PaperProps:{sx:{maxWidth:"448px"}},open:o,onClose:()=>{r()},title:e("package__features:context_menu__lite_editor__modal__delete_tool__title"),confirmButtonText:e("package__features:context_menu__lite_editor__modal__delete_tool__button__delete"),ConfirmButtonProps:{sx:{bgcolor:"#ED5050",color:"white","&:hover":{bgcolor:"rgba(255, 14, 39, 1)",color:"white"}}},onConfirm:async()=>(t?.prompt_id&&(await Hn.deleteContextMenuNode(t.prompt_id,t.parent_prompt_id),await n("LiteContextMenuPromptDeleteConfirm")),!0)},Yh.default.createElement(T,{lineHeight:"24px",fontSize:"16px",textAlign:"left",color:"text.primary",fontWeight:400},e("package__features:context_menu__lite_editor__modal__delete_tool__description")))},Mb=xM;var Fi=v(A()),_M=e=>{let{onCreateVariable:t,onUpdateVariable:o}=e,{t:r}=k(),{isOpenEditVariableModal:n,closeEditVariableModal:i,editVariable:a,updateVariable:s,saveEditVariable:l,variables:c}=Va(),[p,u]=(0,Fi.useState)(""),m=Fi.default.createRef(),d=!a.hint?.trim(),f=()=>{let h=De(a);if(h.hint=h.hint.trim(),c.find(x=>x.hint===h.hint&&x.name!==h.name))return u(r("package__features:context_menu__lite_editor__modal__edit_variable__variable_name__error__name_repeated")),!1;if(h.name)l(h),o?.(h);else{let x=iy(h.hint),_={...h,name:x};l(_),t?.(_)}return!0};return(0,Fi.useEffect)(()=>{n&&(u(""),setTimeout(()=>{m.current&&m.current.focus()},100))},[n]),Fi.default.createElement(Qr,{disableRestoreFocus:!0,title:a.name?r("package__features:context_menu__lite_editor__modal__edit_variable__title__edit"):r("package__features:context_menu__lite_editor__modal__edit_variable__title__add"),open:n,confirmButtonDisabled:d,onClose:()=>{i()},onConfirm:async()=>f(),sx:{zIndex:2147483623}},Fi.default.createElement(g,{gap:"8px"},Fi.default.createElement(T,{fontSize:"16px",fontWeight:500,textAlign:"left",color:"text.primary"},r("package__features:context_menu__lite_editor__modal__edit_variable__variable_name__title")),Fi.default.createElement(Ut,{inputRef:m,error:p!=="",helperText:p,inputProps:{style:{fontSize:"16px",textAlign:"left"}},FormHelperTextProps:{sx:{fontSize:"12px"}},value:a.hint,onChange:h=>{s({...a,hint:h.target.value})},onKeyUpCapture:h=>{h.stopPropagation()},onKeyDown:h=>{h.stopPropagation()},onKeyUp:h=>{h.stopPropagation()},onKeyPress:h=>{h.stopPropagation()},onKeyPressCapture:h=>{h.stopPropagation()},onKeyDownCapture:h=>{if(h.stopPropagation(),h.key==="Enter"&&!h.shiftKey){if(h.preventDefault(),d)return;a&&f()&&i()}else h.key==="Escape"&&(h.preventDefault(),i())},size:"small",placeholder:r("package__features:context_menu__lite_editor__modal__edit_variable__variable_name__label")})))},Eb=_M;var Hr=v(A()),CM=To(({className:e,...t})=>Hr.default.createElement(Pn,{...t,classes:{popper:e}}))(({theme:e})=>({[`& > .${Pr.tooltip}`]:{backgroundColor:"#fff",color:"rgba(0, 0, 0, 0.87)",maxWidth:"unset",border:"1px solid #E0E0E0",boxShadow:e.shadows[5]},"& button > svg":{color:"rgba(0, 0, 0, 0.87)!important"},'&[data-popper-placement="bottom"] > div':{marginTop:"8px !important"},'&[data-popper-placement="top"] > div':{marginBottom:"8px !important"},[`& > .${Pr.arrow}`]:{color:"#fff"}})),yM=e=>{let{variable:t,onClick:o,onDelete:r,onEdit:n}=e,{t:i}=k(),{theme:a}=Zr(),[s,l]=(0,Hr.useState)(!1),c=a.palette.mode==="dark",p=Ly(t.name,c),u=Oy(p,c?.3:.8,c?.1:.3);return Hr.default.createElement("div",null,Hr.default.createElement(CM,{title:Hr.default.createElement(g,{direction:"row",gap:"4px"},Hr.default.createElement(fe,{placement:"top",tooltipProps:{disableInteractive:!0,PopperProps:{disablePortal:!0}},sx:{width:"20px",height:"20px",minWidth:"20px",borderRadius:"2px"},title:i("package__features:context_menu__lite_editor__modal__edit_variable__title__edit"),onClick:()=>{n&&n()}},Hr.default.createElement(X,{sx:{fontSize:"16px!important"},icon:"PromptEdit"})),Hr.default.createElement(fe,{placement:"top",tooltipProps:{disableInteractive:!0,PopperProps:{disablePortal:!0}},sx:{width:"20px",height:"20px",minWidth:"20px",borderRadius:"2px"},title:i("package__features:context_menu__lite_editor__modal__delete_variable__title__delete"),onClick:()=>{l(!0)}},Hr.default.createElement(X,{sx:{fontSize:"16px!important"},icon:"Delete"}))),placement:"top",PopperProps:{disablePortal:!0}},Hr.default.createElement(Ce,{key:t.name,sx:{minWidth:"unset",padding:"2px 6px",color:p,bgcolor:u,"&:hover":{color:p,bgcolor:u}},onClick:()=>{o&&o()}},Hr.default.createElement(T,{lineHeight:"20px",fontSize:"14px",fontWeight:400,textAlign:"left",color:"inherit",noWrap:!0,maxWidth:"240px"},`{{${t.hint}}}`))),Hr.default.createElement(Qr,{PaperProps:{sx:{maxWidth:"448px"}},open:s,onClose:()=>{l(!1)},title:i("package__features:context_menu__lite_editor__modal__delete_variable__title__delete"),confirmButtonText:i("package__features:context_menu__lite_editor__modal__delete_variable__button__delete"),ConfirmButtonProps:{sx:{bgcolor:"#ED5050",color:"white","&:hover":{bgcolor:"rgba(255, 14, 39, 1)",color:"white"}}},onConfirm:async()=>(r&&r(),l(!1),!0)},Hr.default.createElement(T,{lineHeight:"24px",fontSize:"16px",textAlign:"left",color:"text.primary",fontWeight:400},i("package__features:context_menu__lite_editor__modal__delete_variable__description"))))},Ab=yM;var Pb=v(eM());var ja=v(A()),bM=e=>{let{sx:t,onInsertVariable:o,children:r}=e,{t:n}=k(),{variables:i,openEditVariableModal:a,deleteVariable:s}=Va(),{secondaryElementMouseLeave:l,secondaryElementMouseEnter:c,secondaryElementSx:p}=Bi(),u=m=>{a(m)};return ja.default.createElement(g,{onMouseLeave:l,onMouseEnter:c,direction:"row",sx:{flexWrap:"wrap",gap:"8px",alignItems:"center",bgcolor:m=>m.palette.mode==="dark"?"#363839":"#f9f9f9",...p,...t}},i.map(m=>m.hidden||m.type==="select"?null:ja.default.createElement(Ab,{variable:m,onClick:()=>o(m),onEdit:()=>u(m),onDelete:()=>{s(m)},key:m.name+m.hint})),ja.default.createElement(Ce,{sx:{padding:"2px 6px",gap:"4px",display:"flex",alignItems:"center",bgcolor:m=>m.palette.mode==="dark"?"rgba(255, 255, 255, 0.08)":"rgba(0, 0, 0, 0.06)","&:hover":{bgcolor:m=>m.palette.mode==="dark"?"rgba(255, 255, 255, 0.08)":"rgba(0, 0, 0, 0.06)"}},onClick:()=>{a({name:"",hint:"",type:"text"})}},ja.default.createElement(T,{lineHeight:"20px",fontSize:"14px",fontWeight:400,textAlign:"left",color:"inherit",noWrap:!0},n("package__features:context_menu__lite_editor__modal__edit_variable__button__new_variable")),ja.default.createElement(ve,{title:n("package__features:context_menu__lite_editor__modal__edit_variable__button__new_variable__tooltip"),PopperProps:{disablePortal:!0},disableInteractive:!0},ja.default.createElement(Pb.default,{sx:{fontSize:"12px"}}))),ja.default.createElement(Eb,{onCreateVariable:m=>{o(m)}}),r)},kb=bM;var jl=v(A()),SM=typeof Element<"u",IM=typeof Map=="function",vM=typeof Set=="function",wM=typeof ArrayBuffer=="function"&&!!ArrayBuffer.isView,Jm=(e,t)=>{if(e===t)return!0;if(e&&t&&typeof e=="object"&&typeof t=="object"){if(e.constructor!==t.constructor)return!1;let o,r,n;if(Array.isArray(e)){if(o=e.length,o!=t.length)return!1;for(r=o;r--!==0;)if(!Jm(e[r],t[r]))return!1;return!0}let i;if(IM&&e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;for(i=e.entries();!(r=i.next()).done;)if(!t.has(r.value[0]))return!1;for(i=e.entries();!(r=i.next()).done;)if(!Jm(r.value[1],t.get(r.value[0])))return!1;return!0}if(vM&&e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;for(i=e.entries();!(r=i.next()).done;)if(!t.has(r.value[0]))return!1;return!0}if(wM&&ArrayBuffer.isView(e)&&ArrayBuffer.isView(t)){if(o=e.length,o!=t.length)return!1;for(r=o;r--!==0;)if(e[r]!==t[r])return!1;return!0}if(e.constructor===RegExp)return e.source===t.source&&e.flags===t.flags;if(e.valueOf!==Object.prototype.valueOf&&typeof e.valueOf=="function"&&typeof t.valueOf=="function")return e.valueOf()===t.valueOf();if(e.toString!==Object.prototype.toString&&typeof e.toString=="function"&&typeof t.toString=="function")return e.toString()===t.toString();if(n=Object.keys(e),o=n.length,o!==Object.keys(t).length)return!1;for(r=o;r--!==0;)if(!Object.prototype.hasOwnProperty.call(t,n[r]))return!1;if(SM&&e instanceof Element)return!1;for(r=o;r--!==0;)if(!((n[r]==="_owner"||n[r]==="__v"||n[r]==="__o")&&e.$$typeof)&&!Jm(e[n[r]],t[n[r]]))return!1;return!0}return e!==e&&t!==t};function Lb(e){return e&&e.replace(/&nbsp;|\u202F|\u00A0/g," ").replace(/<br\s*\/>/g,"<br>")}function Ob(e){return e.replace(/(<br\s*\/?>)+$/i,"")}function Zh(e){if(!e)return"";let t=e.replace(/<br\s*\/>/gi,"<br>");return/<br>$/i.test(t)?t:t+"<br>"}function Bb(e){let t=document.createTextNode("");e.appendChild(t);let o=document.activeElement===e;if(t.nodeValue!==null&&o){let r=window.getSelection();if(r!==null){let n=document.createRange();n.setStart(t,t.nodeValue.length),n.collapse(!0),r.removeAllRanges(),r.addRange(n)}e.focus()}}var up=class extends jl.Component{constructor(){super(...arguments);this.lastHtml=this.props.html;this.el=typeof this.props.innerRef=="function"?{current:null}:jl.createRef();this.getEl=()=>(this.props.innerRef&&typeof this.props.innerRef!="function"?this.props.innerRef:this.el).current;this.emitChange=o=>{let r=this.getEl();if(!r)return;let n=Ob(r.innerHTML);if(this.props.onChange&&n!==this.lastHtml){let i=Object.assign({},o,{target:{value:n}});this.props.onChange(i)}this.lastHtml=n};this._recordCompositionPrevElement=null;this._recordCompositionPrevElementParentNode=null}_focusRecordCompositionPrevElement(){if(!this._recordCompositionPrevElement)return;let o=document.createRange(),r=window.getSelection();r&&(this._recordCompositionPrevElement===this.getEl()?o.setStart(this.getEl(),0):this._recordCompositionPrevElement.nextSibling?this._recordCompositionPrevElement.nextSibling.contentEditable==="false"&&this._recordCompositionPrevElementParentNode?o.setStart(this._recordCompositionPrevElementParentNode,Array.from(this._recordCompositionPrevElementParentNode.childNodes).indexOf(this._recordCompositionPrevElement.nextSibling)):o.setStart(this._recordCompositionPrevElement.nextSibling,0):this._recordCompositionPrevElementParentNode&&o.setStart(this._recordCompositionPrevElementParentNode,this._recordCompositionPrevElementParentNode.childNodes.length),o.collapse(!0),r.removeAllRanges(),r.addRange(o),this.getEl()?.focus())}getPreviousElementFromCaret(){let r=(this.getEl()?.getRootNode()||window).getSelection();if(!r?.rangeCount)return null;let n=this.getEl();if(!n)return null;let i=r.getRangeAt(0);if(!n.contains(i.commonAncestorContainer))return null;let a=i.startContainer,s=i.startOffset;if(a===n){if(s===0)return n;if(s<=n.childNodes.length)return n.childNodes[s-1]}return a.nodeType===Node.TEXT_NODE&&s===0?a.previousSibling:null}shouldComponentUpdate(o){let r=this.getEl();if(!r)return!0;let n=Ob(r.innerHTML);return Lb(o.html)!==Lb(n)?!0:this.props.disabled!==o.disabled||this.props.tagName!==o.tagName||this.props.className!==o.className||this.props.innerRef!==o.innerRef||this.props.placeholder!==o.placeholder||!Jm(this.props.style,o.style)}componentDidUpdate(){let o=this.getEl();if(!o)return;let r=Zh(this.props.html);r!==o.innerHTML&&(o.innerHTML=r),this.lastHtml=this.props.html,Bb(o)}componentDidMount(){let o=this.getEl();if(!o)return;let r=Zh(this.props.html);r!==o.innerHTML&&(o.innerHTML=r),this.lastHtml=this.props.html,Bb(o)}render(){let{tagName:o,html:r,innerRef:n,children:i,...a}=this.props,s=Zh(r);return jl.createElement(o||"div",{...a,ref:typeof n=="function"?l=>{n(l),this.el.current=l}:n||this.el,onInput:this.emitChange,onBlur:this.props.onBlur||this.emitChange,onKeyUp:this.props.onKeyUp||this.emitChange,onKeyDown:this.props.onKeyDown||this.emitChange,onCompositionStart:l=>{this._recordCompositionPrevElement=this.getPreviousElementFromCaret(),this._recordCompositionPrevElementParentNode=this._recordCompositionPrevElement?.parentNode||null,this.props.onCompositionStart?.(l)},onCompositionEnd:l=>{l.data||this._focusRecordCompositionPrevElement(),this.props.onCompositionEnd?.(l)},contentEditable:!this.props.disabled,dangerouslySetInnerHTML:{__html:s}},i)}};var Dt=v(A()),TM=e=>{let{promptId:t,error:o,disabled:r,placeholder:n,minHeight:i=80,maxHeight:a=80,sx:s,onData:l,onClose:c,...p}=e,[u,m]=(0,Dt.useState)(!1),{t:d}=k(),{theme:f}=Zr(),h=F_(),{template:C,setTemplate:x,variables:_,html:y,setIsDarkMode:b,htmlToTemplate:S}=Va(),I=(0,Dt.useRef)(null),w=(0,Dt.useRef)(""),E=(0,Dt.useRef)(!1),O=!!t,L=(0,Dt.useMemo)(()=>qo([{pointerEvents:r?"none":"auto",borderRadius:"8px",display:"flex",flexDirection:"column",width:"100%",border:"1px solid",outline:"0px solid",height:"100%",outlineColor:N=>N.palette.mode==="dark"?"rgba(255, 255, 255, 0.2)":"rgba(0,0,0,0.12)",borderColor:N=>N.palette.mode==="dark"?"rgba(255, 255, 255, 0.2)":"rgba(0,0,0,0.12)",boxSizing:"border-box","& > div":{"&:first-of-type":{borderRadius:"8px 8px 0 0"},"&:last-of-type":{borderRadius:"0 0 8px 8px"},padding:"8px",fontFamily:"Roboto, Helvetica, Arial, sans-serif!important"},"&:hover":{outlineColor:N=>N.palette.mode==="dark"?"#fff":"rgba(0, 0, 0,.87)",borderColor:N=>N.palette.mode==="dark"?"#fff":"rgba(0, 0, 0,.87)"},"&:has( > div:active),&:has( > div:focus)":{outlineColor:N=>N.palette.mode==="dark"?"#fff":"rgba(0, 0, 0,.87)",borderColor:N=>N.palette.mode==="dark"?"#fff":"rgba(0, 0, 0,.87)",outlineWidth:1},".prompt-template-input[contenteditable=true]:empty:before":{content:"attr(data-placeholder)",display:"block",color:"#aaa",fontFamily:"Roboto, Helvetica, Arial, sans-serif!important"},".prompt-template-input":{display:"block",outline:"none!important",boxSizing:"border-box",width:"calc(100% - 4px)",minHeight:u?"unset":`${i}px`,height:u?"unset":`calc(95vh - ${O?"420":"495"}px)`,flex:u?1:"unset",overflow:"auto",fontSize:16,lineHeight:1.4,letterSpacing:"0.4px",WebkitUserModify:"read-write-plaintext-only"}},s,o?{"&:":{"--borderColor":N=>`${N.palette.error.main}!important`}}:{}]),[r,i,a,s,o,u,O]);(0,Dt.useEffect)(()=>{b(f.palette.mode==="dark")},[f.palette.mode]);let G=()=>{I.current&&setTimeout(()=>{Uh(I.current,w.current,h)},0)},H=async N=>{if(I.current){let Z=I.current.innerText.replace(/\n$/,""),J=w.current;Z.startsWith(J)?(w.current=J+`{{${N.hint}}}`,Z=w.current+Z.slice(J.length)):(w.current=Z+`{{${N.hint}}}`,Z+=`{{${N.hint}}}`);let K=new Map;_.forEach(ge=>{K.set(ge.hint,ge.name)}),K.set(N.hint,N.name);let Q=/\{\{([^{}]+?)\}\}/g,M=document.createElement("textarea");M.textContent=Z;let le=M.innerHTML;M.remove(),Z=le.replace(Q,(ge,P)=>{let $=K.get(P);return $?`{{${$}}}`:ge}),x(Z),G()}},V=N=>{if(I.current)if(h()?.rangeCount){let J=h()?.getRangeAt(0),K=J?.cloneRange();J&&K&&(J.collapsed&&J.startContainer.parentElement?.tagName==="SPAN"&&J.setStartAfter(J.startContainer.parentElement),K.selectNodeContents(I.current),K.setEnd(J.startContainer,J.startOffset),w.current=K.toString())}else I.current.focus()};(0,Dt.useEffect)(()=>{l?.({template:C,variables:_})},[C,_]),(0,Dt.useEffect)(()=>{setTimeout(()=>{I.current&&(w.current=I.current.innerText,I.current.focus(),Uh(I.current,w.current,h))},100)},[t,u]);let W=()=>Dt.default.createElement(F,{sx:L},Dt.default.createElement(up,{style:{textAlign:"left"},innerRef:I,html:y,className:"prompt-template-input",id:"prompt-template-input","data-testid":"prompt-template-input","data-placeholder":n,onChange:N=>{if(E.current)return;let Z=N.target.value;V("onChange"),S(Z)},onCompositionStart:N=>{E.current=!0},onCompositionEnd:N=>{if(E.current=!1,!N.data)return;let Z=N.target.innerHTML;V("onCompositionEnd"),S(Z)},onKeyDownCapture:N=>{N.stopPropagation(),N.key==="Escape"&&(u?m(!1):c?.())},onKeyUpCapture:N=>{N.stopPropagation(),!E.current&&V("onKeyUp")},onKeyPress:N=>{N.stopPropagation()},onKeyPressCapture:N=>{N.stopPropagation()},onKeyDown:N=>{N.stopPropagation()},onKeyUp:N=>{N.stopPropagation()},onMouseUp:()=>{V("onMouseUp")},...p}),Dt.default.createElement(g,{direction:"row",alignItems:"center",justifyContent:"end",sx:{padding:"4px!important","&:empty":{display:"none"}}},!u&&Dt.default.createElement(fe,{placement:"top",tooltipProps:{disableInteractive:!0,PopperProps:{disablePortal:!0}},sx:{alignItems:"flex-end",marginLeft:"auto"},title:d("package__features:context_menu__lite_editor__modal__edit_tool__prompt_template__expand"),onClick:()=>{m(!0)},"data-testid":"maxai-prompt-template-input--expand"},Dt.default.createElement(X,{icon:"ExpandContent"}))),Dt.default.createElement(kb,{onInsertVariable:H}));return u?Dt.default.createElement(Ii,{open:!0,sx:{position:"fixed",zIndex:2147483622},onClose:()=>{m(!1)}},Dt.default.createElement(Kr,{component:"div",sx:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%,-50%)",my:0,boxShadow:"none",overflow:"hidden",height:"95vh",width:"80vw",padding:"24px",alignItems:"center",justifyContent:"center",boxSizing:"border-box"}},Dt.default.createElement(g,{width:"100%",gap:"24px",height:"100%"},Dt.default.createElement(g,{width:"100%",height:0,flex:1},W()),Dt.default.createElement(g,{direction:"row",sx:{flexShrink:0,alignItems:"center",justifyContent:"end",height:"40px"}},Dt.default.createElement(Ce,{variant:"contained",onClick:()=>{m(!1)}},d("package__features:context_menu__lite_editor__modal__edit_tool__prompt_template__close")))))):Dt.default.createElement(Dt.default.Fragment,null,W())},Fb=TM;var At=v(A()),Db=De(rp).map(e=>({label:e,value:e})),MM=({defaultValue:e="",placement:t="bottom-start",tooltipProps:o,onChange:r,disabled:n})=>{let i=Mt(),{t:a}=k(),s=(0,At.useRef)(null),l=(0,At.useRef)(null),[c,p]=(0,At.useState)(!1),[u,m]=(0,At.useState)(""),d=(0,At.useMemo)(()=>Db.filter(C=>C.label.toLowerCase().includes(u.toLowerCase())||C.value.toLowerCase().includes(u.toLowerCase())),[u]),[f,h]=(0,At.useState)(()=>Db.find(C=>C.value===e)||void 0);return(0,At.useEffect)(()=>{c?setTimeout(()=>{l.current?.focus()},100):m("")},[c]),At.default.createElement(ve,{title:a("package__ui:contextmenu_icon_selector__title"),PopperProps:{container:i},...o,disabled:n},At.default.createElement("div",{style:{flexShrink:0}},At.default.createElement(Ce,{ref:s,variant:"outlined",sx:{height:"40px",padding:"8px",display:"flex",alignItems:"center",gap:"8px",width:"fit-content",boxSizing:"border-box",borderColor:C=>C.palette.mode==="dark"?"rgba(255, 255, 255, 0.2)":"rgba(0,0,0,0.12)"},onClick:()=>{n||p(!c)}},f?At.default.createElement(X,{sx:{fontSize:"24px"},icon:f.value}):At.default.createElement(F,{sx:{bgcolor:C=>C.palette.mode==="dark"?"rgba(255, 255, 255, 0.06)":"rgba(0, 0, 0, 0.06)",width:"24px",height:"24px"}}),At.default.createElement(X,{sx:{fontSize:"18px",color:"text.secondary"},icon:c?"ArrowDropUp":"ArrowDropDown"})),At.default.createElement(Ml,{anchorEl:s.current,open:c,placement:t,container:i,onClose:()=>{p(!1)}},At.default.createElement(g,{sx:{padding:"8px",gap:"24px"}},At.default.createElement(Ut,{onKeyUpCapture:C=>{C.stopPropagation()},onKeyDown:C=>{C.stopPropagation()},onKeyUp:C=>{C.stopPropagation()},onKeyPress:C=>{C.stopPropagation()},onKeyPressCapture:C=>{C.stopPropagation()},inputRef:l,placeholder:a("package__ui:contextmenu_icon_selector__filter_label"),inputProps:{style:{fontSize:"16px",textAlign:"left"}},size:"small",InputProps:{startAdornment:At.default.createElement(Bn,{position:"start"},At.default.createElement(X,{icon:"Search"}))},value:u,onChange:C=>{m(C.target.value)}}),At.default.createElement(g,{direction:"row",sx:{gap:"16px",flexWrap:"wrap",width:"288px",maxHeight:"224px",overflowY:"auto"}},d.map((C,x)=>At.default.createElement("div",{key:x},At.default.createElement(fe,{title:C.label,tooltipProps:{PopperProps:{disablePortal:!0},disableInteractive:!0},sx:{backgroundColor:C.value===f?.value?"rgba(0, 0, 0, 0.04)":"transparent"},onClick:()=>{h(C),p(!1),r?.(C.value)}},At.default.createElement(X,{icon:C.value})))),d.length===0&&At.default.createElement(T,{sx:{color:"text.secondary"},textAlign:"center",fontSize:"14px",fontWeight:400,width:"100%"},a("package__ui:contextmenu_icon_selector__no_result")))))))},Hb=MM;var dt=v(A());var Qh=v(A());var EM=()=>{let{t:e}=k(),{isOpenDiscardConfirmModal:t,closeDiscardConfirmModal:o,closeEditor:r}=Bi(),n=Mt();return Qh.default.createElement(Qr,{container:n,PaperProps:{sx:{maxWidth:"448px"}},open:t,title:e("package__features:context_menu__lite_editor__modal__discard_edits__title"),confirmButtonText:e("package__common:discard"),ConfirmButtonProps:{sx:{bgcolor:"#ED5050",color:"white","&:hover":{bgcolor:"rgba(255, 14, 39, 1)",color:"white"}}},onClose:()=>{o()},onConfirm:async()=>(r(),!0)},Qh.default.createElement(T,{lineHeight:"24px",fontSize:"16px",textAlign:"left",color:"text.primary",fontWeight:400},e("package__features:context_menu__lite_editor__modal__discard_edits__description")))},Nb=EM;var AM=e=>{let{sx:t}=e,o=Mt(),{t:r}=k(),{contextMenuPath:n,changeMode:i}=co(),[a,s]=dt.default.useState(!1),[l,c]=dt.default.useState(""),p=(0,dt.useRef)(null),{updatePrompt:u,closeEditor:m,isOpen:d,promptData:f,secondaryElementSx:h,secondaryElementMouseLeave:C,secondaryElementMouseEnter:x,openDiscardConfirmModal:_,originalPromptData:y}=Bi(),{refetch:b}=Nn();(0,dt.useEffect)(()=>{d||(s(!1),c(""))},[d]);let S=st(f),I=st(y),w=O=>({template:O?.prompt_template?.default?.trim()||"",title:O?.prompt_title?.trim()||"",icon:O?.prompt_icon,variables:O?.variables||[]}),E=()=>{let O=S.current,L=I.current;if(!O||!L)return!1;let G=w(O),H=w(L);return G.template!==H.template||G.title!==H.title||G.icon!==H.icon||!K_(G.variables,H.variables)?(_(),!0):!1};return dt.default.createElement(dt.default.Fragment,null,dt.default.createElement(Qr,{actionRef:p,container:o,open:d,PaperProps:{sx:{height:"95vh"}},title:f?.prompt_id?r("package__features:context_menu__lite_editor__modal__edit_tool__title__edit"):r("package__features:context_menu__lite_editor__modal__edit_tool__title__add"),confirmButtonDisabled:f?.prompt_template?.default===""||f?.prompt_title==="",onConfirm:async()=>{if(f){let O=De(f);O.variables=O.variables.filter(G=>!!(G.hidden||O.prompt_template?.default?.includes(G.name)));let L=await Hn.addOrUpdateContextMenu(O);return L.data&&L.success?(c(""),await b("LiteContextMenuPromptEditor"),i("edit")):c(L.error),s(!L.success),L.success}return!0},onClose:(O,L)=>{L!=="confirm"&&E()||m()}},dt.default.createElement(g,{width:"100%",sx:{...t}},dt.default.createElement(g,{gap:"16px"},f&&dt.default.createElement(g,{gap:"4px"},dt.default.createElement(g,{direction:"row",alignItems:"center",justifyContent:"space-between"},dt.default.createElement(g,{direction:"row",gap:"4px",alignItems:"center"},dt.default.createElement(T,{fontSize:"16px",fontWeight:500,color:"text.primary"},r("package__features:context_menu__lite_editor__modal__edit_tool__variable_prompt__label"))),dt.default.createElement(g,{direction:"row",gap:"4px",alignItems:"center"},dt.default.createElement(T,{fontSize:"14px",fontWeight:400,color:"text.secondary"},r("package__features:context_menu__lite_editor__modal__edit_tool__variable_prompt__help_1")),dt.default.createElement(T,{href:"https://www.maxai.me/docs/help/my-own-prompts/ai-prompt-writing-guide/",target:"_blank",component:"a",fontSize:"14px",fontWeight:400,color:"text.primary",sx:{textDecoration:"underline",cursor:"pointer"}},r("package__features:context_menu__lite_editor__modal__edit_tool__variable_prompt__help_2")))),dt.default.createElement(Fb,{promptId:f?.prompt_id,onClose:()=>{E()||m()},onData:O=>{u({prompt_template:{default:O.template},variables:O.variables})},placeholder:r("package__features:context_menu__lite_editor__modal__edit_tool__prompt_template__placeholder")}))),dt.default.createElement(g,{onMouseEnter:x,onMouseLeave:C,sx:{gap:"16px",flexWrap:"wrap",width:"100%",pt:"16px",...h}},dt.default.createElement(g,{gap:"4px"},dt.default.createElement(T,{fontWeight:500,fontSize:"16px",color:"text.primary",textAlign:"left"},r("package__features:context_menu__lite_editor__modal__edit_tool__variable_name__label")),dt.default.createElement(g,{direction:"row",gap:"4px"},dt.default.createElement(Hb,{defaultValue:f?.prompt_icon,onChange:O=>{u({prompt_icon:O})}}),dt.default.createElement(Ut,{error:a,helperText:l,inputProps:{style:{fontSize:"16px",textAlign:"left"}},FormHelperTextProps:{sx:{fontSize:"12px"}},size:"small",fullWidth:!0,placeholder:r("package__features:context_menu__lite_editor__modal__edit_tool__variable_name__placeholder"),defaultValue:f?.prompt_title||"",onKeyDownCapture:O=>{if(O.stopPropagation(),O.key==="Escape"){if(E())return;m()}O.key==="Enter"&&f?.prompt_title&&f.prompt_template?.default&&(O.preventDefault(),p.current?.submit())},onKeyUpCapture:O=>{O.stopPropagation()},onKeyDown:O=>{O.stopPropagation()},onKeyUp:O=>{O.stopPropagation()},onKeyPress:O=>{O.stopPropagation()},onKeyPressCapture:O=>{O.stopPropagation()},onChange:O=>{u({prompt_title:O.target.value})}}))),!f?.prompt_id&&dt.default.createElement(g,{gap:"4px"},dt.default.createElement(T,{fontWeight:500,fontSize:"16px",color:"text.primary",textAlign:"left"},r("package__features:context_menu__lite_editor__modal__edit_tool__variable_parent_group__label")),dt.default.createElement(Tb,{contextMenuPath:n||"",sx:{width:"100%",height:"40px"},defaultValue:f?.parent_prompt_id||"",onChange:O=>{u({parent_prompt_id:O})}}))))),dt.default.createElement(Mb,null),dt.default.createElement(Nb,null))},zb=AM;var ai=v(A()),PM=e=>{let{defaultContextMenuPath:t,defaultMode:o,children:r,panelId:n}=e,[i,a]=(0,ai.useState)(o||"list"),[s,l]=(0,ai.useState)(t!==void 0?t:null),p={panelId:(0,ai.useRef)(n||rr()).current,contextMenuPath:s,mode:i,changeMode:a,changeContextMenuPath:l};return ai.default.createElement(ly.Provider,{value:p},ai.default.createElement(ai.default.Fragment,null,r,ai.default.createElement(zb,null),ai.default.createElement(vb,null)))},qa=PM;var As=v(A()),qb=v(sl());var td=v(A()),kM=function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(r[i]=n[i])},e(t,o)};return function(t,o){e(t,o);function r(){this.constructor=t}t.prototype=o===null?Object.create(o):(r.prototype=o.prototype,new r)}}(),Mo=function(){return Mo=Object.assign||function(e){for(var t,o=1,r=arguments.length;o<r;o++){t=arguments[o];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e},Mo.apply(this,arguments)},Vb={width:"100%",height:"10px",top:"0px",left:"0px",cursor:"row-resize"},Rb={width:"10px",height:"100%",top:"0px",left:"0px",cursor:"col-resize"},ed={width:"20px",height:"20px",position:"absolute"},LM={top:Mo(Mo({},Vb),{top:"-5px"}),right:Mo(Mo({},Rb),{left:void 0,right:"-5px"}),bottom:Mo(Mo({},Vb),{top:void 0,bottom:"-5px"}),left:Mo(Mo({},Rb),{left:"-5px"}),topRight:Mo(Mo({},ed),{right:"-10px",top:"-10px",cursor:"ne-resize"}),bottomRight:Mo(Mo({},ed),{right:"-10px",bottom:"-10px",cursor:"se-resize"}),bottomLeft:Mo(Mo({},ed),{left:"-10px",bottom:"-10px",cursor:"sw-resize"}),topLeft:Mo(Mo({},ed),{left:"-10px",top:"-10px",cursor:"nw-resize"})},Ub=function(e){kM(t,e);function t(){var o=e!==null&&e.apply(this,arguments)||this;return o.onMouseDown=function(r){o.props.onResizeStart(r,o.props.direction)},o.onTouchStart=function(r){o.props.onResizeStart(r,o.props.direction)},o}return t.prototype.render=function(){return td.createElement("div",{className:this.props.className||"",style:Mo(Mo({position:"absolute",userSelect:"none"},LM[this.props.direction]),this.props.replaceStyles||{}),onMouseDown:this.onMouseDown,onTouchStart:this.onTouchStart},this.props.children)},t}(td.PureComponent);var OM=function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(r[i]=n[i])},e(t,o)};return function(t,o){e(t,o);function r(){this.constructor=t}t.prototype=o===null?Object.create(o):(r.prototype=o.prototype,new r)}}(),Di=function(){return Di=Object.assign||function(e){for(var t,o=1,r=arguments.length;o<r;o++){t=arguments[o];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e},Di.apply(this,arguments)},BM={width:"auto",height:"auto"},od=function(e,t,o){return Math.max(Math.min(e,o),t)},Wb=function(e,t,o){var r=Math.round(e/t);return r*t+o*(r-1)},ql=function(e,t){return new RegExp(e,"i").test(t)},rd=function(e){return!!(e.touches&&e.touches.length)},FM=function(e){return!!((e.clientX||e.clientX===0)&&(e.clientY||e.clientY===0))},Gb=function(e,t,o){o===void 0&&(o=0);var r=t.reduce(function(i,a,s){return Math.abs(a-e)<Math.abs(t[i]-e)?s:i},0),n=Math.abs(t[r]-e);return o===0||n<o?t[r]:e},Jh=function(e){return e=e.toString(),e==="auto"||e.endsWith("px")||e.endsWith("%")||e.endsWith("vh")||e.endsWith("vw")||e.endsWith("vmax")||e.endsWith("vmin")?e:e+"px"},nd=function(e,t,o,r){if(e&&typeof e=="string"){if(e.endsWith("px"))return Number(e.replace("px",""));if(e.endsWith("%")){var n=Number(e.replace("%",""))/100;return t*n}if(e.endsWith("vw")){var n=Number(e.replace("vw",""))/100;return o*n}if(e.endsWith("vh")){var n=Number(e.replace("vh",""))/100;return r*n}}return e},DM=function(e,t,o,r,n,i,a){return r=nd(r,e.width,t,o),n=nd(n,e.height,t,o),i=nd(i,e.width,t,o),a=nd(a,e.height,t,o),{maxWidth:typeof r>"u"?void 0:Number(r),maxHeight:typeof n>"u"?void 0:Number(n),minWidth:typeof i>"u"?void 0:Number(i),minHeight:typeof a>"u"?void 0:Number(a)}},HM=function(e){return Array.isArray(e)?e:[e,e]},NM=["as","ref","style","className","grid","gridGap","snap","bounds","boundsByDirection","size","defaultSize","minWidth","minHeight","maxWidth","maxHeight","lockAspectRatio","lockAspectRatioExtraWidth","lockAspectRatioExtraHeight","enable","handleStyles","handleClasses","handleWrapperStyle","handleWrapperClass","children","onResizeStart","onResize","onResizeStop","handleComponent","scale","resizeRatio","snapGap"],jb="__resizable_base__",Kb=function(e){OM(t,e);function t(o){var r,n,i,a,s=e.call(this,o)||this;return s.ratio=1,s.resizable=null,s.parentLeft=0,s.parentTop=0,s.resizableLeft=0,s.resizableRight=0,s.resizableTop=0,s.resizableBottom=0,s.targetLeft=0,s.targetTop=0,s.appendBase=function(){if(!s.resizable||!s.window)return null;var l=s.parentNode;if(!l)return null;var c=s.window.document.createElement("div");return c.style.width="100%",c.style.height="100%",c.style.position="absolute",c.style.transform="scale(0, 0)",c.style.left="0",c.style.flex="0 0 100%",c.classList?c.classList.add(jb):c.className+=jb,l.appendChild(c),c},s.removeBase=function(l){var c=s.parentNode;c&&c.removeChild(l)},s.state={isResizing:!1,width:(n=(r=s.propsSize)===null||r===void 0?void 0:r.width)!==null&&n!==void 0?n:"auto",height:(a=(i=s.propsSize)===null||i===void 0?void 0:i.height)!==null&&a!==void 0?a:"auto",direction:"right",original:{x:0,y:0,width:0,height:0},backgroundStyle:{height:"100%",width:"100%",backgroundColor:"rgba(0,0,0,0)",cursor:"auto",opacity:0,position:"fixed",zIndex:9999,top:"0",left:"0",bottom:"0",right:"0"},flexBasis:void 0},s.onResizeStart=s.onResizeStart.bind(s),s.onMouseMove=s.onMouseMove.bind(s),s.onMouseUp=s.onMouseUp.bind(s),s}return Object.defineProperty(t.prototype,"parentNode",{get:function(){return this.resizable?this.resizable.parentNode:null},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"window",{get:function(){return!this.resizable||!this.resizable.ownerDocument?null:this.resizable.ownerDocument.defaultView},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"propsSize",{get:function(){return this.props.size||this.props.defaultSize||BM},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){var o=0,r=0;if(this.resizable&&this.window){var n=this.resizable.offsetWidth,i=this.resizable.offsetHeight,a=this.resizable.style.position;a!=="relative"&&(this.resizable.style.position="relative"),o=this.resizable.style.width!=="auto"?this.resizable.offsetWidth:n,r=this.resizable.style.height!=="auto"?this.resizable.offsetHeight:i,this.resizable.style.position=a}return{width:o,height:r}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"sizeStyle",{get:function(){var o=this,r=this.props.size,n=function(s){var l;if(typeof o.state[s]>"u"||o.state[s]==="auto")return"auto";if(o.propsSize&&o.propsSize[s]&&(!((l=o.propsSize[s])===null||l===void 0)&&l.toString().endsWith("%"))){if(o.state[s].toString().endsWith("%"))return o.state[s].toString();var c=o.getParentSize(),p=Number(o.state[s].toString().replace("px","")),u=p/c[s]*100;return u+"%"}return Jh(o.state[s])},i=r&&typeof r.width<"u"&&!this.state.isResizing?Jh(r.width):n("width"),a=r&&typeof r.height<"u"&&!this.state.isResizing?Jh(r.height):n("height");return{width:i,height:a}},enumerable:!1,configurable:!0}),t.prototype.getParentSize=function(){if(!this.parentNode)return this.window?{width:this.window.innerWidth,height:this.window.innerHeight}:{width:0,height:0};var o=this.appendBase();if(!o)return{width:0,height:0};var r=!1,n=this.parentNode.style.flexWrap;n!=="wrap"&&(r=!0,this.parentNode.style.flexWrap="wrap"),o.style.position="relative",o.style.minWidth="100%",o.style.minHeight="100%";var i={width:o.offsetWidth,height:o.offsetHeight};return r&&(this.parentNode.style.flexWrap=n),this.removeBase(o),i},t.prototype.bindEvents=function(){this.window&&(this.window.addEventListener("mouseup",this.onMouseUp),this.window.addEventListener("mousemove",this.onMouseMove),this.window.addEventListener("mouseleave",this.onMouseUp),this.window.addEventListener("touchmove",this.onMouseMove,{capture:!0,passive:!1}),this.window.addEventListener("touchend",this.onMouseUp))},t.prototype.unbindEvents=function(){this.window&&(this.window.removeEventListener("mouseup",this.onMouseUp),this.window.removeEventListener("mousemove",this.onMouseMove),this.window.removeEventListener("mouseleave",this.onMouseUp),this.window.removeEventListener("touchmove",this.onMouseMove,!0),this.window.removeEventListener("touchend",this.onMouseUp))},t.prototype.componentDidMount=function(){if(!(!this.resizable||!this.window)){var o=this.window.getComputedStyle(this.resizable);this.setState({width:this.state.width||this.size.width,height:this.state.height||this.size.height,flexBasis:o.flexBasis!=="auto"?o.flexBasis:void 0})}},t.prototype.componentWillUnmount=function(){this.window&&this.unbindEvents()},t.prototype.createSizeForCssProperty=function(o,r){var n=this.propsSize&&this.propsSize[r];return this.state[r]==="auto"&&this.state.original[r]===o&&(typeof n>"u"||n==="auto")?"auto":o},t.prototype.calculateNewMaxFromBoundary=function(o,r){var n=this.props.boundsByDirection,i=this.state.direction,a=n&&ql("left",i),s=n&&ql("top",i),l,c;if(this.props.bounds==="parent"){var p=this.parentNode;p&&(l=a?this.resizableRight-this.parentLeft:p.offsetWidth+(this.parentLeft-this.resizableLeft),c=s?this.resizableBottom-this.parentTop:p.offsetHeight+(this.parentTop-this.resizableTop))}else this.props.bounds==="window"?this.window&&(l=a?this.resizableRight:this.window.innerWidth-this.resizableLeft,c=s?this.resizableBottom:this.window.innerHeight-this.resizableTop):this.props.bounds&&(l=a?this.resizableRight-this.targetLeft:this.props.bounds.offsetWidth+(this.targetLeft-this.resizableLeft),c=s?this.resizableBottom-this.targetTop:this.props.bounds.offsetHeight+(this.targetTop-this.resizableTop));return l&&Number.isFinite(l)&&(o=o&&o<l?o:l),c&&Number.isFinite(c)&&(r=r&&r<c?r:c),{maxWidth:o,maxHeight:r}},t.prototype.calculateNewSizeFromDirection=function(o,r){var n=this.props.scale||1,i=HM(this.props.resizeRatio||1),a=i[0],s=i[1],l=this.state,c=l.direction,p=l.original,u=this.props,m=u.lockAspectRatio,d=u.lockAspectRatioExtraHeight,f=u.lockAspectRatioExtraWidth,h=p.width,C=p.height,x=d||0,_=f||0;return ql("right",c)&&(h=p.width+(o-p.x)*a/n,m&&(C=(h-_)/this.ratio+x)),ql("left",c)&&(h=p.width-(o-p.x)*a/n,m&&(C=(h-_)/this.ratio+x)),ql("bottom",c)&&(C=p.height+(r-p.y)*s/n,m&&(h=(C-x)*this.ratio+_)),ql("top",c)&&(C=p.height-(r-p.y)*s/n,m&&(h=(C-x)*this.ratio+_)),{newWidth:h,newHeight:C}},t.prototype.calculateNewSizeFromAspectRatio=function(o,r,n,i){var a=this.props,s=a.lockAspectRatio,l=a.lockAspectRatioExtraHeight,c=a.lockAspectRatioExtraWidth,p=typeof i.width>"u"?10:i.width,u=typeof n.width>"u"||n.width<0?o:n.width,m=typeof i.height>"u"?10:i.height,d=typeof n.height>"u"||n.height<0?r:n.height,f=l||0,h=c||0;if(s){var C=(m-f)*this.ratio+h,x=(d-f)*this.ratio+h,_=(p-h)/this.ratio+f,y=(u-h)/this.ratio+f,b=Math.max(p,C),S=Math.min(u,x),I=Math.max(m,_),w=Math.min(d,y);o=od(o,b,S),r=od(r,I,w)}else o=od(o,p,u),r=od(r,m,d);return{newWidth:o,newHeight:r}},t.prototype.setBoundingClientRect=function(){var o=1/(this.props.scale||1);if(this.props.bounds==="parent"){var r=this.parentNode;if(r){var n=r.getBoundingClientRect();this.parentLeft=n.left*o,this.parentTop=n.top*o}}if(this.props.bounds&&typeof this.props.bounds!="string"){var i=this.props.bounds.getBoundingClientRect();this.targetLeft=i.left*o,this.targetTop=i.top*o}if(this.resizable){var a=this.resizable.getBoundingClientRect(),s=a.left,l=a.top,c=a.right,p=a.bottom;this.resizableLeft=s*o,this.resizableRight=c*o,this.resizableTop=l*o,this.resizableBottom=p*o}},t.prototype.onResizeStart=function(o,r){if(!(!this.resizable||!this.window)){var n=0,i=0;if(o.nativeEvent&&FM(o.nativeEvent)?(n=o.nativeEvent.clientX,i=o.nativeEvent.clientY):o.nativeEvent&&rd(o.nativeEvent)&&(n=o.nativeEvent.touches[0].clientX,i=o.nativeEvent.touches[0].clientY),this.props.onResizeStart&&this.resizable){var a=this.props.onResizeStart(o,r,this.resizable);if(a===!1)return}this.props.size&&(typeof this.props.size.height<"u"&&this.props.size.height!==this.state.height&&this.setState({height:this.props.size.height}),typeof this.props.size.width<"u"&&this.props.size.width!==this.state.width&&this.setState({width:this.props.size.width})),this.ratio=typeof this.props.lockAspectRatio=="number"?this.props.lockAspectRatio:this.size.width/this.size.height;var s,l=this.window.getComputedStyle(this.resizable);if(l.flexBasis!=="auto"){var c=this.parentNode;if(c){var p=this.window.getComputedStyle(c).flexDirection;this.flexDir=p.startsWith("row")?"row":"column",s=l.flexBasis}}this.setBoundingClientRect(),this.bindEvents();var u={original:{x:n,y:i,width:this.size.width,height:this.size.height},isResizing:!0,backgroundStyle:Di(Di({},this.state.backgroundStyle),{cursor:this.window.getComputedStyle(o.target).cursor||"auto"}),direction:r,flexBasis:s};this.setState(u)}},t.prototype.onMouseMove=function(o){var r=this;if(!(!this.state.isResizing||!this.resizable||!this.window)){if(this.window.TouchEvent&&rd(o))try{o.preventDefault(),o.stopPropagation()}catch{}var n=this.props,i=n.maxWidth,a=n.maxHeight,s=n.minWidth,l=n.minHeight,c=rd(o)?o.touches[0].clientX:o.clientX,p=rd(o)?o.touches[0].clientY:o.clientY,u=this.state,m=u.direction,d=u.original,f=u.width,h=u.height,C=this.getParentSize(),x=DM(C,this.window.innerWidth,this.window.innerHeight,i,a,s,l);i=x.maxWidth,a=x.maxHeight,s=x.minWidth,l=x.minHeight;var _=this.calculateNewSizeFromDirection(c,p),y=_.newHeight,b=_.newWidth,S=this.calculateNewMaxFromBoundary(i,a);this.props.snap&&this.props.snap.x&&(b=Gb(b,this.props.snap.x,this.props.snapGap)),this.props.snap&&this.props.snap.y&&(y=Gb(y,this.props.snap.y,this.props.snapGap));var I=this.calculateNewSizeFromAspectRatio(b,y,{width:S.maxWidth,height:S.maxHeight},{width:s,height:l});if(b=I.newWidth,y=I.newHeight,this.props.grid){var w=Wb(b,this.props.grid[0],this.props.gridGap?this.props.gridGap[0]:0),E=Wb(y,this.props.grid[1],this.props.gridGap?this.props.gridGap[1]:0),O=this.props.snapGap||0,L=O===0||Math.abs(w-b)<=O?w:b,G=O===0||Math.abs(E-y)<=O?E:y;b=L,y=G}var H={width:b-d.width,height:y-d.height};if(f&&typeof f=="string"){if(f.endsWith("%")){var V=b/C.width*100;b=V+"%"}else if(f.endsWith("vw")){var W=b/this.window.innerWidth*100;b=W+"vw"}else if(f.endsWith("vh")){var N=b/this.window.innerHeight*100;b=N+"vh"}}if(h&&typeof h=="string"){if(h.endsWith("%")){var V=y/C.height*100;y=V+"%"}else if(h.endsWith("vw")){var W=y/this.window.innerWidth*100;y=W+"vw"}else if(h.endsWith("vh")){var N=y/this.window.innerHeight*100;y=N+"vh"}}var Z={width:this.createSizeForCssProperty(b,"width"),height:this.createSizeForCssProperty(y,"height")};this.flexDir==="row"?Z.flexBasis=Z.width:this.flexDir==="column"&&(Z.flexBasis=Z.height);var J=this.state.width!==Z.width,K=this.state.height!==Z.height,Q=this.state.flexBasis!==Z.flexBasis,M=J||K||Q;M&&(0,qb.flushSync)(function(){r.setState(Z)}),this.props.onResize&&M&&this.props.onResize(o,m,this.resizable,H)}},t.prototype.onMouseUp=function(o){var r,n,i=this.state,a=i.isResizing,s=i.direction,l=i.original;if(!(!a||!this.resizable)){var c={width:this.size.width-l.width,height:this.size.height-l.height};this.props.onResizeStop&&this.props.onResizeStop(o,s,this.resizable,c),this.props.size&&this.setState({width:(r=this.props.size.width)!==null&&r!==void 0?r:"auto",height:(n=this.props.size.height)!==null&&n!==void 0?n:"auto"}),this.unbindEvents(),this.setState({isResizing:!1,backgroundStyle:Di(Di({},this.state.backgroundStyle),{cursor:"auto"})})}},t.prototype.updateSize=function(o){var r,n;this.setState({width:(r=o.width)!==null&&r!==void 0?r:"auto",height:(n=o.height)!==null&&n!==void 0?n:"auto"})},t.prototype.renderResizer=function(o){var r=this,n=this.props,i=n.enable,a=n.handleStyles,s=n.handleClasses,l=n.handleWrapperStyle,c=n.handleWrapperClass,p=n.handleComponent;if(!i)return null;var u=o.filter(function(m){return i[m]!==!1}).map(function(m){return i[m]!==!1?As.createElement(Ub,{key:m,direction:m,onResizeStart:r.onResizeStart,replaceStyles:a&&a[m],className:s&&s[m]},p&&p[m]?p[m]:null):null});return As.createElement("div",{className:c,style:l},u)},t.prototype.render=function(){var o=this,r=Object.keys(this.props).reduce(function(a,s){return NM.indexOf(s)!==-1||(a[s]=o.props[s]),a},{}),n=Di(Di(Di({position:"relative",userSelect:this.state.isResizing?"none":"auto"},this.props.style),this.sizeStyle),{maxWidth:this.props.maxWidth,maxHeight:this.props.maxHeight,minWidth:this.props.minWidth,minHeight:this.props.minHeight,boxSizing:"border-box",flexShrink:0});this.state.flexBasis&&(n.flexBasis=this.state.flexBasis);var i=this.props.as||"div";return As.createElement(i,Di({style:n,className:this.props.className},r,{ref:function(a){a&&(o.resizable=a)}}),this.state.isResizing&&As.createElement("div",{style:this.state.backgroundStyle}),this.renderResizer(["topLeft","top","topRight","left"]),this.props.children,this.renderResizer(["right","bottomLeft","bottom","bottomRight"]))},t.defaultProps={as:"div",onResizeStart:function(){},onResize:function(){},onResizeStop:function(){},enable:{top:!0,right:!0,bottom:!0,left:!0,topRight:!0,bottomRight:!0,bottomLeft:!0,topLeft:!0},style:{},grid:[1,1],gridGap:[0,0],lockAspectRatio:!1,lockAspectRatioExtraWidth:0,lockAspectRatioExtraHeight:0,scale:1,resizeRatio:1,snapGap:0},t}(As.PureComponent);var zM=({children:e})=>Yx!=="prod"||nl?e:null,id=zM;var Kl=v($b());var Ee=v(A()),Xb=e=>{let{conversationId:t}=e,o=(0,Ee.useRef)(null),[r,n]=(0,Ee.useState)([]),i=kr(()=>{if(o.current){let s=o.current?.querySelector(".max-ai__action_status__loading");s?o.current?.scrollTo({top:s.offsetTop-s.offsetHeight/2-o.current.offsetHeight/2,behavior:"smooth"}):o.current?.scrollTo({top:o.current?.scrollHeight,behavior:"smooth"})}},200);(0,Ee.useEffect)(()=>{let{shortcutsEngine:s}=Om(t);if(!s)return;let l=(c,p)=>{let u=De(p.shortcutsEngine.actions);n(u)};return s.addListener(l),()=>{s.removeListener(l)}},[t]),(0,Ee.useEffect)(()=>{i()},[r]);let a=(s,l=0)=>s.map((c,p)=>{let u="#ebebeb",m="text.primary";c.status==="running"?(u="primary.main",m="primary.main"):c.status==="error"?(u="error.main",m="error.main"):c.status==="complete"&&(u="success.main",m="success.main");let d=c.type==="ASK_CHATGPT",f=d?c.question:"",h=c.status==="complete",C=h?c.output:c.error;typeof f=="object"&&(f=JSON.stringify(f,null,2)),c.type==="SET_VARIABLES_MODAL"?C=JSON.stringify(c.parameters.SetVariablesModalConfig,null,2):c.type==="SET_VARIABLE_MAP"?C=JSON.stringify(c.parameters.VariableMap,null,2):typeof C=="object"&&(C=JSON.stringify(C,null,2));let x=JSON.stringify(c.parameters,null,2);return Ee.default.createElement(g,{key:c.type+p+l,sx:{px:1,alignItems:"center"}},Ee.default.createElement(Pn,{PopperProps:{disablePortal:!0,sx:{zIndex:2147483647}},placement:"right",title:Ee.default.createElement(g,{sx:{maxHeight:500,overflowY:"auto",gap:1}},`[${c.type}]`,d&&Ee.default.createElement(g,null,Ee.default.createElement(T,{fontSize:"12px",display:"flex",alignItems:"center",gap:1},"[Question]",Ee.default.createElement(Fr,{copyText:f,sx:{color:"text.primary",height:"12px"}})),Ee.default.createElement(T,{sx:{whiteSpace:"pre-wrap"},fontSize:"12px"},f)),Ee.default.createElement(T,{fontSize:"12px",display:"flex",alignItems:"center",gap:1},"[parameters]",Ee.default.createElement(Fr,{copyText:x,sx:{color:"text.primary",height:"12px"}})),Ee.default.createElement(T,{sx:{whiteSpace:"pre-wrap"},fontSize:"12px"},x),Ee.default.createElement(T,{fontSize:"12px",display:"flex",alignItems:"center",gap:1},h?"[Answer]":"[Error]",Ee.default.createElement(Fr,{copyText:C,sx:{color:"text.primary",height:"12px"}})),Ee.default.createElement(T,{sx:{whiteSpace:"pre-wrap"},fontSize:"12px"},C))},Ee.default.createElement(g,{className:c.status==="running"?"max-ai__action_status__loading":"",sx:{width:"100%",border:"1px solid",alignItems:"center",justifyContent:"center",borderColor:u,color:m,fontSize:"12px",borderRadius:"4px",position:"relative",padding:"8px 4px"}},c.status==="running"&&Ee.default.createElement(g,{sx:{position:"absolute",right:1,top:1}},Ee.default.createElement(Ft,{size:16,thickness:4,color:"inherit",variant:"indeterminate",sx:{color:m}})),Ee.default.createElement(g,{direction:"row",alignItems:"center",gap:1,height:16,width:"100%"},c.status!=="idle"&&c.status!=="running"&&Ee.default.createElement(Fr,{sx:{flexShrink:0},size:"small",copyText:JSON.stringify(c)}),Ee.default.createElement(T,{noWrap:!0,fontSize:"12px"},c.type)))),c.type==="SCRIPTS_CONDITIONAL"&&c.status==="complete"&&Ee.default.createElement(g,{direction:"row",gap:1,mt:1},Ee.default.createElement(g,null,c.output==="true"?Ee.default.createElement(Kl.default,{sx:{fontSize:"11px",mt:.5,transform:"rotate(45deg)",marginLeft:"auto"}}):Ee.default.createElement(g,{height:16}),Ee.default.createElement(g,{sx:{p:.5,borderRadius:"4px",border:"1px solid",borderColor:c.output==="true"?"success.main":"error.main"}},a(c.parameters.WFConditionalIfTrueActions||[],l+1)),c.output==="true"?Ee.default.createElement(Kl.default,{sx:{fontSize:"11px",mt:.5,transform:"rotate(-45deg)",marginLeft:"auto"}}):Ee.default.createElement(g,{height:16})),Ee.default.createElement(g,null,c.output==="false"?Ee.default.createElement(Kl.default,{sx:{fontSize:"11px",mt:.5,transform:"rotate(-45deg)"}}):Ee.default.createElement(g,{height:16}),Ee.default.createElement(g,{sx:{p:.5,borderRadius:"4px",border:"1px solid",borderColor:c.output==="false"?"success.main":"error.main"}},a(c.parameters.WFConditionalIfFalseActions||[],l+1)),c.output==="false"?Ee.default.createElement(Kl.default,{sx:{fontSize:"11px",mt:.5,transform:"rotate(45deg)"}}):Ee.default.createElement(g,{height:16}))),c.type!=="SCRIPTS_CONDITIONAL"&&p+1!==s.length&&Ee.default.createElement(Kl.default,{sx:{fontSize:"11px",mt:.5}}))});return Ee.default.createElement(id,null,Ee.default.createElement(g,{width:"100%",sx:{flexShrink:0,gap:1,overflowY:"auto",maxHeight:500},ref:o},Ee.default.createElement(g,null,"ConversationId: ",t),Ee.default.createElement(g,{sx:{position:"sticky",top:0,p:1,bgcolor:"background.paper",zIndex:1}},"Actions"),a(r)))};var Eo=v(A());var WM=()=>{let[e,t]=Eo.default.useState(!1),{conversationIds:o,chatDocuments:r}=be(n=>({conversationIds:n.conversationIds,chatDocuments:n.chatDocuments}));return Eo.default.createElement(g,null,Eo.default.createElement(Ce,{onClick:()=>t(!e)},e?"Collapse":"Expand"),Eo.default.createElement(g,{gap:"8px",direction:"row"},Eo.default.createElement(g,{width:"66%",gap:"8px",direction:"row",flexWrap:"wrap"},o.map((n,i)=>Eo.default.createElement(jM,{expanded:e,key:n,conversationId:n,order:i}))),Eo.default.createElement(g,{width:"33%",gap:"8px"},Eo.default.createElement(T,{color:"text.primary"},"Chat Documents"),r.map(n=>Eo.default.createElement(GM,{expanded:e,key:n.id,chatDocument:n})))))},GM=e=>{let{chatDocument:t,expanded:o}=e,{document:r}=Em(t.maxAIDocumentId);return Eo.default.createElement(g,{sx:{width:"100%",border:"1px solid",borderColor:"border.main",padding:"8px",fontSize:"12px",color:"text.primary",gap:"8px",whiteSpace:"pre-wrap",overflow:"auto",wordBreak:"break-all",maxHeight:o?"unset":"auto"}},JSON.stringify(t,null,2),Eo.default.createElement("br",null),o&&JSON.stringify(r||{},null,2))},jM=e=>{let{conversationId:t,order:o,expanded:r}=e,n=Xo(t),i=Zt(KC(t)),a=Zt(vm(t));return Eo.default.createElement(g,{sx:{width:"calc(50% - 4px)",border:"1px solid",borderColor:"border.main",padding:"8px",fontSize:"12px",color:"text.primary",gap:"8px",maxHeight:r?"unset":"auto"}},Eo.default.createElement("div",null,"conversationId:",Eo.default.createElement("br",null),t),Eo.default.createElement("div",null,"order: ",o),Eo.default.createElement("div",null,"chatBoxLoading: ",i?"\u{1F4AB}":"\u2705"),Eo.default.createElement("div",null,"chatBoxShortcutsStatus: ",a),Eo.default.createElement(Xb,{conversationId:t}),r&&Eo.default.createElement("pre",{style:{whiteSpace:"pre-wrap",wordBreak:"break-all"}},JSON.stringify(n,null,2)))},Yb=WM;var Sr=v(A()),qM=rp.reduce((e,t)=>{let o=t[0].toUpperCase();return e[o]||(e[o]=[]),e[o].push(t),e},{}),KM=fl(Object.entries(qM).map(([e,t])=>({key:e,value:t})),"key","asc"),$M=()=>Sr.default.createElement(g,{gap:"16px"},Sr.default.createElement(g,null,Sr.default.createElement(T,{color:"text.primary"},"Contextmenu icons")),Sr.default.createElement(g,null,Sr.default.createElement(Ti,{href:"https://mui.com/material-ui/material-icons/?theme=Outlined",target:"_blank"},"MUI icons")),Sr.default.createElement(T,{color:"text.primary"},"Total"),Sr.default.createElement(g,{direction:"row",flexWrap:"wrap",gap:"8px"},rp.map(e=>Sr.default.createElement(fe,{onClick:()=>{navigator.clipboard.writeText(e)},title:e,sx:{border:"1px solid",borderColor:"border.main",padding:"0"}},Sr.default.createElement(X,{icon:e,sx:{fontSize:"24px"}})))),KM.map(e=>Sr.default.createElement(g,{key:e.key,gap:"4px"},Sr.default.createElement(T,{color:"text.primary"},e.key),Sr.default.createElement(g,{direction:"row",flexWrap:"wrap",gap:"8px"},e.value.map(t=>Sr.default.createElement(fe,{onClick:()=>{navigator.clipboard.writeText(t)},sx:{width:"unset",border:"1px solid",borderColor:"border.main",padding:"0 8px",gap:"4px"}},Sr.default.createElement(X,{icon:t,sx:{fontSize:"24px"}}),Sr.default.createElement(T,{color:"text.primary"},t))))))),Zb=$M;var Ka=v(A()),XM=()=>{let{devShowAuxiliaryLine:e,devAlwaysShowTooltip:t,devAlwaysExpandAllButtons:o,updateQuickAccessDevContent:r}=By();return Ka.default.createElement(g,null,Ka.default.createElement("label",null,Ka.default.createElement("input",{type:"checkbox",checked:e,onChange:()=>r({showAuxiliaryLine:!e})}),"\u663E\u793A\u8F85\u52A9\u7EBF"),Ka.default.createElement("label",null,Ka.default.createElement("input",{type:"checkbox",checked:t,onChange:()=>r({alwaysShowTooltip:!t})}),"\u603B\u662F\u663E\u793Atooltip"),Ka.default.createElement("label",null,Ka.default.createElement("input",{type:"checkbox",checked:o,onChange:()=>r({alwaysExpandAllButtons:!o})}),"\u603B\u662F\u5C55\u5F00\u6240\u6709\u6309\u94AE"))},Qb=XM;var na=v(A()),YM=()=>na.default.createElement(g,null,na.default.createElement(g,null,na.default.createElement(T,null,"Indexed DB")),na.default.createElement(g,null,na.default.createElement(Ce,{onClick:async()=>{await j_(NC,"documents").clear().then(),window.location.reload()}},"Clear Document"),na.default.createElement(Ce,{onClick:async()=>{await $r.set({CHROME_EXTENSION_USE_CHAT_GPT_AI_ON_BOARDING_SAVE_KEY:""}),await $r.set({[by]:""})}},"Clear Onboarding"),na.default.createElement(Ce,{onClick:async()=>{await Ze.resetOnboardingData()}},"Clear maxai-client Onboarding settings"),na.default.createElement(Ce,{onClick:async()=>{await bm.getService("CONTEXT_MENU_SUGGEST").clearUsageHistory()}},"Clear [CONTEXT_MENU] suggestion"))),Jb=YM;var Ir=v(A());var $l=v(A()),ZM=()=>{let e=document.createElement("style");e.id="debug-react-component-style",e.textContent=`
    .maxai_debug_react_component {
      outline: 1px solid red;
    }

    .maxai_need_relative {
      position: relative;
    }
  `;let t=eg();return t&&!t.getElementById("debug-react-component-style")&&t.insertBefore(e,t.firstChild),()=>{let n=eg()?.getElementById("debug-react-component-style");n&&n.parentNode&&n.parentNode.removeChild(n)}},eg=()=>document.querySelector("use-chat-gpt-ai")?.shadowRoot,QM=({name:e})=>{let t=document.createElement("div");return t.classList.add("maxai_debug_react_component_helper"),t.style.position="absolute",t.style.top="0",t.style.left="0",t.style.width="100%",t.style.height="100%",t.style.backgroundColor="rgba(0, 0, 0, 0)",t.style.color="white",t.style.zIndex="1",t.textContent=e,t},JM=()=>{let[e,t]=(0,$l.useState)(!1),o=()=>{let r=!e;t(r);let n=eg()?.querySelectorAll("[data-debug-react-component]");n&&(n.forEach(i=>{}),n.forEach(i=>{r?(i.classList.add("maxai_debug_react_component"),window.getComputedStyle(i).getPropertyValue("position")==="static"&&i.classList.add("maxai_need_relative"),i.querySelector(".maxai_debug_react_component_name")||i.appendChild(QM({name:i.getAttribute("data-debug-react-component")}))):(i.classList.remove("maxai_debug_react_component"),i.classList.remove("maxai_need_relative"),i.querySelector(".maxai_debug_react_component_name")?.remove())}))};return(0,$l.useEffect)(()=>{let r=ZM();return()=>r()},[]),$l.default.createElement("button",{onClick:o},e?"\u5173\u95ED":"\u5F00\u542F")},e4=JM;var t4=[{label:"ChatHub",value:"ChatHub"},{label:"ReactComponent",value:"ReactComponent"},{label:"QuickAccess",value:"QuickAccess"},{label:"Storage",value:"Storage"},{label:"Icons",value:"Icons"}],eE=()=>{let[e,t]=Ir.default.useState(t4[0].value);return Ir.default.createElement(g,{sx:{width:"100%",height:"100%",flex:1}},Ir.default.createElement(O_,{value:e,onChange:(r,n)=>{t(n)},variant:"scrollable",scrollButtons:"auto"},t4.map(r=>Ir.default.createElement(L_,{key:r.value,value:r.value,label:r.label}))),Ir.default.createElement(mp,{active:e==="ChatHub",keepAlive:!0},Ir.default.createElement(Yb,null)),Ir.default.createElement(mp,{active:e==="ReactComponent"},Ir.default.createElement(e4,null)),Ir.default.createElement(mp,{active:e==="QuickAccess"},Ir.default.createElement(Qb,null)),Ir.default.createElement(mp,{active:e==="Storage"},Ir.default.createElement(Jb,null)),Ir.default.createElement(mp,{active:e==="Icons"},Ir.default.createElement(Zb,null)))},mp=e=>{let{active:t,keepAlive:o=!1}=e;return Ir.default.createElement(g,{sx:{width:"100%",height:0,flex:1,display:t?"block":"none",padding:2,textAlign:"left"}},o||t?e.children:null)},o4=eE;var m4=v(n4());var Gt=v(A());var s4=v(kh()),l4=v(i4()),c4=v(a4());var ia=v(A());var pd=_l(e=>({message:"",type:"info",show:!1,setToast:(t,o)=>e({message:t,type:o,show:!0}),hideToast:()=>e({show:!1})})),tg={info:e=>pd.getState().setToast(e,"info"),success:e=>pd.getState().setToast(e,"success"),error:e=>pd.getState().setToast(e,"error")},cE=()=>{let{message:e,type:t,show:o,hideToast:r}=pd(),[n,i]=(0,ia.useState)(!1);if((0,ia.useEffect)(()=>{if(o){let l=setTimeout(()=>{i(!0),setTimeout(()=>{r(),i(!1)},200)},1e3);return()=>clearTimeout(l)}},[o,r]),!o)return null;let a=()=>{switch(t){case"success":return"#4caf50";case"error":return"#f44336";default:return"#2196f3"}};return ia.default.createElement(g,{direction:"row",alignItems:"center",gap:1.5,sx:{position:"fixed",bottom:"24px",right:"24px",backgroundColor:"rgba(33, 33, 33, 0.95)",color:"#fff",padding:"10px 16px",borderRadius:"6px",zIndex:2147483701,transition:"all 0.2s ease",opacity:n?0:1,transform:n?"translateY(10px)":"translateY(0)",boxShadow:"0 4px 12px rgba(0, 0, 0, 0.15)",fontSize:"14px",fontWeight:500,minWidth:"200px",maxWidth:"400px",backdropFilter:"blur(8px)","&::before":{content:'""',position:"absolute",inset:0,borderRadius:"6px",padding:"1px",background:"linear-gradient(to bottom right, rgba(255, 255, 255, 0.2), rgba(255, 255, 255, 0.05))",WebkitMask:"linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0)",WebkitMaskComposite:"xor",maskComposite:"exclude"}}},(()=>{let l={sx:{color:a(),fontSize:20}};switch(t){case"success":return ia.default.createElement(s4.default,{...l});case"error":return ia.default.createElement(l4.default,{...l});default:return ia.default.createElement(c4.default,{...l})}})(),e)},p4=cE;var Wt=v(A());var pE={position:"fixed",border:"2px solid #1976d2",background:"rgba(25, 118, 210, 0.1)",pointerEvents:"none",zIndex:2147483700,boxSizing:"border-box",borderRadius:"4px"},uE={position:"fixed",background:"rgba(0, 0, 0, 0.8)",color:"#fff",padding:"4px 8px",borderRadius:"4px",fontSize:"12px",pointerEvents:"none",zIndex:2147483701,left:"16px",bottom:"16px",whiteSpace:"nowrap"},u4=(e,t)=>{let{sourcePathAttribute:o,tooltipConfig:r}=t,[n,i]=(0,Wt.useState)(!1),[a,s]=(0,Wt.useState)(null),l=(0,Wt.useRef)(null),c=(0,Wt.useRef)(null),p=(0,Wt.useRef)(null),u=(0,Wt.useCallback)(E=>e.querySelector('[data-testid="dev-tools-button"]')?.contains(E),[e]),m=(0,Wt.useCallback)(()=>{if(!e||l.current)return;let E=document.createElement("div");return E.id="component-highlight",Object.assign(E.style,pE),e.appendChild(E),l.current=E,E},[e]),d=(0,Wt.useCallback)(()=>{if(!e||c.current)return;let E=document.createElement("div");return E.id="component-tooltip",Object.assign(E.style,uE),e.appendChild(E),c.current=E,E},[e]),f=(0,Wt.useCallback)(E=>{let O=E.getAttribute(o);if(!O||r?.show===!1)return null;let L=O,G="\u6587\u4EF6\u8DEF\u5F84";if(!r?.attribute)return{title:G,content:L};let H=E.getAttribute(r.attribute);return H?(G=r.attribute,L=H,{title:G,content:L}):r.showDefaultInfo?{title:G,content:L}:null},[o,r]),h=(0,Wt.useCallback)(E=>{if(!e)return;let O=l.current||m(),L=c.current||d();if(!O||!L)return;let G=E.getBoundingClientRect();Object.assign(O.style,{left:`${G.left}px`,top:`${G.top}px`,width:`${G.width}px`,height:`${G.height}px`,display:"block"});let H=f(E);if(H){let{title:V,content:W}=H;L.textContent=`${V}: ${W}\uFF08\u6309 C \u590D\u5236\uFF09`,L.style.display="block",p.current=W}else p.current=null,L.style.display="none"},[e,m,d,f]),C=(0,Wt.useCallback)(E=>{if(!n||u(E.target))return;let O=E.target;s(O),h(O)},[n,h,u]),x=(0,Wt.useCallback)(()=>{l.current&&(l.current.style.display="none"),c.current&&(c.current.style.display="none")},[]),_=(0,Wt.useCallback)(()=>{i(!1),s(null),x()},[x]),y=(0,Wt.useCallback)(E=>{_(),requestAnimationFrame(()=>{window.open(E,"_blank")})},[_]),b=(0,Wt.useCallback)(E=>{!n||u(E.target)||(x(),s(null))},[n,x,u]),S=(0,Wt.useCallback)(E=>{if(!n||u(E.target))return;let L=E.target.getAttribute(o);L&&(E.stopPropagation(),E.preventDefault(),y(L))},[n,y,u,o]),I=(0,Wt.useCallback)(E=>{n&&(E.preventDefault(),E.stopPropagation(),i(!1),s(null),x())},[n,x]),w=(0,Wt.useRef)(null);return(0,Wt.useEffect)(()=>{n?tg.success("\u5DF2\u5F00\u542F\u7EC4\u4EF6\u6620\u5C04\u5DE5\u5177"):w.current&&tg.info("\u5DF2\u5173\u95ED\u7EC4\u4EF6\u6620\u5C04\u5DE5\u5177"),w.current=n},[n]),(0,Wt.useEffect)(()=>{let E=O=>{if(O.code==="KeyX"&&O.metaKey&&O.altKey){if(O.preventDefault(),O.stopPropagation(),O.shiftKey){i(!1),s(null),x(),l.current&&(l.current.remove(),l.current=null);return}n?(i(!1),s(null),x()):i(!0)}O.code==="KeyC"&&n&&p.current&&(O.preventDefault(),navigator.clipboard.writeText(p.current).then(()=>{let L=c.current.textContent;c.current.textContent="\u5DF2\u590D\u5236\uFF01",setTimeout(()=>{c.current&&(c.current.textContent=L)},1e3)}).catch(console.error)),O.key==="Escape"&&n&&(i(!1),s(null),x())};return window.addEventListener("keydown",E,!0),()=>{window.removeEventListener("keydown",E,!0)}},[n,x]),(0,Wt.useEffect)(()=>{if(e)return n&&(e.addEventListener("mouseover",C,!0),e.addEventListener("mouseout",b,!0),e.addEventListener("click",S,!0),e.addEventListener("contextmenu",I,!0)),()=>{e.removeEventListener("mouseover",C,!0),e.removeEventListener("mouseout",b,!0),e.removeEventListener("click",S,!0),e.removeEventListener("contextmenu",I,!0)}},[n,C,b,S,I,e]),(0,Wt.useEffect)(()=>()=>{l.current&&(l.current.remove(),l.current=null),c.current&&(c.current.remove(),c.current=null)},[]),{needOpenIDE:n,setNeedOpenIDE:i,currentHoverElement:a}};var ud="maxa-devtools-cache",Xl=_l(e=>({open:!1,setOpen:t=>e({open:t}),position:{x:0,y:0},size:{width:300,height:200},setPosition:t=>e({position:t}),setSize:t=>e({size:t})})),mE=e=>{let o=Math.max(Math.min(e.position.x,window.innerWidth-e.size.width),10),r=Math.max(Math.min(e.position.y,window.innerHeight-e.size.height),10),n=Math.min(e.size.width,window.innerWidth-10),i=Math.min(e.size.height,window.innerHeight-10);return{position:{x:o,y:r},size:{width:n,height:i}}},og=()=>{let e=Xl(c=>c.open),t=Xl(c=>c.position),o=Xl(c=>c.size),r=Xl(c=>c.setPosition),n=Xl(c=>c.setSize),i=Xl(c=>c.setOpen);return(0,Gt.useEffect)(()=>{$r.getItem(ud).then(c=>{if(c){let{position:p,size:u}=mE(c);r(p),n(u),i(c.open)}})},[]),{position:t,size:o,setPosition:c=>{r(c),$r.setItem(ud,{open:e,position:c,size:o})},setSize:c=>{n(c),$r.setItem(ud,{open:e,position:t,size:c})},setOpen:c=>{i(c),$r.setItem(ud,{open:c,position:t,size:o})},open:e}},dE=e=>{let{sx:t,...o}=e.fabProps||{},{position:r,setPosition:n}=og(),i=(0,Gt.useRef)(null),a=(0,Gt.useRef)(!1),s=(0,Gt.useRef)(!1),l=(0,Gt.useRef)({x:0,y:0}),c=f=>{if(i.current){a.current=!0;let h=i.current.getBoundingClientRect();l.current={x:f.clientX-h.left,y:f.clientY-h.top}}},p=()=>{s.current||e.onToolsClick()},u=(0,Gt.useCallback)(f=>{if(a.current){s.current=!0;let h=f.clientX-l.current.x,C=f.clientY-l.current.y,x=window.innerWidth-44,_=window.innerHeight-44;n({x:Math.min(Math.max(0,h),x),y:Math.min(Math.max(0,C),_)})}},[a,l,n]),m=()=>{s.current&&(s.current=!1),a.current=!1};(0,Gt.useEffect)(()=>(window.addEventListener("mousemove",u),window.addEventListener("mouseup",m),()=>{window.removeEventListener("mousemove",u),window.removeEventListener("mouseup",m)}),[u]);let d=e.onComponentToIDEClick&&e.needOpenIDE!==void 0;return Gt.default.createElement(M_,{"data-testid":"dev-tools-button",ref:i,size:"small","aria-label":"add",onMouseDown:c,sx:{color:"text.primary",backgroundColor:"background.paper","&:hover":{backgroundColor:"background.paper"},position:"fixed",left:`${r.x}px`,top:`${r.y}px`,width:"44px",height:"44px",cursor:"move",px:1,touchAction:"none",userSelect:"none",zIndex:2047483647,...t},...o},Gt.default.createElement(g,{direction:"row",alignItems:"center",justifyContent:"center",gap:1},Gt.default.createElement(m4.default,{onMouseUp:p}),d&&Gt.default.createElement(Fy,{onMouseUp:()=>{s.current||e.onComponentToIDEClick&&e.onComponentToIDEClick()},sx:{color:e.needOpenIDE?"text.primary":"text.secondary"}})))},fE=e=>{let{open:t}=e,{position:o,size:r,setSize:n}=og(),i=bb(),a=(s,l,c,p)=>{let u={width:Math.min(c.offsetWidth,window.innerWidth),height:Math.min(c.offsetHeight,window.innerHeight)};n(u)};return Gt.default.createElement(g,{sx:{position:"fixed",left:`${o.x}px`,top:`${o.y}px`,zIndex:2047483646,display:t?"block":"none"}},Gt.default.createElement(Kb,{ref:i,size:r,onResize:a,minWidth:100,minHeight:100,style:{position:"fixed",zIndex:2047483646,display:t?"block":"none"}},Gt.default.createElement(Kr,{elevation:3,style:{width:"100%",height:"100%",overflow:"auto",boxSizing:"border-box"},sx:{padding:"36px"}},Gt.default.createElement(o4,null))))},hE={sourcePathAttribute:"debug-open-path",tooltipConfig:{attribute:"data-testid",showDefaultInfo:!1}},gE=()=>{let e=Mt(),{setOpen:t,open:o}=og(),{needOpenIDE:r,setNeedOpenIDE:n}=u4(e,hE);return Gt.default.createElement(Gt.default.Fragment,null,Gt.default.createElement(p4,null),Gt.default.createElement(dE,{needOpenIDE:r,onToolsClick:()=>t(!o),onComponentToIDEClick:()=>n(!r),fabProps:{variant:"extended",sx:{width:"auto"}}}),Gt.default.createElement(fE,{open:o}))},xE=()=>Gt.default.createElement(id,null,Gt.default.createElement(gE,null)),d4=xE;var f4=e=>{let{sigOutMaxAIAccount:t}=r_();Lr(()=>{Xr.request.use(v2(async()=>{await Ma.checkAccessToken();let o=await Ma.getAccessToken();return Ci&&Ma.isTokenExpired(o)&&(o=await Ma.getRefreshToken()),{userId:await Ru.getUserId()||"",token:o||""}},["/app/send_mixpanel_log","/app/uplog",...Object.values(Y2),...e??[]])),Xr.response.use(w2(()=>{t()}))})};var dp=class{constructor(){this.cacheStorage=new Ih({saveKey:"MAXAI_CLIENT__FEATURES__MARKETING__REWARDS_STATUS",cacheTime:Ih.DAILY*2})}async fetchRewardDashboard(){let t=await Xr.fetch("/user/get_referral_dashboard",{method:"GET"});return t.success&&t.data?.data?t.data.data:null}async getRewardDashboard(t=!1){let o=await this.cacheStorage.get();if(t||o.expired){let r=await this.fetchRewardDashboard();r&&(o.data=r,await this.cacheStorage.sync(r))}return o.data}async uploadRewardScreenshot(t){let o=Date.now(),r=new FormData;r.append("file",t);let{success:n,message:i}=await Xr.fetch("/app/upload_review_screenshot",{method:"POST",body:r}),a=Date.now()-o;a<mh.SECOND*2&&await new Promise(l=>setTimeout(l,mh.SECOND*2-a)),n&&await ip.refreshModelUsage();let s=await this.getRewardDashboard(n);return{success:n,data:s,message:i}}async clearRewardDashboard(){await this.cacheStorage.clear()}};Xx([X2({cacheArgs:!0})],dp.prototype,"getRewardDashboard",1);var fp=new dp;var hp=v(A());var Ps=_l(e=>({loading:!1,dashboard:null,setLoading:t=>e({loading:t}),setDashboard:t=>e({dashboard:t})})),_E=()=>Ps(),CE=()=>{let{loadModelUsage:e}=Bm(),t=(0,hp.useCallback)(async()=>{Ps.setState({loading:!0});let i=await fp.getRewardDashboard();Ps.setState({loading:!1,dashboard:i})},[]),o=(0,hp.useCallback)(async()=>{Ps.setState({loading:!0});let i=await fp.getRewardDashboard(!0);Ps.setState({loading:!1,dashboard:i})},[]),r=(0,hp.useCallback)(async()=>{await fp.clearRewardDashboard(),Ps.setState({loading:!1,dashboard:null})},[]),n=(0,hp.useCallback)(async i=>{let{success:a,data:s,message:l}=await fp.uploadRewardScreenshot(i);return a?e():Qi.error(l),Ps.setState({dashboard:s}),{success:a,data:s,message:l}},[]);return{loadRewardDashboard:t,refreshRewardDashboard:o,clearRewardDashboard:r,uploadRewardScreenshot:n}},h4=()=>{let e=_E(),t=CE();return{...e,...t}};var g4=v(A()),x4=()=>{let{loading:e,dashboard:t,loadRewardDashboard:o,refreshRewardDashboard:r,clearRewardDashboard:n}=h4(),i=st({loading:e,dashboard:t});(0,g4.useEffect)(()=>{o();let a=(s,l)=>{l.proChatReward&&!i.current.loading&&!i.current.dashboard?.is_webstore_commented&&r()};return ip.addListener("onUsageChange",a),()=>{ip.removeListener("onUsageChange",a)}},[]),_y(()=>{r()}),Cy(()=>{n()})};var fd=v(A());var md=Jn({key:"SurveyFilledOutAtom",default:{feedback:!1}}),dd=Jn({key:"firstFetchSurveyStatusLoadedAtom",default:!1});var yE=(e=!0)=>{let{isLogin:t}=Ko(),o=ro(md),r=ro(dd),n=(0,fd.useCallback)(async(i,a=!1)=>{if(t){let s=await Hy.getSurveyStatus(i,a);o(s)}else o({});r(!0)},[t]);return(0,fd.useEffect)(()=>{e&&n()},[n,e]),{syncSurveyStatus:n}},Yl=yE;var fr=v(A());var dS=v(mS());var HP=()=>{let e=new Map,t=new V_,o=async(r,n,i)=>{await t.postMessage({event:"Client_ListenProxyWebsocketResponse",data:{data:n,taskId:r,listenerType:i}})};Nm(async(r,n)=>{switch(r){case"Client_ListenProxyWebsocket":{let{taskId:i,data:a,type:s}=n;switch(s){case"Open":{let l=new dS.default(a.url,{});return l.onUnpackedMessage.addListener(c=>{o(i,c,"onUnpackedMessage")}),l.onMessage.addListener(async c=>{o(i,c,"onMessage")}),l.onClose.addListener(()=>{o(i,{},"onClose")}),await l.open(),e.set(i,l),{success:!0,data:"success",message:"ok"}}break;case"Close":{let l=e.get(i);return l?(l.removeAllListeners(),await l.close(),e.delete(i),{success:!0,data:"success",message:"ok"}):{success:!1,message:"websocket not found",data:!1}}break;case"SendPacked":{let l=e.get(i);return l?(l.sendPacked(a),{success:!0,data:"success",message:"ok"}):{success:!1,message:"websocket not found",data:!1}}break;default:return{success:!0,data:"success",message:"ok"}}}break}})},fS=HP;var rc=v(A());var hS=(e,t)=>{for(let o=e.length-1;o>=0;o--){let r=e[o];if(t(r))return r}};var gS=()=>{let e=(0,rc.useRef)(!1),{conversationMessages:t,conversationIdRef:o}=Pi(),{createMessage:r}=Li(),n=(0,rc.useRef)(!1),i=(0,rc.useRef)("");return tC(a=>{a.name!=="free"&&(n.current=!0,a.name==="elite"?i.current="You have successfully upgraded to MaxAI Elite.":a.name==="pro"?i.current="You have successfully upgraded to MaxAI Pro.":a.name==="basic"&&(i.current="You have successfully upgraded to MaxAI Basic."))}),(0,rc.useEffect)(()=>{!n.current||!i.current||e.current||o.current&&!hS(t,a=>a.text==="You have successfully upgraded to MaxAI Elite."||a.text==="You have successfully upgraded to MaxAI Pro."||a.text==="You have successfully upgraded to MaxAI Basic.")&&r(o.current,{messageId:rr(),type:"system",parentMessageId:void 0,text:i.current,meta:{status:"success"}}).then().catch().finally(()=>{e.current=!0})},[t]),null};var xS="maxai-artifacts-portal";var _S=v(A()),CS=v(sl()),NP=e=>{let o=Mt()?.querySelector(`#${xS}`);return o?(0,CS.createPortal)(e.children,o):_S.default.createElement(g,{flex:1,sx:{...e.sx,"&:empty":{display:"none"}}},e.children)},yS=NP;var bS=v(A()),zP=({children:e,...t})=>{let{sx:o,...r}=t;return bS.default.createElement(Sl,{anchor:"bottom",open:!0,sx:{display:"flex",zIndex:1502,position:"absolute",[`& .${bl.paper}`]:{position:"absolute",borderTopRightRadius:8,borderTopLeftRadius:8,height:"80vh",bgcolor:"background.paper",backgroundImage:"unset"},"& .maxai--browser-window":{border:"none !important",borderRadius:"0px !important",boxShadow:"none !important"},...o},disableScrollLock:!0,disableEnforceFocus:!0,slotProps:{root:{},backdrop:{sx:{position:"absolute"}}},...r},e)},Nd=zP;var zi=v(A()),VP=e=>{let{children:t,reference:o,offset:r=16,sx:n}=e,[i,a]=(0,zi.useState)(0),[s,l]=(0,zi.useState)(0),[c,p]=(0,zi.useState)(0),u=(0,zi.useCallback)(()=>{if(!o)return;let d=o.getBoundingClientRect(),f=r*2,h=Math.min(680,d.left-f),C=Math.max(r,d.left-h-r);p(d.top),l(C),a(h)},[r,o]);(0,zi.useEffect)(()=>{if(!o)return;let d=oi(()=>{u()},0),f=new ResizeObserver(d);return f.observe(o),window.addEventListener("resize",d),()=>{window.removeEventListener("resize",d),f.disconnect()}},[u,o]);let m=ju("maxai-animation-slide-in",{duration:250});return zi.default.createElement(g,{sx:{position:"fixed",zIndex:1e3,width:i,marginTop:`${r}px`,height:`calc(100vh - ${r*2}px)`,left:s,top:c,display:i>0?"flex":"none",flexDirection:"column","&:empty":{display:"none"},...m,...n}},t)},zd=VP;var si=v(A()),Vd=()=>{let e=(0,si.useRef)(null),{conversationId:t}=ue(),o=ye(t),{showStatus:r,closeArtifacts:n,hideArtifacts:i}=ZC(),a=Mt();return(0,si.useEffect)(()=>{let s=a?.children?.[0];s&&(e.current=s)},[a]),r!=="open"?null:_i&&e.current?window.innerWidth-e.current.offsetWidth<450?si.default.createElement(Nd,{onClose:o?i:n},si.default.createElement(Dm,null)):si.default.createElement(zd,{reference:e.current},si.default.createElement(Dm,null)):si.default.createElement(yS,null,si.default.createElement(Dm,{sx:{width:"calc(100% - 24px)",height:"calc(100% - 32px)",margin:"16px 0 12px 8px"}}))};var Rd=v(A()),IS={},Og=Rd.default.createContext({}),vS=()=>(0,Rd.useContext)(Og);var wS=v(va());var li=v(A()),UP=e=>{let{children:t,onClick:o,link:r,dataTestId:n,tooltip:i,tooltipProps:a,...s}=e,[l,c]=(0,li.useState)(!1),p=ju("maxai-animation-hover-left-bottom-slide-in",{duration:200});return li.default.createElement(ve,{title:i,...a},li.default.createElement(F,null,li.default.createElement(Ce,{"data-testid":n,component:r?"a":"button",...r?{href:r,target:"_blank"}:{},sx:{minWidth:"unset",textAlign:"center",color:"text.primary",opacity:.55,"&:hover":{opacity:1},[`& .${m2.root}`]:{borderRadius:"7px"}},onClick:o,onMouseEnter:()=>c(!0),onMouseLeave:()=>c(!1),...s},li.default.createElement(T,{component:"h2",sx:{fontSize:"12px",fontWeight:400,lineHeight:"150%"}},t),l?li.default.createElement(wS.default,{sx:{ml:"4px",fontSize:"16px",color:"inherit",...p}},li.default.createElement("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},li.default.createElement("path",{d:"M4.03076 11.9679L11.9687 4.02991M11.9687 4.02991H5.51913M11.9687 4.02991V10.2039",stroke:"currentColor",strokeWidth:"1.24031",strokeLinecap:"round",strokeLinejoin:"round"}))):li.default.createElement(F,{sx:{width:"20px",height:"16px"}}))))},Bg=UP;var Ud=v(A()),WP=e=>{let{sx:t}=e,{t:o}=k();return Ud.default.createElement(g,{direction:"row",flexWrap:"wrap",alignItems:"center",justifyContent:"center",sx:{position:"absolute",bottom:"16px",left:"50%",transform:"translateX(-50%)",zIndex:1502,...t}},Ud.default.createElement(Bg,{dataTestId:"maxai--chat-home-view--chat-with-any-content--write",link:`${qr}/ai-writing-tools/`},o("package__features:home_view__chat_with_any_content__tab__write__title")),Ud.default.createElement(Bg,{dataTestId:"maxai--chat-home-view--chat-with-any-content--create-image",link:`${qr}/ai-tools/ai-art/`},o("package__features:home_view__chat_with_any_content__tab__create_image__title")))},Wd=WP;var Jt=v(A());var GP=30*1e3,TS=async(e,t)=>{let{signal:o}=t||{};try{let r=new FormData;r.append("audio_file",e),r.append("feature_name",Ci?"immersive_chat":"sidebar"),r.append("prompt_name","Use microphone"),r.append("event_source",p_);let n=new AbortController,i=n.signal;return new Promise(a=>{let s=setTimeout(()=>{n.abort()},GP);Xr.fetch("/gpt/speech_to_text",{signal:o?AbortSignal.any([i,o]):i,method:"POST",body:r}).then(async l=>{clearTimeout(s);let c=await l.data;c.status!=="OK"&&a({status:"error",data:{speechText:""},error:c.detail||""}),a({status:"success",data:{speechText:c?.data?.speech_text||""}})}).catch(l=>{if(l.name==="AbortError"){a({status:"timeout",data:{speechText:""}});return}clearTimeout(s),a({status:"error",data:{speechText:""}})})})}catch{return{status:"error",data:{speechText:""}}}};var dn=v(A()),jP=(e,t,o)=>{let[r,n]=(0,dn.useState)(!1),[i,a]=(0,dn.useState)(!1),[s,l]=(0,dn.useState)(0),[c,p]=(0,dn.useState)(),[u,m]=(0,dn.useState)(),[d,f]=(0,dn.useState)(),h=(0,dn.useCallback)(()=>{let b=setInterval(()=>{l(S=>S+1)},1e3);m(b)},[l,m]),C=(0,dn.useCallback)(()=>{u!=null&&clearInterval(u),m(void 0)},[u,m]),x=(0,dn.useCallback)(()=>{u==null&&navigator.mediaDevices.getUserMedia({audio:e??!0}).then(b=>{n(!0);let S=new MediaRecorder(b,o);p(S),S.start(),h(),S.addEventListener("dataavailable",I=>{f(I.data),S.stream.getTracks().forEach(w=>w.stop()),p(void 0)})}).catch(b=>{t?.(b)})},[u,n,p,h,f,t,o]),_=(0,dn.useCallback)(()=>{c?.stop(),C(),l(0),n(!1),a(!1)},[c,l,n,a,C]),y=(0,dn.useCallback)(()=>{i?(a(!1),c?.resume(),h()):(a(!0),C(),c?.pause())},[c,a,h,C]);return{startRecording:x,stopRecording:_,togglePauseResume:y,recordingBlob:d,isRecording:r,isPaused:i,recordingTime:s,mediaRecorder:c}},MS=jP;var Fg=(e,t)=>{if(!/^#?([a-f\d]{3}|[a-f\d]{6}|[a-f\d]{8})$/i.test(e))return null;let r=e.replace("#",""),n=0,i=0,a=0,s=0;return r.length===3?(n=parseInt(r[0]+r[0],16),i=parseInt(r[1]+r[1],16),a=parseInt(r[2]+r[2],16),s=t!==void 0?Math.max(0,Math.min(1,t)):1):(n=parseInt(r.substring(0,2),16),i=parseInt(r.substring(2,4),16),a=parseInt(r.substring(4,6),16),r.length===8?s=t!==void 0?Math.max(0,Math.min(1,t)):parseInt(r.substring(6,8),16)/255:s=t!==void 0?Math.max(0,Math.min(1,t)):1),isNaN(n)||isNaN(i)||isNaN(a)||isNaN(s)?null:`rgba(${n}, ${i}, ${a}, ${s})`};var Ao=v(A()),qP=({stream:e,boxStyle:t,barStyle:o,leftMaskStyle:r,rightMaskStyle:n,barWidth:i=2,barGap:a=2})=>{let s=(0,Ao.useRef)(null),[l,c]=(0,Ao.useState)([]),p=(0,Ao.useRef)([]),u=(0,Ao.useRef)(0),{isDarkMode:m,theme:{palette:d}}=Zr();(0,Ao.useEffect)(()=>{if(!s.current)return;let x=()=>{if(s.current){let b=s.current.clientWidth,S=i+a,I=Math.floor(b/S);if(u.current===0){let w=Array(I).fill({type:"idle",volume:8});c(w),p.current=[...w],u.current=I}else if(I!==u.current){let w=[...p.current];if(I>u.current){let E={type:"idle",volume:8},G=[...Array(I-u.current).fill(E),...w].slice(-I);c(G),p.current=G}else{let E=w.slice(-I);c(E),p.current=E}u.current=I}}};x();let _=new ResizeObserver(x),y=s.current;return _.observe(y),()=>{y&&_.unobserve(y),_.disconnect()}},[i,a]);let f=(0,Ao.useRef)(new Uint8Array(0));(0,Ao.useEffect)(()=>{if(!e)return;let x=window.AudioContext||window.webkitAudioContext,_=new x,y=_.createMediaStreamSource(e),b=_.createAnalyser();b.fftSize=2048,b.smoothingTimeConstant=.5,f.current=new Uint8Array(b.frequencyBinCount),y.connect(b);let S,I=()=>{b.getByteFrequencyData(f.current);let w={type:"idle",volume:3},E=14,O=Math.min(140,f.current.length-1),L=0,G=0;for(let le=E;le<=O;le++)L+=f.current[le],G++;let H=G>0?L/G:0,V=8,W=24,N=W-V,Z=H/255,K=Math.pow(Z,.8),Q=Math.max(V,Math.min(W,V+Math.round(N*K)));w.type="recording",w.volume=Q;let M=p.current;M.length!==0&&(M.shift(),M.push(w),c([...M]),S=requestAnimationFrame(I))};return S=requestAnimationFrame(I),()=>{cancelAnimationFrame(S),b.disconnect(),y.disconnect(),_.close().catch(console.error)}},[e]);let h=(0,Ao.useMemo)(()=>Fg(d.background.paper,0),[d.background.paper]),C=(0,Ao.useMemo)(()=>Fg(d.background.paper,1),[d.background.paper]);return Ao.default.createElement("div",{ref:s,style:{flex:1,height:"32px",display:"flex",alignItems:"center",position:"relative",overflow:"hidden",gap:`${a}px`,...t}},l.map((x,_)=>{let y=m?"rgba(255, 255, 255, 0.08)":"rgba(0, 0, 0, 0.08)",b=x.type==="recording";return Ao.default.createElement("div",{key:_,style:{width:`${i}px`,height:`${x.volume}px`,backgroundColor:b?d.primary.main:y,borderRadius:"1px",flexShrink:0,...o}})}),Ao.default.createElement("div",{style:{position:"absolute",left:0,top:0,width:"12px",height:"100%",background:`linear-gradient(to left, ${h}, ${C})`,pointerEvents:"none",...r}}),Ao.default.createElement("div",{style:{position:"absolute",right:0,top:0,width:"12px",height:"100%",background:`linear-gradient(to right, ${h}, ${C})`,pointerEvents:"none",...n}}))},ES=(0,Ao.memo)(qP);var LS=v(On()),OS=v(AS());var We=v(A()),BS=v(sl());var nc=v(A()),PS=(0,nc.createContext)({isVoiceInput:!1,setIsVoiceInput:()=>{},isUseInternalState:!0}),kS=()=>(0,nc.useContext)(PS),ic=({children:e,value:t})=>nc.default.createElement(PS.Provider,{value:t},e);var YP=60,Dg=e=>e===3||e===4||e===5||e===6,ZP=async(e,t,o={canceled:!1})=>{let n=new Set,i=window.AudioContext||window.webkitAudioContext,a=new i,s=a.createMediaStreamSource(e),l=a.createAnalyser();l.fftSize=2048,s.connect(l);let c=new Uint8Array(l.frequencyBinCount),p=!1,u=()=>{l.getByteTimeDomainData(c);for(let f of Array.from(c))if(n.add(f),f>138||f<118){p=!0;break}},m=a.currentTime,d=t;return new Promise(f=>{let h=()=>{if(u(),p||a.currentTime-m>=d||o.canceled){a.close(),f(p);return}setTimeout(h,100)};h()})},QP="max-ai__actions__button--voice-input",JP=e=>{let{sx:t,onStartRecording:o,onStopRecording:r,onVoiceInputStatusChange:n,onSpeechToTextSuccess:i,onSpeechToTextFinally:a,disabled:s,...l}=e,{t:c}=k(),{conversationId:p,inputMediator:u}=ue(),m=ye(p),[d,f]=(0,We.useState)(""),[h,C]=(0,We.useState)(!1),[x,_]=(0,We.useState)(0),{startRecording:y,stopRecording:b,recordingBlob:S,isRecording:I,mediaRecorder:w,recordingTime:E}=MS(void 0,()=>{_(3)}),O=(0,We.useRef)(0);E&&(O.current=E);let L=st(n),G=(0,We.useRef)(new AbortController),H=(0,We.useMemo)(()=>({0:c("package__features:chat__inputbox__button__voice_input__idle__tooltip"),1:c("package__features:chat__inputbox__button__voice_input__done__tooltip"),2:c("package__features:chat__inputbox__button__voice_input__transcribing__tooltip"),3:c("package__features:chat__inputbox__button__voice_input__permission_denied__tooltip"),4:c("package__features:chat__inputbox__button__voice_input__no_speech__tooltip"),5:c("package__features:chat__inputbox__button__voice_input__timeout__tooltip"),6:d})[x],[x,d,c]),V=(0,We.useMemo)(()=>Dg(x)||h,[x,h]),W=(0,We.useRef)(!1),N=(0,We.useRef)(x),Z=(0,We.useRef)(!1),J=(0,We.useRef)(null),K=(0,We.useCallback)(()=>{J.current&&(J.current.getTracks().forEach(Re=>Re.stop()),J.current=null)},[]),Q=st(o),M=(0,We.useCallback)(async()=>{try{if(Z.current)return;Z.current=!0,J.current=await navigator.mediaDevices.getUserMedia({audio:!0}),Z.current=!1,O.current=0,G.current=new AbortController,y(),_(1),Q.current?.()}catch{_(3),Z.current=!1}},[Q,y]),le=st(r),ge=(0,We.useCallback)(Re=>{b(),K(),_(2),le.current?.(Re)},[le,b,K]),P=async()=>{I?ge("done"):await M()},$=async Re=>{Re.key==="Enter"?I?ge("done"):await M():Re.key==="Escape"&&I&&(b(),K(),_(0),le.current?.("cancel"),Re.stopPropagation())},j=()=>{C(!0)},de=()=>{C(!1)};(0,We.useEffect)(()=>{if(N.current=x,Dg(x)){let Re=setTimeout(()=>{_(mt=>Dg(mt)?0:mt)},3e3);return()=>{clearTimeout(Re)}}},[x]),(0,We.useEffect)(()=>{L.current?.(x)},[L,x]),(0,We.useEffect)(()=>{if(I&&w){let Re=YP,mt=setInterval(()=>{Re--,Re<=0&&I&&ge("timeout")},1e3),B={canceled:!1};return ZP(w.stream,5,B).then(R=>{R||(_(q=>q===1?4:q),b(),K(),N.current!==2&&le.current?.("timeout"))}).catch(R=>{}),()=>{B.canceled=!0,clearTimeout(mt)}}},[ge,I,w,b,K,le]);let re=st(i),ce=st(a);(0,We.useEffect)(()=>{if(S&&x===2&&!W.current){W.current=!0;let Re=new File([S],"audio.webm",{type:"audio/webm"});TS(Re,{signal:G.current.signal}).then(mt=>{if(mt.status==="success"){let B=mt.data.speechText;re.current?re.current(B):u.updateInputValue(u.getInputValue()+B),(0,BS.flushSync)(()=>{_(0)})}else mt.status==="timeout"?_(5):mt.error?(f(mt.error),_(6)):_(0)}).catch().finally(()=>{W.current=!1,ce.current?.()})}},[u,re,ce,S,x]);let ut=(0,We.useMemo)(()=>({height:"30px"}),[]),Te=x!==0&&x!==3&&x!==4,Ie=x===2,{isVoiceInput:Pe,setIsVoiceInput:qe,isUseInternalState:$e}=kS();(0,We.useEffect)(()=>{qe(Te)},[Te,qe]);let Nt=$e?Te:Pe;return m?null:We.default.createElement(g,{direction:"row",spacing:1,flex:Nt?1:void 0,justifyContent:"flex-end",overflow:"hidden"},Nt&&We.default.createElement(We.default.Fragment,null,We.default.createElement(fe,{title:c("package__common:cancel"),placement:"top",variant:"secondary",onClick:()=>{G.current.abort(),b(),K(),_(0),le.current?.("cancel")}},We.default.createElement(LS.default,null)),We.default.createElement(g,{direction:"row",gap:1,sx:{flex:1,alignItems:"center",justifyContent:"center",height:"32px",overflow:"hidden"}},We.default.createElement(ES,{stream:w?.stream,boxStyle:ut}),We.default.createElement(T,{sx:{fontSize:"14px",color:"text.primary"}},TC(O.current)))),We.default.createElement(ve,{key:x,title:H,open:V,onOpen:j,onClose:de},We.default.createElement("span",null,We.default.createElement(an,{onKeyDownCapture:$,tabIndex:-1,loading:Ie,onClick:P,id:"MaxAISidebarVoiceInputButton",variant:"contained","data-testid":QP,disabled:Ie||s,sx:{width:32,height:32,minWidth:"unset",borderRadius:1,boxSizing:"border-box",boxShadow:"none",[`&.${Th.loading}`]:{backgroundColor:"transparent"},[`& .${Th.loadingIndicator}`]:{color:"text.secondary"},...t},...l},Nt?We.default.createElement(X,{icon:"Done",sx:{color:"inherit!important",fontSize:"20px"}}):We.default.createElement(OS.default,{sx:{color:"inherit!important",fontSize:"20px"}})))))},ac=JP;var FS=v(Ap()),DS=v(Hg()),Pp=v(A()),ak=e=>{let{onSpeechToTextSuccess:t,voiceButtonProps:o,loading:r,inputMediator:n,onSend:i,...a}=e,{t:s}=k(),{conversationId:l}=ue(),c=ye(l),p=Ha(n),{askAIQuestionV2:u,stopGenerate:m}=ze(),d=p.getInputValue(),{localSettings:f}=lt(),h=r||c,C=async()=>{if(!await nt({emitEvent:!0})){p.focus();return}h?m?.():d&&(await u({type:"user",text:d,meta:{includeHistory:!0}}),i?.())};return f.chatMode==="pro_chat"&&d===""&&!h?Pp.default.createElement(ac,{onSpeechToTextSuccess:t,...o}):Pp.default.createElement(fe,{title:s(h?"package__features:chat__inputbox__button__stop_generating__tooltip":"package__features:chat__inputbox__button__send_to_ai__tooltip"),description:h?void 0:"\u23CE",tooltipProps:{sx:{minWidth:"unset",p:1}},variant:"contained","data-testid":"sidebar_actions__send_btn",sx:{width:32,height:32,minWidth:"unset",borderRadius:1,boxSizing:"border-box","&[disabled]":{color:"background.paper"},"&:hover":{color:x=>x.palette.mode==="dark"?"rgba(0, 0, 0, 0.87)":"rgba(255, 255, 255, 1)"}},disabled:!d&&!h,onClick:C,styleType:"default",...a},h?Pp.default.createElement(DS.default,{sx:{fontSize:"16px",color:"inherit !important"}}):Pp.default.createElement(FS.default,{sx:{fontSize:"16px",color:"inherit !important"}}))},sc=ak;var ar=v(A()),Xa=24,Ng=0,sk=e=>{let t=e||window.innerHeight*.4;return Math.max(Math.floor(t/Xa),5)},kp=(e,t)=>{let o=e?.parentElement;if(e&&o){let r=window.getComputedStyle(e),n=Number(e.getAttribute("data-min-line"))||1,i=parseInt(r.paddingTop??Ng,10)+parseInt(r.paddingBottom??Ng,10);e.style.cssText="height:0px";let a=e.value?e.scrollHeight:Xa*n+i,s=e?.previousElementSibling?.offsetHeight||0,l=Math.min(Xa*sk(t),a),c=Math.max(Xa*n+i,s),p=Math.max(c,l);e.style.cssText=`height: ${p}px`,o.style.cssText=`height: ${p}px`}},lk=(e,t)=>{kp(e,t),setTimeout(()=>{if(kp(e,t),!e)return;let o=e.value;e.focus(),e.setSelectionRange(o.length,o.length)},100)},ck=(e,t)=>{if(!e)return;let o=document.querySelector('div[data-testid=sentinelStart][tabindex="0"]');if(o?.nextElementSibling&&o.nextElementSibling.getAttribute("tabindex")==="-1"&&o.nextElementSibling.removeAttribute("tabindex"),window.location.host==="www.linkedin.com"){let n=document.querySelector('div[tabindex="-1"][role="dialog"]');n&&(n.removeAttribute("tabindex"),document.activeElement?.blur(),setTimeout(()=>{n.setAttribute("tabindex","-1")},100))}let r=document.activeElement;r?.shadowRoot&&(r=r.shadowRoot.activeElement),(!r||!e.isSameNode(r))&&lk(e,t)},HS=(0,ar.forwardRef)((e,t)=>{let{t:o}=k(),{loading:r,value:n,placeholder:i=o("package__features:chat__input__chat__placeholder"),onChange:a,onChangeText:s,onPasteFiles:l,onPaste:c,onEnter:p,sx:u,stopPropagation:m=!0,minLine:d=1,maxHeight:f,...h}=e,C=(0,ar.useRef)(null),x=g_(C,t),_=(0,ar.useRef)(!1),y=(0,ar.useMemo)(()=>oi(kp,200),[]),b=(0,ar.useCallback)(S=>{let I=S.target.value;a?.(S),s?.(I)},[a,s]);return(0,ar.useEffect)(()=>{y(C.current,f);let S=setTimeout(()=>{kp(C.current,f)},0);return()=>clearTimeout(S)},[n,f]),(0,ar.useEffect)(()=>{let S=()=>{kp(C.current,f)};return window.addEventListener("resize",S),()=>{window.removeEventListener("resize",S)}},[f]),ar.default.createElement(F,{component:"div",className:r?"chat-box__input--loading":"",borderRadius:1,width:"100%",minHeight:Xa*d+Ng*2,sx:{overflow:"hidden","& .chat-box__input-skeleton":{opacity:0,zIndex:-1,position:"absolute",top:0,padding:"8px",left:0,width:"100%",display:"none"},"&.chat-box__input--loading":{maxHeight:"106.5px",overflow:"hidden",position:"relative","& textarea":{opacity:0},"& .chat-box__input-skeleton":{opacity:1,zIndex:1,display:"block"}},...u}},ar.default.createElement(F,{component:"div",className:"chat-box__input-skeleton"},ar.default.createElement(Co,{height:Xa})),ar.default.createElement(F,{component:"textarea",sx:{boxSizing:"border-box",display:"block",maxHeight:r?Xa*d+16:"unset",color:S=>S.palette.mode==="dark"?"#fff":"rgba(0,0,0,.87)!important",fontSize:"16px",lineHeight:Xa+"px",background:"transparent!important",borderColor:"transparent!important",margin:"0!important",border:"0!important",outline:"0!important",boxShadow:"none!important",width:"100%",resize:"none",overflow:"hidden",overflowY:"auto",fontFamily:'"Roboto","Helvetica","Arial",sans-serif!important',"&::placeholder":{fontWeight:"400",color:S=>S.palette.mode==="dark"?"rgba(255, 255, 255, 0.38)":"rgba(0, 0, 0, 0.38)"},"&::-webkit-scrollbar":{width:0,background:"transparent"},"&::-webkit-scrollbar-thumb":{background:"transparent"}},placeholder:i,disabled:r,ref:x,value:n,rows:1,"data-min-line":d,onCopy:S=>{S.stopPropagation()},onCut:S=>{S.stopPropagation()},onPaste:S=>{if(S.stopPropagation(),c&&c(S),l){let I=S.clipboardData,w=Array.from(I?.items||[]).map(E=>E.getAsFile?.()).filter(E=>E!==null);w&&w.length>0&&(S.preventDefault(),l(w,S))}},onKeyUp:S=>{m&&S.stopPropagation()},onKeyPress:S=>{m&&S.stopPropagation()},onKeyDown:S=>{if(m&&S.stopPropagation(),!_.current&&!(S.key==="Enter"&&S.shiftKey)){if(S.key==="Enter"){S.preventDefault();let I=S.currentTarget.value;p?.(I)}else if(S.code==="Space"){S.stopPropagation();return}}},onClick:S=>{ck(S.currentTarget,f)},onCompositionUpdate:S=>{m&&S.stopPropagation()},onCompositionStart:S=>{m&&S.stopPropagation(),_.current=!0},onCompositionEnd:S=>{m&&S.stopPropagation(),_.current=!1,b(S)},onInput:S=>{m&&S.stopPropagation(),_.current?s?.(S.currentTarget.value):b(S)},onBlur:S=>{y(S.currentTarget,f)},...h}))});HS.displayName="AutoHeightTextarea";var lc=HS;var pk=e=>{let{enableChatMode:t,disableChatMode:o,children:r}=e,{localSettings:n}=N_(),i=n.chatMode||"free_chat";return typeof r=="function"?r(i):t&&i!==t||o&&i===o?null:r},Kd=pk;var $d=class{async sendUserAction(t,o){let r=await Xr.fetch("/user/send_user_action",{method:"POST",body:JSON.stringify({action:t,...o})});return r.data?.paywall&&(r.data.info&&(r.data.paywall.info=r.data.info),Object.keys(r.data.paywall).forEach(n=>{let i=n,a=r.data?.paywall?.[i]||{};Object.keys(a).length===0&&delete r.data?.paywall?.[i]})),r.data}};var uk=new $d,Os=uk;var zS=v(NS());var Me=v(A()),hk=(e,t)=>e.left<=t.right&&e.right>=t.left&&e.top<=t.bottom&&e.bottom>=t.top,gk=(e,t)=>!(e.left>=t.left&&e.right<=t.right&&e.top>=t.top&&e.bottom<=t.bottom),xk=e=>{let{total:t,remaining:o}=e;return Me.default.createElement(g,{direction:"row",sx:{width:"100%",gap:"2px"}},Array.from({length:t},(r,n)=>Me.default.createElement(F,{key:n,sx:{flex:1,height:"4px",bgcolor:i=>i.palette.mode==="light"?n<o?"primary.main":"#d9d9d9":n<o?"primary.main":"#4f4f4f",borderRadius:"2px"}})))},_k=e=>{let{total:t,remaining:o}=e;return Me.default.createElement(F,{position:"relative"},Me.default.createElement(F,{sx:{flex:1,height:"4px",bgcolor:r=>r.palette.mode==="light"?"#d9d9d9":"#4f4f4f",borderRadius:"2px"}}),Me.default.createElement(F,{sx:{position:"absolute",top:0,width:`${o/t*100}%`,height:"4px",bgcolor:"primary.main",borderRadius:"2px"}}))},zg=()=>{let{t:e}=k(),{modelUsage:t}=Oi(),{showPricingHooksPopup:o}=wl(),r=be(n=>n.conversationIds[0]);return Me.default.createElement(g,{sx:{gap:"8px",width:"100%"}},Me.default.createElement(T,{sx:{fontSize:"18px",fontWeight:500,color:"text.primary",textAlign:"left",lineHeight:1.5}},"Pro chat"),Me.default.createElement(T,{sx:{fontSize:"14px",fontWeight:400,color:"text.secondary",textAlign:"left",lineHeight:1.4}},e("package__features:chat__pro_chat_switch__usage_card__description")),Me.default.createElement(g,{sx:{padding:"8px 0 16px 0",gap:"8px",width:"100%"}},t.proChatReward?Me.default.createElement(Me.default.Fragment,null,Me.default.createElement(_k,{total:Vu+yh,remaining:t.proChat+t.proChatReward}),Me.default.createElement(g,{direction:"row",alignItems:"center",gap:1},Me.default.createElement(T,{sx:{fontSize:"14px",fontWeight:400,color:t.proChat+t.proChatReward<=0?"#f44336":"text.secondary",textAlign:"left",lineHeight:1.4}},e("package__features:chat__pro_chat_switch__usage_card__daily_left_single__title",{LEFT_COUNT:t.proChat+t.proChatReward,NAME:t.proChat+t.proChatReward<=1?"Pro chat":"Pro chats"})),Me.default.createElement(g2,{title:Me.default.createElement(g,{minWidth:250},Me.default.createElement(T,{fontSize:"14px",fontWeight:600,mb:1},e("package__features:chat__pro_chat_switch__usage_card__daily_left_single__title",{LEFT_COUNT:"",NAME:"Pro chats"})),Me.default.createElement(g,{direction:"row",justifyContent:"space-between",gap:1,mb:.5},Me.default.createElement(T,{fontSize:"14px",color:"rgba(255, 255, 255, 0.7)"},e("package__features:chat__pro_chat_switch__usage_card__daily_free__title")),Me.default.createElement(T,{fontSize:"14px",color:"rgba(255, 255, 255, 0.7)"},t.proChat," / ",Vu)),Me.default.createElement(g,{direction:"row",justifyContent:"space-between",gap:1},Me.default.createElement(T,{fontSize:"14px",color:"rgba(255, 255, 255, 0.7)"},e("package__features:chat__pro_chat_switch__usage_card__rewarded__title")),Me.default.createElement(T,{fontSize:"14px",color:"rgba(255, 255, 255, 0.7)"},t.proChatReward," /"," ",yh))),arrow:!0},Me.default.createElement(zS.default,{sx:{fontSize:18,color:"text.secondary"}})))):Me.default.createElement(Me.default.Fragment,null,Me.default.createElement(xk,{total:Vu,remaining:t.proChat}),Me.default.createElement(T,{sx:{fontSize:"14px",fontWeight:400,color:t.proChat<=0?"#f44336":"text.secondary",textAlign:"left",lineHeight:1.4}},e("package__features:chat__pro_chat_switch__usage_card__daily_left_single__title",{LEFT_COUNT:t.proChat,NAME:t.proChat<=1?"Pro chat":"Pro chats"})))),Me.default.createElement(Ce,{variant:"contained",sx:{width:"100%",minHeight:"44px",gap:1},onClick:async n=>{ti("click",{paywallType:"pro_chat_card",paywallReason:"ProChat",buttonType:"upgrade",targetElement:n?.currentTarget});let i=await Os.sendUserAction("click_upgrade_cta_pro_chat");i?.paywall&&o(r,i.paywall)}},Me.default.createElement(Lu,{sx:{fontSize:"20px",color:"inherit"}}),Me.default.createElement(T,{sx:{fontSize:"16x",fontWeight:500,textAlign:"left",color:"inherit"}},e("package__features:chat__pro_chat_switch__usage_card__button__upgrade",{NAME:"Pro chat"}))))},Ck=e=>{let{children:t}=e,[o,r]=(0,Me.useState)("top-start"),n=(0,Me.useMemo)(()=>dC(o,8),[o]),i=Me.default.useRef(null),a=Me.default.useRef(null),[s,l]=Me.default.useState(!1),c=Me.default.useRef({width:320,height:240}),{paywallShowDebounce:p}=vl(),u=()=>{let m=c.current;if(i.current){let d=i.current.getBoundingClientRect(),f={left:0,right:window.innerWidth,top:0,bottom:window.innerHeight},C=[{placement:"top-start",top:d.top-m.height-8,bottom:d.top-8,left:d.left,right:m.width+d.left},{placement:"bottom-start",top:d.bottom+8,bottom:d.bottom+m.height+8,left:d.left,right:m.width+d.left},{placement:"left",left:d.left-m.width-8,right:d.left-8,top:d.top-m.height/2-20,bottom:d.top+m.height/2},{placement:"right",...m,left:d.right+8,right:d.right+m.width+8,top:d.top-m.height/2,bottom:d.top+m.height/2},{placement:"left",left:d.left-m.width-8,right:d.left-8,top:0,bottom:m.height},{placement:"right",...m,left:d.right+8,right:d.right+m.width+8,top:0,bottom:m.height}].find(x=>!gk(x,f)&&!hk(x,d));r(C?.placement||"top")}};return(0,Me.useEffect)(()=>{s&&p({paywallType:"pro_chat_card",paywallReason:"ProChat"})},[s,p]),Me.default.createElement(Ay,{popupId:"maxai_client__features__chat__pro_chat_switch",variant:"popover",disableAutoFocus:!0},m=>{let d=Ey(m);return l(d.open),d.open&&u(),Me.default.createElement("div",null,Me.default.createElement("div",{ref:i,...My(m),onMouseEnter:()=>{u()}},t),Me.default.createElement(Py,{...d,anchorOrigin:n.anchorOrigin,transformOrigin:n.transformOrigin,disableScrollLock:!0,slotProps:{paper:{elevation:0,sx:{background:"transparent",overflow:"unset"}}}},Me.default.createElement(Kr,{ref:a,elevation:0,sx:{width:"280px",padding:"16px",marginBottom:"6px",border:"1px solid",borderColor:"border.main",boxShadow:"0px 0px 1px 0px rgba(0, 0, 0, 0.20), 0px 0px 16px 0px rgba(0, 0, 0, 0.10), 0px 16px 24px 0px rgba(0, 0, 0, 0.08);"}},Me.default.createElement(zg,null))))})},VS=Ck;var Vg=v(A()),yk=()=>{let e=be(m=>m.conversationIds[0]),{localSettings:t,setLocalSettings:o}=lt(),{isFreeUser:r}=vt(),{modelUsage:n,refreshModelUsage:i}=Oi(),{showPricingHooksPopup:a}=wl(),s=(0,Vg.useRef)(null),l=(0,Vg.useRef)(!1),{paywallShow:c}=vl(),p=async m=>(l.current=!1,new Promise(d=>{s.current=setTimeout(()=>{Os.sendUserAction("turn_on_pro_chat_mode").then(f=>{l.current||(f?.paywall?(a(e,f.paywall),c({paywallType:"modal",paywallReason:"ProChat"}),o({chatMode:"free_chat"}),d(!1)):(i(),d(!0)))})},m)})),u=async(m,d)=>{let{asyncConfirm:f=!0,asyncConfirmDelay:h=100}=d||{};return await nt({emitEvent:!0})?(l.current=!0,s.current&&clearTimeout(s.current),m==="pro_chat"?(await o({chatMode:"pro_chat"}),r&&f&&n.proChat===0&&n.proChatReward===0?await p(h):!0):(await o({chatMode:m}),!0)):!1};return{chatMode:t.chatMode,updateChatMode:u}},Ya=yk;var aa=v(A()),bk=e=>{let{anchorElementSelectors:t='[data-testid="maxai--chat-pro-chat-switch"]',placement:o="top-start",onTryIt:r,...n}=e,{t:i}=k(),{modelUsage:a}=Oi(),{isPayingUser:s}=vt(),{localSettings:l}=lt(),[c,p]=(0,aa.useState)(!1),[u,m]=aa.default.useState(!0);return(0,aa.useEffect)(()=>{Ze.getOnboardingDataByKey("ON_BOARDING__RECORD_FIRST_AUTO_CLOSE_PRO_CHAT_SWITCH_TOOLTIP").then(d=>m(!!d))},[]),(0,aa.useEffect)(()=>{let d=!1;return!s&&a.proChat===0&&a.proChatReward===0&&l.chatMode==="free_chat"&&Ze.getOnboardingData().then(f=>{d||f.ON_BOARDING__RECORD_FIRST_AUTO_CLOSE_PRO_CHAT_SWITCH_TOOLTIP||f.ON_BOARDING__RECORD_FIRST_AUTO_CLOSE_PRO_CHAT_SWITCH&&p(!0)}),()=>{d=!0}},[s,a.proChat,l.chatMode]),u?null:aa.default.createElement(Et,{trigger:c,arrow:!1,hideCTAButton:!0,placement:o,anchorElementSelectors:t,onShow:()=>{Ze.setOnboardingData("ON_BOARDING__RECORD_FIRST_AUTO_CLOSE_PRO_CHAT_SWITCH_TOOLTIP",!0)},ctaButtonText:i("package__features:onboarding__onboarding_popover__cta_button__try_it"),onCTAButtonClick:async()=>{r&&r()},...n},aa.default.createElement(zg,null))},RS=bk;var Lp="ON_BOARDING_POPOVER__PRO_CHAT__OPENED",Yd="ON_BOARDING_POPOVER__PRO_CHAT__CLOSED",Op="ON_BOARDING_POPOVER__NEW_CHAT",FY="ON_BOARDING_POPOVER__CHAT_IN_FULL_PAGE",Rg="ON_BOARDING_POPOVER__CHAT_HISTORY",Ug="ON_BOARDING_POPOVER__CHAT_HUB_SELECTOR",Bp="ON_BOARDING_POPOVER__AI_MODEL_SELECTOR";var fn=v(A()),Sk=e=>{let{anchorElementSelectors:t='[data-testid="maxai--chat-pro-chat-switch"]',placement:o="top-start",onTryIt:r,...n}=e,{t:i}=k(),[a,s]=fn.default.useState(!1),[l,c]=fn.default.useState(!0),p=be(x=>x.conversationIds),u=xr(p[0]),m=ye(p[0]),d=(0,fn.useRef)(!1),{localSettings:f}=lt(),{isFreeUser:h}=vt(),C=_r.use.setChatAIModelAndProvider();return(0,fn.useEffect)(()=>{Ze.getOnboardingDataByKey(Lp).then(x=>c(!!x))},[]),(0,fn.useEffect)(()=>{if(l)return;let x=u.find(_=>_.type==="ai");x&&x.originalMessage?.metadata?.chatMode==="free_chat"&&f.chatMode==="free_chat"&&!m&&d.current&&s(!0)},[u,f.chatMode,l,m]),(0,fn.useEffect)(()=>{m&&(d.current=!0)},[m]),l?null:fn.default.createElement(Et,{trigger:a,placement:o,anchorElementSelectors:t,onShow:()=>{Ze.setOnboardingData(Lp,!0),h&&C({AIModel:Xc.value,AIProvider:Xc.AIProvider})},onClose:()=>{Ze.setOnboardingData(Yd,!0)},ctaButtonText:i("package__features:onboarding__onboarding_popover__cta_button__try_it"),onCTAButtonClick:async()=>{r&&r()},CtaButtonProps:{"data-button-clicked-name":"Onboarding > Pro chat > Try it"},...n},fn.default.createElement(g,{spacing:.5},fn.default.createElement(T,{fontSize:20,lineHeight:1.4,color:"text.primary",fontWeight:700,textAlign:"left"},"Pro chat"),fn.default.createElement(T,{fontSize:14,lineHeight:1.4,color:"text.primary",fontWeight:400,textAlign:"left"},i("package__features:onboarding__onboarding_popover__pro_chat__description"))))},US=Sk;var ci=v(A()),Ik=e=>{let{anchorElementSelectors:t='[data-testid="maxai--chat-pro-chat-switch"]',placement:o="top-start",onTryIt:r,...n}=e,{t:i}=k(),{modelUsage:a}=Oi(),{isPayingUser:s}=vt(),{localSettings:l}=lt(),[c,p]=(0,ci.useState)(!1),[u,m]=ci.default.useState(!0);return(0,ci.useEffect)(()=>{Ze.getOnboardingData().then(d=>{d.ON_BOARDING__RECORD_FIRST_AUTO_CLOSE_PRO_CHAT_SWITCH_TOOLTIP&&m(d.ON_BOARDING__RECORD_FIRST_RESET_DAILY_USAGE_PRO_CHAT_SWITCH_TOOLTIP===!0)})},[]),(0,ci.useEffect)(()=>{!s&&a.proChat>0&&l.chatMode==="free_chat"&&p(!0)},[s,a.proChat,l.chatMode]),u?null:ci.default.createElement(Et,{trigger:c,placement:o,anchorElementSelectors:t,onShow:()=>{Ze.setOnboardingData("ON_BOARDING__RECORD_FIRST_RESET_DAILY_USAGE_PRO_CHAT_SWITCH_TOOLTIP",!0)},ctaButtonText:i("package__features:onboarding__onboarding_popover__cta_button__try_it"),onCTAButtonClick:async d=>{r&&r(d)},CtaButtonProps:{"data-button-clicked-name":"Onboarding > Pro chat > Got it"},...n},ci.default.createElement(g,{spacing:.5},ci.default.createElement(T,{fontSize:20,lineHeight:1.4,color:"text.primary",fontWeight:700,textAlign:"left"},"Pro chat"),ci.default.createElement(T,{fontSize:14,lineHeight:1.4,color:"text.primary",fontWeight:400,textAlign:"left"},i("package__features:onboarding__onboarding_popover__pro_chat__first_reset_daily_usage__description",{NAME:"Pro chats"}))))},WS=Ik;var yo=v(A());var GS=e=>{let{sx:t,children:o,...r}=e;return yo.default.createElement(g,{direction:"row",alignItems:"center",sx:{padding:"6px 4px",gap:"4px",cursor:"pointer",transform:"translateY(0)",...t},...r},o,yo.default.createElement(T,{sx:{fontSize:"14px",fontWeight:500,color:"text.primary",textAlign:"left"}},"Pro"))},jS=e=>{let{children:t,title:o}=e;return yo.default.createElement(ve,{disableInteractive:!0,testId:"maxai--chat-pro-chat-switch--tooltip",placement:"top",title:o},yo.default.createElement("div",null,t))},vk=()=>{let{t:e}=k();return yo.default.createElement(jS,{title:e("package__features:chat__pro_chat_switch__pay_user_tooltip")},yo.default.createElement(GS,null,yo.default.createElement(ll,{sx:{color:"text.primary"},"data-testid":"maxai--chat-pro-chat-switch"})))},wk=e=>{let{hideOnboarding:t=!1}=e,{chatMode:o,updateChatMode:r}=Ya(),{isLogin:n}=Ko(),{t:i}=k(),a=async l=>{await Ze.setOnboardingData("ON_BOARDING__RECORD_FIRST_CLICK_PRO_CHAT_SWITCH",!0),await r(o==="free_chat"?"pro_chat":"free_chat")===!1&&ti("click",{paywallType:"pro_chat_card",paywallReason:"ProChat",buttonType:"pro_switch",targetElement:l?.target})},s=yo.default.createElement(GS,{onClick:a},yo.default.createElement("div",{"data-testid":"maxai--chat-pro-chat-switch"},yo.default.createElement(kl,{...e,checked:o==="pro_chat"})));return n?yo.default.createElement("div",null,yo.default.createElement(VS,null,s),yo.default.createElement(RS,null),yo.default.createElement(WS,{onTryIt:a}),!t&&yo.default.createElement(US,{onTryIt:a})):yo.default.createElement(jS,{title:i("package__features:chat__pro_chat_switch__not_login_user_tooltip",{NAME:"Pro chat"})},s)},Tk=e=>{let{isPayingUser:t}=vt(),{isLogin:o}=Ko(),{setLocalSettings:r,localSettings:n}=lt();return(0,yo.useEffect)(()=>{o&&t&&n.chatMode!=="pro_chat"&&r({chatMode:"pro_chat"})},[o,t,n.chatMode]),o&&t?yo.default.createElement(vk,null):yo.default.createElement(wk,{...e})},Za=Tk;var qS=v(A()),Mk=e=>{let{onChanged:t,...o}=e,{userSettings:r,setUserSettings:n}=Yr(),i=oC(),a=Ci&&typeof i.query.locale=="string"?i.query.locale:"",s=async c=>{n({language:c}),t?.(c)},l=i_(r?.language||"",a||r?.preferredLanguage||"");return qS.default.createElement(Ky,{options:Zx,value:l,onChange:s,...o})},KS=Mk;var $S=v(A()),Ek=e=>{let{onChanged:t,tooltipProps:o,popoverProps:r,...n}=e,{t:i}=k(),{conversationId:a,inputMediator:s}=ue(),l=ye(a);return $S.default.createElement(KS,{onChanged:c=>{s.focus(),t?.(c)},disabled:l,tooltipProps:{title:i("package__features:chat__ai_language_selector__button__tooltip"),...o},popoverProps:{offset:5,...r},...n})},Qa=Ek;var Fp=v(A()),XS=v(A()),Ak=e=>{let{type:t="floating",sx:o}=e,{t:r}=k(),n=(0,XS.useMemo)(()=>[{value:"clear_suggested",label:r("package__features:context_menu__more_button__clear_suggested_tools"),ButtonProps:{tooltipProps:{placement:"right",disabled:!1}},labelSx:{color:"rgba(255, 14, 39, 1) !important"},icon:Fp.default.createElement(X,{icon:"Delete",sx:{color:"rgba(255, 14, 39, 1) !important"}})}],[r]),i=async u=>{if(u==="clear_suggested"){if(!await nt({emitEvent:!0}))return;await l()}},{contextMenuPath:a}=co(),{contextMenuSuggestions:s,resetContextMenuSuggestions:l}=ni(a||""),{contextMenuSuggestions:c}=ni("/rewrite"),{contextMenuSuggestions:p}=ni("/my_own_tools");return a&&s.length===0||c.length===p.length&&c.length===0?null:Fp.default.createElement(F,{sx:{padding:0,...o}},Fp.default.createElement(fe,{options:n,placement:"bottom-end",onSelectOption:u=>{i(u)},OptionsCardProps:{sx:{width:"auto",marginRight:"-13px"}},sx:{width:"26px",height:"26px",padding:"8px"}},Fp.default.createElement(X,{size:t==="floating"?18:16,icon:"More"})))},cc=Ak;var Dp=class{constructor(){this.menuList=[];this.path=[];this.onUpdate=()=>{}}setOnUpdate(t){this.onUpdate=t}updatePath(t){this.path=t,this.onUpdate()}setMenuList(t){if(t!==this.menuList)if(this.menuList=t,this.menuList.length===0)this.updatePath([]);else{let o=null,r=[];for(let n of this.menuList){if(n.type==="chat_complete"){o=n,r=this.menuList;break}if(n.type==="group"){let i=!1;for(let a of n.children)if(a.type==="chat_complete"){o=a,r=n.children,i=!0;break}if(i)break}}this.updatePath(o?[{item:o,siblingList:r,triggerByHover:!1}]:[])}}onHover(t){let o=[];function r(n){let i=n;for(let a of n){if(a.prompt_id===t.prompt_id)return o.unshift({item:a,siblingList:i,triggerByHover:!0}),!0;a.type==="group"&&r(a.children??[])&&o.unshift({item:a,siblingList:i,triggerByHover:!0})}return!1}r(this.menuList),this.updatePath(o)}proxyKeyboardEvent(t){return t.key==="ArrowUp"||t.key==="ArrowDown"||t.key==="ArrowLeft"||t.key==="ArrowRight"?this.onNavigate(t.key.slice(5)):!1}onNavigate(t){if(this.path.length===0)return!1;let o=this.path[this.path.length-1];switch(t){case"Up":{let r=o.siblingList.indexOf(o.item);if(r===-1)throw Error("onNavigate up index = -1");return r===0?!1:(o.item=o.siblingList[r-1],this.updatePath(this.path.map(n=>({...n,triggerByHover:!1}))),!0)}case"Down":{let r=o.siblingList.indexOf(o.item);if(r===-1)throw Error("onNavigate down index = -1");return r===o.siblingList.length-1?!1:(o.item=o.siblingList[r+1],this.updatePath(this.path.map(n=>({...n,triggerByHover:!1}))),!0)}case"Left":return this.path.length===1?!1:(this.updatePath(this.path.slice(0,this.path.length-1).map(r=>({...r,triggerByHover:!1}))),!0);case"Right":{if(o.item.type!=="group")return!1;let r=o.item;return!r.children||r.children.length===0?!1:(this.path.push({item:r.children[0],siblingList:r.children,triggerByHover:!1}),this.updatePath(this.path.map(n=>({...n,triggerByHover:!1}))),!0)}}}getSelectedItem(){let t=wi(this.path);if(t&&t.item.type==="chat_complete")return t.item}match(t){return!!this.path.find(r=>r.item===t)}matchOpenGroup(t){let o=this.path.findIndex(r=>r.item===t);return o===-1?!1:o!==this.path.length-1||this.path[o].triggerByHover}onLeave(){this.updatePath(this.path.slice(0,1).map(t=>({...t,triggerByHover:!1})))}};var ZS=v(Zy()),QS=v(lM());var ft=v(A()),Wg=v(A()),Gg=(0,ft.forwardRef)(function({disabled:t,data:o,onHover:r,isActive:n,label:i,iconKey:a,includeChildren:s,onClick:l,stopClickEventPropagation:c,...p},u){let m=(0,ft.useRef)();(0,ft.useEffect)(()=>{if(n&&m.current&&m.current.parentElement){let f=m.current,h=m.current.parentElement,C={top:h.scrollTop,bottom:h.clientHeight+h.scrollTop};if(f.offsetTop+f.clientHeight>C.bottom)h.scrollTo({behavior:"instant",top:f.offsetTop+f.clientHeight-h.clientHeight,left:h.scrollLeft});else if(f.offsetTop<C.top){let x=f;f.previousElementSibling instanceof HTMLElement&&f.previousElementSibling.classList.contains("maxai-context-menu-group-label")&&(x=f.previousElementSibling),h.scrollTo({behavior:"instant",top:x.offsetTop,left:h.scrollLeft})}}},[n]);let d=(0,Wg.useMemo)(()=>{try{return`dropdown-menu--item--${o.text.replace(/\s+/g,"-").toLowerCase()}`}catch{return""}},[o.text]);return ft.default.createElement(F,{...p,"aria-disabled":t,className:`floating-context-menu-item ${n?"floating-context-menu-item--active":""}`,tabIndex:n?0:-1,"data-testid":d,sx:{display:"flex",alignItems:"center",flexDirection:"row",gap:1,boxSizing:"border-box",px:1,borderRadius:"3px",height:"28px",fontSize:"14px",width:"100%",cursor:"pointer","&.floating-context-menu-item--active":{bgcolor:f=>f.palette.mode==="dark"?"rgba(255, 255, 255, 0.08)":"rgba(55, 53, 47, 0.08)","& .floating-context-menu-item__footer-icon":{display:"flex"}},"& .floating-context-menu-item__footer-icon":{display:"none",flexShrink:0},"& .floating-context-menu-item__footer-icon--active":{display:"flex"},"&:hover":{bgcolor:f=>f.palette.mode==="dark"?"rgba(255, 255, 255, 0.08)":"rgba(55, 53, 47, 0.08)","& .floating-context-menu-item__footer-icon":{display:"flex"}}},ref:f=>{f&&(u&&(typeof u=="function"?u(f):u.current=f),m.current=f)},component:"div",role:"menuitem",onMouseEnter:()=>{r?.(o)},onClick:f=>{l?.(o),c&&f.stopPropagation()}},a&&ft.default.createElement(X,{size:16,icon:a,sx:{color:"primary.main",flexShrink:0}}),ft.default.createElement(T,{fontSize:14,textAlign:"left",color:"text.primary",width:0,noWrap:!0,flex:1,lineHeight:"28px"},i),ft.default.createElement("span",{className:"floating-context-menu-item__footer-icon "+(s?"floating-context-menu-item__footer-icon--active":"")},s?ft.default.createElement(ZS.default,{sx:{color:f=>f.palette.mode==="dark"?"#ffffff85":"rgba(55, 53, 47, 0.45)",fontSize:16}}):ft.default.createElement(QS.default,{className:"floating-context-menu-item__footer-hover-icon",sx:{color:f=>f.palette.mode==="dark"?"#ffffff85":"rgba(55, 53, 47, 0.45)",fontSize:16}})))}),Pk=(e,t,o)=>xl(e,t,o,{animationFrame:!0}),YS=(0,ft.forwardRef)(function({referenceElement:t,referenceElementRef:o,zIndex:r=1,children:n,root:i=document.body,open:a,needAutoUpdate:s=!0,sx:l,defaultPlacement:c,defaultFallbackPlacements:p,data:u,menuMaxHeight:m,menuWidth:d,onHover:f,onLeave:h,stopClickEventPropagation:C,...x},_){let y=aC(),b=Oh(),S=!b,I=!!b,[w,E]=(0,ft.useState)(a??!1),O=(0,Wg.useMemo)(()=>w||a,[a,w]),L=c||(S?"bottom-start":"right-start"),G=p||(S?["bottom-start","left","left-end","top-start","right"]:["right","right-start","right-end","left","left-start","left-end"]),{x:H,y:V,strategy:W,placement:N,refs:Z,context:J}=Da({nodeId:y,open:O,onOpenChange:(j,de,re)=>{E(j),re==="hover"&&(j?f?.(u):h?.(u))},placement:L,middleware:[Uu({mainAxis:S?4:0,alignmentAxis:S?0:-4}),Gu({fallbackPlacements:G}),Wu()],whileElementsMounted:s?Pk:void 0}),K=fm(J,{role:"menu"}),Q=dm(J),M=cC(J,{delay:{open:70,close:70},handleClose:uC({blockPointerEvents:!0})}),{getReferenceProps:le,getFloatingProps:ge,getItemProps:P}=Tl([K,Q,M]),$=iC([Z.setReference,_,o]);return ft.default.createElement(sC,{id:y},t&&ft.default.isValidElement(t)&&ft.default.cloneElement(t,{...le({...x,className:`${I?"MenuItem":"RootMenu"}`,...I&&{role:"menuitem"},ref:$})}),ft.default.createElement(um,{root:i},O&&ft.default.Children.count(n)!==0&&ft.default.createElement(pC,{context:J,modal:!1,initialFocus:-1,visuallyHiddenDismiss:!0},ft.default.createElement(g,{sx:{zIndex:r+1,display:"flex",flexDirection:"column",p:ft.default.Children.count(n)===0?0:.5,outline:"none!important",maxHeight:m||340,boxSizing:"border-box",overflowY:"auto",border:"1px solid",borderColor:j=>j.palette.mode==="dark"?"rgba(255, 255, 255, 0.2)":"rgba(0,0,0,0.12)",bgcolor:"background.paper",borderRadius:1,boxShadow:N.includes("top")?"rgba(15, 15, 15, 0.05) 0px 0px 0px 1px, rgba(15, 15, 15, 0.1) 0px -3px 6px, rgba(15, 15, 15, 0.05) 0px -9px 24px":"rgba(15, 15, 15, 0.05) 0px 0px 0px 1px, rgba(15, 15, 15, 0.1) 0px 3px 6px, rgba(15, 15, 15, 0.2) 0px 9px 24px","& *":{outline:"none!important"},"&:has(.max-ai--popper-wrapper)":{overflowY:"unset"},width:d,...l},component:"div",ref:Z.setFloating,className:"Menu dropdown-menu",onClick:j=>{C&&j.stopPropagation()},style:{position:W,top:V??0,left:H??0},...ge()},ft.default.Children.map(n,j=>ft.default.isValidElement(j)&&ft.default.cloneElement(j,{...P({})}))))))}),kk=(0,ft.forwardRef)(function(t,o){return Oh()?ft.default.createElement(YS,{...t,ref:o}):ft.default.createElement(lC,null,ft.default.createElement(YS,{...t,ref:o}))}),jg=kk;var Pt=v(A()),Zd=(0,Pt.forwardRef)((e,t)=>{let{menuItem:o,onClick:r,root:n,zIndex:i,menuWidth:a,contextMenuNavigator:s,onClickGroup:l,...c}=e,{t:p}=k(),u=(0,Pt.useMemo)(()=>{let m=`context_menu__prompt__${o.prompt_id.replace(ir,"")}`,d=`package__features:${m}`,f=p(d);return f!==d&&f!==m?f:o.prompt_title},[o.prompt_title,p]);return o.type==="group"?Pt.default.createElement(jg,{zIndex:i,ref:t,root:n,label:u,data:o,menuWidth:a,open:s.matchOpenGroup(o),onHover:()=>{s.onHover(o)},stopClickEventPropagation:!0,referenceElement:Pt.default.createElement(Gg,{label:u,data:o,includeChildren:!0,onClick:l,iconKey:o.prompt_icon,isActive:s.match(o)})},(o.children??[]).map(m=>Pt.default.createElement(Zd,{...c,zIndex:i+1,onClick:r,root:n,contextMenuNavigator:s,key:m.prompt_id,menuItem:m,menuWidth:a}))):Pt.default.createElement(Gg,{data:o,ref:t,label:u,iconKey:o.prompt_icon,onClick:r,isActive:s.match(o),onHover:()=>{s.onHover(o)}})});Zd.displayName="DropdownItemWrapper";var JS=()=>Pt.default.createElement(F,{"data-testid":"max-ai-context-menu-divider","aria-disabled":!0,onClick:e=>{e.stopPropagation(),e.preventDefault()},component:"div",sx:{pointerEvents:"none",borderTop:"1px solid",borderColor:e=>e.palette.mode==="dark"?"rgba(255, 255, 255, 0.2)":"rgba(0,0,0,0.12)",my:.5}}),Lk=(0,Pt.forwardRef)(function(t,o){let{root:r,referenceElement:n,referenceElementRef:i,menuList:a=[],open:s,needAutoUpdate:l,defaultPlacement:c,defaultFallbackPlacements:p,onClickItem:u,menuWidth:m=450,zIndex:d=pl()?0:2147483601,menuMaxHeight:f,noOptionFallback:h,onClickGroup:C,sx:x}=t,_=h_(),y=(0,Pt.useMemo)(()=>{let b=new Dp;return b.setOnUpdate(_),b},[]);return(0,Pt.useImperativeHandle)(o,()=>({proxyKeyboardEvent:b=>y.proxyKeyboardEvent(b),getSelectedItem:()=>y.getSelectedItem()})),(0,Pt.useEffect)(()=>{y.setMenuList(a.filter(b=>typeof b=="object"))},[a]),Pt.default.createElement(jg,{zIndex:d,root:r,open:s,needAutoUpdate:l,referenceElement:n,referenceElementRef:i,defaultPlacement:c,defaultFallbackPlacements:p,onClick:u,menuMaxHeight:f,menuWidth:m,stopClickEventPropagation:!0,onLeave:()=>{y.onLeave()},sx:x},a.length===0&&h,a.map((b,S)=>{if(typeof b=="string"){let I=b.split("__CONTEXT_MENU_LABEL_SLOT_PLACEHOLDER__")[0],w=b.split("__CONTEXT_MENU_LABEL_SLOT_PLACEHOLDER__")[1];return Pt.default.createElement(Pt.Fragment,{key:w+"_group_name"},S!==0&&JS(),Pt.default.createElement(F,{"aria-disabled":!0,sx:{display:"flex",justifyContent:"space-between",alignItems:"center",width:"100%",boxSizing:"border-box",direction:"row",pl:"8px"},className:"maxai-context-menu-group-label",onClick:E=>{E.stopPropagation(),E.preventDefault()}},Pt.default.createElement(F,{sx:{p:"3px 0 6px 0",pointerEvents:"none"}},Pt.default.createElement(T,{textAlign:"left",fontSize:12,color:"text.secondary"},I)),w===ir&&Pt.default.createElement(cc,{sx:{ml:"auto"}})))}return b.type==="group"?Pt.default.createElement(Pt.Fragment,{key:b.prompt_id+"_group_name"},$y.includes(b.prompt_id)&&JS(),Pt.default.createElement(Zd,{menuItem:b,root:r,zIndex:d+1,menuWidth:m,contextMenuNavigator:y,onClick:u,onClickGroup:C})):Pt.default.createElement(Zd,{key:b.prompt_id,zIndex:d+1,root:r,menuItem:b,menuWidth:m,contextMenuNavigator:y,onClick:u})}))}),Qd=Lk;var ef=v(A());var eI=v(va());var Hp=v(A()),qg=[{language_code:"uk",value:"Ukrainian",label:"\u0423\u043A\u0440\u0430\u0457\u043D\u0441\u044C\u043A\u0430"},{language_code:"so",value:"Somali",label:"Af Soomaali"},{language_code:"af",value:"Afrikaans",label:"Afrikaans"},{language_code:"az",value:"Azerbaijani",label:"Az\u0259rbaycan dili"},{language_code:"id",value:"Indonesian",label:"Bahasa Indonesia"},{language_code:"ms-MY",value:"Malaysian Malay",label:"Bahasa Malaysia"},{language_code:"ms",value:"Malay",label:"Bahasa Melayu"},{language_code:"jv",value:"Javanese",label:"Basa Jawa"},{language_code:"su",value:"Sundanese",label:"Basa Sunda"},{language_code:"bs",value:"Bosnian",label:"Bosanski jezik"},{language_code:"ca",value:"Catalan",label:"Catal\xE0"},{language_code:"cs",value:"Czech",label:"\u010Ce\u0161tina"},{language_code:"ny",value:"Chichewa",label:"Chichewa"},{language_code:"cy",value:"Welsh",label:"Cymraeg"},{language_code:"da",value:"Danish",label:"Dansk"},{language_code:"de",value:"German",label:"Deutsch"},{language_code:"et",value:"Estonian",label:"Eesti keel"},{language_code:"en",value:"English",label:"English"},{language_code:"en-GB",value:"English (UK)",label:"English (UK)"},{language_code:"en-US",value:"English (US)",label:"English (US)"},{language_code:"es",value:"Spanish",label:"Espa\xF1ol"},{language_code:"eo",value:"Esperanto",label:"Esperanto"},{language_code:"eu",value:"Basque",label:"Euskara"},{language_code:"fr",value:"French",label:"Fran\xE7ais"},{language_code:"ga",value:"Irish",label:"Gaeilge"},{language_code:"gl",value:"Galician",label:"Galego"},{language_code:"hr",value:"Croatian",label:"Hrvatski jezik"},{language_code:"xh",value:"Xhosa",label:"isiXhosa"},{language_code:"zu",value:"Zulu",label:"isiZulu"},{language_code:"is",value:"Icelandic",label:"\xCDslenska"},{language_code:"it",value:"Italian",label:"Italiano"},{language_code:"sw",value:"Swahili",label:"Kiswahili"},{language_code:"ht",value:"Haitian Creole",label:"Krey\xF2l Ayisyen"},{language_code:"ku",value:"Kurdish",label:"Kurd\xEE"},{language_code:"la",value:"Latin",label:"Lat\u012Bna"},{language_code:"lv",value:"Latvian",label:"Latvie\u0161u valoda"},{language_code:"lb",value:"Luxembourgish",label:"L\xEBtzebuergesch"},{language_code:"lt",value:"Lithuanian",label:"Lietuvi\u0173 kalba"},{language_code:"hu",value:"Hungarian",label:"Magyar"},{language_code:"mg",value:"Malagasy",label:"Malagasy"},{language_code:"mt",value:"Maltese",label:"Malti"},{language_code:"mi",value:"Maori",label:"M\u0101ori"},{language_code:"nl",value:"Dutch",label:"Nederlands"},{language_code:"no",value:"Norwegian",label:"Norsk"},{language_code:"uz",value:"Uzbek",label:"O'zbek tili"},{language_code:"pl",value:"Polish",label:"Polski"},{language_code:"pt",value:"Portuguese",label:"Portugu\xEAs"},{language_code:"ro",value:"Romanian",label:"Rom\xE2n\u0103"},{language_code:"st",value:"Sesotho",label:"Sesotho"},{language_code:"sq",value:"Albanian",label:"Shqip"},{language_code:"sk",value:"Slovak",label:"Sloven\u010Dina"},{language_code:"sl",value:"Slovenian",label:"Sloven\u0161\u010Dina"},{language_code:"fi",value:"Finnish",label:"Suomi"},{language_code:"sv",value:"Swedish",label:"Svenska"},{language_code:"tl",value:"Tagalog",label:"Tagalog"},{language_code:"tt",value:"Tatar",label:"Tatar\xE7a"},{language_code:"tr",value:"Turkish",label:"T\xFCrk\xE7e"},{language_code:"vi",value:"Vietnamese",label:"Vi\u1EC7t ng\u1EEF"},{language_code:"yo",value:"Yoruba",label:"Yor\xF9b\xE1"},{language_code:"el",value:"Greek",label:"\u0395\u03BB\u03BB\u03B7\u03BD\u03B9\u03BA\u03AC"},{language_code:"be",value:"Belarusian",label:"\u0411\u0435\u043B\u0430\u0440\u0443\u0441\u043A\u0430\u044F \u043C\u043E\u0432\u0430"},{language_code:"bg",value:"Bulgarian",label:"\u0411\u044A\u043B\u0433\u0430\u0440\u0441\u043A\u0438 \u0435\u0437\u0438\u043A"},{language_code:"ky",value:"Kyrgyz",label:"\u041A\u044B\u0440"},{language_code:"kk",value:"Kazakh",label:"\u049A\u0430\u0437\u0430\u049B \u0442\u0456\u043B\u0456"},{language_code:"mk",value:"Macedonian",label:"\u041C\u0430\u043A\u0435\u0434\u043E\u043D\u0441\u043A\u0438 \u0458\u0430\u0437\u0438\u043A"},{language_code:"mn",value:"Mongolian",label:"\u041C\u043E\u043D\u0433\u043E\u043B \u0445\u044D\u043B"},{language_code:"ru",value:"Russian",label:"\u0420\u0443\u0441\u0441\u043A\u0438\u0439"},{language_code:"sr",value:"Serbian",label:"\u0421\u0440\u043F\u0441\u043A\u0438 \u0458\u0435\u0437\u0438\u043A"},{language_code:"tg",value:"Tajik",label:"\u0422\u043E\u04B7\u0438\u043A\u04E3"},{language_code:"ka",value:"Georgian",label:"\u10E5\u10D0\u10E0\u10D7\u10E3\u10DA\u10D8"},{language_code:"hy",value:"Armenian",label:"\u0540\u0561\u0575\u0565\u0580\u0565\u0576"},{language_code:"yi",value:"Yiddish",label:"\u05D9\u05D9\u05B4\u05D3\u05D9\u05E9"},{language_code:"he",value:"Hebrew",label:"\u05E2\u05D1\u05E8\u05D9\u05EA"},{language_code:"ug",value:"Uyghur",label:"\u0626\u06C7\u064A\u063A\u06C7\u0631\u0686\u06D5"},{language_code:"ur",value:"Urdu",label:"\u0627\u0631\u062F\u0648"},{language_code:"ar",value:"Arabic",label:"\u0627\u0644\u0639\u0631\u0628\u064A\u0629"},{language_code:"ps",value:"Pashto",label:"\u067E\u069A\u062A\u0648"},{language_code:"fa",value:"Persian",label:"\u0641\u0627\u0631\u0633\u06CC"},{language_code:"ne",value:"Nepali",label:"\u0928\u0947\u092A\u093E\u0932\u0940"},{language_code:"mr",value:"Marathi",label:"\u092E\u0930\u093E\u0920\u0940"},{language_code:"hi",value:"Hindi",label:"\u0939\u093F\u0928\u094D\u0926\u0940"},{language_code:"bn",value:"Bengali",label:"\u09AC\u09BE\u0982\u09B2\u09BE"},{language_code:"pa",value:"Punjabi",label:"\u0A2A\u0A70\u0A1C\u0A3E\u0A2C\u0A40"},{language_code:"gu",value:"Gujarati",label:"\u0A97\u0AC1\u0A9C\u0AB0\u0ABE\u0AA4\u0AC0"},{language_code:"or",value:"Oriya",label:"\u0B13\u0B21\u0B3C\u0B3F\u0B06"},{language_code:"ta",value:"Tamil",label:"\u0BA4\u0BAE\u0BBF\u0BB4\u0BCD"},{language_code:"te",value:"Telugu",label:"\u0C24\u0C46\u0C32\u0C41\u0C17\u0C41"},{language_code:"kn",value:"Kannada",label:"\u0C95\u0CA8\u0CCD\u0CA8\u0CA1"},{language_code:"ml",value:"Malayalam",label:"\u0D2E\u0D32\u0D2F\u0D3E\u0D33\u0D02"},{language_code:"si",value:"Sinhala",label:"\u0DC3\u0DD2\u0D82\u0DC4\u0DBD"},{language_code:"th",value:"Thai",label:"\u0E44\u0E17\u0E22"},{language_code:"lo",value:"Lao",label:"\u0E9E\u0EB2\u0EAA\u0EB2\u0EA5\u0EB2\u0EA7"},{language_code:"my",value:"Burmese",label:"\u1017\u1019\u102C\u1005\u102C"},{language_code:"km",value:"Khmer",label:"\u1797\u17B6\u179F\u17B6\u1781\u17D2\u1798\u17C2\u179A"},{language_code:"ko",value:"Korean",label:"\uD55C\uAD6D\uC5B4"},{language_code:"zh",value:"Chinese",label:"\u4E2D\u6587"},{language_code:"zh-TW",value:"Traditional Chinese",label:"\u7E41\u9AD4\u4E2D\u6587"},{language_code:"ja",value:"Japanese",label:"\u65E5\u672C\u8A9E"}];function Ok(e,{inputValue:t}){return e.filter(o=>{let r=o.label.toLowerCase(),n=o.value.toLowerCase(),i=t.toLowerCase();return r.includes(i)||n.includes(i)})}var Bk=e=>{let{label:t="Output language",defaultValue:o="",onChange:r=l=>{},placeholder:n,sx:i}=e,[a,s]=(0,Hp.useState)(()=>qg.find(l=>l.value===o)||qg[0]);return Hp.default.createElement(Yu,{"data-testid":"system-variable--language-select",disablePortal:!0,disableClearable:!0,value:a,size:"small",sx:{[`.${k_.root}`]:{fontSize:16},[`.${Mh.root}`]:{fontSize:16,paddingRight:"28px!important"},[`.${Mh.root} fieldset > legend`]:{fontSize:14},[`.${I_.popupIndicator} .${eI.svgIconClasses.root}`]:{fontSize:24},...i},slotProps:{paper:{sx:{fontSize:16}}},ListboxProps:{style:{maxHeight:"144px"}},autoHighlight:!0,getOptionLabel:l=>l.label,options:qg,onChange:(l,c)=>{l.stopPropagation(),s(c),r(c.value)},onKeyDown:l=>{l.stopPropagation()},onPaste:l=>{l.stopPropagation()},filterOptions:Ok,renderInput:l=>Hp.default.createElement(Ut,{...l,label:t,placeholder:n,InputLabelProps:{sx:{fontSize:"16px"},...l.InputLabelProps},inputProps:{sx:{fontSize:"16px"},...l.inputProps}})})},tI=Bk;var oI=v(kh()),Kg=v(Lh());var kt=v(A()),Fk=({onSelectOption:e,options:t,selectedOption:o,menuListBoxSx:r,sx:n})=>{let{t:i}=k(),a=(0,kt.useRef)(null),s=(0,kt.useRef)(null),[l,c]=(0,kt.useState)(""),[p,u]=(0,kt.useState)(null),m=(0,kt.useMemo)(()=>l===""?t:t.filter(x=>{let _=x.label.toLowerCase(),y=String(x.value).toLowerCase(),b=l.toLowerCase();return _.includes(b)||y.includes(b)}),[l,t]),d=(0,kt.useRef)(!1),f=m.length-1,h=x=>{u(_=>{if(_!==null){let y=x==="increase"?_+1:_-1;return y>=f?f:y<=0?0:y}return _})};(0,kt.useEffect)(()=>{s.current&&(s.current.focus(),setTimeout(()=>{s.current?.focus()},200))},[]),(0,kt.useEffect)(()=>{l!==""&&u(0)},[l]),(0,kt.useEffect)(()=>{if(a.current&&p!==null){let x=m[p];if(x){let _=a.current,y=_.querySelector(`[data-testid="maxai-client--ui--select-option--${x.value}"]`);if(y){let b=y.offsetTop-_.offsetTop;_.scrollTo({top:b,behavior:"smooth"})}}}},[p,m]);let C=()=>{if(!m.length)return kt.default.createElement(g,{width:"100%",justifyContent:"center",alignItems:"center",spacing:1},kt.default.createElement(Kg.default,{sx:{fontSize:32,color:"text.secondary"}}),kt.default.createElement(T,{fontSize:12,color:"text.secondary"},i("package__ui:select__no_options__title")));let x=(_,y)=>{let b=o===_.value;return kt.default.createElement(Ju,{"data-testid":`maxai-client--ui--select-option--${_.value}`,selected:p===y,key:`${y}-${_.value}`,sx:[{py:"6px",px:"10px",borderRadius:1,mt:.5,"&.Mui-selected":{backgroundColor:"rgba(0, 0, 0, 0.04)"}}],onClick:S=>{S.stopPropagation(),e&&e(_)}},kt.default.createElement(tp,{sx:{my:0},primary:kt.default.createElement(g,{direction:"row",alignItems:"center",sx:{color:"text.primary",fontSize:14}},kt.default.createElement(T,{fontSize:"inherit",noWrap:!0,sx:{color:"inherit"}},_.label),b?kt.default.createElement(oI.default,{sx:{fontSize:"inherit",color:"text.primary",ml:"auto"}}):null)}))};return kt.default.createElement(Qu,{sx:{p:0,width:"100%"},onKeyDown:_=>{_.key==="ArrowDown"&&(_.preventDefault(),h("increase")),_.key==="ArrowUp"&&(_.preventDefault(),h("decrease"))}},m.map((_,y)=>x(_,y)))};return kt.default.createElement(g,{sx:n},kt.default.createElement(Ut,{inputRef:s,size:"small",value:l,onChange:x=>c(x.target.value),onCompositionStart:()=>d.current=!0,onCompositionEnd:()=>d.current=!1,placeholder:i("package__common:search"),InputProps:{startAdornment:kt.default.createElement(Bn,{position:"start"},kt.default.createElement(Kg.default,null)),sx:{fontSize:16}},inputProps:{autoComplete:"off"},sx:{pt:1,px:1,pb:.5},onKeyUp:x=>{x.stopPropagation()},onKeyDown:x=>{x.stopPropagation();let _=x.key;if((_==="ArrowDown"||_==="ArrowUp")&&(x.preventDefault(),p===null?u(0):h(_==="ArrowDown"?"increase":"decrease")),_==="Enter"&&p!==null&&!d.current){let y=m[p];x.preventDefault(),y&&e&&e(y)}}}),kt.default.createElement(F,{sx:{overflow:"auto",maxHeight:310,minHeight:310,px:1,pb:0,mb:1,overscrollBehavior:"contain",scrollbarColor:x=>x.palette.mode==="dark"?"rgba(255, 255, 255, 0.6) transparent":"rgba(0, 0, 0, 0.6) transparent",boxSizing:"border-box",display:"flex",...r},ref:a},C()))},rI=Fk;var ko=v(A()),Dk=e=>{let{title:t,dataTestId:o,options:r,defaultValue:n,value:i="",onChange:a,disabled:s,sx:l,startIcon:c,endIcon:p="ExpandMore",labelMaxWidth:u=64,tooltipProps:m,popoverProps:d,...f}=e,[h,C]=(0,ko.useState)(!1),[x,_]=(0,ko.useState)(()=>r.find(w=>w.value===i)||r.find(w=>w.value===n)||r[0]),[y,b]=(0,ko.useState)(!1),S=(0,ko.useRef)(null),I=s?!1:h;return(0,ko.useLayoutEffect)(()=>{let w=r.find(E=>E.value===i);w&&w.value!==x.value&&_(w)},[i]),qu(()=>{C(!1)}),ko.default.createElement(ko.default.Fragment,null,ko.default.createElement(ve,{title:t,open:y&&!I,disabled:s,...m},ko.default.createElement(Ce,{ref:S,disableRipple:!0,onMouseEnter:()=>{b(!0)},onMouseLeave:()=>{b(!1)},onClick:()=>{s||C(w=>!w)},className:h?"MAXAI_CLIENT__UI__SELECT":"","data-testid":o,startIcon:c?ko.default.createElement(Bn,{position:"start",sx:{marginRight:0}},typeof c=="string"?ko.default.createElement(X,{icon:c,sx:{fontSize:"18px",mx:"4px",color:"text.secondary"}}):c):void 0,endIcon:p?ko.default.createElement(Bn,{position:"end",sx:{marginLeft:0,position:"absolute",right:0,top:"50%",transform:"translateY(-50%)",zIndex:1,p:"6px"}},typeof p=="string"?ko.default.createElement(X,{icon:p,sx:{color:"text.secondary",fontSize:"16px",transform:h?"rotate(180deg)":"rotate(0)"}}):p):void 0,sx:{minWidth:"unset",maxWidth:"120px",borderRadius:1,cursor:s?"default":"pointer","&:focus":{cursor:"default"},color:"text.secondary",transition:"background-color 250ms cubic-bezier(0.4, 0, 0.2, 1)",[`& .${Ta.startIcon}`]:{mr:0},[`& .${Ta.endIcon}`]:{ml:0,p:0},[`& .${Ta.endIcon} .${P_.root}`]:{position:"static",transform:"none"},height:"32px",display:"flex",flexWrap:"nowrap",p:"4px 6px",alignItems:"center",justifyContent:"flex-start",fontSize:14,...l},...f},ko.default.createElement(T,{noWrap:!0,fontSize:"inherit",maxWidth:u,textAlign:"left"},x.label))),ko.default.createElement(Ml,{transitionDuration:0,disableScrollLock:!0,...d,placement:"bottom-start",fallbackPlacements:["top-start"],open:h,onClose:()=>{C(!1)},anchorEl:S.current},ko.default.createElement(rI,{selectedOption:i,options:r,onSelectOption:w=>{_(w),a?.(w.value),C(!1)}})))},Jd=Dk;var nI=v(A()),Hk=[{label:"Default tone",value:"Default"},{label:"Authoritative",value:"Authoritative"},{label:"Casual",value:"Casual"},{label:"Clinical",value:"Clinical"},{label:"Cold",value:"Cold"},{label:"Confident",value:"Confident"},{label:"Cynical",value:"Cynical"},{label:"Emotional",value:"Emotional"},{label:"Empathetic",value:"Empathetic"},{label:"Formal",value:"Formal"},{label:"Friendly",value:"Friendly"},{label:"Humorous",value:"Humorous"},{label:"Informal",value:"Informal"},{label:"Ironic",value:"Ironic"},{label:"Optimistic",value:"Optimistic"},{label:"Pessimistic",value:"Pessimistic"},{label:"Playful",value:"Playful"},{label:"Professional",value:"Professional"},{label:"Sarcastic",value:"Sarcastic"},{label:"Serious",value:"Serious"},{label:"Straightforward",value:"Straightforward"},{label:"Sympathetic",value:"Sympathetic"},{label:"Tentative",value:"Tentative"},{label:"Warm",value:"Warm"}],Nk=e=>{let{t}=k();return nI.default.createElement(Jd,{title:t("package__features:shortcuts__set_variables_modal__system_selector__tone"),labelMaxWidth:"unset",startIcon:"GraphicEqualizer",sx:{maxWidth:"unset"},...e,options:Hk})},iI=Nk;var aI=v(A()),zk=[{label:"Default writing style",value:"Default"},{value:"Academic",label:"Academic"},{value:"Analytical",label:"Analytical"},{value:"Argumentative",label:"Argumentative"},{value:"Conversational",label:"Conversational"},{value:"Creative",label:"Creative"},{value:"Critical",label:"Critical"},{value:"Descriptive",label:"Descriptive"},{value:"Epigrammatic",label:"Epigrammatic"},{value:"Epistolary",label:"Epistolary"},{value:"Expository",label:"Expository"},{value:"Informative",label:"Informative"},{value:"Instructive",label:"Instructive"},{value:"Journalistic",label:"Journalistic"},{value:"Metaphorical",label:"Metaphorical"},{value:"Narrative",label:"Narrative"},{value:"Persuasive",label:"Persuasive"},{value:"Poetic",label:"Poetic"},{value:"Satirical",label:"Satirical"},{value:"Technical",label:"Technical"}],Vk=e=>{let{t}=k();return aI.default.createElement(Jd,{title:t("package__features:shortcuts__set_variables_modal__system_selector__writing_style"),labelMaxWidth:"unset",startIcon:"Feather",sx:{maxWidth:"unset"},...e,options:zk})},sI=Vk;var Rk=e=>{let{systemVariableSelectKey:t,...o}=e;switch(t){case"AI_RESPONSE_WRITING_STYLE":return ef.default.createElement(sI,{...o});case"AI_RESPONSE_LANGUAGE":return ef.default.createElement(tI,{...o});case"AI_RESPONSE_TONE":return ef.default.createElement(iI,{...o});default:return null}},tf=Rk;var Np=class{constructor(){this.SET_VARIABLES_MODAL_SELECT_KEY="MAXAI_CLIENT__FEATURES__SET_VARIABLES_MODAL_SELECT_KEY"}async getSetVariablesModalSelectCache(){return await $r.getItem(this.SET_VARIABLES_MODAL_SELECT_KEY)||{}}async setVariablesModalSelectCache(t,o){try{let r=await this.getSetVariablesModalSelectCache();return r[t]=o,await $r.setItem(this.SET_VARIABLES_MODAL_SELECT_KEY,r),!0}catch{return!1}}};var pc=new Np;var kI=v(On()),LI=v(Ap()),OI=v(Hg());var He=v(A()),BI=v(sl());var ke=v(A(),1),Rp=e=>e.type==="checkbox",mc=e=>e instanceof Date,zr=e=>e==null,hI=e=>typeof e=="object",Oo=e=>!zr(e)&&!Array.isArray(e)&&hI(e)&&!mc(e),gI=e=>Oo(e)&&e.target?Rp(e.target)?e.target.checked:e.target.value:e,Uk=e=>e.substring(0,e.search(/\.\d+(\.|$)/))||e,xI=(e,t)=>e.has(Uk(t)),Wk=e=>{let t=e.constructor&&e.constructor.prototype;return Oo(t)&&t.hasOwnProperty("isPrototypeOf")},s0=typeof window<"u"&&typeof window.HTMLElement<"u"&&typeof document<"u";function zo(e){let t,o=Array.isArray(e);if(e instanceof Date)t=new Date(e);else if(e instanceof Set)t=new Set(e);else if(!(s0&&(e instanceof Blob||e instanceof FileList))&&(o||Oo(e)))if(t=o?[]:{},!o&&!Wk(e))t=e;else for(let r in e)e.hasOwnProperty(r)&&(t[r]=zo(e[r]));else return e;return t}var Up=e=>Array.isArray(e)?e.filter(Boolean):[],jt=e=>e===void 0,pe=(e,t,o)=>{if(!t||!Oo(e))return o;let r=Up(t.split(/[,[\].]+?/)).reduce((n,i)=>zr(n)?n:n[i],e);return jt(r)||r===e?jt(e[t])?o:e[t]:r},Vn=e=>typeof e=="boolean",l0=e=>/^\w*$/.test(e),_I=e=>Up(e.replace(/["|']|\]/g,"").split(/\.|\[/)),Lt=(e,t,o)=>{let r=-1,n=l0(t)?[t]:_I(t),i=n.length,a=i-1;for(;++r<i;){let s=n[r],l=o;if(r!==a){let c=e[s];l=Oo(c)||Array.isArray(c)?c:isNaN(+n[r+1])?{}:[]}if(s==="__proto__")return;e[s]=l,e=e[s]}return e},nf={BLUR:"blur",FOCUS_OUT:"focusout",CHANGE:"change"},Rn={onBlur:"onBlur",onChange:"onChange",onSubmit:"onSubmit",onTouched:"onTouched",all:"all"},sa={max:"max",min:"min",maxLength:"maxLength",minLength:"minLength",pattern:"pattern",required:"required",validate:"validate"},Gk=ke.default.createContext(null),pf=()=>ke.default.useContext(Gk);var CI=(e,t,o,r=!0)=>{let n={defaultValues:t._defaultValues};for(let i in e)Object.defineProperty(n,i,{get:()=>{let a=i;return t._proxyFormState[a]!==Rn.all&&(t._proxyFormState[a]=!r||Rn.all),o&&(o[a]=!0),e[a]}});return n},Nr=e=>Oo(e)&&!Object.keys(e).length,yI=(e,t,o,r)=>{o(e);let{name:n,...i}=e;return Nr(i)||Object.keys(i).length>=Object.keys(t).length||Object.keys(i).find(a=>t[a]===(!r||Rn.all))},Jr=e=>Array.isArray(e)?e:[e],bI=(e,t,o)=>!e||!t||e===t||Jr(e).some(r=>r&&(o?r===t:r.startsWith(t)||t.startsWith(r)));function uf(e){let t=ke.default.useRef(e);t.current=e,ke.default.useEffect(()=>{let o=!e.disabled&&t.current.subject&&t.current.subject.subscribe({next:t.current.next});return()=>{o&&o.unsubscribe()}},[e.disabled])}function jk(e){let t=pf(),{control:o=t.control,disabled:r,name:n,exact:i}=e||{},[a,s]=ke.default.useState(o._formState),l=ke.default.useRef(!0),c=ke.default.useRef({isDirty:!1,isLoading:!1,dirtyFields:!1,touchedFields:!1,validatingFields:!1,isValidating:!1,isValid:!1,errors:!1}),p=ke.default.useRef(n);return p.current=n,uf({disabled:r,next:u=>l.current&&bI(p.current,u.name,i)&&yI(u,c.current,o._updateFormState)&&s({...o._formState,...u}),subject:o._subjects.state}),ke.default.useEffect(()=>(l.current=!0,c.current.isValid&&o._updateValid(!0),()=>{l.current=!1}),[o]),CI(a,o,c.current,!1)}var Vi=e=>typeof e=="string",SI=(e,t,o,r,n)=>Vi(e)?(r&&t.watch.add(e),pe(o,e,n)):Array.isArray(e)?e.map(i=>(r&&t.watch.add(i),pe(o,i))):(r&&(t.watchAll=!0),o);function qk(e){let t=pf(),{control:o=t.control,name:r,defaultValue:n,disabled:i,exact:a}=e||{},s=ke.default.useRef(r);s.current=r,uf({disabled:i,subject:o._subjects.values,next:p=>{bI(s.current,p.name,a)&&c(zo(SI(s.current,o._names,p.values||o._formValues,!1,n)))}});let[l,c]=ke.default.useState(o._getWatch(r,n));return ke.default.useEffect(()=>o._removeUnmounted()),l}function Kk(e){let t=pf(),{name:o,disabled:r,control:n=t.control,shouldUnregister:i}=e,a=xI(n._names.array,o),s=qk({control:n,name:o,defaultValue:pe(n._formValues,o,pe(n._defaultValues,o,e.defaultValue)),exact:!0}),l=jk({control:n,name:o,exact:!0}),c=ke.default.useRef(n.register(o,{...e.rules,value:s,...Vn(e.disabled)?{disabled:e.disabled}:{}}));return ke.default.useEffect(()=>{let p=n._options.shouldUnregister||i,u=(m,d)=>{let f=pe(n._fields,m);f&&f._f&&(f._f.mount=d)};if(u(o,!0),p){let m=zo(pe(n._options.defaultValues,o));Lt(n._defaultValues,o,m),jt(pe(n._formValues,o))&&Lt(n._formValues,o,m)}return()=>{(a?p&&!n._state.action:p)?n.unregister(o):u(o,!1)}},[o,n,a,i]),ke.default.useEffect(()=>{pe(n._fields,o)&&n._updateDisabledField({disabled:r,fields:n._fields,name:o,value:pe(n._fields,o)._f.value})},[r,o,n]),{field:{name:o,value:s,...Vn(r)||l.disabled?{disabled:l.disabled||r}:{},onChange:ke.default.useCallback(p=>c.current.onChange({target:{value:gI(p),name:o},type:nf.CHANGE}),[o]),onBlur:ke.default.useCallback(()=>c.current.onBlur({target:{value:pe(n._formValues,o),name:o},type:nf.BLUR}),[o,n]),ref:ke.default.useCallback(p=>{let u=pe(n._fields,o);u&&p&&(u._f.ref={focus:()=>p.focus(),select:()=>p.select(),setCustomValidity:m=>p.setCustomValidity(m),reportValidity:()=>p.reportValidity()})},[n._fields,o])},formState:l,fieldState:Object.defineProperties({},{invalid:{enumerable:!0,get:()=>!!pe(l.errors,o)},isDirty:{enumerable:!0,get:()=>!!pe(l.dirtyFields,o)},isTouched:{enumerable:!0,get:()=>!!pe(l.touchedFields,o)},isValidating:{enumerable:!0,get:()=>!!pe(l.validatingFields,o)},error:{enumerable:!0,get:()=>pe(l.errors,o)}})}}var fc=e=>e.render(Kk(e));var $k=(e,t,o,r,n)=>t?{...o[e],types:{...o[e]&&o[e].types?o[e].types:{},[r]:n||!0}}:{},Ja=()=>{let e=typeof performance>"u"?Date.now():performance.now()*1e3;return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,t=>{let o=(Math.random()*16+e)%16|0;return(t=="x"?o:o&3|8).toString(16)})},$g=(e,t,o={})=>o.shouldFocus||jt(o.shouldFocus)?o.focusName||`${e}.${jt(o.focusIndex)?t:o.focusIndex}.`:"",Vp=e=>({isOnSubmit:!e||e===Rn.onSubmit,isOnBlur:e===Rn.onBlur,isOnChange:e===Rn.onChange,isOnAll:e===Rn.all,isOnTouch:e===Rn.onTouched}),i0=(e,t,o)=>!o&&(t.watchAll||t.watch.has(e)||[...t.watch].some(r=>e.startsWith(r)&&/^\.\w+/.test(e.slice(r.length)))),dc=(e,t,o,r)=>{for(let n of o||Object.keys(e)){let i=pe(e,n);if(i){let{_f:a,...s}=i;if(a){if(a.refs&&a.refs[0]&&t(a.refs[0],n)&&!r)return!0;if(a.ref&&t(a.ref,a.name)&&!r)return!0;if(dc(s,t))break}else if(Oo(s)&&dc(s,t))break}}},II=(e,t,o)=>{let r=Jr(pe(e,o));return Lt(r,"root",t[o]),Lt(e,o,r),e},c0=e=>e.type==="file",la=e=>typeof e=="function",af=e=>{if(!s0)return!1;let t=e?e.ownerDocument:0;return e instanceof(t&&t.defaultView?t.defaultView.HTMLElement:HTMLElement)},rf=e=>Vi(e),p0=e=>e.type==="radio",sf=e=>e instanceof RegExp,lI={value:!1,isValid:!1},cI={value:!0,isValid:!0},vI=e=>{if(Array.isArray(e)){if(e.length>1){let t=e.filter(o=>o&&o.checked&&!o.disabled).map(o=>o.value);return{value:t,isValid:!!t.length}}return e[0].checked&&!e[0].disabled?e[0].attributes&&!jt(e[0].attributes.value)?jt(e[0].value)||e[0].value===""?cI:{value:e[0].value,isValid:!0}:cI:lI}return lI},pI={isValid:!1,value:null},wI=e=>Array.isArray(e)?e.reduce((t,o)=>o&&o.checked&&!o.disabled?{isValid:!0,value:o.value}:t,pI):pI;function uI(e,t,o="validate"){if(rf(e)||Array.isArray(e)&&e.every(rf)||Vn(e)&&!e)return{type:o,message:rf(e)?e:"",ref:t}}var uc=e=>Oo(e)&&!sf(e)?e:{value:e,message:""},a0=async(e,t,o,r,n)=>{let{ref:i,refs:a,required:s,maxLength:l,minLength:c,min:p,max:u,pattern:m,validate:d,name:f,valueAsNumber:h,mount:C,disabled:x}=e._f,_=pe(t,f);if(!C||x)return{};let y=a?a[0]:i,b=H=>{r&&y.reportValidity&&(y.setCustomValidity(Vn(H)?"":H||""),y.reportValidity())},S={},I=p0(i),w=Rp(i),E=I||w,O=(h||c0(i))&&jt(i.value)&&jt(_)||af(i)&&i.value===""||_===""||Array.isArray(_)&&!_.length,L=$k.bind(null,f,o,S),G=(H,V,W,N=sa.maxLength,Z=sa.minLength)=>{let J=H?V:W;S[f]={type:H?N:Z,message:J,ref:i,...L(H?N:Z,J)}};if(n?!Array.isArray(_)||!_.length:s&&(!E&&(O||zr(_))||Vn(_)&&!_||w&&!vI(a).isValid||I&&!wI(a).isValid)){let{value:H,message:V}=rf(s)?{value:!!s,message:s}:uc(s);if(H&&(S[f]={type:sa.required,message:V,ref:y,...L(sa.required,V)},!o))return b(V),S}if(!O&&(!zr(p)||!zr(u))){let H,V,W=uc(u),N=uc(p);if(!zr(_)&&!isNaN(_)){let Z=i.valueAsNumber||_&&+_;zr(W.value)||(H=Z>W.value),zr(N.value)||(V=Z<N.value)}else{let Z=i.valueAsDate||new Date(_),J=M=>new Date(new Date().toDateString()+" "+M),K=i.type=="time",Q=i.type=="week";Vi(W.value)&&_&&(H=K?J(_)>J(W.value):Q?_>W.value:Z>new Date(W.value)),Vi(N.value)&&_&&(V=K?J(_)<J(N.value):Q?_<N.value:Z<new Date(N.value))}if((H||V)&&(G(!!H,W.message,N.message,sa.max,sa.min),!o))return b(S[f].message),S}if((l||c)&&!O&&(Vi(_)||n&&Array.isArray(_))){let H=uc(l),V=uc(c),W=!zr(H.value)&&_.length>+H.value,N=!zr(V.value)&&_.length<+V.value;if((W||N)&&(G(W,H.message,V.message),!o))return b(S[f].message),S}if(m&&!O&&Vi(_)){let{value:H,message:V}=uc(m);if(sf(H)&&!_.match(H)&&(S[f]={type:sa.pattern,message:V,ref:i,...L(sa.pattern,V)},!o))return b(V),S}if(d){if(la(d)){let H=await d(_,t),V=uI(H,y);if(V&&(S[f]={...V,...L(sa.validate,V.message)},!o))return b(V.message),S}else if(Oo(d)){let H={};for(let V in d){if(!Nr(H)&&!o)break;let W=uI(await d[V](_,t),y,V);W&&(H={...W,...L(V,W.message)},b(W.message),o&&(S[f]=H))}if(!Nr(H)&&(S[f]={ref:y,...H},!o))return S}}return b(!0),S},Xg=(e,t)=>[...e,...Jr(t)],Yg=e=>Array.isArray(e)?e.map(()=>{}):void 0;function Zg(e,t,o){return[...e.slice(0,t),...Jr(o),...e.slice(t)]}var Qg=(e,t,o)=>Array.isArray(e)?(jt(e[o])&&(e[o]=void 0),e.splice(o,0,e.splice(t,1)[0]),e):[],Jg=(e,t)=>[...Jr(t),...Jr(e)];function Xk(e,t){let o=0,r=[...e];for(let n of t)r.splice(n-o,1),o++;return Up(r).length?r:[]}var e0=(e,t)=>jt(t)?[]:Xk(e,Jr(t).sort((o,r)=>o-r)),t0=(e,t,o)=>{[e[t],e[o]]=[e[o],e[t]]};function Yk(e,t){let o=t.slice(0,-1).length,r=0;for(;r<o;)e=jt(e)?r++:e[t[r++]];return e}function Zk(e){for(let t in e)if(e.hasOwnProperty(t)&&!jt(e[t]))return!1;return!0}function Lo(e,t){let o=Array.isArray(t)?t:l0(t)?[t]:_I(t),r=o.length===1?e:Yk(e,o),n=o.length-1,i=o[n];return r&&delete r[i],n!==0&&(Oo(r)&&Nr(r)||Array.isArray(r)&&Zk(r))&&Lo(e,o.slice(0,-1)),e}var mI=(e,t,o)=>(e[t]=o,e);function u0(e){let t=pf(),{control:o=t.control,name:r,keyName:n="id",shouldUnregister:i}=e,[a,s]=ke.default.useState(o._getFieldArray(r)),l=ke.default.useRef(o._getFieldArray(r).map(Ja)),c=ke.default.useRef(a),p=ke.default.useRef(r),u=ke.default.useRef(!1);p.current=r,c.current=a,o._names.array.add(r),e.rules&&o.register(r,e.rules),uf({next:({values:S,name:I})=>{if(I===p.current||!I){let w=pe(S,p.current);Array.isArray(w)&&(s(w),l.current=w.map(Ja))}},subject:o._subjects.array});let m=ke.default.useCallback(S=>{u.current=!0,o._updateFieldArray(r,S)},[o,r]),d=(S,I)=>{let w=Jr(zo(S)),E=Xg(o._getFieldArray(r),w);o._names.focus=$g(r,E.length-1,I),l.current=Xg(l.current,w.map(Ja)),m(E),s(E),o._updateFieldArray(r,E,Xg,{argA:Yg(S)})},f=(S,I)=>{let w=Jr(zo(S)),E=Jg(o._getFieldArray(r),w);o._names.focus=$g(r,0,I),l.current=Jg(l.current,w.map(Ja)),m(E),s(E),o._updateFieldArray(r,E,Jg,{argA:Yg(S)})},h=S=>{let I=e0(o._getFieldArray(r),S);l.current=e0(l.current,S),m(I),s(I),o._updateFieldArray(r,I,e0,{argA:S})},C=(S,I,w)=>{let E=Jr(zo(I)),O=Zg(o._getFieldArray(r),S,E);o._names.focus=$g(r,S,w),l.current=Zg(l.current,S,E.map(Ja)),m(O),s(O),o._updateFieldArray(r,O,Zg,{argA:S,argB:Yg(I)})},x=(S,I)=>{let w=o._getFieldArray(r);t0(w,S,I),t0(l.current,S,I),m(w),s(w),o._updateFieldArray(r,w,t0,{argA:S,argB:I},!1)},_=(S,I)=>{let w=o._getFieldArray(r);Qg(w,S,I),Qg(l.current,S,I),m(w),s(w),o._updateFieldArray(r,w,Qg,{argA:S,argB:I},!1)},y=(S,I)=>{let w=zo(I),E=mI(o._getFieldArray(r),S,w);l.current=[...E].map((O,L)=>!O||L===S?Ja():l.current[L]),m(E),s([...E]),o._updateFieldArray(r,E,mI,{argA:S,argB:w},!0,!1)},b=S=>{let I=Jr(zo(S));l.current=I.map(Ja),m([...I]),s([...I]),o._updateFieldArray(r,[...I],w=>w,{},!0,!1)};return ke.default.useEffect(()=>{if(o._state.action=!1,i0(r,o._names)&&o._subjects.state.next({...o._formState}),u.current&&(!Vp(o._options.mode).isOnSubmit||o._formState.isSubmitted))if(o._options.resolver)o._executeSchema([r]).then(S=>{let I=pe(S.errors,r),w=pe(o._formState.errors,r);(w?!I&&w.type||I&&(w.type!==I.type||w.message!==I.message):I&&I.type)&&(I?Lt(o._formState.errors,r,I):Lo(o._formState.errors,r),o._subjects.state.next({errors:o._formState.errors}))});else{let S=pe(o._fields,r);S&&S._f&&!(Vp(o._options.reValidateMode).isOnSubmit&&Vp(o._options.mode).isOnSubmit)&&a0(S,o._formValues,o._options.criteriaMode===Rn.all,o._options.shouldUseNativeValidation,!0).then(I=>!Nr(I)&&o._subjects.state.next({errors:II(o._formState.errors,I,r)}))}o._subjects.values.next({name:r,values:{...o._formValues}}),o._names.focus&&dc(o._fields,(S,I)=>{if(o._names.focus&&I.startsWith(o._names.focus)&&S.focus)return S.focus(),1}),o._names.focus="",o._updateValid(),u.current=!1},[a,r,o]),ke.default.useEffect(()=>(!pe(o._formValues,r)&&o._updateFieldArray(r),()=>{(o._options.shouldUnregister||i)&&o.unregister(r)}),[r,o,n,i]),{swap:ke.default.useCallback(x,[m,r,o]),move:ke.default.useCallback(_,[m,r,o]),prepend:ke.default.useCallback(f,[m,r,o]),append:ke.default.useCallback(d,[m,r,o]),remove:ke.default.useCallback(h,[m,r,o]),insert:ke.default.useCallback(C,[m,r,o]),update:ke.default.useCallback(y,[m,r,o]),replace:ke.default.useCallback(b,[m,r,o]),fields:ke.default.useMemo(()=>a.map((S,I)=>({...S,[n]:l.current[I]||Ja()})),[a,n])}}var o0=()=>{let e=[];return{get observers(){return e},next:n=>{for(let i of e)i.next&&i.next(n)},subscribe:n=>(e.push(n),{unsubscribe:()=>{e=e.filter(i=>i!==n)}}),unsubscribe:()=>{e=[]}}},lf=e=>zr(e)||!hI(e);function es(e,t){if(lf(e)||lf(t))return e===t;if(mc(e)&&mc(t))return e.getTime()===t.getTime();let o=Object.keys(e),r=Object.keys(t);if(o.length!==r.length)return!1;for(let n of o){let i=e[n];if(!r.includes(n))return!1;if(n!=="ref"){let a=t[n];if(mc(i)&&mc(a)||Oo(i)&&Oo(a)||Array.isArray(i)&&Array.isArray(a)?!es(i,a):i!==a)return!1}}return!0}var TI=e=>e.type==="select-multiple",Qk=e=>p0(e)||Rp(e),r0=e=>af(e)&&e.isConnected,MI=e=>{for(let t in e)if(la(e[t]))return!0;return!1};function cf(e,t={}){let o=Array.isArray(e);if(Oo(e)||o)for(let r in e)Array.isArray(e[r])||Oo(e[r])&&!MI(e[r])?(t[r]=Array.isArray(e[r])?[]:{},cf(e[r],t[r])):zr(e[r])||(t[r]=!0);return t}function EI(e,t,o){let r=Array.isArray(e);if(Oo(e)||r)for(let n in e)Array.isArray(e[n])||Oo(e[n])&&!MI(e[n])?jt(t)||lf(o[n])?o[n]=Array.isArray(e[n])?cf(e[n],[]):{...cf(e[n])}:EI(e[n],zr(t)?{}:t[n],o[n]):o[n]=!es(e[n],t[n]);return o}var of=(e,t)=>EI(e,t,cf(t)),AI=(e,{valueAsNumber:t,valueAsDate:o,setValueAs:r})=>jt(e)?e:t?e===""?NaN:e&&+e:o&&Vi(e)?new Date(e):r?r(e):e;function n0(e){let t=e.ref;if(!(e.refs?e.refs.every(o=>o.disabled):t.disabled))return c0(t)?t.files:p0(t)?wI(e.refs).value:TI(t)?[...t.selectedOptions].map(({value:o})=>o):Rp(t)?vI(e.refs).value:AI(jt(t.value)?e.ref.value:t.value,e)}var Jk=(e,t,o,r)=>{let n={};for(let i of e){let a=pe(t,i);a&&Lt(n,i,a._f)}return{criteriaMode:o,names:[...e],fields:n,shouldUseNativeValidation:r}},zp=e=>jt(e)?e:sf(e)?e.source:Oo(e)?sf(e.value)?e.value.source:e.value:e,dI="AsyncFunction",eL=e=>(!e||!e.validate)&&!!(la(e.validate)&&e.validate.constructor.name===dI||Oo(e.validate)&&Object.values(e.validate).find(t=>t.constructor.name===dI)),tL=e=>e.mount&&(e.required||e.min||e.max||e.maxLength||e.minLength||e.pattern||e.validate);function fI(e,t,o){let r=pe(e,o);if(r||l0(o))return{error:r,name:o};let n=o.split(".");for(;n.length;){let i=n.join("."),a=pe(t,i),s=pe(e,i);if(a&&!Array.isArray(a)&&o!==i)return{name:o};if(s&&s.type)return{name:i,error:s};n.pop()}return{name:o}}var oL=(e,t,o,r,n)=>n.isOnAll?!1:!o&&n.isOnTouch?!(t||e):(o?r.isOnBlur:n.isOnBlur)?!e:(o?r.isOnChange:n.isOnChange)?e:!0,rL=(e,t)=>!Up(pe(e,t)).length&&Lo(e,t),nL={mode:Rn.onSubmit,reValidateMode:Rn.onChange,shouldFocusError:!0};function iL(e={}){let t={...nL,...e},o={submitCount:0,isDirty:!1,isLoading:la(t.defaultValues),isValidating:!1,isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,touchedFields:{},dirtyFields:{},validatingFields:{},errors:t.errors||{},disabled:t.disabled||!1},r={},n=Oo(t.defaultValues)||Oo(t.values)?zo(t.defaultValues||t.values)||{}:{},i=t.shouldUnregister?{}:zo(n),a={action:!1,mount:!1,watch:!1},s={mount:new Set,unMount:new Set,array:new Set,watch:new Set},l,c=0,p={isDirty:!1,dirtyFields:!1,validatingFields:!1,touchedFields:!1,isValidating:!1,isValid:!1,errors:!1},u={values:o0(),array:o0(),state:o0()},m=Vp(t.mode),d=Vp(t.reValidateMode),f=t.criteriaMode===Rn.all,h=B=>R=>{clearTimeout(c),c=setTimeout(B,R)},C=async B=>{if(p.isValid||B){let R=t.resolver?Nr((await E()).errors):await L(r,!0);R!==o.isValid&&u.state.next({isValid:R})}},x=(B,R)=>{(p.isValidating||p.validatingFields)&&((B||Array.from(s.mount)).forEach(q=>{q&&(R?Lt(o.validatingFields,q,R):Lo(o.validatingFields,q))}),u.state.next({validatingFields:o.validatingFields,isValidating:!Nr(o.validatingFields)}))},_=(B,R=[],q,ne,te=!0,z=!0)=>{if(ne&&q){if(a.action=!0,z&&Array.isArray(pe(r,B))){let U=q(pe(r,B),ne.argA,ne.argB);te&&Lt(r,B,U)}if(z&&Array.isArray(pe(o.errors,B))){let U=q(pe(o.errors,B),ne.argA,ne.argB);te&&Lt(o.errors,B,U),rL(o.errors,B)}if(p.touchedFields&&z&&Array.isArray(pe(o.touchedFields,B))){let U=q(pe(o.touchedFields,B),ne.argA,ne.argB);te&&Lt(o.touchedFields,B,U)}p.dirtyFields&&(o.dirtyFields=of(n,i)),u.state.next({name:B,isDirty:H(B,R),dirtyFields:o.dirtyFields,errors:o.errors,isValid:o.isValid})}else Lt(i,B,R)},y=(B,R)=>{Lt(o.errors,B,R),u.state.next({errors:o.errors})},b=B=>{o.errors=B,u.state.next({errors:o.errors,isValid:!1})},S=(B,R,q,ne)=>{let te=pe(r,B);if(te){let z=pe(i,B,jt(q)?pe(n,B):q);jt(z)||ne&&ne.defaultChecked||R?Lt(i,B,R?z:n0(te._f)):N(B,z),a.mount&&C()}},I=(B,R,q,ne,te)=>{let z=!1,U=!1,ee={name:B},D=!!(pe(r,B)&&pe(r,B)._f&&pe(r,B)._f.disabled);if(!q||ne){p.isDirty&&(U=o.isDirty,o.isDirty=ee.isDirty=H(),z=U!==ee.isDirty);let Y=D||es(pe(n,B),R);U=!!(!D&&pe(o.dirtyFields,B)),Y||D?Lo(o.dirtyFields,B):Lt(o.dirtyFields,B,!0),ee.dirtyFields=o.dirtyFields,z=z||p.dirtyFields&&U!==!Y}if(q){let Y=pe(o.touchedFields,B);Y||(Lt(o.touchedFields,B,q),ee.touchedFields=o.touchedFields,z=z||p.touchedFields&&Y!==q)}return z&&te&&u.state.next(ee),z?ee:{}},w=(B,R,q,ne)=>{let te=pe(o.errors,B),z=p.isValid&&Vn(R)&&o.isValid!==R;if(e.delayError&&q?(l=h(()=>y(B,q)),l(e.delayError)):(clearTimeout(c),l=null,q?Lt(o.errors,B,q):Lo(o.errors,B)),(q?!es(te,q):te)||!Nr(ne)||z){let U={...ne,...z&&Vn(R)?{isValid:R}:{},errors:o.errors,name:B};o={...o,...U},u.state.next(U)}},E=async B=>{x(B,!0);let R=await t.resolver(i,t.context,Jk(B||s.mount,r,t.criteriaMode,t.shouldUseNativeValidation));return x(B),R},O=async B=>{let{errors:R}=await E(B);if(B)for(let q of B){let ne=pe(R,q);ne?Lt(o.errors,q,ne):Lo(o.errors,q)}else o.errors=R;return R},L=async(B,R,q={valid:!0})=>{for(let ne in B){let te=B[ne];if(te){let{_f:z,...U}=te;if(z){let ee=s.array.has(z.name),D=te._f&&eL(te._f);D&&p.validatingFields&&x([ne],!0);let Y=await a0(te,i,f,t.shouldUseNativeValidation&&!R,ee);if(D&&p.validatingFields&&x([ne]),Y[z.name]&&(q.valid=!1,R))break;!R&&(pe(Y,z.name)?ee?II(o.errors,Y,z.name):Lt(o.errors,z.name,Y[z.name]):Lo(o.errors,z.name))}!Nr(U)&&await L(U,R,q)}}return q.valid},G=()=>{for(let B of s.unMount){let R=pe(r,B);R&&(R._f.refs?R._f.refs.every(q=>!r0(q)):!r0(R._f.ref))&&de(B)}s.unMount=new Set},H=(B,R)=>(B&&R&&Lt(i,B,R),!es(le(),n)),V=(B,R,q)=>SI(B,s,{...a.mount?i:jt(R)?n:Vi(B)?{[B]:R}:R},q,R),W=B=>Up(pe(a.mount?i:n,B,e.shouldUnregister?pe(n,B,[]):[])),N=(B,R,q={})=>{let ne=pe(r,B),te=R;if(ne){let z=ne._f;z&&(!z.disabled&&Lt(i,B,AI(R,z)),te=af(z.ref)&&zr(R)?"":R,TI(z.ref)?[...z.ref.options].forEach(U=>U.selected=te.includes(U.value)):z.refs?Rp(z.ref)?z.refs.length>1?z.refs.forEach(U=>(!U.defaultChecked||!U.disabled)&&(U.checked=Array.isArray(te)?!!te.find(ee=>ee===U.value):te===U.value)):z.refs[0]&&(z.refs[0].checked=!!te):z.refs.forEach(U=>U.checked=U.value===te):c0(z.ref)?z.ref.value="":(z.ref.value=te,z.ref.type||u.values.next({name:B,values:{...i}})))}(q.shouldDirty||q.shouldTouch)&&I(B,te,q.shouldTouch,q.shouldDirty,!0),q.shouldValidate&&M(B)},Z=(B,R,q)=>{for(let ne in R){let te=R[ne],z=`${B}.${ne}`,U=pe(r,z);(s.array.has(B)||!lf(te)||U&&!U._f)&&!mc(te)?Z(z,te,q):N(z,te,q)}},J=(B,R,q={})=>{let ne=pe(r,B),te=s.array.has(B),z=zo(R);Lt(i,B,z),te?(u.array.next({name:B,values:{...i}}),(p.isDirty||p.dirtyFields)&&q.shouldDirty&&u.state.next({name:B,dirtyFields:of(n,i),isDirty:H(B,z)})):ne&&!ne._f&&!zr(z)?Z(B,z,q):N(B,z,q),i0(B,s)&&u.state.next({...o}),u.values.next({name:a.mount?B:void 0,values:{...i}})},K=async B=>{a.mount=!0;let R=B.target,q=R.name,ne=!0,te=pe(r,q),z=()=>R.type?n0(te._f):gI(B),U=ee=>{ne=Number.isNaN(ee)||es(ee,pe(i,q,ee))};if(te){let ee,D,Y=z(),oe=B.type===nf.BLUR||B.type===nf.FOCUS_OUT,me=!tL(te._f)&&!t.resolver&&!pe(o.errors,q)&&!te._f.deps||oL(oe,pe(o.touchedFields,q),o.isSubmitted,d,m),ie=i0(q,s,oe);Lt(i,q,Y),oe?(te._f.onBlur&&te._f.onBlur(B),l&&l(0)):te._f.onChange&&te._f.onChange(B);let Fe=I(q,Y,oe,!1),_t=!Nr(Fe)||ie;if(!oe&&u.values.next({name:q,type:B.type,values:{...i}}),me)return p.isValid&&(e.mode==="onBlur"?oe&&C():C()),_t&&u.state.next({name:q,...ie?{}:Fe});if(!oe&&ie&&u.state.next({...o}),t.resolver){let{errors:ae}=await E([q]);if(U(Y),ne){let je=fI(o.errors,r,q),it=fI(ae,r,je.name||q);ee=it.error,q=it.name,D=Nr(ae)}}else x([q],!0),ee=(await a0(te,i,f,t.shouldUseNativeValidation))[q],x([q]),U(Y),ne&&(ee?D=!1:p.isValid&&(D=await L(r,!0)));ne&&(te._f.deps&&M(te._f.deps),w(q,D,ee,Fe))}},Q=(B,R)=>{if(pe(o.errors,R)&&B.focus)return B.focus(),1},M=async(B,R={})=>{let q,ne,te=Jr(B);if(t.resolver){let z=await O(jt(B)?B:te);q=Nr(z),ne=B?!te.some(U=>pe(z,U)):q}else B?(ne=(await Promise.all(te.map(async z=>{let U=pe(r,z);return await L(U&&U._f?{[z]:U}:U)}))).every(Boolean),!(!ne&&!o.isValid)&&C()):ne=q=await L(r);return u.state.next({...!Vi(B)||p.isValid&&q!==o.isValid?{}:{name:B},...t.resolver||!B?{isValid:q}:{},errors:o.errors}),R.shouldFocus&&!ne&&dc(r,Q,B?te:s.mount),ne},le=B=>{let R={...a.mount?i:n};return jt(B)?R:Vi(B)?pe(R,B):B.map(q=>pe(R,q))},ge=(B,R)=>({invalid:!!pe((R||o).errors,B),isDirty:!!pe((R||o).dirtyFields,B),error:pe((R||o).errors,B),isValidating:!!pe(o.validatingFields,B),isTouched:!!pe((R||o).touchedFields,B)}),P=B=>{B&&Jr(B).forEach(R=>Lo(o.errors,R)),u.state.next({errors:B?o.errors:{}})},$=(B,R,q)=>{let ne=(pe(r,B,{_f:{}})._f||{}).ref,te=pe(o.errors,B)||{},{ref:z,message:U,type:ee,...D}=te;Lt(o.errors,B,{...D,...R,ref:ne}),u.state.next({name:B,errors:o.errors,isValid:!1}),q&&q.shouldFocus&&ne&&ne.focus&&ne.focus()},j=(B,R)=>la(B)?u.values.subscribe({next:q=>B(V(void 0,R),q)}):V(B,R,!0),de=(B,R={})=>{for(let q of B?Jr(B):s.mount)s.mount.delete(q),s.array.delete(q),R.keepValue||(Lo(r,q),Lo(i,q)),!R.keepError&&Lo(o.errors,q),!R.keepDirty&&Lo(o.dirtyFields,q),!R.keepTouched&&Lo(o.touchedFields,q),!R.keepIsValidating&&Lo(o.validatingFields,q),!t.shouldUnregister&&!R.keepDefaultValue&&Lo(n,q);u.values.next({values:{...i}}),u.state.next({...o,...R.keepDirty?{isDirty:H()}:{}}),!R.keepIsValid&&C()},re=({disabled:B,name:R,field:q,fields:ne,value:te})=>{if(Vn(B)&&a.mount||B){let z=B?void 0:jt(te)?n0(q?q._f:pe(ne,R)._f):te;Lt(i,R,z),I(R,z,!1,!1,!0)}},ce=(B,R={})=>{let q=pe(r,B),ne=Vn(R.disabled)||Vn(e.disabled);return Lt(r,B,{...q||{},_f:{...q&&q._f?q._f:{ref:{name:B}},name:B,mount:!0,...R}}),s.mount.add(B),q?re({field:q,disabled:Vn(R.disabled)?R.disabled:e.disabled,name:B,value:R.value}):S(B,!0,R.value),{...ne?{disabled:R.disabled||e.disabled}:{},...t.progressive?{required:!!R.required,min:zp(R.min),max:zp(R.max),minLength:zp(R.minLength),maxLength:zp(R.maxLength),pattern:zp(R.pattern)}:{},name:B,onChange:K,onBlur:K,ref:te=>{if(te){ce(B,R),q=pe(r,B);let z=jt(te.value)&&te.querySelectorAll&&te.querySelectorAll("input,select,textarea")[0]||te,U=Qk(z),ee=q._f.refs||[];if(U?ee.find(D=>D===z):z===q._f.ref)return;Lt(r,B,{_f:{...q._f,...U?{refs:[...ee.filter(r0),z,...Array.isArray(pe(n,B))?[{}]:[]],ref:{type:z.type,name:B}}:{ref:z}}}),S(B,!1,void 0,z)}else q=pe(r,B,{}),q._f&&(q._f.mount=!1),(t.shouldUnregister||R.shouldUnregister)&&!(xI(s.array,B)&&a.action)&&s.unMount.add(B)}}},ut=()=>t.shouldFocusError&&dc(r,Q,s.mount),Te=B=>{Vn(B)&&(u.state.next({disabled:B}),dc(r,(R,q)=>{let ne=pe(r,q);ne&&(R.disabled=ne._f.disabled||B,Array.isArray(ne._f.refs)&&ne._f.refs.forEach(te=>{te.disabled=ne._f.disabled||B}))},0,!1))},Ie=(B,R)=>async q=>{let ne;q&&(q.preventDefault&&q.preventDefault(),q.persist&&q.persist());let te=zo(i);if(u.state.next({isSubmitting:!0}),t.resolver){let{errors:z,values:U}=await E();o.errors=z,te=U}else await L(r);if(Lo(o.errors,"root"),Nr(o.errors)){u.state.next({errors:{}});try{await B(te,q)}catch(z){ne=z}}else R&&await R({...o.errors},q),ut(),setTimeout(ut);if(u.state.next({isSubmitted:!0,isSubmitting:!1,isSubmitSuccessful:Nr(o.errors)&&!ne,submitCount:o.submitCount+1,errors:o.errors}),ne)throw ne},Pe=(B,R={})=>{pe(r,B)&&(jt(R.defaultValue)?J(B,zo(pe(n,B))):(J(B,R.defaultValue),Lt(n,B,zo(R.defaultValue))),R.keepTouched||Lo(o.touchedFields,B),R.keepDirty||(Lo(o.dirtyFields,B),o.isDirty=R.defaultValue?H(B,zo(pe(n,B))):H()),R.keepError||(Lo(o.errors,B),p.isValid&&C()),u.state.next({...o}))},qe=(B,R={})=>{let q=B?zo(B):n,ne=zo(q),te=Nr(B),z=te?n:ne;if(R.keepDefaultValues||(n=q),!R.keepValues){if(R.keepDirtyValues)for(let U of s.mount)pe(o.dirtyFields,U)?Lt(z,U,pe(i,U)):J(U,pe(z,U));else{if(s0&&jt(B))for(let U of s.mount){let ee=pe(r,U);if(ee&&ee._f){let D=Array.isArray(ee._f.refs)?ee._f.refs[0]:ee._f.ref;if(af(D)){let Y=D.closest("form");if(Y){Y.reset();break}}}}r={}}i=e.shouldUnregister?R.keepDefaultValues?zo(n):{}:zo(z),u.array.next({values:{...z}}),u.values.next({values:{...z}})}s={mount:R.keepDirtyValues?s.mount:new Set,unMount:new Set,array:new Set,watch:new Set,watchAll:!1,focus:""},a.mount=!p.isValid||!!R.keepIsValid||!!R.keepDirtyValues,a.watch=!!e.shouldUnregister,u.state.next({submitCount:R.keepSubmitCount?o.submitCount:0,isDirty:te?!1:R.keepDirty?o.isDirty:!!(R.keepDefaultValues&&!es(B,n)),isSubmitted:R.keepIsSubmitted?o.isSubmitted:!1,dirtyFields:te?{}:R.keepDirtyValues?R.keepDefaultValues&&i?of(n,i):o.dirtyFields:R.keepDefaultValues&&B?of(n,B):R.keepDirty?o.dirtyFields:{},touchedFields:R.keepTouched?o.touchedFields:{},errors:R.keepErrors?o.errors:{},isSubmitSuccessful:R.keepIsSubmitSuccessful?o.isSubmitSuccessful:!1,isSubmitting:!1})},$e=(B,R)=>qe(la(B)?B(i):B,R);return{control:{register:ce,unregister:de,getFieldState:ge,handleSubmit:Ie,setError:$,_executeSchema:E,_getWatch:V,_getDirty:H,_updateValid:C,_removeUnmounted:G,_updateFieldArray:_,_updateDisabledField:re,_getFieldArray:W,_reset:qe,_resetDefaultValues:()=>la(t.defaultValues)&&t.defaultValues().then(B=>{$e(B,t.resetOptions),u.state.next({isLoading:!1})}),_updateFormState:B=>{o={...o,...B}},_disableForm:Te,_subjects:u,_proxyFormState:p,_setErrors:b,get _fields(){return r},get _formValues(){return i},get _state(){return a},set _state(B){a=B},get _defaultValues(){return n},get _names(){return s},set _names(B){s=B},get _formState(){return o},set _formState(B){o=B},get _options(){return t},set _options(B){t={...t,...B}}},trigger:M,register:ce,handleSubmit:Ie,watch:j,setValue:J,getValues:le,reset:$e,resetField:Pe,clearErrors:P,unregister:de,setError:$,setFocus:(B,R={})=>{let q=pe(r,B),ne=q&&q._f;if(ne){let te=ne.refs?ne.refs[0]:ne.ref;te.focus&&(te.focus(),R.shouldSelect&&te.select())}},getFieldState:ge}}function mf(e={}){let t=ke.default.useRef(),o=ke.default.useRef(),[r,n]=ke.default.useState({isDirty:!1,isValidating:!1,isLoading:la(e.defaultValues),isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,submitCount:0,dirtyFields:{},touchedFields:{},validatingFields:{},errors:e.errors||{},disabled:e.disabled||!1,defaultValues:la(e.defaultValues)?void 0:e.defaultValues});t.current||(t.current={...iL(e),formState:r});let i=t.current.control;return i._options=e,uf({subject:i._subjects.state,next:a=>{yI(a,i._proxyFormState,i._updateFormState,!0)&&n({...i._formState})}}),ke.default.useEffect(()=>i._disableForm(e.disabled),[i,e.disabled]),ke.default.useEffect(()=>{if(i._proxyFormState.isDirty){let a=i._getDirty();a!==r.isDirty&&i._subjects.state.next({isDirty:a})}},[i,r.isDirty]),ke.default.useEffect(()=>{e.values&&!es(e.values,o.current)?(i._reset(e.values,i._options.resetOptions),o.current=e.values,n(a=>({...a}))):i._resetDefaultValues()},[e.values,i]),ke.default.useEffect(()=>{e.errors&&i._setErrors(e.errors)},[e.errors,i]),ke.default.useEffect(()=>{i._state.mount||(i._updateValid(),i._state.mount=!0),i._state.watch&&(i._state.watch=!1,i._subjects.state.next({...i._formState})),i._removeUnmounted()}),ke.default.useEffect(()=>{e.shouldUnregister&&i._subjects.values.next({values:i._getWatch()})},[e.shouldUnregister,i]),t.current.formState=CI(r,i),t.current}var PI=!0,FI=(0,He.forwardRef)((e,t)=>{let{title:o,variables:r,modelKey:n,onShow:i,onClose:a,onBeforeRunShortcuts:s,onChange:l,onBeforeClose:c,onInputCustomVariable:p,actions:u,answerInsertMessageId:m,askChatGPTActionParameters:d,showCloseButton:f=!0,isSaveLastRunShortcuts:h,disabled:C,sx:x,notBuiltInVariables:_,includeHistory:y,autoFocusAfterBlur:b=!1,disableCachingSystemVariableValue:S=!1,disabledResetFormOnConfirmModal:I=!1,MaxAIPromptActionConfig:w}=e,{betaSettings:E}=Yo(),{askAIWithShortcutsV2:O,askAIWithShortcuts:L,shortCutsEngine:G,stopGenerate:H}=ze(),V=Mt(),{conversationId:W,conversationType:N,conversation:Z}=ue(),J=ye(W),{localSettings:K}=lt(),{t:Q}=k(),[M,le]=(0,He.useState)(!1),ge=(0,He.useMemo)(()=>N!=="Chat"&&!M,[N,M]),P=Aa(),[$,j]=(0,He.useState)(null),de=(0,He.useRef)(null),[re,ce]=(0,He.useState)([]),{control:ut,getValues:Te,setValue:Ie,register:Pe,trigger:qe,reset:$e,clearErrors:Nt,formState:{errors:Re,isValid:mt}}=mf(),[B,R]=(0,He.useState)({}),q=async ae=>{c&&!c()||(re.forEach(je=>{je.resolve({data:Te(),type:ae?"cancel":"close",success:!1})}),n!=="PromptPreview"&&($e(),R({}),le(!1),a?.("close")))},ne=async()=>{let ae=await qe();return!ae&&!M&&le(!0),ae},te=async ae=>{if(!(J||C)){if(lm(ae)){let je=de.current?.querySelectorAll("textarea[id]")?.[ae+1];if(je){je.focus();return}}if($?.waitForUserAction){if(!await ne())return;re.forEach(je=>{je.resolve({data:Te(),type:"confirm",success:!0})})}else await z(!1)}},z=(0,He.useCallback)(async(ae,je={})=>{let{ignoreChatHubLoading:it=!1}=je,It=Object.values(Te()).filter(ol=>String(ol||"").trim()==="").length>0;if(!await ne()){ae&&It&&Nt();return}if(ae&&It){le(!0);return}let at=De(Te());n!=="PromptPreview"&&!I&&(R({}),$e(),le(!1)),l?.({data:at,type:"change",success:!0},"runPromptStart");let No=[];if($?.template||$?.MaxAIPromptActionConfig||w){let ol=String(at?.TEMPLATE||$?.template||$?.title||""),ph={...$?.variables?.reduce((Le,lo)=>({...Le,[lo.name]:lo}),{})},hr={};if(Object.keys(at).forEach(Le=>{let lo=ph[Le];if(lo?.hidden){if(PI)return;lo.hint="(Dev show) "+lo.hint}lo?(hr[Le]={key:Le,value:at[Le],overwrite:!0,label:lo.hint},(_||$?.notBuiltInVariables)?.includes(Le)&&(hr[Le].isBuiltIn=!1)):hr[Le]={key:Le,value:at[Le],overwrite:!0}}),!hr.SELECTED_TEXT){let Le=$?.variables?.find(lo=>lo.name==="SELECTED_TEXT");Le&&(hr.SELECTED_TEXT={key:"SELECTED_TEXT",value:Le.default_value,isBuiltIn:!0,overwrite:!0,label:"patch selected text not found"})}if(!hr.SELECTED_TEXT&&hr.MAXAI_CONTINUE_WRITING_TEXT_DRAFT&&(hr.MAXAI_CONTINUE_WRITING_TEXT_DRAFT.isBuiltIn=!0,hr.SELECTED_TEXT={...hr.MAXAI_CONTINUE_WRITING_TEXT_DRAFT,key:"SELECTED_TEXT"}),K.chatMode!=="pro_chat"){let Le=hr.AI_RESPONSE_TONE;Le&&(Le.value="Default");let lo=hr.AI_RESPONSE_WRITING_STYLE;lo&&(lo.value="Default")}No.push({type:"SET_VARIABLE_MAP",parameters:{VariableMap:hr}});let Mu=De(u||$?.actions||[]);No.push(...Mu),No.push({type:"RENDER_TEMPLATE",parameters:{template:ol}});let jc=m||$?.answerInsertMessageId||"",Eu=d||$?.askChatGPTActionParameters||{},Au=y??$?.includeHistory??void 0,Pu={type:"ASK_CHATGPT",parameters:{template:"{{LAST_ACTION_OUTPUT}}",AskChatGPTActionType:jc?"ASK_CHAT_GPT_HIDDEN":"ASK_CHAT_GPT_WITH_PREFIX",AskChatGPTActionQuestion:{text:"{{LAST_ACTION_OUTPUT}}",meta:qo([{includeHistory:!0,...jc?{outputMessageId:jc}:{}},$?.questionMeta||{}])},MaxAIPromptActionConfig:De($?.MaxAIPromptActionConfig||w),...Eu}};Au!==void 0&&(Pu.parameters.AskChatGPTActionQuestion.meta.includeHistory=Au),No.push(Pu);let ku=await s?.();await(E?.appearance_v2_enabled?O:L)(No,{isSaveLastRunShortcuts:h,conversationId:ku?ku.id:void 0,isNeedAttachments:!1}).then(()=>{let Le=G?.getNextAction()?.error||""}).catch(Le=>{}).finally(()=>{n!=="PromptPreview"&&!I&&($e(),R({}),le(!1),a?.("runPrompt")),l?.({data:Te(),type:"change",success:!0},"runPromptEnd")})}},[K.chatMode,O,E?.appearance_v2_enabled,L,Nt,Te,h,l,a,$e,G,ne,$,u,m,d,n,_,y,I,Z]),U=(0,He.useMemo)(()=>{let ae={},je=r||$?.variables||[],it=o||$?.title||"";if($?.MaxAIPromptActionConfig?.prompt_id){let Le=$.MaxAIPromptActionConfig.prompt_id,lo=`package__features:context_menu__prompt__${Le}`;hh().t(lo).includes(Le)||(it=hh().t(lo))}let It=[],at=[],No=Te();n==="PromptPreview"&&$e(),je.forEach(Le=>{let lo=n==="PromptPreview"&&No[Le.name]!==void 0?No[Le.name]:Le.default_value?.trim();if(Le.hidden){if(PI)return;Le.hint?.startsWith("(Dev show) ")||(Le.hint="(Dev show) "+Le.hint)}Le.type==="select"&&It.push(Le),Le.type==="text"&&(at.push(Le),Object.prototype.hasOwnProperty.call(No,Le.name)&&Ie(Le.name,lo));let rl=Le.optional?[]:[{required:!0,message:""}];ae[Le.name]=Pe(Le.name,{value:lo,validate:X7=>{for(let $x of rl)if($x.required&&!X7)return $x.message||`${Le.hint} is required`;return!0}})});let ol=It.length,ph=typeof window>"u"?580:window.innerHeight*.6,hr=It.length+at.length>0?36:30,Mu=Math.ceil(ol/3),jc=Mu*48+(Mu-1)*16,Eu=at.length,Au=(Eu-1)*16,Pu=16*3,ku=ph-hr-jc-Au-Pu,Kx=Math.max(Math.floor(ku/24/Eu)-3,2);return pc.getSetVariablesModalSelectCache().then(Le=>{let lo=Object.keys(ae);lo.length!==0&&(lo.forEach(rl=>{Le[rl]!==void 0&&Ie(rl,Le[rl])}),R(ae))}),{titleHeight:hr,currentTitle:it,currentSelectTotalCount:ol,selectTypeVariables:It,textTypeVariables:at,maxTextareaMaxRows:Kx,minTextareaMaxRows:2}},[r,o,n,$]);(0,He.useEffect)(()=>{let ae=Ss.receive(`SetVariablesModal_${W}`,je=>new Promise((it,It)=>{je.task==="open"&&(R({}),$e(),j(je.config),le(!1),setTimeout(()=>{je.config.waitForUserAction?ce([{resolve:it,reject:It}]):it({data:De(B),type:"confirm",success:!0})},200))}));return()=>{ae()}},[W]);let ee=(0,He.useRef)(z);ee.current=z,(0,He.useEffect)(()=>{if(!G)return;let ae=(je,{currentAction:it})=>{je==="afterRunAction"&&it&&it.type==="SET_VARIABLES_MODAL"&&ee.current(!0,{ignoreChatHubLoading:!0}).then().catch(It=>{})};return G.addListener(ae),()=>{G.removeListener(ae)}},[G]);let D=()=>{let ae=Array.from(de.current?.querySelectorAll("textarea")||[]);if(ae.length===0)return;let je=ae.find(it=>!it.hasAttribute("aria-hidden")&&it.value==="")||ae[0];return je&&(je.focus(),je.setSelectionRange(0,0)),je};(0,He.useEffect)(()=>{if(M){if(ge)a?.("reset");else if(setTimeout(()=>{D()},500),i?.(),b){let ae=()=>{D()};return setTimeout(()=>{de.current?.removeEventListener("focusout",ae)},500),de.current?.addEventListener("focusout",ae),()=>{de.current?.removeEventListener("focusout",ae)}}}},[M,ge]);let Y=(0,He.useRef)(null),oe=ae=>{Y.current=ae},me=()=>{Y.current?Y.current.focus():D()};(0,He.useImperativeHandle)(t,()=>({discard:()=>q(!0),focusLastFocusInput:me}));let ie=ye(W),Fe=(0,He.useRef)(!1);return!e.show&&(!M||ge||Object.keys(B).length===0)||ie?null:He.default.createElement(g,{className:"max-ai__action__set_variables_modal",sx:{width:"100%",overflow:"hidden",pb:1,gap:1,boxSizing:"border-box",...x},maxHeight:"60vh",onKeyPressCapture:ae=>{ae.stopPropagation()},onKeyPress:ae=>{ae.stopPropagation()}},He.default.createElement(g,{flexShrink:0,height:U.titleHeight,direction:"row",alignItems:"start",justifyContent:"space-between",width:"100%"},He.default.createElement(F,{width:0,flex:1,component:"div",display:"flex",alignItems:"center"},He.default.createElement(T,{fontSize:"14px",color:"#fff",fontWeight:600,height:30,lineHeight:"30px",sx:{textAlign:"left",borderRadius:"8px",p:"0 8px",bgcolor:"rgba(0, 0, 0, 0.87)",width:n!=="PromptPreview"?"100%":"auto"},noWrap:!0},U.currentTitle)),f&&He.default.createElement(Xe,{"data-testid":"close-modal-button",onClick:async()=>await q(!0),sx:{flexShrink:0,position:"relative",top:"-8px",right:"-8px"}},He.default.createElement(kI.default,{sx:{fontSize:"24px"}}))),He.default.createElement(g,{flexShrink:0,flexWrap:"wrap",direction:"row",display:U.selectTypeVariables.length?void 0:"none",sx:{gap:"16px"}},U.selectTypeVariables.map((ae,je)=>{if(ae.type==="select"){let it=V?.querySelector('div[data-testid="maxai--chat-box--tools--left-container--portal-root"]');return it?BI.default.createPortal(He.default.createElement(fc,{key:ae.name,control:ut,name:ae.name,defaultValue:ae.default_value,render:({field:It})=>He.default.createElement(tf,{systemVariableSelectKey:ae.name,key:ae.name,defaultValue:It.value,onChange:at=>{S||pc.setVariablesModalSelectCache(ae.name,at),It.onChange(at)}})}),it):void 0}return null})),He.default.createElement(g,{component:"div",direction:"row",flexWrap:"wrap",gap:2,paddingTop:1,ref:de,flex:1,height:0,display:U.textTypeVariables.length?void 0:"none",sx:{overflowY:"auto"}},U.textTypeVariables.map((ae,je)=>{let it=(P==="lg"||P==="xl")&&U.textTypeVariables.length>1?"calc(50% - 8px)":"100%",It=U.minTextareaMaxRows*23+17;return He.default.createElement(Ut,{"data-testid":`custom-variable--${ae.name}`,sx:{width:it},size:"small",key:ae.name,label:ae.label||ae.hint||"Label",...B[ae.name],onKeyUp:at=>{p?.({data:Te(),type:"input",success:!0,variables:U.textTypeVariables}),at.stopPropagation()},onKeyDown:async at=>{at.key==="Enter"&&!at.shiftKey&&!Fe.current?(at.stopPropagation(),at.preventDefault(),await te(je)):at.stopPropagation()},onCompositionStart:()=>{Fe.current=!0},onCompositionEnd:()=>{Fe.current=!1},onPaste:at=>{at.stopPropagation()},InputProps:{sx:{fontSize:"16px",minHeight:It}},inputProps:{style:{fontSize:"16px",textAlign:"left"}},FormHelperTextProps:{sx:{ml:0,fontSize:"12px"}},error:!!Re[ae.name],helperText:Re[ae.name]?.message||"",InputLabelProps:{shrink:!0,sx:{fontSize:"16px"}},multiline:!0,placeholder:ae.hint,minRows:U.minTextareaMaxRows,maxRows:U.maxTextareaMaxRows,onFocus:at=>oe(at.target)})})),He.default.createElement(g,{direction:"row",alignItems:"center",justifyContent:"end",gap:1,flexShrink:0},He.default.createElement(ve,{title:Q(J?"package__features:chat__inputbox__button__stop_generating__tooltip":"package__features:chat__inputbox__button__send_to_ai__tooltip"),description:J?void 0:"\u23CE",placement:"bottom",disabled:C||!mt},He.default.createElement(Ce,{"data-testid":"sidebar-variables-modal--send-btn",disabled:J?C:C||!mt,onClick:()=>{J?H():te()},variant:"contained",sx:{width:"32px",height:"32px",minWidth:"unset",borderRadius:"8px"}},J?He.default.createElement(OI.default,{sx:{fontSize:"16px",color:"white !important"}}):He.default.createElement(LI.default,{sx:{fontSize:"16px"}})))))});FI.displayName="ActionSetVariablesModal";var df=He.default.memo(FI);var e3=v(On());var we=v(A());var Cf=v(A());var ZI=v(A());var Un=v(A()),aL=e=>{let{anchorElementSelectors:t='[data-testid="max-ai__ai-provider-floating-button"]',placement:o="top",...r}=e,{t:n}=k(),[i,a]=Un.default.useState(!0),{localSettings:s}=lt(),[l,c]=Un.default.useState(!1),p=(0,Un.useCallback)(async()=>{await Ze.getOnboardingDataByKey("ON_BOARDING__RECORD_FIRST_CLICK_PRO_CHAT_SWITCH")&&s.chatMode==="pro_chat"&&c(!0)},[s.chatMode]);return(0,Un.useEffect)(()=>{Ze.getOnboardingDataByKey(Bp).then(u=>a(!!u))},[]),(0,Un.useEffect)(()=>{i||p()},[i,p]),i?null:Un.default.createElement(Et,{placement:o,trigger:l,anchorElementSelectors:t,onShow:()=>{Ze.setOnboardingData(Bp,!0)},CtaButtonProps:{"data-button-clicked-name":"Onboarding > Choose a smarter AI > Got it"},...r},Un.default.createElement(g,{spacing:.5},Un.default.createElement(T,{fontSize:20,lineHeight:1.4,color:"text.primary",fontWeight:700,textAlign:"left"},n("package__features:onboarding__onboarding_popover__ai_model_selector__title")),Un.default.createElement(T,{fontSize:14,lineHeight:1.4,color:"text.primary",fontWeight:400,textAlign:"left"},n("package__features:onboarding__onboarding_popover__ai_model_selector__description"))))},DI=aL;var ff=class{constructor(t=!1){this.defaultCaptureEvent=t;this.executionIndex=new Map;this.eventMap=new Map}add(t,o,r,n=0,i=this.defaultCaptureEvent){this.eventMap.has(t)||this.eventMap.set(t,new Map);let a=this.eventMap.get(t);if(!a.has(o)){a.set(o,[]);let l=c=>{let p=!0,u=a.get(o).sort((m,d)=>d.priority-m.priority);for(let m of u){let d=new Proxy(c,{get(f,h){if(h==="stopSpread")return()=>{p=!1};let C=f[h];return typeof C=="function"?C.bind(f):C}});if(m.handler(d),!p)break}};t.addEventListener(o,l,i),a.set(`${o}_proxy`,[{handler:l,priority:0}])}a.get(o).push({handler:r,priority:n})}remove(t,o,r,n=this.defaultCaptureEvent){let i=this.eventMap.get(t);if(!i)return;let a=i.get(o);if(!a)return;let s=a.findIndex(l=>l.handler===r);if(s>-1&&a.splice(s,1),a.length===0){let l=i.get(`${o}_proxy`);l&&l[0]&&t.removeEventListener(o,l[0].handler,n),i.delete(o),i.delete(`${o}_proxy`)}i.size===0&&this.eventMap.delete(t)}removeAll(t){let o=this.eventMap.get(t);if(o){for(let r of o.keys()){if(r.endsWith("_proxy"))continue;let n=o.get(`${r}_proxy`);n&&n[0]&&t.removeEventListener(r,n[0].handler)}this.eventMap.delete(t)}}executeOnPriority(t,o,r){let n=this.eventMap.get(t);if(!n)return!0;let i=n.get(o);if(!i||i.length===0)return!0;if(o==="keydown"&&r?.event instanceof KeyboardEvent){let m=r.event;if(r.keys&&!r.keys.includes(m.key))return!0}let a=`${t.toString()}_${String(o)}`,s=this.executionIndex.get(a)??0,l=[...i].sort((m,d)=>d.priority-m.priority);if(s>=l.length)return this.executionIndex.delete(a),!0;let c=l[s],p=r?.event||new Event(o),u=new Proxy(p,{get:(m,d)=>{if(d==="stopSpread")return()=>{this.executionIndex.delete(a)};let f=m[d];return typeof f=="function"?f.bind(m):f}});return c.handler(u),this.executionIndex.set(a,s+1),!1}};var hf=class{static{this.managers=new Map}static getManager(t,o=!1){return this.managers.has(t)||this.managers.set(t,new ff(o)),this.managers.get(t)}static removeManager(t){this.managers.has(t)&&this.managers.delete(t)}static clear(){this.managers.clear()}};var ca=v(A()),HI=(0,ca.createContext)(null);function NI({children:e,managerId:t="default",defaultCaptureEvent:o=!1}){let r=(0,ca.useRef)(hf.getManager(t,o)),n=(0,ca.useRef)((a,s)=>{a.stopPropagation(),a.preventDefault(),s&&a.stopSpread()}),i={domEventManager:r.current,stopPropagation:n.current};return ca.default.createElement(HI.Provider,{value:i},e)}function gf(){let e=(0,ca.useContext)(HI);if(!e)throw new Error("useDomEventManager must be used within DomEventManagerProvider");return e}var hn=v(A());function hc({open:e,onOpenChange:t,onOpen:o,onClose:r,delay:n=100}={}){let[i,a]=(0,hn.useState)(!1),s=e??i,l=typeof n=="object"?n.open??100:n,c=typeof n=="object"?n.close??-1:n,p=(0,hn.useRef)(),u=(0,hn.useCallback)(()=>{p.current&&(clearTimeout(p.current),p.current=void 0)},[]),m=(0,hn.useCallback)(x=>{if(e!==void 0){t?.(x);return}a(x),x?o?.():r?.()},[e,t,o,r]),d=(0,hn.useCallback)(()=>{if(u(),l<0){m(!0);return}p.current=setTimeout(()=>{m(!0)},l)},[u,m,l]),f=(0,hn.useCallback)(()=>{if(u(),c<0){m(!1);return}p.current=setTimeout(()=>{m(!1)},c)},[u,m,c]),h=(0,hn.useRef)(s);h.current=s;let C=(0,hn.useCallback)((x=h.current)=>{x?f():d()},[f,d]);return(0,hn.useEffect)(()=>()=>{u()},[u]),{open:s,setUncontrolledOpen:a,setOpen:m,handleOpen:d,handleClose:f,handleToggle:C,clearTimer:u}}var Bo=v(A()),zI="maxai-popper-dropdown-menu",sL=({referenceElement:e,children:t,contentSx:o,contentProps:r,hoverOpen:n=!1,delay:i=0,open:a,onOpenChange:s,width:l=200,onMouseEnter:c,onMouseLeave:p,onOpen:u,onClose:m,sx:d,customTransitionProps:f,referenceElementBoxProps:h,isMirror:C=!1,headless:x=!1,isCloseOnBlur:_=!0,...y})=>{let{open:b,handleOpen:S,handleClose:I,setUncontrolledOpen:w}=hc({open:a,onOpenChange:s,onOpen:u,onClose:m,delay:i}),E=(0,Bo.useRef)(null),O=(0,Bo.useRef)(null),L=(0,Bo.useCallback)(()=>{n||w(W=>!W)},[n,w]);(0,Bo.useEffect)(()=>{let W=N=>{if(!O.current||!E.current)return;if(N instanceof FocusEvent){I();return}let{clientX:Z,clientY:J}=N,K=O.current.getBoundingClientRect(),Q=E.current.getBoundingClientRect(),M=le=>Z>=le.left&&Z<=le.right&&J>=le.top&&J<=le.bottom;M(Q)||M(K)||(I(),N.stopPropagation())};return document.addEventListener("mousedown",W),_&&window.addEventListener("blur",W),()=>{document.removeEventListener("mousedown",W),_&&window.removeEventListener("blur",W)}},[I,_]);let G=(0,Bo.useCallback)(W=>{n&&S(),c?.(W)},[n,S,c]),H=(0,Bo.useCallback)(W=>{n&&I(),p?.(W)},[n,I,p]),V=(0,Bo.useMemo)(()=>({onMouseEnter:G,onMouseLeave:H}),[G,H]);return Bo.default.createElement(Bo.default.Fragment,null,Bo.default.createElement(F,{ref:E,onClick:L,...V,...h},e),Bo.default.createElement(h2,{...y,...V,sx:{zIndex:1,...s_({isMirror:C,popperSelector:"data-popper-placement",menuClassName:zI}),...d},open:b,anchorEl:E.current,transition:!0},({TransitionProps:W})=>Bo.default.createElement(f2,{className:zI,...W,...f},Bo.default.createElement(F,{...r,component:"div",ref:O,sx:x?{width:l,...o}:{borderRadius:1,border:"1px solid",borderColor:"border.main",boxShadow:"0px 4px 8px 0px rgba(0, 0, 0, 0.16)",boxSizing:"border-box",overflow:"hidden",width:l,bgcolor:N=>N.palette.mode==="dark"?"rgba(61, 61, 61, 1)":"#fff",...o},onMouseDownCapture:N=>N.stopPropagation()},t))))},ts=(0,Bo.memo)(sL);var bt=v(A());var bo=v(A());var m0=class e extends Z2{constructor(){super()}static getInstance(){return this.instance||(this.instance=new e),this.instance}},gc=()=>m0.getInstance();var os=v(A());var Fs=v(A()),lL=({model:e,selectedModel:t,onSelect:o,listItemIndex:r,focusKey:n,onFocusKey:i,zIndex:a,eventPriority:s,parentOpen:l,MainComponent:c})=>{let{t:p}=k(),{label:u,children:m}=e,d=wa(u||"",p);return Fs.default.createElement(Fs.default.Fragment,null,d&&Fs.default.createElement(Ct,{sx:{fontSize:"12px",lineHeight:"18px",fontWeight:500,p:"2px 8px",color:f=>f.palette.mode==="dark"?"rgba(255, 255, 255, 0.38)":"rgba(0, 0, 0, 0.38)",opacity:"1!important",mt:r===0?void 0:"4px",minHeight:"unset"},disabled:!0},d+" AI"),m?.map(f=>Fs.default.createElement(c,{key:f.key,model:f,selectedModel:t,onSelect:o,focusKey:n,onFocusKey:i,zIndex:a,eventPriority:s,parentOpen:l})))},VI=(0,Fs.memo)(lL);var RI=v(A()),cL=({sx:e,children:t,...o})=>RI.default.createElement(T,{sx:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",color:"text.primary",...e},...o},t),xc=cL;var sr=v(A());var xf=v(A()),pL=e=>{let{tag:t,...o}=e,{t:r}=k(),n=wa(t,r);return n==="New"?xf.default.createElement(T,{component:"span",bgcolor:"rgba(52, 168, 83, 1)",color:"#fff",fontSize:"9px",fontWeight:500,px:"4px",py:"1px",borderRadius:"4px",lineHeight:1.5,whiteSpace:"nowrap",...o},n):n==="Beta"?xf.default.createElement(T,{component:"span",color:i=>i.palette.mode==="dark"?"rgba(255, 255, 255, 0.6)":"rgba(0, 0, 0, 0.6)",border:"1px solid",borderColor:i=>i.palette.mode==="dark"?"rgba(255, 255, 255, 0.16)":"rgba(0, 0, 0, 0.08)",fontSize:"9px",fontWeight:500,px:"4px",py:"1px",borderRadius:"4px",lineHeight:1.5,whiteSpace:"nowrap",...o},n):xf.default.createElement(T,{component:"span",bgcolor:i=>i.palette.mode==="dark"?"rgba(255, 255, 255, 0.12)":"rgba(0, 0, 0, 0.06)",color:i=>i.palette.mode==="dark"?"rgba(255, 255, 255, 0.6)":"rgba(0, 0, 0, 0.6)",fontSize:"9px",fontWeight:500,px:"4px",py:"1px",borderRadius:"4px",lineHeight:1.5,whiteSpace:"nowrap",...o},n)},UI=pL;var uL=({model:e,selectedModel:t,onSelect:o,isKeyOrChildrenFocused:r,onFocusKey:n,zIndex:i,parentOpen:a})=>{let{t:s}=k(),{key:l,label:c,value:p}=e,u=wa(c||"",s),m=p,{open:d,handleOpen:f,handleClose:h}=hc({delay:{open:100}});(0,sr.useEffect)(()=>{a===!1&&h()},[a,h]),(0,sr.useEffect)(()=>{r===!1&&h()},[r,h]);let C=(0,sr.useCallback)(()=>{f(),n?.(l)},[l,n,f]),x=(0,sr.useRef)(null);return Ku(x,_=>{_||requestAnimationFrame(()=>{h()})}),m?sr.default.createElement(ve,{open:d,placement:"right",sx:{maxWidth:"200px"},disableInteractive:!0,TransitionProps:{timeout:{enter:300,exit:0}},PopperProps:{modifiers:[{name:"flip",enabled:!0,options:{fallbackPlacements:["right","left"]}}]},zIndex:i,title:xy(m,s)},sr.default.createElement(Ct,{component:"div",key:l,ref:x,"data-testid":`maxai--ai-model-selector--menu-item--${m.value}`,"data-menu-item-key":l,disabled:m.disabled,selected:m.value===t,onClick:()=>{o(m),h()},onMouseEnter:C,onMouseLeave:h,sx:{...Nu,...r&&{backgroundColor:_=>_.palette.mode==="dark"?"rgba(255, 255, 255, 0.1)":"rgba(0, 0, 0, 0.04)"}}},sr.default.createElement(g,{alignItems:"center",direction:"row",spacing:1,sx:zu},sr.default.createElement(Or,{model:m.value}),sr.default.createElement(xc,{fontSize:"14px",lineHeight:"21px"},u),sr.default.createElement(g,{direction:"row",alignItems:"center",sx:{ml:"auto !important"}},m.tag&&sr.default.createElement(UI,{tag:m.tag}))))):null},WI=(0,sr.memo)(uL);var jI=v(Zy());var Tt=v(A());var mL=({model:e,selectedModel:t,onSelect:o,onFocusKey:r,zIndex:n,eventPriority:i,parentOpen:a,isKeyOrChildrenFocused:s,MainComponent:l})=>{let{t:c}=k(),{key:p,label:u,children:m}=e,d=wa(u||"",c),{open:f,handleOpen:h,handleClose:C}=hc({delay:{open:100}}),[x,_]=(0,Tt.useState)(!1),y=(0,Tt.useRef)(0),[b,S]=(0,Tt.useState)(""),I=(0,Tt.useCallback)(()=>{C(),y.current=0,S(""),_(!1)},[C]),w=(0,Tt.useCallback)((Q=!0)=>{h(),Q&&_(!0)},[h]);(0,Tt.useEffect)(()=>{(!s||a===!1)&&I()},[I,a,s]);let E=(0,Tt.useCallback)(Q=>{o(Q),I()},[o,I]),O=(0,Tt.useRef)(null),L=(0,Tt.useCallback)(()=>{O.current=setTimeout(()=>{I()},300)},[I]),G=(0,Tt.useCallback)(()=>{r?.(p),O.current&&clearTimeout(O.current),w(!1)},[p,r,w]),H=(0,Tt.useCallback)(Q=>{_(!0),S(Q),m&&(y.current=m?.findIndex(M=>M?.key===Q))},[m]),{domEventManager:V,stopPropagation:W}=gf(),[N,Z]=(0,Tt.useState)(!1),J=gc();(0,Tt.useEffect)(()=>{let Q=le=>{if(!m?.length)return;let ge=()=>W(le,!0);switch(["ArrowDown","ArrowUp"].includes(le.key)&&m?.length>1&&(Z(!0),requestAnimationFrame(()=>{J.emit("scrollToItem",m[y.current].key)})),le.key){case"ArrowRight":if(!s)return;ge(),m?.[0]&&S(m[0].key),w();break;case"ArrowUp":if(!f||!x||!s)return;ge(),y.current=(y.current-1+m.length)%m.length,S(m[y.current].key);break;case"ArrowDown":if(!f||!x||!s)return;ge(),y.current=(y.current+1)%m.length,S(m[y.current].key);break;case"Enter":{if(!f||!x||!s)return;ge();let P=m[y.current];P?.value&&E(P.value);break}case"Tab":ge();break}},M=()=>{Z(!1)};return V.add(document,"keydown",Q,i),V.add(document,"mousemove",M),()=>{V.remove(document,"keydown",Q),V.remove(document,"mousemove",M)}},[J,m,V,i,w,E,x,s,p,f,W]),(0,Tt.useEffect)(()=>{let Q=M=>{if(!m?.length)return;let le=()=>W(M,!0);switch(M.key){case"Escape":case"ArrowLeft":if(!f)return;le(),I();break}};return s&&V.add(document,"keydown",Q,i,!0),()=>{V.remove(document,"keydown",Q,!0)}},[m?.length,V,i,I,f,W,s]);let K=(0,Tt.useRef)(null);return Ku(K,Q=>{Q||requestAnimationFrame(()=>{I()})}),Tt.default.createElement(ts,{open:f,placement:"right-start",sx:{zIndex:n},contentSx:{display:s?"block":"none"},onMouseEnter:G,onMouseLeave:L,modifiers:[{name:"flip",options:{fallbackPlacements:["left-start"]}}],customTransitionProps:{timeout:{enter:300,exit:0}},referenceElementBoxProps:{component:"li","data-menu-item-key":p,"data-testid":`maxai--ai-model-selector--menu-more-item--${p}`,sx:{display:"flex",alignItems:"center",cursor:"pointer",...Nu,...s&&{backgroundColor:Q=>Q.palette.mode==="dark"?"rgba(255, 255, 255, 0.1)":"rgba(0, 0, 0, 0.04)"}}},referenceElement:Tt.default.createElement(g,{ref:K,alignItems:"center",direction:"row",spacing:1,sx:zu},Tt.default.createElement(X,{icon:"More",size:20,sx:{color:Q=>Q.palette.mode==="dark"?"#ffffff85":"rgba(55, 53, 47, 0.45)"}}),Tt.default.createElement(xc,{fontSize:"14px",lineHeight:"21px"},d),Tt.default.createElement(jI.default,{sx:{ml:"auto !important",color:Q=>Q.palette.mode==="dark"?"#ffffff85":"rgba(55, 53, 47, 0.45)",fontSize:16}}))},Tt.default.createElement(Mi,{sx:{scrollPaddingBlock:"6px",cursor:N?"none":"default","& *":{cursor:N?"none !important":"",pointerEvents:N?"none":"auto"}}},m?.map(Q=>Tt.default.createElement(l,{key:Q.key,model:Q,selectedModel:t,onSelect:E,focusKey:b,onFocusKey:H,zIndex:n&&n+1,eventPriority:i&&i+1,parentOpen:f}))))},qI=(0,Tt.memo)(mL);var d0=({model:e,selectedModel:t,onSelect:o,listItemIndex:r,focusKey:n,onFocusKey:i,zIndex:a,eventPriority:s,parentOpen:l})=>{let{type:c="item"}=e,p=(0,os.useMemo)(()=>{let u=m=>m.key===n?!0:m.children?m.children.some(d=>u(d)):!1;return u(e)},[e,n]);switch(c){case"item":return os.default.createElement(WI,{model:e,selectedModel:t,onSelect:o,onFocusKey:i,zIndex:a,parentOpen:l,isKeyOrChildrenFocused:p});case"group":return os.default.createElement(VI,{model:e,selectedModel:t,onSelect:o,listItemIndex:r,focusKey:n,onFocusKey:i,zIndex:a,eventPriority:s,parentOpen:l,MainComponent:d0});case"more":return os.default.createElement(qI,{model:e,selectedModel:t,onSelect:o,onFocusKey:i,zIndex:a,eventPriority:s,parentOpen:l,MainComponent:d0,isKeyOrChildrenFocused:p});default:return null}},KI=(0,os.memo)(d0);var dL=e=>{let{conversationType:t,AIModel:o,onSelect:r,onClose:n,buttonRef:i,sx:a,parentOpen:s}=e,l=(0,bo.useMemo)(()=>rC(t),[t]),c=i?.current?.getBoundingClientRect()??{y:0,height:0},p=c.y-10,u=window.innerHeight-c.y-c.height-10,m=Math.max(p,u),d=Math.min(m,370),f=(0,bo.useCallback)(async L=>{r?.(t,L.AIProvider,L.value)},[t,r]),h=(0,bo.useMemo)(()=>l.flatMap(L=>L.children),[l]),C=(0,bo.useRef)(-1),[x,_]=(0,bo.useState)(""),y=(0,bo.useCallback)(L=>{_(L),C.current=h.findIndex(G=>G?.key===L)},[h]),{domEventManager:b,stopPropagation:S}=gf(),[I,w]=(0,bo.useState)(!1),E=gc();(0,bo.useEffect)(()=>{let L=H=>{if(!h?.length)return;let V=()=>S(H);switch(["ArrowDown","ArrowUp"].includes(H.key)&&(w(!0),requestAnimationFrame(()=>{E.emit("scrollToItem",h[C.current]?.key??"")})),H.key){case"ArrowDown":V(),C.current=(C.current+1)%h.length,_(h[C.current]?.key??"");break;case"ArrowUp":V(),C.current=C.current<0?h.length-1:(C.current-1+h.length)%h.length,_(h[C.current]?.key??"");break;case"Escape":V(),n?.();break;case"Enter":{V();let W=h?.[C.current];W?.value&&f(W.value);break}case"Tab":V();break}},G=()=>{w(!1)};return b.add(document,"keydown",L,1),b.add(document,"mousemove",G),()=>{b.remove(document,"keydown",L),b.remove(document,"mousemove",G)}},[h,f,S,n,b,E]),(0,bo.useEffect)(()=>{let L=G=>{if(!h?.length)return;let H=()=>S(G);switch(G.key){case"Escape":H(),n?.();break}};return b.add(document,"keydown",L,1),()=>{b.remove(document,"keydown",L)}},[b,h?.length,x,n,S]);let O=(0,bo.useRef)(null);return(0,bo.useEffect)(()=>{let L=G=>{let H=C.current===0,V=C.current===h.length-1,W=O.current?.querySelector(`[data-menu-item-key="${G}"]`);W&&(W.scrollIntoView({block:"nearest"}),H?O.current?.scrollTo({top:0,behavior:"smooth"}):V&&O.current?.scrollTo({top:O.current.scrollHeight,behavior:"smooth"}))};return E.on("scrollToItem",L),()=>{E.off("scrollToItem",L)}},[h,E]),bo.default.createElement(Mi,{component:"div",ref:O,id:"maxai-ai-model-selector-menu","data-testid":"maxai--ai-model-selector-card","aria-labelledby":"maxai-ai-model-selector-menu",disableListWrap:!0,sx:{scrollPaddingBlock:"6px",cursor:I?"none":"default","& *":{cursor:I?"none !important":"",pointerEvents:I?"none":"auto"},overflowY:"auto",overflowX:"hidden",flexShrink:0,maxHeight:d,py:"6px",boxSizing:"border-box",bgcolor:L=>L.palette.mode==="dark"?"rgba(61, 61, 61, 1)":"#fff",...a}},l.map((L,G)=>bo.default.createElement(KI,{key:L.key,listItemIndex:G,model:L,selectedModel:o,onSelect:f,focusKey:x,onFocusKey:y,zIndex:2147483622,eventPriority:2,parentOpen:s})))},$I=(0,bo.memo)(dL);var fL=[...Il.FREE,...Il.FAST,...Il.SMART,...Il.REASONING,...Il.LEGACY],hL=e=>{let{mode:t,conversationType:o="Chat",AIProvider:r=bh[o].AIProvider,AIModel:n=bh[o].AIModel,onChange:i,sx:a,disabled:s,labelProps:l,tooltipProps:c,popperProps:p,domEventManagerId:u,defaultCaptureEvent:m=!0,...d}=e,{t:f}=k(),[h,C]=(0,bt.useState)(!1),{setIsWaitingSelectFile:x}=Al(),_=(0,bt.useMemo)(()=>{let K=fL.find(le=>le.value===n);if(K&&K.AIProvider===r)return{label:K.title,value:K.value,AIProvider:K.AIProvider};let Q=W2[r],M=Q.find(le=>le.value===n)||Q?.[0];return M?{label:M?.title||"",value:M?.value||"",AIProvider:r}:{label:_h.title,value:_h.value,AIProvider:"USE_CHAT_GPT_PLUS"}},[r,n]),[y,b]=(0,bt.useState)(!1),S=(0,bt.useCallback)(()=>{b(!1)},[b]),I=(0,bt.useCallback)(()=>{b(!y)},[y,b]),w=(0,bt.useRef)(null),E=(0,bt.useCallback)(async(K,Q,M)=>{S(),C(!1),await Ze.setOnboardingData("ON_BOARDING__RECORD_FIRST_SELECTOR_AI_MODEL",!0),i?.(K,Q,M)},[i,S]),O=[{name:"RTLSupport",enabled:typeof document<"u"&&document.querySelector("body")?.getAttribute("dir")==="rtl",phase:"main",fn({state:K}){if(K.modifiersData.popperOffsets){let M=K.rects.reference.x+K.rects.reference.width-K.rects.popper.width;M>0&&(K.modifiersData.popperOffsets.x=M)}}},{name:"offset",options:{offset:[0,5]}},{name:"flip",options:{fallbackPlacements:["top-start"]}}],L=(0,bt.useRef)(y);(0,bt.useEffect)(()=>{L.current===!0&&y===!1&&w.current.focus(),L.current=y},[y]);let G=(0,bt.useCallback)(()=>{I(),x(!1)},[x,I]),H=(0,bt.useCallback)(K=>{b(K),K||C(!1)},[b]),V=(0,bt.useCallback)(()=>{H(!1),w.current?.matches(":hover")&&C(!0)},[H]),W=st(o),N=st(r),Z=st(n),J=gc();return(0,bt.useEffect)(()=>{let K=Q=>{let M=Q({conversationType:W.current,AIProvider:N.current,AIModel:Z.current});M&&E(M.conversationType??W.current,M.AIProvider,M.AIModel)};return J.on("closePopper",V),J.on("selectModel",K),()=>{J.off("closePopper",V),J.off("selectModel",K)}},[J,E,V,W,N,Z]),bt.default.createElement(NI,{managerId:u,defaultCaptureEvent:m},bt.default.createElement(ts,{width:220,sx:{zIndex:2147483621},open:y,onOpenChange:H,placement:"bottom-start",isMirror:!0,modifiers:O,referenceElement:bt.default.createElement(ve,{title:f("package__features:chat__ai_model_selector__button__tooltip"),testId:"maxai--ai-model-selector--tooltip",open:h&&!y,...c},bt.default.createElement(Ce,{disableRipple:!0,disabled:s,id:"max-ai__ai-provider-floating-button","data-testid":"max-ai__ai-provider-floating-button",ref:w,sx:{position:"relative",display:"flex",justifyContent:"center",alignItems:"center",cursor:"pointer",p:.5,pl:"6px",height:32,minWidth:t==="mini"?"auto":void 0,...a},"aria-controls":y?"composition-menu":void 0,"aria-expanded":y?"true":void 0,"aria-haspopup":"true",onClick:G,onMouseEnter:()=>{y||C(!0)},onMouseLeave:()=>{y||C(!1)},...d},bt.default.createElement(g,{direction:"row",alignItems:"center"},cm(r)?bt.default.createElement(r2,{sx:{fontSize:"20px"}}):bt.default.createElement(Or,{model:n}),t!=="mini"&&_?.label&&bt.default.createElement(T,{mx:.5,fontSize:14,lineHeight:1.4,color:"text.secondary",...l,sx:{userSelect:"none",...l?.sx}},_.label),bt.default.createElement(X,{icon:"ExpandMore",sx:{color:"text.secondary",fontSize:"16px",transform:y?"rotate(180deg)":"rotate(0)"}})))),...p},bt.default.createElement($I,{buttonRef:w,conversationType:o,AIProvider:r,AIModel:n,onSelect:E,onClose:V,parentOpen:y})),bt.default.createElement(DI,null))},YI=hL;var gL=e=>{let{disabled:t,onChanged:o,domEventManagerId:r,defaultCaptureEvent:n,AIModel:i,AIProvider:a,setAIModelAndProvider:s,...l}=e,{conversationId:c,conversationType:p,inputMediator:u}=ue(),m=ye(c);return ZI.default.createElement(YI,{conversationType:p,AIProvider:a,AIModel:i,onChange:async(f,h,C)=>{let x=async()=>{s({AIProvider:h,AIModel:C}),u.focus(),o?.(a,i)};if(_i)x();else{if(!await nt({emitEvent:!0}))return;x()}},disabled:t||m,domEventManagerId:r,defaultCaptureEvent:n,...l})},_f=gL;var rs=e=>{let{AIModel:t,AIProvider:o}=_r.use.chat(),r=_r.use.setChatAIModelAndProvider();return Cf.default.createElement(_f,{AIModel:t,AIProvider:o,setAIModelAndProvider:r,...e})},QI=e=>{let{AIModel:t,AIProvider:o}=_r.use.art(),r=_r.use.setArtAIModelAndProvider();return Cf.default.createElement(_f,{AIModel:t,AIProvider:o,setAIModelAndProvider:r,...e})},JI=({order:e,...t})=>{let{isPayingUser:o}=vt(),r=o?gy:hy,n=_r.use.chat(),i=_r.use.chatHub(),a=_r.use.setChatAIModelAndProvider(),s=_r.use.setChatHubAIModelAndProvider(),l=e===0?a:m=>{s(e,m)},c=e===0?n:i[e],{AIModel:p,AIProvider:u}=c||r;return Cf.default.createElement(_f,{AIModel:p,AIProvider:u,setAIModelAndProvider:l,...t})};var xL=200,_L=({contentHeight:e})=>{let{t}=k(),{palette:o}=cl(),r=(0,we.useMemo)(()=>typeof window>"u"?"immersive_rewrite":vi()?"sidebar_rewrite":"immersive_rewrite",[]),[n,i]=(0,we.useState)(""),a=st(n),[s,l]=(0,we.useState)(!1),[c,p]=(0,we.useState)(!1),{askAIQuestion:u,askAIWithShortcuts:m,stopGenerate:d}=ze(),f=Ha(),{conversationId:h}=eo(),C=ye(h),x=f.getInputValue(),{liteContextMenuActionsItems:_}=Hl(x),y=(0,we.useRef)(null),b=(0,we.useMemo)(()=>c?[]:_,[c,_,t]),S=(0,we.useMemo)(()=>b.flatMap(j=>{if(j.type==="group"){let de=`context_menu__prompt__${j.prompt_id}`,re=`package__features:${de}`,ce=t(re),ut=Ci?ce==="package__features:"+de:ce===de;return(!ce||ce===j.prompt_id||ut||de===re)&&(ce=j.prompt_title),[ce+"__CONTEXT_MENU_LABEL_SLOT_PLACEHOLDER__"+j.prompt_id,...j.children??[]]}return[j]}),[b,t]),I=async()=>{if(!await nt({emitEvent:!0})){f.focus();return}if(C){d();return}let j=a.current;if(!j){l(!0);return}let de=y.current?.getSelectedItem();if(de)H(de);else if(x.trim()){let re=`${x}:
"""
{{SELECTED_TEXT}}
"""`;await u({type:"user",text:re,meta:{includeHistory:!0}},{beforeActions:[{type:"RENDER_TEMPLATE",parameters:{template:"{{POPUP_DRAFT}}"}},{type:"SET_VARIABLE",parameters:{Variable:{key:"SELECTED_TEXT",overwrite:!0,value:j,isBuiltIn:!0}}},{type:"SET_VARIABLE",parameters:{Variable:{key:"ANALYTICS_FEATURE_NAME",value:r,overwrite:!0,isBuiltIn:!0}}}]})}},w=(0,we.useRef)(null),E=(0,we.useRef)(null),O=(0,we.useRef)(null),L=()=>{O.current?.querySelector("textarea")?.focus()},G=()=>{L()},H=async j=>{if(L(),!a.current){l(!0);return}if(!j||!j.prompt_id||j.type==="group")return;let re=De(j.actions||[]);re.unshift({type:"SET_VARIABLE",parameters:{Variable:{key:"SELECTED_TEXT",value:a.current.trim(),overwrite:!0,isBuiltIn:!0,label:"Selected text overwrite"}}},{type:"SET_VARIABLE",parameters:{Variable:{key:"VARIABLE_MODAL_KEY",value:"SidebarRewrite",overwrite:!0,isBuiltIn:!0}}},{type:"SET_VARIABLE",parameters:{Variable:{key:"ANALYTICS_FEATURE_NAME",value:r,overwrite:!0,isBuiltIn:!0}}}),re.length>0&&m(re,{overwriteParameters:[{key:"SELECTED_TEXT",value:a.current,label:"Selected text",isBuiltIn:!0,overwrite:!0}]})},V=Mt(),[W,N]=(0,we.useState)(10);(0,we.useEffect)(()=>{let j=Math.floor((e-xL-140)/24);j<=0||N(Math.min(j,10))},[e]);let Z=(0,we.useMemo)(()=>Math.min(e-140-W*24,300),[e,W]),J=(0,we.useRef)(null),K=()=>{le.current?.()},Q=()=>{E.current?.focus()},M=()=>{f.focus()},le=(0,we.useRef)(Q),ge=j=>{le.current=j},[P,$]=d_([["maxai-animation-slide-in",{duration:200}],["maxai-animation-slide-in",{fillMode:"forwards",delay:-100,duration:200}]]);return we.default.createElement(we.default.Fragment,null,we.default.createElement(g,{gap:1,sx:{boxSizing:"border-box",border:"1px solid",borderColor:"border.main",bgcolor:o.background.paper,borderRadius:1,boxShadow:"rgb(15 15 15 / 5%) 0px 0px 0px 1px, rgb(15 15 15 / 10%) 0px 3px 6px, rgb(15 15 15 / 20%) 0px 9px 24px",overflow:"hidden",isolation:"isolate",width:"100%",py:1,px:1.5,maxWidth:"768px",...P},onKeyUp:j=>{j.stopPropagation()},onKeyDown:j=>{j.stopPropagation()}},we.default.createElement(g,{direction:"row",justifyContent:"space-between",sx:{wordBreak:"break-word",color:j=>j.palette.mode==="dark"?"#FFFFFFDE":"rgba(0,0,0,0.87)"},component:"div"},we.default.createElement(g,{direction:"row",gap:.5},we.default.createElement(Za,null),we.default.createElement(Kd,{enableChatMode:"pro_chat"},we.default.createElement(rs,{conversationType:"ContextMenu",tooltipProps:{placement:"bottom"},sx:{height:"32px"},onChanged:K}),we.default.createElement(Qa,{onChanged:K}))),we.default.createElement(g,{direction:"row",gap:1,alignItems:"center"},c&&we.default.createElement(ve,{title:t("package__common:discard")},we.default.createElement(Xe,{onClick:()=>{J.current?.discard()},sx:{width:"auto",color:"inherit",padding:"3px",marginLeft:"-4px",marginRight:"-3px"}},we.default.createElement(e3.default,{sx:{fontSize:17,color:"text.secondary"}}))))),!c&&we.default.createElement(F,{sx:{width:"100%",p:1,bgcolor:j=>j.palette.mode==="dark"?"#3B3D3E":"#F4F4F4",boxShadow:"0px 1px 2px rgba(16, 24, 40, 0.05)",borderRadius:1,boxSizing:"border-box",border:"1px solid",borderColor:s?u2[800]:"transparent","& > textarea":{border:"none",outline:"none",background:"transparent",width:"100%",height:"100%",resize:"none",color:"text.primary",lineHeight:"24px",fontFamily:"inherit",fontSize:"16px"}}},we.default.createElement("textarea",{onFocus:()=>ge(Q),ref:E,rows:W,onClick:j=>{j.stopPropagation()},value:n,onChange:j=>{l(!1),i(j.target.value)},placeholder:t("package__features:chat__home_view__rewrite__textarea__placeholder"),autoFocus:!0})),we.default.createElement(df,{ref:J,showCloseButton:!1,onClose:()=>{p(!1)},onShow:()=>{p(!0)},modelKey:"SidebarRewrite"}),!c&&we.default.createElement(g,{direction:"row",alignItems:"end",gap:1},we.default.createElement(g,{direction:"row",width:0,flex:1,alignItems:"center",spacing:1,justifyContent:"left",ref:O},we.default.createElement(lc,{ref:j=>f.bindRef(j),minLine:1,stopPropagation:!0,autoFocus:!0,onKeyDownCapture:j=>{y.current?.proxyKeyboardEvent(j.nativeEvent)?(j.preventDefault(),j.stopPropagation()):j.shiftKey&&j.key.toLowerCase()==="tab"&&(E.current?.focus(),j.preventDefault(),j.stopPropagation())},onFocusCapture:j=>{E.current&&E.current.value===""&&!E.current.getAttribute("data-autofocused")?(E.current.setAttribute("data-autofocused","true"),E.current.focus(),j.preventDefault(),ge(Q)):ge(M)},value:x,onChangeText:j=>f.updateInputValue(j),placeholder:t("package__features:chat__home_view__rewrite__input__placeholder"),sx:{border:"none","& > div":{"& > div":{p:0},"& > textarea":{p:0},"& > .max-ai-user-input__expand":{"&:has(> div)":{pr:1}}},borderRadius:0,minHeight:"24px"},onEnter:I})),we.default.createElement(sc,{placement:"bottom-end",disabled:(!x||!n)&&!C,onClick:I}))),we.default.createElement(F,{sx:{maxWidth:"768px",width:"100%",display:S.length<=0?"none":void 0}},we.default.createElement(Qd,{sx:{opacity:0,...$},ref:y,open:!0,defaultPlacement:"bottom-start",needAutoUpdate:!0,root:V,menuList:S,referenceElementRef:w,menuWidth:415,referenceElement:we.default.createElement(F,{"data-test-id":"ContextMenuList-referenceElementRef"}),onClickItem:H,onClickGroup:G,menuMaxHeight:`${Z}px`})))},CL=()=>{let e=(0,we.useRef)(),[t,o]=(0,we.useState)(0);return(0,we.useEffect)(()=>{e.current&&o(e.current.clientHeight)},[]),(0,we.useEffect)(()=>{if(!e.current)return;let r=()=>{e.current&&o(e.current.clientHeight)},n=new ResizeObserver(r);return n.observe(e.current),()=>{n.disconnect()}},[]),we.default.createElement(F,{ref:e,component:"div",width:"100%",padding:"10px",paddingBottom:0,flexGrow:1,display:"flex",flexDirection:"column",alignItems:"center",sx:{boxSizing:"border-box"}},t!==0?we.default.createElement(qa,{defaultContextMenuPath:"/rewrite"},we.default.createElement(_L,{contentHeight:t})):null)},t3=CL;var qp=v(A());var o3={MAXAI_FLUX:Du({prompt_id:F2,prompt_title:"Prompt Optimization FLUX/SD",type:"chat_complete",variables:[{hint:"User input",name:"USER_INPUT",type:"text"},Ue.PRESET_VARIABLE__AI_RESPONSE_TONE,Ue.PRESET_VARIABLE__AI_RESPONSE_WRITING_STYLE],output:[Ue.OUTPUT_PRESET_VARIABLE__CHAT_COMPLETE]}),MAXAI_STABLE_DIFFUSION:Du({prompt_id:D2,prompt_title:"Prompt Optimization FLUX/SD",type:"chat_complete",variables:[{hint:"User input",name:"USER_INPUT",type:"text"},{hint:"The previous user inputs",name:"PREVIOUS_USER_INPUTS",type:"text"},Ue.PRESET_VARIABLE__AI_RESPONSE_TONE,Ue.PRESET_VARIABLE__AI_RESPONSE_WRITING_STYLE],output:[Ue.OUTPUT_PRESET_VARIABLE__CHAT_COMPLETE]}),MAXAI_DALLE:Du({prompt_id:B2,prompt_title:"Prompt Optimization DALL\xB7E",type:"chat_complete",variables:[{hint:"User input",name:"USER_INPUT",type:"text"},Ue.PRESET_VARIABLE__AI_RESPONSE_TONE,Ue.PRESET_VARIABLE__AI_RESPONSE_WRITING_STYLE],output:[Ue.OUTPUT_PRESET_VARIABLE__CHAT_COMPLETE]})};var Wp=class{async createTextToArtActions(t,o){let r=await nr.getService().getConversationById(t),n=r?.meta.AIProvider;if(!r||o.trim()===""||!n)return[];let i=await cn.getService().dangerouslyGetTotalMessages(t),a=rr(),s=await OC("MAXAI_DALLE"),l={prompt:o,model:ul.value,contentType:s?.contentType,resolution:s?.resolution,generateCount:s?.generateCount,aspectRatio:s?.aspectRatio},c=o3[r?.meta.AIProvider||"MAXAI_DALLE"],p=!0,u=[];if(p&&c){let m=[];for(let f=i.length-1;f>=0;f--){let h=i[f];if(ln(h)&&h.originalMessage){let C=h.originalMessage.metadata?.title?.title||"",x=h.originalMessage.metadata?.artTextToImagePrompt||"";if(C&&x&&C&&m.unshift(C),h.originalMessage.metadata?.includeHistory===!1)break}}let d=m.map((f,h)=>`${h+1}. ${f}`).join(`
`);u=[{type:"CHAT_MESSAGE",parameters:{ActionChatMessageOperationType:"add",ActionChatMessageConfig:{type:"ai",messageId:a,text:"",originalMessage:{metadata:{shareType:"art",title:{title:o},copilot:{title:{title:"AI art",titleIcon:"Awesome",titleIconSize:24},steps:[{title:"Optimizing art prompt",status:"loading",icon:"CheckCircle"}]},artTextToImageMetadata:l}}}}},{type:"SET_VARIABLE",parameters:{VariableKey:"AI_RESPONSE_MESSAGE_ID"}},{type:"SET_VARIABLE_MAP",parameters:{VariableMap:{PREVIOUS_USER_INPUTS:d,USER_INPUT:o}}},{type:"ASK_CHATGPT",parameters:{isEnabledDetectAIResponseLanguage:!1,AskChatGPTActionType:"ASK_CHAT_GPT_HIDDEN",MaxAIPromptActionConfig:c,AskChatGPTActionQuestion:{text:o,meta:{historyMessages:[],outputMessageId:"{{AI_RESPONSE_MESSAGE_ID}}",messageVisibleText:o}}}},{type:"TEXT_HANDLER",parameters:{ActionTextHandleParameters:{trim:!0,noQuotes:!0,noCommand:!0}}},{type:"SET_VARIABLE",parameters:{VariableKey:"IMAGE_PROMPT"}},{type:"CHAT_MESSAGE",parameters:{ActionChatMessageOperationType:"update",ActionChatMessageConfig:{type:"ai",messageId:"{{AI_RESPONSE_MESSAGE_ID}}",text:"",originalMessage:{metadata:{isComplete:!1,copilot:{steps:[{title:"Optimizing art prompt",status:"complete",icon:"CheckCircle",value:"{{IMAGE_PROMPT}}",valueType:"text"}]},artTextToImagePrompt:"{{IMAGE_PROMPT}}"},content:{title:{title:"Image",titleIcon:"Image"},contentType:"image",text:""}}}}},{type:"ASK_CHATGPT",parameters:{AskChatGPTActionType:"ASK_CHAT_GPT_HIDDEN",isEnabledDetectAIResponseLanguage:!1,AskChatGPTActionQuestion:{text:"{{IMAGE_PROMPT}}",meta:{outputMessageId:"{{AI_RESPONSE_MESSAGE_ID}}",messageVisibleText:"{{IMAGE_PROMPT}}",contextMenu:{id:Ch,droppable:!1,parent:"",text:"[Art] text to image",data:{editable:!1,type:"shortcuts",actions:[]}}}}}},{type:"SCRIPTS_LIST",parameters:{}},{type:"CHAT_MESSAGE",parameters:{ActionChatMessageOperationType:"update",ActionChatMessageConfig:{type:"ai",text:"",messageId:"{{AI_RESPONSE_MESSAGE_ID}}",originalMessage:{content:{text:"",contentType:"image"},metadata:{attachments:"{{LAST_ACTION_OUTPUT}}"}}}}}]}else u=[{type:"CHAT_MESSAGE",parameters:{ActionChatMessageOperationType:"add",ActionChatMessageConfig:{type:"ai",messageId:a,text:"",originalMessage:{metadata:{includeHistory:!1,artTextToImagePrompt:o,shareType:"art",title:{title:o},copilot:{title:{title:"Pro art",titleIcon:"Awesome",titleIconSize:24},steps:[{title:"Generating art",status:"complete",icon:"CheckCircle",value:o}]},artTextToImageMetadata:l}}}}},{type:"SET_VARIABLE",parameters:{VariableKey:"AI_RESPONSE_MESSAGE_ID"}},{type:"CHAT_MESSAGE",parameters:{ActionChatMessageOperationType:"update",ActionChatMessageConfig:{type:"ai",messageId:"{{AI_RESPONSE_MESSAGE_ID}}",text:"",originalMessage:{content:{title:{title:"Image",titleIcon:"Image"},contentType:"image",text:""}}}}},{type:"ASK_CHATGPT",parameters:{AskChatGPTActionType:"ASK_CHAT_GPT_HIDDEN",isEnabledDetectAIResponseLanguage:!1,AskChatGPTActionQuestion:{text:o,meta:{includeHistory:!1,outputMessageId:"{{AI_RESPONSE_MESSAGE_ID}}",messageVisibleText:o,contextMenu:{id:Ch,droppable:!1,parent:"",text:"[Art] text to image",data:{editable:!1,type:"shortcuts",actions:[]}}}}}},{type:"SCRIPTS_LIST",parameters:{}},{type:"CHAT_MESSAGE",parameters:{ActionChatMessageOperationType:"update",ActionChatMessageConfig:{type:"ai",text:"",messageId:"{{AI_RESPONSE_MESSAGE_ID}}",originalMessage:{content:{text:"",contentType:"image"},metadata:{attachments:"{{LAST_ACTION_OUTPUT}}"}}}}}];return u}};var r3=new Wp;var Vo=v(A());var yL=e=>{let{tip:t,sx:o,wrapSx:r,children:n,lineClamp:i=3,resizeListener:a=!1,tooltipZIndex:s,TooltipProps:l,startSlot:c,endSlot:p,hideTooltip:u,...m}=e,d=(0,Vo.useRef)(null),f=(0,Vo.useRef)(null),[h,C]=(0,Vo.useState)(!1),[x,_]=(0,Vo.useState)(!0),y=(0,Vo.useMemo)(()=>t??n,[n,t]),b=(0,Vo.useCallback)(()=>{if(f.current){let S=f.current;_(S.offsetHeight>=S.scrollHeight)}},[]);return(0,Vo.useEffect)(()=>{h&&n&&b()},[h,n,b]),(0,Vo.useEffect)(()=>{n&&!h&&C(!0)},[n,h]),(0,Vo.useEffect)(()=>{if(h&&a){let S=()=>b();d.current=new ResizeObserver(S),f.current&&d.current.observe(f.current)}return()=>{d.current?.disconnect()}},[h,a,b,f]),Vo.default.createElement(ve,{title:u||x?"":Vo.default.createElement(T,{fontSize:"14px"},y),PopperProps:{style:{zIndex:s||2147483620,maxWidth:180}},...l},Vo.default.createElement(g,{direction:"row",alignItems:"center",flex:1,gap:"4px",sx:r},c,Vo.default.createElement(T,{ref:f,sx:{MozBoxOrient:"vertical",WebkitBoxOrient:"vertical",WebkitLineClamp:`${i}`,lineClamp:`${i}`,boxOrient:"vertical",display:"-webkit-box",overflow:"hidden",textOverflow:"ellipsis",flex:1,...o},...m},n),p))},pa=yL;var yf=v(A()),bL=({promptData:e,disabled:t,onClick:o,order:r,showLineClamp:n=1})=>yf.default.createElement(Si,{in:!0,style:{transitionDelay:r?`${r*150}ms`:"0ms"}},yf.default.createElement(Kr,{component:"button","data-testid":`sample-prompt-item${r}`,sx:{width:"100%",px:2,py:1.5,bgcolor:t?"background.secondary":"background.paper",border:"1px solid",borderColor:"border.main",boxShadow:t?"none":"0px 1px 2px 0px #0000000D",cursor:t?"default":"pointer",transition:"border-color 0.3s",borderRadius:1,flex:1,"&:hover":{borderColor:t?"border.main":"primary.main"}},onClick:()=>{t||o&&o(e)}},yf.default.createElement(pa,{textAlign:"left",tip:e.title,resizeListener:!0,lineClamp:n,sx:{fontSize:"14px",lineHeight:"21px",whiteSpace:"normal",wordBreak:"break-word",minHeight:n*21,color:t?"text.disabled":"text.primary"}},e.title))),bf=bL;var n3=[{title:"Product mockups",prompt:"Generate a realistic product mockup for an Elegant Glass Meal Prep Set, which will allow customers to envision the product before making a purchase."},{title:"Social media graphics ",prompt:"Design an attention-grabbing graphic for a social post on healthy eating trends. Focus on food and without human faces or text."},{title:"Email banners",prompt:"Create an email banner for email sharing Christmas holiday greetings. With clear text: Merry Christmas!. Without human faces or other texts."},{title:"Logos",prompt:"Generate one single logo for a business eco-friendly packaging firm. Without human faces or texts."},{title:"Ad campaign visuals",prompt:"Generate an image for a banner ad on the theme of fitness, without text or human face."},{title:"Blog post feature image",prompt:"Generate an image that will complement a blog post on the topic mental health."},{title:"Website hero image",prompt:"Generate a hero image for a website dedicated to online learning. With clear beautiful human faces. Highlight the online learning concept."},{title:"Brochure Design",prompt:"Design a visually appealing brochure showcasing the benefits of a premium skincare line, targeting business owners."},{title:"Event Poster",prompt:"Create a vibrant poster promoting an upcoming event hosted by my company that focuses on community events, featuring captivating visuals. Without text."},{title:"Promotional video thumbnails",prompt:"Generate a compelling thumbnail for a promotional video showcasing success stories from customers, designed to attract clicks and drive engagement on platforms like YouTube or social media. If there are human faces, they need to be clear and beautiful."},{title:"Blog images",prompt:"Create a custom graphic for a blog post on remote working best practices. Make sure to include related images. If featuring human faces, ensure they are clear and radiate a sense of beauty and concentration."},{title:"Web page graphic",prompt:"Generate a graphic of homepage for a pet care services website that illustrates care and attention to pets."},{title:"Google ad",prompt:"Create a Google Ads banner to highlight a limited-time offer. Use images of Tablet products, and make sure the image grabs attention. With the text Limited Time Offer as the only text element."},{title:"Poster graphic",prompt:"Design a realistic graphic for a poster for a concert announcement. Make sure to incorporate detailed drawings of musical instruments."},{title:"Travel blogs/websites",prompt:"Generate a photo illustrating the vibrant and intricate rituals during the festival of Carnival. Without human faces."},{title:"E-commerce/online retail platforms",prompt:"Generate photos of a set of modern cookware in various settings, highlighting their non-stick surfaces and ergonomic handles."},{title:"Business websites/corporate blogs",prompt:"Generate photos of an executive team in a strategic retreat setting, fostering a sense of unity and vision. If featuring human faces, ensure they are clear and radiate a sense of beauty and concentration."},{title:"Lifestyle magazines/websites",prompt:"Generate a photo illustrating a mid-century modern home with eclectic decor and cozy corners."},{title:"Educational platforms/e-Learning websites",prompt:"Generate photos of students actively participating in a coding workshop. If featuring human faces, ensure they are clear and radiate a sense of beauty and concentration."},{title:"Event management websites/promotion platforms",prompt:"Capture the excitement of professionals networking and exchanging ideas at an event in a photograph. If featuring human faces, ensure they are front, clear and radiate a sense of beauty and concentration. When the human figure in the picture is relatively small, the complete face does not appear."},{title:"Wellness blogs/healthcare platforms",prompt:"Showcase farmers harvesting organic produce for a healthy and sustainable lifestyle."},{title:"Food and beverage blogs/websites",prompt:"Generate mouthwatering images of pasta dish being cooked, showcasing the blend of colours and textures."},{title:"Fitness and exercise blogs/websites",prompt:"Generate motivational images of individuals engaged in intense workout routines, highlighting their determination and perseverance to achieve their fitness goals.If featuring human faces, ensure they are front, clear and radiate a sense of beauty and concentration. When the human figure in the picture is relatively small, the complete face does not appear."},{title:"Fashion accessories brands/websites",prompt:"Create visually stunning images of a designer handbag, showcasing their elegance and luxury against contrasting backgrounds."},{title:"Product photography",prompt:"Create studio-quality photos of wireless earphones, showcasing them from multiple angles, highlighting the Noise Blocking and Comfortable Fit feature. Without any text."},{title:"Property listings",prompt:"Generate exterior photos of a suburban home. Include shots of the swimming pool and landscaped front yard."},{title:"Hospitality",prompt:"Generate inviting photos of a deluxe king room. Highlight the modern decor and comfortable seating area, ensuring the room looks welcoming and well-appointed."},{title:"Feature articles",prompt:"Generate a photo for a feature story on urban gardening. Include images of community gardens and green rooftops, highlighting sustainability and community spirit. Without any text or human faces."},{title:"Storyboard",prompt:"Generate a storyboard sequence for a romantic comedy where two rival chefs fall in love while competing on a cooking show. Include key scenes like the emotional revelation that changes everything."},{title:"Art for theatrical productions",prompt:"Create a set design concepts for Hamlet. Include elaborate period costumes and props."},{title:"Editorial Art",prompt:"Create a feature illustration for National Geographic exploring climate change and its effects on global migration. Include juxtaposition of contrasting images."},{title:"Art for awareness campaigns",prompt:"Generate a marketing graphic for an ocean plastic pollution awareness campaign. Include emotive photography of affected individuals or environments."},{title:"Literary classics reimagined",prompt:'Reimagine scenes from the literary classic "Pride and Prejudice", blending traditional and modern elements to add a unique artistic touch for a modern graphic novel adaptation. Need to without any texts.'},{title:"Bedtime stories",prompt:"Create warm visuals with soft lighting, cozy setting, and a touch of magic on the theme of nighttime journey through the cosmos, tailored for a bedtime story."},{title:"Philosophical abstract expressions",prompt:"Generate abstract and thought-provoking visuals that resonate with the philosophical concept of the paradox of infinity."},{title:"Surrealistic depiction",prompt:"Create surreal dreamscapes on the theme of the passage of time blending reality and fantasy, using unconventional perspectives and dreamlike elements to evoke a sense of wonder and curiosity."},{title:"Mandalas",prompt:"Craft mandalas incorporating vibrant colors and unique patterns that will inspire feelings of happiness and well-being."},{title:"Artwork from quote",prompt:'"I think, therefore I am." - Ren\xE9 Descartes. Turn this quote into an image artwork.'},{title:"Portrait",prompt:"Generate a portrait of Leonardo da Vinci in impressionism for a blog exploring the history of the Italian Renaissance"},{title:"Pop culture icons redesigned",prompt:"Reimagine iconic characters from Harry Potter with a contemporary twist, incorporating modern fashion and technology elements to breathe new life into familiar favorites."},{title:"Abstract emotions",prompt:"Generate an abstract artwork exploring the depths of human emotion, using color, form, and texture to convey feelings of serenity and chaos."},{title:"Cartoonized web series or online content",prompt:"Create artwork for characters for an animated web series about space adventures. Include robotic appendages in the character design."},{title:"Cartoons and caricatures for promotional material",prompt:"Design a caricature for a social media campaign promoting a food festival. Include exaggerated, humorous depictions of the character eating, highlighting fun atmosphere."},{title:"Custom caricatures for souvenirs ",prompt:"Design beautiful custom caricature for a mug souvenir, showing it exploring landmarks."},{title:"Public Art",prompt:"Create a mural design for a community center. Include environmental sustainability themes in the mural. Without any text."},{title:"Realistic Cartoon",prompt:"Generate a semi-realistic cartoon character with intricate details, blending elements of realism with a cartoon aesthetic into one piece. Need to Without any text."},{title:"Anime Hero",prompt:"Generate an anime character with large, detailed eyes with distinctive Japanese anime aesthetics."},{title:"Minimalist Line Art",prompt:"Design a simple cartoon character using minimalist line art, focusing on clean lines and basic shapes."},{title:"Pixel Art Character",prompt:"Craft a pixel art character, reminiscent of old-school video games, with limited colors and a blocky, pixelated design."},{title:"Comic Book Superhero",prompt:"Create a powerful superhero character in the style of a comic book, complete with bold outlines and vibrant colors."},{title:"Children's Book Illustration",prompt:"Generate a whimsical cartoon character suitable for children's book illustrations, characterized by soft lines and pastel colors to bring a gentle and enchanting vibe to the illustrations."},{title:"Manga Chibi",prompt:"Design a cute and chibi-style manga character with oversized heads, small bodies, and adorable expressions."},{title:"Surreal Art Deco",prompt:"Craft a surreal character in the style of Art Deco, known for its geometric shapes, bold colors, and elegant, vintage feel."},{title:"Retro Cartoon",prompt:"Create a character reminiscent of the classic, retro cartoon era, featuring exaggerated movements and playful antics."},{title:"Historical figure cartoonized",prompt:"Transform a famous historical figure into a lovable cartoon character, depicting them in humorous situations or reimagining their achievements with a playful twist. ! AI image prompts for video game design"},{title:"Color schemes and themes",prompt:"Design a thematic color palette for a fantasy game. I want the colors to evoke a sense of wonder and enchantment."},{title:"Props and objects",prompt:"Create designs for magical props for a role-playing game. Include detailed illustrations of a weathered tome with arcane symbols."},{title:"NPCs and enemies",prompt:"Design a non-playable character for a cyberpunk role-playing game. Include the distinct visual traits of a ruthless corporate enforcer."},{title:"Visuals for the game's website, social media channels",prompt:"I have created a game that explores a fantastical world of magic and adventure. Create a banner image for the game's  Instagram highlight cover. Include the player character wielding a legendary weapon featuring the main characters, set against a backdrop of towering futuristic skyscrapers."},{title:"Epic Fantasy World",prompt:"Design a picture of a stunning fantasy world, complete with enchanted forests, towering castles, and mythical creatures, setting the stage for a grand adventure."},{title:"Cyberpunk Cityscape",prompt:"Craft a futuristic cyberpunk cityscape, with neon-lit skyscrapers, bustling streets, and intricate details that define the urban dystopia."},{title:"Playable Character Concept ",prompt:"Design a character image of a unique playable character, outlining their appearance for a protagonist in an RPG game."},{title:"Alien Planet Ecosystem",prompt:"Create an illusion of an alien planet's ecosystem, with bizarre flora and fauna, strange geology, and atmospheric anomalies."},{title:"Haunted Mansion Interior",prompt:"Generate a chilling interior layout for a haunted mansion, replete with eerie corridors, ghostly apparitions, and secrets waiting to be discovered."},{title:"Melee Weaponry Collection",prompt:"Craft a collection of melee weapons, each with its own distinct design, perfect for a combat-focused game."},{title:"Sci-Fi Space Station",prompt:"Design a massive, intricate space station, teeming with advanced technology, modular compartments, and areas for various in-game activities."},{title:"Ancient Ruins Exploration",prompt:"Generate the environment of a long-forgotten civilization's ruins."},{title:"Interstellar Starship Bridge",prompt:"Craft the interior of an interstellar starship bridge, featuring advanced control panels, holographic displays, and the latest in spacefaring technology."},{title:"Legendary Artifact",prompt:"Craft an iconic legendary artifact for players to discover in-game, featuring intricate detailing, mystical symbols."}];var Sf=v(A()),SL=(e,t)=>vC(e).slice(0,t),IL=(e,t=4)=>{let[o,r]=(0,Sf.useState)([]);return(0,Sf.useLayoutEffect)(()=>{r(SL(e,t))},[]),{samplePromptList:o}},If=IL;var Gp=v(A()),vL=({promptItemXs:e,showLineClamp:t})=>{let{samplePromptList:o}=If(n3),{conversationId:r}=ue(),{runShortcutsActions:n}=ze();return Gp.default.createElement(g,{width:"100%","data-button-clicked-name":"art-sample-prompt-clicked"},Gp.default.createElement(ei,{container:!0,spacing:1.5},o.map((i,a)=>Gp.default.createElement(ei,{key:i.title,item:!0,xs:e},Gp.default.createElement(bf,{promptData:i,disabled:!1,onClick:async s=>{if(s&&s.prompt){let l=await r3.createTextToArtActions(r,s.prompt);l&&n(l)}},order:a+1,showLineClamp:t})))))},i3=vL;var a3=async(e,t=0)=>{let o=async()=>{t<=0?await e():setTimeout(async()=>{await e()},t)},r=await vh.isLogin();return new Promise(n=>{if(r)o().then(()=>{n(!0)});else{if(_i){n(!1);return}let i=document.querySelector('[data-testid="maxai--sign-in--button"]');if(i){i.dispatchEvent(new MouseEvent("click",{bubbles:!0}));let a=setInterval(async()=>{await vh.isLogin()?(clearInterval(a),await o(),n(!0)):i.disabled===!1&&(clearInterval(a),n(!1))},250)}}})};var s3="MAXAI_CLIENT__FEATURES__CHAT__SEARCH__SETTINGS",wL={searchEngine:"google",maxResultsCount:6,copilot:!1},vf=class{async getSettings(){let t={...wL},o=await $r.getItem(s3);return o&&Object.assign(t,o),t}async setSettings(t){let r={...this.getSettings(),...t};return await $r.setItem(s3,r),!0}async createShortcutsActions(t,o,r){if(o.trim()==="")return[];let n=await cn.getService().dangerouslyGetTotalMessages(t),i=[];for(let s=n.length-1;s>=0;s--){let l=n[s];if(l?.originalMessage&&i.unshift(l?.originalMessage?.metadata?.title?.title||l.text||""),l.type==="ai"&&l?.originalMessage?.metadata?.includeHistory===!1)break}let{actions:a}=await fy(o,i,r);return a}};var l3=new vf;var c3=[{title:"Humanity's Last Exam"},{title:"New Blood Group Identified"},{title:"View the Comet of the Century"},{title:"Global Seed Vault Under Threat"},{title:"The Fed\u2019s Big Rate Cut"},{title:"23andMe's Fallout"},{title:"New Insights into the Multiverse"},{title:"Lionsgate's Runway AI Video Deal"},{title:"'Third State' Beyond Life and Death"},{title:"Snap's New Large AR Spectacles"},{title:"Earth's Ancient Ring System"},{title:"Neuralink Gets FDA Breakthrough Device"},{title:"CATL's Million-Mile Bus Battery"},{title:"Bitcoin's 66-bit Puzzle Solved"},{title:"Slack Debuts AI Agents"},{title:"Blue Origin Mars Mission Delayed"},{title:"Lucid's Upcoming Affordable SUV"},{title:"The History of Lehman Brothers Bankruptcy"},{title:"Larry Ellison's Take on AI"}];var jp=v(A()),ML=({promptItemXs:e,showLineClamp:t})=>{let{conversationId:o}=ue(),{runShortcutsActions:r}=ze(),{samplePromptList:n}=If(c3);return jp.default.createElement(g,{"data-button-clicked-name":"search-sample-prompt-clicked"},jp.default.createElement(ei,{container:!0,spacing:1.5},n.map((i,a)=>jp.default.createElement(ei,{key:i.title,item:!0,xs:e},jp.default.createElement(bf,{promptData:i,disabled:!1,onClick:async s=>{if(s.title){let l=await l3.createShortcutsActions(o,s.title,!0);await a3(()=>{r(l)})}},order:a+1,showLineClamp:t})))))},p3=ML;var EL=()=>{let{conversationType:e}=ue(),t={promptItemXs:6,showLineClamp:2},o={Art:qp.default.createElement(i3,{...t}),Search:qp.default.createElement(p3,{...t})}[e]||null;return qp.default.createElement(qp.default.Fragment,null,o)},u3=EL;var AL=()=>{let[e,t]=(0,Jt.useState)(0);return(0,Jt.useEffect)(()=>{let o=()=>{t(window.innerHeight)};return t(window.innerHeight),window.addEventListener("resize",o),()=>{window.removeEventListener("resize",o)}},[]),e},PL=e=>{let{sx:t,chatBoxHeight:o}=e,r=AL(),{t:n}=k();return Jt.default.createElement(g,{className:"maxai--chat-home-view",gap:1.5,m:1.5,sx:{"& *":{boxSizing:"border-box"},flex:1,overflow:"hidden",...t}},Jt.default.createElement(T,{"data-testid":"maxai--chat-home-view--title",sx:{height:"100%",display:"flex",alignItems:"flex-end",color:"text.primary",fontSize:"24px",fontWeight:700,lineHeight:"33.6px",textAlign:"center"}},n(_i?"package__features:chat__home_view__extension__title":"package__features:chat__home_view__website__title")),r>=(o?o+120:600)&&Jt.default.createElement(Wd,null))},kL=e=>{let{sx:t,isMessageEmpty:o}=e,{t:r}=k(),n=be(i=>i.conversationType);return Jt.default.createElement(g,{className:"maxai--chat-home-view",flexGrow:1,width:"100%",sx:{overflowY:"auto","& *":{boxSizing:"border-box"},...t}},n==="ContextMenu"&&Jt.default.createElement(g,{direction:"column",sx:{width:"100%",padding:"32px 10px"},flexGrow:1},Jt.default.createElement(g,{direction:"column",alignItems:"center",justifyContent:"center",sx:{height:"175px"}},Jt.default.createElement(X,{icon:"Rewrite",sx:{color:"primary.main",fontSize:"40px",marginBottom:"12px"}}),Jt.default.createElement(T,{component:"h1",marginBottom:"8px",lineHeight:"140%",fontWeight:700,fontSize:20,textAlign:"center",color:i=>i.palette.mode==="dark"?"rgba(255, 255, 255, 0.87)":"rgba(0, 0, 0, 0.87)"},r("package__features:chat__home_view__rewrite__title")),Jt.default.createElement(T,{lineHeight:"150%",fontSize:14,textAlign:"center",color:i=>i.palette.mode==="dark"?"rgba(255, 255, 255, 0.87)":"rgba(0, 0, 0, 0.60)"},r("package__features:chat__home_view__rewrite__description"))),o&&Jt.default.createElement(t3,null)),n==="Art"&&Jt.default.createElement(g,{px:2,width:"100%",height:"100%",justifyContent:"center",alignItems:"center",position:"relative"},Jt.default.createElement(g,{justifyContent:"center",alignItems:"center",maxWidth:680,width:"80%"},Jt.default.createElement(X,{icon:"Art",sx:{color:"primary.main",fontSize:"48px"}}),Jt.default.createElement(T,{component:"h1",mt:1.5,mb:1,fontSize:"20px",fontWeight:700,textAlign:"center",color:"text.primary"},r("package__features:chat__home_view__art__title")),Jt.default.createElement(T,{fontSize:"14px",fontWeight:400,textAlign:"center",color:"text.primary"},r("package__features:chat__home_view__art__description")))),n==="Summary"&&Jt.default.createElement(Br,{sx:{my:0},loading:!0}),Jt.default.createElement(g,{alignItems:"center",maxWidth:768,mx:"auto",width:"100%",p:1.5,gap:1.5},Jt.default.createElement(u3,null)))},LL=e=>be(o=>o.conversationType)==="Chat"?Jt.default.createElement(PL,{...e}):Jt.default.createElement(kL,{...e}),m3=LL;var In=v(A());var Kp=v(A()),OL=e=>class extends Kp.Component{constructor(o){super(o),this.state={hasError:!1}}componentDidCatch(o,r){this.setState({hasError:!0})}render(){return this.state.hasError?Kp.default.createElement(e,{...this.props,liteMode:!0,hasError:!0}):Kp.default.createElement(e,{...this.props})}},_c=OL;var lx=v(A());var Wn=v(A()),wf="chat-message--AI-tools",Tf=(0,Wn.createContext)({AIMessage:{},usePromptOpen:!1,setUsePromptOpen:()=>{},onClickPromptItem:()=>{},onRegenerate:()=>{},content:{contentType:"text",text:""},metadata:{},processingStep:"RESPONDED",isLoading:!1,isWritingMessage:!1,isLastMessage:!1,isAutoHideTools:!0}),Mf=e=>{let{message:t,loading:o,children:r}=e,{conversationId:n,inputMediator:i}=eo(),a=Xo(n),[s,l]=(0,Wn.useState)(!1),{content:c,metadata:p,processingStep:u}=uy(t,o),m=!!o,d=t?.messageId===a?.lastMessageId||m,f=!d&&!s,h=!p.isComplete||m,{askAIWithShortcutsV2:C,regenerate:x}=ze(),_=(0,Wn.useRef)(!1),y=async S=>{if(!_.current)try{if(_.current=!1,S&&S.length>0){let w=(t&&Dn(t,!1)||"").replace(dl,""),E=De(S||[]);E.unshift({type:"SET_VARIABLE",parameters:{Variable:{key:"SELECTED_TEXT",value:w||" ",label:"Selected text",isBuiltIn:!0,overwrite:!0}}},{type:"SET_VARIABLE",parameters:{Variable:{key:"VARIABLE_MODAL_KEY",value:"Sidebar",overwrite:!0,isBuiltIn:!0}}}),i.focus(),await ay(E,async O=>{let L=O.parameters?.AskChatGPTActionQuestion;return L?.meta&&(L.meta.includeHistory=!0),O}),await C(E,{disabledMaxAIDocumentIds:!0})}}catch{}finally{_.current=!1}},b=(0,Wn.useCallback)(()=>{x(n)},[x,n]);return Wn.default.createElement(Tf.Provider,{value:{AIMessage:t,usePromptOpen:s,setUsePromptOpen:l,onClickPromptItem:y,onRegenerate:b,content:c,metadata:p,processingStep:u,isLoading:h,isWritingMessage:m,isLastMessage:d,isAutoHideTools:f}},r)},ot=()=>(0,Wn.useContext)(Tf);var d3=v(rM()),f3=v(iM());var po=v(A()),BL=e=>{let{message:t}=e,{t:o}=k(),[r,n]=po.default.useState(null),[i,a]=(0,po.useState)(!1),s=!!r,{updateMessage:l}=Li(),{conversationId:c}=ue(),p=x=>{n(x.currentTarget)},u=()=>{n(null)},m=()=>{a(!0)},d=()=>{a(!1)},f=()=>{a(!1);let x=De(t);ln(t)?(x.originalMessage?.metadata&&(x.originalMessage.metadata.includeHistory=!0),x=qo([x,{originalMessage:{metadata:{includeHistory:!0}}}])):x=qo([x,{meta:{includeHistory:!0}}]),l(c,x)},h=(0,po.useMemo)(()=>vi(),[]);return!0?null:po.default.createElement(wt,{sx:{mb:2}},po.default.createElement(g,{direction:"row",alignItems:"center"},po.default.createElement(T,{color:"text.secondary",fontSize:"12px"},o("package__features:chat__context_cleared__title")),po.default.createElement(Ce,{variant:"text",sx:{width:"30px",height:"30px",color:"inherit",minWidth:"unset",ml:"auto!important"},onClick:p},po.default.createElement(f3.default,{sx:{fontSize:16,color:"text.primary"}}))),po.default.createElement(Ei,{anchorEl:r,open:s,onClose:u,slotProps:{}},po.default.createElement(Ct,{onClick:()=>{u(),m()},sx:{color:"error.main"}},po.default.createElement(d3.default,{sx:{fontSize:16,mr:1,color:"inherit"}}),o("package__common:delete"))),po.default.createElement(d2,{open:i,onClose:x=>{x.stopPropagation(),d()},sx:{position:h?"absolute":"fixed"}},po.default.createElement(Zu,{sx:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",borderRadius:"4px",bgcolor:"background.paper",maxWidth:"512px!important",width:h?"448px":"100%",p:2},onClick:x=>{x.stopPropagation()}},po.default.createElement(g,{spacing:2},po.default.createElement(T,{fontSize:"20px",fontWeight:700,lineHeight:"24px",color:"text.primary"},o("package__features:chat__context_cleared__delete__title")),po.default.createElement(T,{fontSize:"16px",color:"text.primary"},o("package__features:chat__context_cleared__delete__description")),po.default.createElement(g,{direction:"row",spacing:1,justifyContent:"end"},po.default.createElement(Ce,{variant:"outlined",onClick:d},o("package__common:cancel")),po.default.createElement(Ce,{variant:"contained",color:"error",onClick:f,sx:{bgcolor:"#f44336!important","&:hover":{bgcolor:"#d32f2f!important"}}},o("package__common:confirm")))))))},Ef=BL;var Ke=v(A());var Cc=v(A()),FL=e=>{let{fontSx:t,iconSx:o,showLoading:r}=e,{title:n,titleIcon:i,titleIconSize:a}=e.title,s=`${a||20}px`;return Cc.default.createElement(g,{direction:"row",alignItems:"center",spacing:1},typeof i=="string"&&i?Cc.default.createElement(g,{alignItems:"center",justifyContent:"center",width:s,height:s},Cc.default.createElement(X,{sx:{color:"text.primary",fontSize:s,...o},icon:i})):i,Cc.default.createElement(T,{sx:{color:"text.primary",fontWeight:400,fontSize:"18px",...t}},n),r&&Cc.default.createElement(F,{sx:{display:"inline-block",width:"12px",height:"12px",margin:"0 0 0 4px !important",borderRadius:"50%",backgroundColor:l=>l.palette.mode==="dark"?"#fff":"#000"}}))},Ri=FL;var ua=v(A()),h3=e=>{let{AIProvider:t,AIModel:o,icon:r,title:n,sx:i}=e,a=(0,ua.useMemo)(()=>{let s=$o(void 0,o),l=r;return!r&&s&&(l=ua.default.createElement(Or,{size:24,provider:t,model:s.value,sx:{outline:"1px solid rgba(0, 0, 0, 0.08)",borderRadius:"8px"}})),{icon:l,title:n||s?.title||""}},[t,o,r,n]);return!a.icon&&!a.title?null:ua.default.createElement(g,{direction:"row",alignItems:"center",gap:1,height:24,className:"chat-ai-message--ai-model",sx:i},a.icon,ua.default.isValidElement(a.title)?a.title:ua.default.createElement(T,{sx:{fontSize:"16px",lineHeight:"24px",color:s=>s.palette.mode==="dark"?"rgba(255, 255, 255, 0.87)":"rgba(0, 0, 0, 0.87)",fontWeight:500}},a.title))},ma=e=>ua.default.createElement(h3,{icon:ua.default.createElement(Ln,null),title:"MaxAI",...e}),yc=h3;var Sc=v(A());var f0=v(A());var DL=()=>{let{processingStep:e}=ot();return e==="RESPONDING"||e==="RESPONDED"?f0.default.createElement(g,{direction:"row",alignItems:"center",gap:1},f0.default.createElement(ma,{title:"Answer"})):null},g3=DL;var x3=v(A()),HL=()=>{let{processingStep:e}=ot();return e==="RESPONDING"||e==="RESPONDED"?x3.default.createElement(ma,{title:"Answer"}):null},_3=HL;var bc=v(A()),NL=e=>{let{message:t}=e,{content:o,metadata:r}=ot(),n=r?.shareType==="summary",i=Xo(t.conversationId||"");if(i?.meta&&i.meta?.AIModel!==xh.value&&t.originalMessage?.metadata?.AIModel!==xh.value)return bc.default.createElement(yc,{AIProvider:i?.meta?.AIProvider,AIModel:t.originalMessage?.metadata?.AIModel||i.meta.AIModel});let a=bc.default.createElement(Ft,{size:18}),s="";return r.isComplete?(a=o.title?.titleIcon&&o.title?.titleIcon!=="Loading"?o.title?.titleIcon:bc.default.createElement(Kc,{icon:"Read",sx:{fontSize:"24px"}}),s=o.title?.title||"Answer"):(o.contentType==="text"?s="Writing":o.contentType==="image"&&(s="Creating image"),o.title?.title&&(s=o.title.title),o.title?.titleIcon&&o.title?.titleIcon!=="Loading"&&(a=o.title?.titleIcon),n&&o?.title?.titleIcon!=="Loading"&&(a=o.title?.titleIcon||bc.default.createElement(Kc,{icon:"Read",sx:{fontSize:"24px"}}),s=o.title?.title||"Answer")),bc.default.createElement(Ri,{title:{title:s,titleIcon:a,titleIconSize:24}})},C3=NL;var zL=e=>{let{message:t}=e,{metadata:o}=ot(),r=Xo(t.conversationId||"");if(o.chatMode==="free_chat")return Sc.default.createElement(g3,{message:t});if(o.chatMode==="pro_chat")return Sc.default.createElement(_3,{message:t});if(o.shareType==="summary")return Sc.default.createElement(C3,{message:t});let n=o.AIModel||r?.meta.AIModel;return n?Sc.default.createElement(yc,{AIProvider:r?.meta?.AIProvider,AIModel:n}):Sc.default.createElement(ma,null)},h0=zL;var Hs=v(A());var Rr=v(A()),VL=e=>{let{message:t}=e,o=(0,Rr.useRef)(null),[r,n]=(0,Rr.useState)([0,0]),[i]=(0,Rr.useState)(1),[a]=(0,Rr.useState)("1:1"),s=(0,Rr.useMemo)(()=>{try{let c=t.originalMessage?.metadata?.attachments||[],p=r[0],u=r[1];if(c.length>0&&p&&u){let d=2;c.length>=12?d=4:c.length>=9&&(d=3);let f=Math.ceil(c.length/d),h=c.length>=d,C=h?(d-1)*6*2:0,x=h?(f-1)*6*2:0,_=h?(p-C)/d:p,y=h?(u-x)/f:u,b=Math.min(_,y);return c.map((S,I)=>{let w=a||S?.meta?.aspectRatio||"1:1",[E,O]=w.split(":").map(Number),L=E>=O,G=E/O,H=L?b:b*G,V=L?b/G:b,W=Math.floor(I/d),N=I%d,Z=W*(b+6*2),J=N*(b+6*2);return{imageBoxWidth:H,imageBoxHeight:V,imageBoxTop:Z,imageBoxLeft:J,image:S}})}else return[]}catch{return[]}},[t.originalMessage?.metadata?.attachments,r,i,a]),l=(0,Rr.useMemo)(()=>kr(()=>{if(o.current){let{width:c,height:p}=o.current.getBoundingClientRect();n([c,p])}},50),[]);return(0,Rr.useEffect)(()=>{let c=new ResizeObserver(()=>{l()});return o.current&&c.observe(o.current),()=>{c.disconnect()}},[o]),Rr.default.createElement(g,{component:"div",ref:o,mt:1,minHeight:"16px",width:"60%",minWidth:Zc-16-16,sx:{position:"relative"}},s.map(c=>{let u=(o.current?.getBoundingClientRect().width||Zc-16-16)/PC(c?.image?.meta?.aspectRatio);return Rr.default.createElement(F,{ref:o,key:1,className:"maxai-ai-message__image__content__box",sx:{position:"relative",zIndex:0,display:"inline-flex",alignItems:"center",justifyContent:"center",width:"auto",height:"auto",overflow:"hidden",borderRadius:"4px","& > img":{width:"100%",height:"100%",border:"2px solid rgba(0,0,0,0)",boxSizing:"border-box",borderRadius:"8px",transition:"border .1s cubic-bezier(0.22, 0.61, 0.36, 1)",userSelect:"none",overflow:"hidden"}}},Rr.default.createElement(Ai,{SkeletonSx:{width:"100%"},fileId:c.image.uploadedFileId,height:u,src:c.image?.uploadedUrl||"",alt:`Variation 1 of ${s.length}`}))}))},y3=VL;var Ds=v(A()),RL=e=>{let{message:t}=e,{isDarkMode:o}=Zr(),{content:r,isLoading:n}=ot(),i=r.status===void 0?!n:r.status==="complete";return Ds.default.createElement("div",{"data-testid":"chat-ai-message--markdown","data-disabled-button-clicked":!0,className:`markdown-body ${o?"markdown-body-dark":""}`,translate:i?void 0:"no"},Ds.default.createElement(Ds.Suspense,{fallback:Ds.default.createElement(Br,{loading:!0})},Ds.default.createElement(Na,{appendLoadingDot:!i,message:t},r.text)))},b3=RL;var S3=v(A()),Ro=v(A()),UL=e=>{let{transcripts:t,loading:o}=e,{t:r}=k(),[n,i]=(0,S3.useState)({}),a=u=>{let m=document.createElement("textarea");return m.innerHTML=u.trim().replace(/\n/g,""),m.value},s=u=>{let d=u.split("[AI KNOWLEDGE]({})"),f=[];return d.forEach((h,C)=>{let x=h.trim();x&&f.push(x),C<d.length-1&&f.push(Ro.default.createElement(qC,null))}),f},l=u=>{n[u]=!n[u],i({...n})},c=!t||!Array.isArray(t),p=t?.length===0;return c?Ro.default.createElement(T,{fontSize:16,color:"error",sx:{p:0,flex:1}},r("package__features:chat__ai_message__youtube_summary__transcript_timestamped_error")):p?Ro.default.createElement(T,{fontSize:16,color:"text.primary",sx:{p:0,flex:1}},r("package__features:chat__ai_message__youtube_summary__not_have__transcript")):Ro.default.createElement(g,{gap:2},t.map((u,m)=>{if(u.text||u.status==="error"){let d=u?.children&&u?.children.length>0;return Ro.default.createElement(g,{key:u.start},Ro.default.createElement(g,{direction:"row",justifyContent:"flex-start",alignItems:"flex-start",spacing:1,key:m},Ro.default.createElement(Nh,{time:u.start,docId:u.docId,url:u.url}),u.status!=="error"&&Ro.default.createElement(g,{sx:{flex:1,cursor:d?"pointer":"default"},onClick:()=>u.id&&l(u.id)},Ro.default.createElement(T,{fontSize:16,color:"text.primary"},s(a(u.text||""))),d&&Ro.default.createElement(g,{direction:"row",alignItems:"center"},Ro.default.createElement(T,{fontSize:15,color:"text.secondary"},n[u.id||""]?r("package__features:chat__ai_message__youtube_summary__collapse"):r("package__features:chat__ai_message__youtube_summary__expand")),n[u.id||""]?Ro.default.createElement(X,{sx:{transform:"rotate(180deg)",color:f=>f.palette.mode==="dark"?"rgba(255, 255, 255, 0.7)":"rgba(0, 0, 0, 0.6)"},size:25,icon:"KeyboardArrowDown"}):Ro.default.createElement(X,{sx:{color:f=>f.palette.mode==="dark"?"rgba(255, 255, 255, 0.7)":"rgba(0, 0, 0, 0.6)"},size:25,icon:"KeyboardArrowDown"}))),u.status==="error"&&Ro.default.createElement(T,{fontSize:16,color:"error",sx:{p:0,flex:1}},r("package__features:chat__ai_message__youtube_summary__transcript_timestamped_error"))),u?.children&&n[u.id||""]&&u?.children?.map(f=>Ro.default.createElement(g,{direction:"row",justifyContent:"flex-start",alignItems:"flex-start",spacing:1,key:f.id,sx:{marginTop:"5px",marginLeft:"10px"}},Ro.default.createElement(Nh,{mode:"lite",time:f.start,docId:f.docId,url:f.url}),Ro.default.createElement(T,{fontSize:15,color:"text.secondary",onClick:()=>u.id&&l(u.id),sx:{p:0,flex:1,cursor:"pointer"}},s(a(f.text||""))))))}else if(o&&u.status==="loading")return Ro.default.createElement(Co,{key:m,variant:"rounded",width:"100%",height:15});return null}))},g0=UL;var WL=e=>{let{message:t,hasError:o}=e,{content:r,metadata:n,processingStep:i,isLoading:a}=ot(),s=()=>!_m(t)||i==="RESPONDING"||i==="RESPONDED"?r.contentType==="image"||n.artTextToImageMetadata||n.shareType==="art"?Hs.default.createElement(y3,{message:t}):(n.videoTimestamped?.length||n.videoTranscripts?.length)&&!r.text?null:Hs.default.createElement(b3,{message:t}):null;return Hs.default.createElement(Hs.default.Fragment,null,!o&&n.videoTimestamped&&Hs.default.createElement(g0,{transcripts:n.videoTimestamped,loading:a}),!o&&n.videoTranscripts&&Hs.default.createElement(g0,{transcripts:n.videoTranscripts,loading:a}),s())},x0=WL;var Xp=v(A()),GL=()=>{let[e,t]=(0,Xp.useState)(()=>window.location.href),[o,r]=(0,Xp.useState)(document.title),n=(0,Xp.useRef)(null),i=()=>{a(),n.current=setInterval(()=>{r(document.title),t(window.location.href)},1e3)},a=()=>{n.current&&clearInterval(n.current)};return{pageUrl:e,documentTitle:o,startListen:i,stopListen:a}},I3=GL;var v3=[{itemId:H2,count:10.2,timestamp:Date.now(),readonly:!0},{itemId:z2,count:10.3,timestamp:Date.now(),readonly:!0},{itemId:R2,count:10.2,timestamp:Date.now(),readonly:!0},{itemId:V2,count:10.1,timestamp:Date.now(),readonly:!0},{itemId:U2,count:10,timestamp:Date.now(),readonly:!0},{itemId:N2,count:10.2,timestamp:Date.now(),readonly:!0},{itemId:Ou,count:10.2,timestamp:Date.now(),readonly:!0},{itemId:Bu,count:10.1,timestamp:Date.now(),readonly:!0},{itemId:Fu,count:10.2,timestamp:Date.now(),readonly:!0},{itemId:ml,count:10.2,timestamp:Date.now(),readonly:!0}];var w3=[{title:"DOGE Has 'God Mode' Access to Government Data"},{title:"Dan Bongino Named FBI Deputy Director"},{title:"Anthropic Releases Hybrid Reasoning Model"},{title:"Microsoft Cancels AI Data Center Leases"},{title:"Indoor Scent Pollution Hazards"},{title:"Zelenskyy Offers to Resign for Peace"},{title:"SEC Drops OpenSea Investigation"},{title:"DOGE Tells Federal Employees Document Your Work"},{title:"NBA Debuts AI Training Robots"},{title:"Trump Fires Military Leaders"},{title:"Nadella Dismisses AGI Benchmarks"},{title:"SEC Approves Interest-Bearing Stablecoin"},{title:"Musk Recommends ISS Deorbit"},{title:"DeepSeek Plans R1 Code Release"},{title:"Chinese Team Finds New Bat Coronavirus"},{title:"DHS Revokes TPS for Haitians"},{title:"SEC To Drop Charges Against Coinbase"},{title:"FTC Investigates Big Tech Censorship"},{title:"Kash Patel Confirmed as FBI Director"},{title:"Trump and Zelenskyy Feud Over Peace Talks"}];var Yp=v(A()),ns=(e,t)=>{if(!e)return t;let o=e.toLowerCase();return t.filter(r=>r.prompt_title.toLowerCase().includes(o)||Ra(r.prompt_id,r.prompt_title).toLowerCase().includes(o))},jL=e=>{let{t}=k(),{contextMenuPath:o}=co(),{conversationId:r}=eo(),{selectedChatDocuments:n}=ki(),i=xr(r),{selectedType:a}=pn(),s=(0,Yp.useMemo)(()=>{let h=null;for(let C=i.length-1;C>=0;C--){let x=i[C];if(xm(x)){h=x;break}}return h?.meta?.messageChatDocuments||[]},[i]),{liteContextMenuActionsItems:l}=Hl(e,{selectionInputAble:!0}),c=Yy(),{contextMenuSuggestions:p}=ni("/rewrite",30),{contextMenuSuggestions:u}=ni("/my_own_tools",30),m=(0,Yp.useMemo)(()=>w3.map(h=>Dl({promptId:rr(),parentPromptId:Yc,promptTitle:h.title,question:h.title,icon:"Search"})),[t]),d=(0,Yp.useMemo)(()=>{let h=n.map(O=>O.maxAIDocumentId).filter(rm),C=h.length===s.length&&i.length>0;for(let O of s){let L=O.maxAIDocumentId;if(ws(O.id)&&(L=O.id),L&&!h.includes(L)){C=!1;break}}let x=[],_={prompt_id:Yc,parent_prompt_id:"",prompt_title:t("package__features:chat_box__auto_suggestion__suggested__title"),type:"group",children:[],actions:[]};if(x.push(_),C)return _.children=[],x;let y=n.length>0&&n.every(O=>O.maxAIDocumentType==="page_content__webpage"&&O.selected),b=n.length===1&&n[0].maxAIDocumentType==="page_content__youtube"&&n[0].selected,S=n.length===1&&n[0].maxAIDocumentType==="page_content__email"&&n[0].selected,I=n.length==1&&n[0].maxAIDocumentType==="search_results"&&n[0].selected,w=n.length>0&&n.every(O=>O.maxAIDocumentType==="image"&&O.selected),E=n.length>0&&n.every(O=>O.maxAIDocumentType!=="search_results"&&O.selected);if(y){let O=Hu.PAGE_SUMMARY;O&&_.children?.push(...ns(e,O(n)))}else if(b){let O=Hu.YOUTUBE_VIDEO_SUMMARY;O&&_.children?.push(...ns(e,O(n)))}else if(S){let O=Hu.DEFAULT_EMAIL_SUMMARY;O&&_.children?.push(...ns(e,O(n)))}else if(w){let O=[Dl({promptId:Ou,parentPromptId:_.prompt_id,icon:"DocumentScanner",promptTitle:t("package__features:chat_box__auto_suggestion__suggested__prompt__extract_text"),question:t("package__features:chat_box__auto_suggestion__suggested__prompt__extract_text")}),Dl({promptId:Bu,parentPromptId:_.prompt_id,icon:"Question",question:t("package__features:chat_box__auto_suggestion__suggested__prompt__explain_content"),promptTitle:t("package__features:chat_box__auto_suggestion__suggested__prompt__explain_content")})];_.children?.push(...ns(e,O))}else if(I)_.children?.push(...ns(e,m).slice(0,6));else if(E){let O=[Dl({promptId:Fu,parentPromptId:_.prompt_id,promptTitle:t("package__features:chat_box__auto_suggestion__suggested__prompt__summarize"),question:t("package__features:chat_box__auto_suggestion__suggested__prompt__summarize")})];_.children?.push(...ns(e,O))}if(!I){let O=ns(e,p),L=ns(e,u);_.children?.push(...O,...L),_.children.length&&c.length&&(_.children=c.map(G=>_.children.find(H=>H.prompt_id.replace(ir,"")===G)).filter(Boolean).slice(0,30))}if(e.trim()&&_.children?.length){let O=Dl({promptId:ml,parentPromptId:_.prompt_id,promptTitle:t("package__features:chat_box__auto_suggestion__suggested__prompt__ask_query",{QUERY:`"${e}"`}),question:e});I?_.children=[O,..._.children.slice(0,5)]:_.children.unshift(O)}return x},[i.length,c,u,p,s,n,e,t]),f=(0,Yp.useMemo)(()=>o===null&&a==="SUGGESTED"?d.filter(h=>(h.children||[]).length>0):l,[o,d,a,l]);return{query:e,selectedContextMenuList:f}},T3=jL;var C0=v(A()),qL=e=>{let{t}=k(),{onClick:o}=e;return C0.default.createElement(fe,{onClick:o,title:t("package__common:close"),placement:"bottom",sx:{width:"26px",height:"26px",padding:"8px"}},C0.default.createElement(X,{icon:"Close"}))},M3=qL;var Ns=v(A()),KL=e=>{let{sx:t,children:o,LiteContextMenuEditViewProps:r,LiteContextMenuPositionSettingsProps:n,isBottom:i,hideToolbar:a=!1}=e,{mode:s,contextMenuPath:l}=co(),{refetch:c}=Nn();return(0,Ns.useEffect)(()=>{c("SidebarLiteContextMenuLayout")},[l]),Ns.default.createElement(g,{sx:{width:"100%",height:"100%",...t}},s==="edit"&&Ns.default.createElement(Xy,{...n}),s==="list"&&o,s==="edit"&&Ns.default.createElement(Qy,{...r}),l!==null&&!a&&Ns.default.createElement(Jy,{sx:{...i?{borderTop:"1px solid",borderColor:"border.main",borderRadius:" 0 0 8px 8px"}:{borderBottom:"1px solid",borderColor:"border.main",borderRadius:"8px 8px 0 0"}}}))},E3=KL;var rt=v(A()),$L=e=>{let{sx:t,inputElementRef:o,onBeforeRunSuggestion:r,filterContextMenuList:n}=e,{t:i}=k(),{conversationId:a,inputMediator:s}=eo(),l=rt.default.useRef(null),{layout:c,conversationType:p}=be(Q=>({layout:Q.layout,conversationType:Q.conversationType})),{selectedType:u,resetMyOwnToolsType:m}=pn(),d=ye(a),f=xr(a),{loading:h,selectedChatDocuments:C}=ki(),x=C.length===1&&C[0].maxAIDocumentType==="search_results"&&u==="SUGGESTED",[_,y]=(0,rt.useState)(""),{selectedContextMenuList:b}=T3(_),S=(0,rt.useMemo)(()=>n?n(b):b,[b,n]);(0,rt.useEffect)(()=>{},[n]);let{askAIWithShortcutsV2:I}=ze(),w=c<=1&&f.length===0,[E,O]=(0,rt.useState)(!1),[L,G]=(0,rt.useState)(null),[H,V]=(0,rt.useState)(!0),W=(0,rt.useMemo)(()=>d,[h,d]),N=async Q=>{if(Q.actions){if(r&&!r(Q))return;await I(Q.actions,{isClearInput:!0,isFocusInput:!0})}};(0,rt.useEffect)(()=>{let Q=o?.current||Qt(p).ref;if(Q){let M=j=>{if(["ArrowUp","ArrowDown"].includes(j.key)){let re=j.key==="ArrowUp"?-1:1,ce=l.current?.querySelectorAll("[data-promptid]");if(ce&&ce.length>0){j.preventDefault(),O(!0);let Te=Array.from(ce).findIndex(Pe=>Pe.getAttribute("data-promptid")===L)+re,Ie=null;Te<0?Ie=ce[ce.length-1]:Te>=0&&Te<ce.length?Ie=ce[Te]:Ie=ce[0],G(Ie.getAttribute("data-promptid")),Ie.scrollIntoView({behavior:"instant",block:"nearest"})}}else if(j.key==="Enter"&&!s.isComposing){let re=l.current?.querySelector(`[data-promptid="${L}"]`);re&&(j.stopPropagation(),j.preventDefault(),re.click())}},le=()=>{y(Q.value)},ge=()=>{setTimeout(()=>{y(Q.value)},0),setTimeout(()=>{y(Q.value)},200)},P=()=>{O(!1)};Q.addEventListener("keydown",M,{capture:!0}),Q.addEventListener("input",le,{capture:!0}),Q.addEventListener("blur",ge),y(Q.value);let $=setInterval(()=>{y(Q.value)},1e3);return window.addEventListener("mousemove",P),()=>{clearInterval($),Q.removeEventListener("keydown",M,{capture:!0}),Q.removeEventListener("input",le,{capture:!0}),Q.removeEventListener("blur",ge),window.removeEventListener("mousemove",P)}}},[p,L]),(0,rt.useEffect)(()=>{let Q=null;for(let M of S)if(M.children.length>0){Q=M.children[0],Q.prompt_id===ml&&M.children[1]&&(Q=M.children[1]);break}G(Q?.prompt_id||null)},[S]),Lr(()=>{bm.getService("CONTEXT_MENU_SUGGEST").setReadonlyItems(v3)});let Z=(0,rt.useRef)(!1);(0,rt.useEffect)(()=>{if(Z.current){Z.current=!1;return}V(!0)},[f,C,u]);let J=S.length===0,K=f.length===0;return d?null:rt.default.createElement(g,{ref:l,"data-testid":"maxai--chat-auto-suggestion--container",sx:{...w?{borderTop:"1px solid",borderColor:"border.main",order:"2!important"}:{borderBottom:"1px solid",borderColor:"border.main",marginTop:"0px !important",order:"0!important"},...J?{border:"none"}:{},...E?{pointerEvents:"none"}:{},...H?{}:{display:"none"},gap:"10px","&:empty":{display:"none"},...t}},rt.default.createElement(E3,{hideToolbar:_!=="",isBottom:w,LiteContextMenuEditViewProps:{sx:{padding:"4px",maxHeight:"max(192px, 14vh)",overflowY:"auto",p:0}}},rt.default.createElement(Mi,{sx:{display:J?"none":"block",maxHeight:"max(192px, 14vh)",overflowY:"auto",padding:"4px"}},S.map((Q,M)=>{let le=Q.prompt_title,ge=`package__features:context_menu__prompt__${Q.prompt_id}`;return i(ge).includes(Q.prompt_id)||(le=i(ge)),rt.default.createElement(g,{key:Q.prompt_id},S.length>=1&&rt.default.createElement(g,{direction:"row",alignItems:"center",justifyContent:"space-between"},rt.default.createElement(T,{fontSize:"12px",fontWeight:400,height:"32px",px:"8px",textAlign:"left",lineHeight:"32px",color:"text.secondary"},le),rt.default.createElement(g,{direction:"row",gap:"6px",sx:{pr:"8px"}},!x&&[ir,Yc].includes(Q.prompt_id)&&rt.default.createElement(cc,null),!K&&M===0&&H&&rt.default.createElement(M3,{onClick:()=>{m(),u!=="SUGGESTED"&&(Z.current=!0),V(!1)}}))),Q.children?.map(P=>{if(P.type==="group")return P.children.map(j=>{let de=L===j.prompt_id;return rt.default.createElement(A3,{isSelected:de,key:P.prompt_id+P.prompt_title,contextMenuItem:j,parent:P,disabled:W,onMouseEnter:()=>{G(j.prompt_id)},onClick:async()=>{await N(j)}})});let $=L===P.prompt_id;return rt.default.createElement(A3,{isSelected:$,key:P.prompt_id+P.prompt_title,contextMenuItem:P,disabled:W,onMouseEnter:()=>{G(P.prompt_id)},onClick:async()=>{await N(P)}})}))}))))},A3=e=>{let{contextMenuItem:t,parent:o,disabled:r,onMouseEnter:n,onMouseLeave:i,onClick:a,isSelected:s}=e,{t:l}=k(),{selectedType:c}=pn(),p=t.prompt_icon||o?.prompt_icon,u=t.origin?.path||"",m=u&&u.startsWith("/rewrite"),d=u&&u.startsWith("/my_own_tools"),f=(0,rt.useMemo)(()=>{let C=t.prompt_title,x=t.prompt_id.startsWith(ir)?t.prompt_id.replace(ir,""):t.prompt_id,_=`package__features:context_menu__prompt__${x}`;if(l(_).includes(x)||(C=l(_)),o?.prompt_title&&o?.prompt_id){let y=o.prompt_title,b=`package__features:context_menu__prompt__${o.prompt_id}`;l(b).includes(o.prompt_id)||(y=l(b),C=`${y} -> ${C}`)}return C},[l]),h=Ha();return rt.default.createElement(Ct,{disabled:r,onClick:async()=>{if(!await nt({emitEvent:!0})){h.focus();return}a?.()},onMouseEnter:n,onMouseLeave:i,"data-testid":`maxai--chat-auto-suggestion--menu-item--${t.prompt_id}`,"data-promptid":t.prompt_id,key:t.prompt_id,sx:{padding:"6px 8px",height:"32px",boxSizing:"border-box",gap:"12px",alignItems:"center",borderRadius:"4px",color:"text.primary",minHeight:"unset","&:hover":{color:"text.primary"},...s?{bgcolor:C=>C.palette.mode==="dark"?"rgba(255, 255, 255, 0.06)!important":"rgba(0, 0, 0, 0.04)!important"}:{}}},p&&rt.default.createElement(X,{sx:{color:"text.secondary",flexShrink:0},icon:p,size:20}),rt.default.createElement(T,{width:0,flex:1,fontSize:"14px",fontWeight:400,textAlign:"left",color:"text.primary",noWrap:!0},f),m&&s&&c==="SUGGESTED"&&rt.default.createElement(T,{component:"span",sx:{border:"1px solid",borderColor:C=>C.palette.mode==="dark"?"rgba(255, 255, 255, 0.2)":"rgba(0, 0, 0, 0.1)",padding:"2px 4px",fontSize:"12px",borderRadius:"4px",color:C=>C.palette.mode==="dark"?"rgba(255, 255, 255, 0.38)":"rgba(0, 0, 0, 0.38)"}},l("package__features:chat__inputbox__button__my_own_tools__menu__rewrite")),d&&s&&c==="SUGGESTED"&&rt.default.createElement(T,{component:"span",sx:{border:"1px solid",borderColor:C=>C.palette.mode==="dark"?"rgba(255, 255, 255, 0.2)":"rgba(0, 0, 0, 0.1)",padding:"1px 4px",fontSize:"12px",borderRadius:"4px",color:C=>C.palette.mode==="dark"?"rgba(255, 255, 255, 0.38)":"rgba(0, 0, 0, 0.38)"}},l("package__features:chat__inputbox__button__my_own_tools__menu__my_own_tools")))},Af=$L;var P3=v(Ap());var Qo=v(A());var XL=e=>{let{value:t,onChange:o,onEnter:r,TextareaProps:n,error:i,sx:a,hideFooter:s=!1,onClickSuggestion:l,liteContextMenuPath:c}=e,{t:p}=k(),{chatMode:u}=Ya(),m=Zt(cy),d=Qo.default.useRef(null),f=(0,Qo.useCallback)(x=>{if(m==="UNKNOWN"||!c||op(c)!=="/compose_reply")return x;let _=y=>{let b=[];return m==="CHAT_APP_WEBSITE"&&b.push(...Eh,...Ph),m==="EMAIL"&&b.push(...Ah,...Ph),m==="SOCIAL_MEDIA"&&b.push(...Ah,...Eh),!b.includes(y.prompt_id.replace(ir,""))};return De(x).filter(y=>_(y)?(y.children&&(y.children=y.children.filter(b=>_(b))),!0):!1)},[m,c]),[h,C]=(0,Qo.useState)(!1);return Qo.default.createElement(g,{direction:"column",width:"100%",borderRadius:1,border:"1px solid",borderColor:`${i?"rgb(239, 83, 80)":"border.main"}`,boxShadow:"0px 1px 2px 0px rgba(0, 0, 0, 0.05)",boxSizing:"border-box",sx:{"& > *":{order:1},...a}},Qo.default.createElement(g,{"data-testid":"maxai--chat-box--chat-input--main",spacing:1,sx:{p:"10px"}},Qo.default.createElement(lc,{ref:d,"data-testid":"chat-input-textarea",value:t,onChangeText:x=>{o?.(x)},onEnter:r,stopPropagation:!0,...n}),!s&&Qo.default.createElement(F,{display:"flex",alignItems:"center",justifyContent:"space-between"},Qo.default.createElement(g,{direction:"row",spacing:1,sx:{display:h?"none":"flex"}},e.footerLeftNode),Qo.default.createElement(g,{direction:"row",spacing:1,flex:1,justifyContent:"flex-end"},u==="free_chat"||t!==""?Qo.default.createElement(fe,{title:p("package__features:chat__inputbox__button__send_to_ai__tooltip"),description:"\u23CE",tooltipProps:{sx:{minWidth:"unset",p:1}},variant:"contained","data-testid":"sidebar_actions__send_btn",sx:{width:32,height:32,minWidth:"unset",borderRadius:1,boxSizing:"border-box","&[disabled]":{color:"background.paper"},"&:hover":{color:x=>x.palette.mode==="dark"?"rgba(0, 0, 0, 0.87)":"rgba(255, 255, 255, 1)"}},disabled:!t,onClick:r,styleType:"default"},Qo.default.createElement(P3.default,{sx:{fontSize:"16px",color:"inherit !important"}})):Qo.default.createElement(ic,{value:{isVoiceInput:h,setIsVoiceInput:C}},Qo.default.createElement(ac,{onSpeechToTextSuccess:x=>{o?.(x),r?.()}}))))),c&&Qo.default.createElement(qa,{defaultContextMenuPath:op(c)},Qo.default.createElement(Af,{onBeforeRunSuggestion:x=>l?(l(x),!1):!0,inputElementRef:d,filterContextMenuList:f})))},k3=XL;var O3=v(On()),B3=v(Ap());var xe=v(A());var Pf=()=>{Ss.send("SetVariablesModalClose",{})},YL=e=>{let{onShow:t,onClose:o,sx:r}=e,{t:n}=k(),{setChatHubLoading:i}=yt(),{askAIWithShortcutsV2:a}=ze(),{chatMode:s}=Ya(),l=(0,xe.useRef)(null),[c,p]=(0,xe.useState)(!1),{conversationId:u}=ue(),[m,d]=(0,xe.useState)(!1),[f,h]=(0,xe.useState)(null),[C,x]=(0,xe.useState)(null),[_,y]=(0,xe.useState)(!1),[b,S]=(0,xe.useState)(!1),[I,w]=(0,xe.useState)(null),[E,O]=(0,xe.useState)(null),L=st(m),{control:G,trigger:H,reset:V,getValues:W,setValue:N,watch:Z}=mf({defaultValues:{textVariables:[],selectVariables:[]}}),J=Aa(),{fields:K}=u0({control:G,name:"textVariables"}),{fields:Q}=u0({control:G,name:"selectVariables"}),M=f!==null?Z(`textVariables.${f}.default_value`):null,le=(0,xe.useRef)(!1),ge=K.filter(U=>!U.hidden).length,P=W().textVariables.filter(U=>!U.hidden&&!U.default_value).length>0,$=st(C),[j,de]=(0,xe.useState)(!1),re=(0,xe.useMemo)(()=>s==="free_chat"?!1:_||b||j?!0:typeof f=="number"?!M:!1,[s,_,b,j,f,M]),ce=(0,xe.useMemo)(()=>I?.contextMenuId&&["47070ec6-8700-43fd-a519-20fe3841df38","9a65c4c0-c2b8-4fe1-a85e-0e2d84682eb1","b5381aa7-5ba3-4f96-a696-c694da938ef2"].includes(I.contextMenuId),[I?.contextMenuId]),ut=(0,xe.useRef)(),Te=(0,xe.useRef)(null),Ie=(0,xe.useRef)(!1),Pe=(0,xe.useCallback)(U=>{U!=="done"&&y(!1),de(!1),Te.current&&(Te.current.getTracks().forEach(ee=>ee.stop()),Te.current=null)},[]),qe=()=>{y(!0)},$e=U=>{Pe(U),mt($.current)},Nt=(0,xe.useCallback)(()=>{p(!1),V({textVariables:[],selectVariables:[]}),O(null),m&&(d(!1),x(0),o?.())},[o,V,m]),Re=st(Nt),mt=U=>{let ee=Array.from(l.current?.querySelectorAll('textarea:not([aria-hidden="true"])')||[]);if(typeof U=="number"&&ee[U])return ee[U].focus(),ee[U].setSelectionRange(ee[U].value.length,ee[U].value.length),!0;let D=ee.find(Y=>!Y.value);return D?(D.focus(),D.setSelectionRange(D.value.length,D.value.length),!1):!0},B=async()=>{!mt()||!await H()||I&&await R([{type:"ASK_CHATGPT",parameters:{AskChatGPTActionQuestion:{text:"",meta:qo([{MaxAIPromptActionConfig:I.MaxAIPromptActionConfig},I?.questionMeta||{}])}}}])},R=(0,xe.useCallback)(async(U,ee)=>{try{i(!0);let D=De(U),Y=ee?De(ee):{};if(!ee){let Fe=De(W());Fe.textVariables.concat(Fe.selectVariables).forEach(_t=>{Y[_t.name]={key:_t.name,value:_t.default_value,overwrite:!0,isBuiltIn:_t.hidden,label:_t.hint}})}if(s==="free_chat"){let Fe=Y.AI_RESPONSE_TONE;Fe&&(Fe.value="Default");let _t=Y.AI_RESPONSE_WRITING_STYLE;_t&&(_t.value="Default")}D.unshift({type:"SET_VARIABLE_MAP",parameters:{VariableMap:Y}});let oe=D.some(Fe=>{let _t=sy(Fe);if(_t?.path){let ae=op(_t.path);return["/refine_draft","/rewrite","/compose_new","/compose_reply"].includes(ae)}return!1});d(!1),o?.(),await a(D,{conversationId:u,disabledMaxAIDocumentIds:oe,keepLoadingAfterExecution:!0});let me=ri.getShortcutsEngine(u),ie=!0;if(me.status!=="stop"&&E&&(ie=!1,D[D.length-1].type!=="SET_VARIABLES_MODAL")){let Fe=ri.getShortcutsEngine(u),_t=await cn.getService().getMessageByType(u,"ai","latest");if(_t&&Fe.status==="idle"){ie=!1;let ae=De(ry);ae.variables=[Ue.PRESET_VARIABLE__REFINE_DRAFT__FOLLOW_UP_INSTRUCTION,{name:"SELECTED_TEXT",hint:"Text to rewrite",type:"text",hidden:!0,default_value:Dn(_t,!1)}],await Ss.send(`SetVariablesModal_${u}`,{task:"open",config:{title:E,contextMenuId:ae.prompt_id,variables:ae.variables,MaxAIPromptActionConfig:ae}})}}ie&&i(!1)}catch{i(!1)}},[a,s,u,E,W,o]),q=(0,xe.useCallback)(async(U,ee)=>{try{return p(!0),await FC.usePromptAction(u,ee,{chatMode:"free_chat",jsonMode:!0,taskId:U})}catch{return null}finally{p(!1)}},[u]),ne=(0,xe.useRef)(""),te=(0,xe.useCallback)(async U=>{let{task:ee,config:D}=U||{};ne.current&&Xr.abort(ne.current);let Y=rr();if(ne.current=Y,ee==="open"&&D){i(!0);let oe=D;oe?.contextMenuId&&["d833ef67-36fb-4228-8e04-4b6d7583a341","1cc8f601-27ac-474f-a70c-20ed1177711a","47070ec6-8700-43fd-a519-20fe3841df38","9a65c4c0-c2b8-4fe1-a85e-0e2d84682eb1","b5381aa7-5ba3-4f96-a696-c694da938ef2"].includes(oe.contextMenuId)&&O(Ra(oe?.MaxAIPromptActionConfig?.prompt_id||"",oe?.title||""));let me=await pc.getSetVariablesModalSelectCache();oe.variables=oe.variables?.map(ae=>(Object.prototype.hasOwnProperty.call(me,ae.name)&&(ae.default_value=me[ae.name]),ae))||[];let ie=(oe.variables||[]).filter(ae=>ae.type==="text"),Fe=(oe.variables||[]).filter(ae=>ae.type==="select");if(V({textVariables:ie,selectVariables:Fe}),oe.description?.label&&oe.extraDataByPromptAction?.prompt_id&&(oe.description.label=Ra(oe.extraDataByPromptAction.prompt_id,oe.description.label)),w(oe),oe.extraDataByPromptAction&&q(ne.current,oe.extraDataByPromptAction).then(ae=>{!ae||Y!==ne.current||w(je=>({...je,description:{icon:"LightBulb",label:"Intent",...je?.description,content:ae.intent}}))}),!(ie.length>0&&ie.some(ae=>!ae.hidden&&!ae.default_value))&&!D.disableAutoExecuteWhenAllVariableHaveValue){let ae=oe.variables||[],je={};ae.forEach(it=>{je[it.name]={key:it.name,value:it.default_value,overwrite:!0,isBuiltIn:it.hidden,label:it.hint}}),R([{type:"ASK_CHATGPT",parameters:{AskChatGPTActionQuestion:{text:"",meta:qo([{MaxAIPromptActionConfig:oe?.MaxAIPromptActionConfig},oe?.questionMeta||{}])}}}],je)}else d(!0),t?.(),setTimeout(()=>{mt()},0),i(!1);return{data:{},type:"confirm",success:!0}}},[R,q,t,V,i]);(0,xe.useEffect)(()=>{let U=Ss.receive(`SetVariablesModal_${u}`,te);return()=>{U()}},[u,te]),(0,xe.useEffect)(()=>{u&&Re.current()},[u]),(0,xe.useEffect)(()=>{let U=Ss.receive("SetVariablesModalClose",()=>{L.current&&Re.current()});return()=>{U()}},[]);let z=(0,xe.useRef)(null);return m?xe.default.createElement(g,{className:"max-ai__action__set_variables_modal",sx:{width:"100%",overflow:"hidden",pb:1,boxSizing:"border-box",...r,gap:"12px"},maxHeight:"100%",onKeyPressCapture:U=>{U.stopPropagation()},onKeyPress:U=>{U.stopPropagation()}},xe.default.createElement(g,{width:"100%",flexShrink:0},xe.default.createElement(g,{direction:"row",alignItems:"start",justifyContent:"space-between",width:"100%",sx:{bgcolor:"rgba(0, 0, 0, 0.87)",borderRadius:"8px",padding:"2px 2px 2px 12px",gap:"10px","&:has(+ .max-ai__action__set_variables_modal--description)":{borderRadius:"8px 8px 0 0"}}},xe.default.createElement(F,{width:0,flex:1,component:"div",display:"flex",alignItems:"center"},xe.default.createElement(T,{fontSize:"14px",color:"#fff",fontWeight:600,height:"32px",lineHeight:"30px",sx:{textAlign:"left",width:"100%"},noWrap:!0},Ra(I?.MaxAIPromptActionConfig?.prompt_id||"",I?.title||""))),xe.default.createElement(fe,{"data-testid":"close-modal-button",sx:{width:"32px",height:"32px",flexShrink:0},onMouseDown:()=>{Re.current()}},xe.default.createElement(O3.default,{sx:{fontSize:"20px",color:"#fff!important"}}))),I?.description&&xe.default.createElement(g,{className:"max-ai__action__set_variables_modal--description",sx:{padding:"8px",border:"1px solid",borderTop:"none",borderColor:"border.main",gap:"4px",width:"100%",borderRadius:"0 0 8px 8px"}},xe.default.createElement(g,{direction:"row",alignItems:"center",gap:"8px"},xe.default.createElement(X,{icon:I.description.icon,sx:{flexShrink:0,fontSize:"20px",color:"text.primary"}}),xe.default.createElement(T,{fontSize:"14px",color:"text.primary",fontWeight:500,lineHeight:"20px",width:0,flex:1,noWrap:!0},I.description.label)),c?xe.default.createElement(g,null,xe.default.createElement(Co,{height:21,animation:"wave"})):xe.default.createElement(Si,{in:!0},xe.default.createElement(T,{fontSize:"14px",color:"text.secondary",fontWeight:400,lineHeight:"21px"},I.description.content)))),xe.default.createElement(g,{direction:"row",alignItems:"center",gap:"4px",sx:{height:"32px",width:"100%"}},xe.default.createElement(Za,null),s!=="free_chat"&&xe.default.createElement(rs,null),s!=="free_chat"&&xe.default.createElement(Qa,null)),xe.default.createElement(g,{component:"div",direction:"row",flexWrap:"wrap",flex:1,height:0,sx:{marginTop:"-8px",gap:"8px",overflowY:"auto",scrollbarColor:"auto","&::-webkit-scrollbar":{width:"7px"},"&::-webkit-scrollbar-thumb":{borderRadius:"20px",backgroundColor:"text.secondary"}},ref:l},ge===1&&K.map((U,ee)=>U.hidden?null:xe.default.createElement(fc,{control:G,rules:{required:!0},key:U.name,render:({field:D})=>xe.default.createElement(k3,{"data-testid":`custom-variable--${U.name}`,value:D.value||"",onChange:D.onChange,TextareaProps:{minLine:4,placeholder:(U.hintI18nKey?n(U.hintI18nKey):U.hint)||`Enter ${U.name}`},onEnter:B,onClickSuggestion:async Y=>{await R(Y.actions)},liteContextMenuPath:ce?I?.MaxAIPromptActionConfig?.path:void 0,footerLeftNode:ce?xe.default.createElement(xe.default.Fragment,null,s!=="free_chat"&&Q.map((Y,oe)=>Y.hidden?null:xe.default.createElement(fc,{key:Y.name,control:G,name:`selectVariables.${oe}.default_value`,defaultValue:Y.default_value,render:({field:me})=>xe.default.createElement(tf,{systemVariableSelectKey:Y.name,key:Y.name,defaultValue:me.value,onChange:ie=>{pc.setVariablesModalSelectCache(Y.name,ie),me.onChange(ie)}})}))):null}),name:`textVariables.${ee}.default_value`})),ge>1&&xe.default.createElement(xe.default.Fragment,null,K.map((U,ee)=>{let D=(J==="lg"||J==="xl")&&K.length>1?"calc(50% - 8px)":"100%";return U.hidden?null:xe.default.createElement(fc,{control:G,rules:{required:!0},key:U.name,name:`textVariables.${ee}.default_value`,render:({field:Y})=>xe.default.createElement(Ut,{fullWidth:!0,"data-testid":`custom-variable--${U.name}`,size:"small",key:U.name,label:U.hint||"Label",value:Y.value||"",sx:{width:D,mt:"8px"},InputProps:{sx:{fontSize:"16px",minHeight:"63px"}},inputProps:{style:{fontSize:"16px",textAlign:"left"}},FormHelperTextProps:{sx:{ml:0,fontSize:"12px"}},onChange:oe=>{Y.onChange(oe.target.value)},onKeyUp:oe=>{oe.stopPropagation()},onKeyDown:async oe=>{oe.key==="Enter"&&!oe.shiftKey&&!le.current?(oe.stopPropagation(),oe.preventDefault(),B()):oe.stopPropagation()},onCompositionStart:()=>{le.current=!0},onCompositionEnd:()=>{le.current=!1},onPaste:oe=>{oe.stopPropagation()},onFocus:oe=>{h(ee),x(ee)},onBlur:()=>{h(null)},InputLabelProps:{shrink:!0,sx:{fontSize:"16px"}},multiline:!0,placeholder:U.hint||`Enter ${U.name}`,minRows:2,maxRows:2})})}),xe.default.createElement(g,{direction:"row",alignItems:"center",justifyContent:"end",width:"100%"},re?xe.default.createElement(ac,{onMouseDown:async()=>{try{if(Ie.current)return;z.current&&clearTimeout(z.current),S(!0),clearTimeout(ut.current),Ie.current=!0,Te.current=await navigator.mediaDevices.getUserMedia({audio:!0}),Ie.current=!1,de(!0),window.addEventListener("mouseup",()=>{Ie.current||(clearTimeout(ut.current),ut.current=setTimeout(()=>{S(!1)},200))},{once:!0})}catch{Ie.current=!1,z.current=setTimeout(()=>{S(!1)},3e3)}},onStartRecording:qe,onStopRecording:$e,onSpeechToTextSuccess:U=>{$.current!==null&&(N(`textVariables.${$.current}.default_value`,U),mt($.current),y(!1))},onSpeechToTextFinally:()=>{Pe()}}):xe.default.createElement(fe,{title:n("package__features:chat__inputbox__button__send_to_ai__tooltip"),description:"\u23CE",tooltipProps:{sx:{minWidth:"unset",p:1}},variant:"contained","data-testid":"sidebar_actions__send_btn",sx:{width:32,height:32,minWidth:"unset",borderRadius:1,boxSizing:"border-box","&[disabled]":{color:"background.paper"},"&:hover":{color:U=>U.palette.mode==="dark"?"rgba(0, 0, 0, 0.87)":"rgba(255, 255, 255, 1)"}},disabled:P,onClick:B,styleType:"default"},xe.default.createElement(B3.default,{sx:{fontSize:"16px",color:"inherit !important"}})))))):null},F3=YL;var D3=()=>{let e=document.createElement("div");e.contentEditable="true",e.style.all="initial",e.style.position="absolute",e.style.top="-9999px",e.style.left="-9999px",e.style.width="1px",e.style.height="1px",e.style.overflow="hidden",document.body.appendChild(e),e.focus(),document.execCommand("paste",!1,"");let t=document.createElement("div");return e.childNodes.forEach(o=>{t.appendChild(o.cloneNode(!0))}),e.remove(),t},pi=e=>{let t=[];return e.forEach(o=>{document.querySelectorAll(o).forEach(r=>{r instanceof HTMLElement&&t.push(r)})}),t},Lf=e=>{e.focus(),document.execCommand("selectAll",!1,""),document.execCommand("paste",!1,""),(e.lastElementChild||e).scrollIntoView({block:"center",inline:"center"})},H3={selectors:['div[id][contenteditable="true"]'],insertContent:async(e,t,o)=>{let r=H3.selectors,n=o||pi(r)[0];if(!n){let d=pi([".amn .ams.bkH",".amn .ams.bkI"]),f=d[d.length-1];f&&(f.click(),await wh(document.body,r[0],100,5e3),n=pi(r)[0])}if(!n)return;let i=document.createElement("div");i.className="F0iAze";let a=D3();a.className="Znr6db";let s=document.createElement("br");a.appendChild(s),i.appendChild(a),n.scrollIntoView({block:"center",inline:"center"});let l=!1,c=Array.from(n.children);c.length===1&&(c=Array.from(c[0].children)),c.forEach(d=>{(d.tagName==="HR"||d.matches(".gmail_quote")||d.querySelector(".gmail_quote"))&&(l=!0),!l&&d.remove()}),n.focus(),n.prepend(i);let p=document.createRange();p.selectNodeContents(a),p.collapse(!1);let u=window.getSelection();u?.removeAllRanges(),u?.addRange(p),(a.lastElementChild||a).scrollIntoView({block:"center",inline:"center"}),setTimeout(()=>{i.classList.remove("F0iAze")},1e3)}},kf={selectors:['div[id^=editor] div[aria-multiline][spellcheck][contenteditable="true"]'],insertContent:async(e,t,o)=>{let r=kf.selectors,n=o||pi(r)[0];if(!n){let m=pi(['button[role="menuitem"]:has(i[data-icon-name="ArrowReplyRegular"])','button[role="menuitem"]:has(i[data-icon-name="ArrowReplyAllRegular"])']),d=m[m.length-1];d&&(d.click(),await wh(document.body,r[0],100,5e3),n=pi(r)[0])}if(!n)return;let i=document.createElement("div"),a=D3();a.innerHTML=a.innerHTML.replace(/\n/g,"<br />");let s=document.createElement("br");a.appendChild(s),i.appendChild(a);let l=!1;Array.from(n.children).forEach(m=>{(m.id.includes("RplyFwdMsg")||m.matches("#divRplyFwdMsg")||m.matches("#RplyFwdMsg")||m.querySelector("#divRplyFwdMsg")||m.querySelector("#RplyFwdMsg")||m.tagName==="HR")&&(l=!0),!l&&m.remove()}),n.focus(),n.prepend(i);let c=document.createRange();c.selectNodeContents(a),c.collapse(!1);let p=window.getSelection();p?.removeAllRanges(),p?.addRange(c),(a.lastElementChild||a).scrollIntoView({block:"center",inline:"center"})}},N3={selectors:["div[id][contenteditable]","div#contents ytd-commentbox:not([hidden]) div[id][contenteditable]"],insertContent:async(e,t,o)=>{let r=N3.selectors,n=o||pi(r)[0];n&&Lf(n)}},z3={selectors:['div.ql-editor[contenteditable="true"]','div.msg-form__contenteditable[contenteditable="true"]'],insertContent:async(e,t,o)=>{let r=z3.selectors,n=o||pi(r)[0];n&&Lf(n)}},V3={selectors:['div.ql-editor[contenteditable="true"]'],insertContent:async(e,t,o)=>{let r=V3.selectors,n=o||pi(r)[0];n&&Lf(n)}};var R3={selectors:['[class^="channelTextArea"] [class^="textArea"] div[role="textbox"][contenteditable="true"]'],insertContent:async(e,t,o)=>{let r=R3.selectors,n=o||pi(r)[0];n&&Lf(n)}};var U3={selectors:["textarea[id]"],insertContent:async(e,t,o)=>{let r=U3.selectors,n=o||pi(r)[0];n&&(n.focus(),n.select(),document.execCommand("paste",!1,""),n.setSelectionRange(n.value.length,n.value.length),n.scrollIntoView())}},W3={"outlook.live.com":kf,"outlook.office.com":kf,"outlook.office365.com":kf,"mail.google.com":H3,"youtube.com":N3,"studio.youtube.com":U3,"linkedin.com":z3,"app.slack.com":V3,"discord.com":R3};var uo=v(A());var ZL={};function zs(e,t){let o=t||ZL,r=typeof o.includeImageAlt=="boolean"?o.includeImageAlt:!0,n=typeof o.includeHtml=="boolean"?o.includeHtml:!0;return j3(e,r,n)}function j3(e,t,o){if(QL(e)){if("value"in e)return e.type==="html"&&!o?"":e.value;if(t&&"alt"in e&&e.alt)return e.alt;if("children"in e)return G3(e.children,t,o)}return Array.isArray(e)?G3(e,t,o):""}function G3(e,t,o){let r=[],n=-1;for(;++n<e.length;)r[n]=j3(e[n],t,o);return r.join("")}function QL(e){return!!(e&&typeof e=="object")}function vr(e,t,o,r){let n=e.length,i=0,a;if(t<0?t=-t>n?0:n+t:t=t>n?n:t,o=o>0?o:0,r.length<1e4)a=Array.from(r),a.unshift(t,o),e.splice(...a);else for(o&&e.splice(t,o);i<r.length;)a=r.slice(i,i+1e4),a.unshift(t,0),e.splice(...a),i+=1e4,t+=1e4}function Ur(e,t){return e.length>0?(vr(e,e.length,0,t),e):t}var q3={}.hasOwnProperty;function K3(e){let t={},o=-1;for(;++o<e.length;)JL(t,e[o]);return t}function JL(e,t){let o;for(o in t){let n=(q3.call(e,o)?e[o]:void 0)||(e[o]={}),i=t[o],a;if(i)for(a in i){q3.call(n,a)||(n[a]=[]);let s=i[a];eO(n[a],Array.isArray(s)?s:s?[s]:[])}}}function eO(e,t){let o=-1,r=[];for(;++o<t.length;)(t[o].add==="after"?e:r).push(t[o]);vr(e,0,0,r)}function Of(e,t){let o=Number.parseInt(e,t);return o<9||o===11||o>13&&o<32||o>126&&o<160||o>55295&&o<57344||o>64975&&o<65008||(o&65535)===65535||(o&65535)===65534||o>1114111?"\uFFFD":String.fromCodePoint(o)}function da(e){return e.replace(/[\t\n\r ]+/g," ").replace(/^ | $/g,"").toLowerCase().toUpperCase()}var gn=is(/[A-Za-z]/),Wr=is(/[\dA-Za-z]/),$3=is(/[#-'*+\--9=?A-Z^-~]/);function Zp(e){return e!==null&&(e<32||e===127)}var Qp=is(/\d/),X3=is(/[\dA-Fa-f]/),Y3=is(/[!-/:-@[-`{-~]/);function _e(e){return e!==null&&e<-2}function So(e){return e!==null&&(e<0||e===32)}function Oe(e){return e===-2||e===-1||e===32}var Z3=is(/\p{P}|\p{S}/u),Q3=is(/\s/);function is(e){return t;function t(o){return o!==null&&o>-1&&e.test(String.fromCharCode(o))}}function Be(e,t,o,r){let n=r?r-1:Number.POSITIVE_INFINITY,i=0;return a;function a(l){return Oe(l)?(e.enter(o),s(l)):t(l)}function s(l){return Oe(l)&&i++<n?(e.consume(l),s):(e.exit(o),t(l))}}var J3={tokenize:tO};function tO(e){let t=e.attempt(this.parser.constructs.contentInitial,r,n),o;return t;function r(s){if(s===null){e.consume(s);return}return e.enter("lineEnding"),e.consume(s),e.exit("lineEnding"),Be(e,t,"linePrefix")}function n(s){return e.enter("paragraph"),i(s)}function i(s){let l=e.enter("chunkText",{contentType:"text",previous:o});return o&&(o.next=l),o=l,a(s)}function a(s){if(s===null){e.exit("chunkText"),e.exit("paragraph"),e.consume(s);return}return _e(s)?(e.consume(s),e.exit("chunkText"),i):(e.consume(s),a)}}var t8={tokenize:oO},e8={tokenize:rO};function oO(e){let t=this,o=[],r=0,n,i,a;return s;function s(y){if(r<o.length){let b=o[r];return t.containerState=b[1],e.attempt(b[0].continuation,l,c)(y)}return c(y)}function l(y){if(r++,t.containerState._closeFlow){t.containerState._closeFlow=void 0,n&&_();let b=t.events.length,S=b,I;for(;S--;)if(t.events[S][0]==="exit"&&t.events[S][1].type==="chunkFlow"){I=t.events[S][1].end;break}x(r);let w=b;for(;w<t.events.length;)t.events[w][1].end=Object.assign({},I),w++;return vr(t.events,S+1,0,t.events.slice(b)),t.events.length=w,c(y)}return s(y)}function c(y){if(r===o.length){if(!n)return m(y);if(n.currentConstruct&&n.currentConstruct.concrete)return f(y);t.interrupt=!!(n.currentConstruct&&!n._gfmTableDynamicInterruptHack)}return t.containerState={},e.check(e8,p,u)(y)}function p(y){return n&&_(),x(r),m(y)}function u(y){return t.parser.lazy[t.now().line]=r!==o.length,a=t.now().offset,f(y)}function m(y){return t.containerState={},e.attempt(e8,d,f)(y)}function d(y){return r++,o.push([t.currentConstruct,t.containerState]),m(y)}function f(y){if(y===null){n&&_(),x(0),e.consume(y);return}return n=n||t.parser.flow(t.now()),e.enter("chunkFlow",{contentType:"flow",previous:i,_tokenizer:n}),h(y)}function h(y){if(y===null){C(e.exit("chunkFlow"),!0),x(0),e.consume(y);return}return _e(y)?(e.consume(y),C(e.exit("chunkFlow")),r=0,t.interrupt=void 0,s):(e.consume(y),h)}function C(y,b){let S=t.sliceStream(y);if(b&&S.push(null),y.previous=i,i&&(i.next=y),i=y,n.defineSkip(y.start),n.write(S),t.parser.lazy[y.start.line]){let I=n.events.length;for(;I--;)if(n.events[I][1].start.offset<a&&(!n.events[I][1].end||n.events[I][1].end.offset>a))return;let w=t.events.length,E=w,O,L;for(;E--;)if(t.events[E][0]==="exit"&&t.events[E][1].type==="chunkFlow"){if(O){L=t.events[E][1].end;break}O=!0}for(x(r),I=w;I<t.events.length;)t.events[I][1].end=Object.assign({},L),I++;vr(t.events,E+1,0,t.events.slice(w)),t.events.length=I}}function x(y){let b=o.length;for(;b-- >y;){let S=o[b];t.containerState=S[1],S[0].exit.call(t,e)}o.length=y}function _(){n.write([null]),i=void 0,n=void 0,t.containerState._closeFlow=void 0}}function rO(e,t,o){return Be(e,e.attempt(this.parser.constructs.document,t,o),"linePrefix",this.parser.constructs.disable.null.includes("codeIndented")?void 0:4)}function y0(e){if(e===null||So(e)||Q3(e))return 1;if(Z3(e))return 2}function vc(e,t,o){let r=[],n=-1;for(;++n<e.length;){let i=e[n].resolveAll;i&&!r.includes(i)&&(t=i(t,o),r.push(i))}return t}var Jp={name:"attention",tokenize:iO,resolveAll:nO};function nO(e,t){let o=-1,r,n,i,a,s,l,c,p;for(;++o<e.length;)if(e[o][0]==="enter"&&e[o][1].type==="attentionSequence"&&e[o][1]._close){for(r=o;r--;)if(e[r][0]==="exit"&&e[r][1].type==="attentionSequence"&&e[r][1]._open&&t.sliceSerialize(e[r][1]).charCodeAt(0)===t.sliceSerialize(e[o][1]).charCodeAt(0)){if((e[r][1]._close||e[o][1]._open)&&(e[o][1].end.offset-e[o][1].start.offset)%3&&!((e[r][1].end.offset-e[r][1].start.offset+e[o][1].end.offset-e[o][1].start.offset)%3))continue;l=e[r][1].end.offset-e[r][1].start.offset>1&&e[o][1].end.offset-e[o][1].start.offset>1?2:1;let u=Object.assign({},e[r][1].end),m=Object.assign({},e[o][1].start);o8(u,-l),o8(m,l),a={type:l>1?"strongSequence":"emphasisSequence",start:u,end:Object.assign({},e[r][1].end)},s={type:l>1?"strongSequence":"emphasisSequence",start:Object.assign({},e[o][1].start),end:m},i={type:l>1?"strongText":"emphasisText",start:Object.assign({},e[r][1].end),end:Object.assign({},e[o][1].start)},n={type:l>1?"strong":"emphasis",start:Object.assign({},a.start),end:Object.assign({},s.end)},e[r][1].end=Object.assign({},a.start),e[o][1].start=Object.assign({},s.end),c=[],e[r][1].end.offset-e[r][1].start.offset&&(c=Ur(c,[["enter",e[r][1],t],["exit",e[r][1],t]])),c=Ur(c,[["enter",n,t],["enter",a,t],["exit",a,t],["enter",i,t]]),c=Ur(c,vc(t.parser.constructs.insideSpan.null,e.slice(r+1,o),t)),c=Ur(c,[["exit",i,t],["enter",s,t],["exit",s,t],["exit",n,t]]),e[o][1].end.offset-e[o][1].start.offset?(p=2,c=Ur(c,[["enter",e[o][1],t],["exit",e[o][1],t]])):p=0,vr(e,r-1,o-r+3,c),o=r+c.length-p-2;break}}for(o=-1;++o<e.length;)e[o][1].type==="attentionSequence"&&(e[o][1].type="data");return e}function iO(e,t){let o=this.parser.constructs.attentionMarkers.null,r=this.previous,n=y0(r),i;return a;function a(l){return i=l,e.enter("attentionSequence"),s(l)}function s(l){if(l===i)return e.consume(l),s;let c=e.exit("attentionSequence"),p=y0(l),u=!p||p===2&&n||o.includes(l),m=!n||n===2&&p||o.includes(r);return c._open=!!(i===42?u:u&&(n||!m)),c._close=!!(i===42?m:m&&(p||!u)),t(l)}}function o8(e,t){e.column+=t,e.offset+=t,e._bufferIndex+=t}var b0={name:"autolink",tokenize:aO};function aO(e,t,o){let r=0;return n;function n(d){return e.enter("autolink"),e.enter("autolinkMarker"),e.consume(d),e.exit("autolinkMarker"),e.enter("autolinkProtocol"),i}function i(d){return gn(d)?(e.consume(d),a):d===64?o(d):c(d)}function a(d){return d===43||d===45||d===46||Wr(d)?(r=1,s(d)):c(d)}function s(d){return d===58?(e.consume(d),r=0,l):(d===43||d===45||d===46||Wr(d))&&r++<32?(e.consume(d),s):(r=0,c(d))}function l(d){return d===62?(e.exit("autolinkProtocol"),e.enter("autolinkMarker"),e.consume(d),e.exit("autolinkMarker"),e.exit("autolink"),t):d===null||d===32||d===60||Zp(d)?o(d):(e.consume(d),l)}function c(d){return d===64?(e.consume(d),p):$3(d)?(e.consume(d),c):o(d)}function p(d){return Wr(d)?u(d):o(d)}function u(d){return d===46?(e.consume(d),r=0,p):d===62?(e.exit("autolinkProtocol").type="autolinkEmail",e.enter("autolinkMarker"),e.consume(d),e.exit("autolinkMarker"),e.exit("autolink"),t):m(d)}function m(d){if((d===45||Wr(d))&&r++<63){let f=d===45?m:u;return e.consume(d),f}return o(d)}}var as={tokenize:sO,partial:!0};function sO(e,t,o){return r;function r(i){return Oe(i)?Be(e,n,"linePrefix")(i):n(i)}function n(i){return i===null||_e(i)?t(i):o(i)}}var Bf={name:"blockQuote",tokenize:lO,continuation:{tokenize:cO},exit:pO};function lO(e,t,o){let r=this;return n;function n(a){if(a===62){let s=r.containerState;return s.open||(e.enter("blockQuote",{_container:!0}),s.open=!0),e.enter("blockQuotePrefix"),e.enter("blockQuoteMarker"),e.consume(a),e.exit("blockQuoteMarker"),i}return o(a)}function i(a){return Oe(a)?(e.enter("blockQuotePrefixWhitespace"),e.consume(a),e.exit("blockQuotePrefixWhitespace"),e.exit("blockQuotePrefix"),t):(e.exit("blockQuotePrefix"),t(a))}}function cO(e,t,o){let r=this;return n;function n(a){return Oe(a)?Be(e,i,"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(a):i(a)}function i(a){return e.attempt(Bf,t,o)(a)}}function pO(e){e.exit("blockQuote")}var Ff={name:"characterEscape",tokenize:uO};function uO(e,t,o){return r;function r(i){return e.enter("characterEscape"),e.enter("escapeMarker"),e.consume(i),e.exit("escapeMarker"),n}function n(i){return Y3(i)?(e.enter("characterEscapeValue"),e.consume(i),e.exit("characterEscapeValue"),e.exit("characterEscape"),t):o(i)}}var Df={name:"characterReference",tokenize:mO};function mO(e,t,o){let r=this,n=0,i,a;return s;function s(u){return e.enter("characterReference"),e.enter("characterReferenceMarker"),e.consume(u),e.exit("characterReferenceMarker"),l}function l(u){return u===35?(e.enter("characterReferenceMarkerNumeric"),e.consume(u),e.exit("characterReferenceMarkerNumeric"),c):(e.enter("characterReferenceValue"),i=31,a=Wr,p(u))}function c(u){return u===88||u===120?(e.enter("characterReferenceMarkerHexadecimal"),e.consume(u),e.exit("characterReferenceMarkerHexadecimal"),e.enter("characterReferenceValue"),i=6,a=X3,p):(e.enter("characterReferenceValue"),i=7,a=Qp,p(u))}function p(u){if(u===59&&n){let m=e.exit("characterReferenceValue");return a===Wr&&!El(r.sliceSerialize(m))?o(u):(e.enter("characterReferenceMarker"),e.consume(u),e.exit("characterReferenceMarker"),e.exit("characterReference"),t)}return a(u)&&n++<i?(e.consume(u),p):o(u)}}var r8={tokenize:fO,partial:!0},Hf={name:"codeFenced",tokenize:dO,concrete:!0};function dO(e,t,o){let r=this,n={tokenize:S,partial:!0},i=0,a=0,s;return l;function l(I){return c(I)}function c(I){let w=r.events[r.events.length-1];return i=w&&w[1].type==="linePrefix"?w[2].sliceSerialize(w[1],!0).length:0,s=I,e.enter("codeFenced"),e.enter("codeFencedFence"),e.enter("codeFencedFenceSequence"),p(I)}function p(I){return I===s?(a++,e.consume(I),p):a<3?o(I):(e.exit("codeFencedFenceSequence"),Oe(I)?Be(e,u,"whitespace")(I):u(I))}function u(I){return I===null||_e(I)?(e.exit("codeFencedFence"),r.interrupt?t(I):e.check(r8,h,b)(I)):(e.enter("codeFencedFenceInfo"),e.enter("chunkString",{contentType:"string"}),m(I))}function m(I){return I===null||_e(I)?(e.exit("chunkString"),e.exit("codeFencedFenceInfo"),u(I)):Oe(I)?(e.exit("chunkString"),e.exit("codeFencedFenceInfo"),Be(e,d,"whitespace")(I)):I===96&&I===s?o(I):(e.consume(I),m)}function d(I){return I===null||_e(I)?u(I):(e.enter("codeFencedFenceMeta"),e.enter("chunkString",{contentType:"string"}),f(I))}function f(I){return I===null||_e(I)?(e.exit("chunkString"),e.exit("codeFencedFenceMeta"),u(I)):I===96&&I===s?o(I):(e.consume(I),f)}function h(I){return e.attempt(n,b,C)(I)}function C(I){return e.enter("lineEnding"),e.consume(I),e.exit("lineEnding"),x}function x(I){return i>0&&Oe(I)?Be(e,_,"linePrefix",i+1)(I):_(I)}function _(I){return I===null||_e(I)?e.check(r8,h,b)(I):(e.enter("codeFlowValue"),y(I))}function y(I){return I===null||_e(I)?(e.exit("codeFlowValue"),_(I)):(e.consume(I),y)}function b(I){return e.exit("codeFenced"),t(I)}function S(I,w,E){let O=0;return L;function L(N){return I.enter("lineEnding"),I.consume(N),I.exit("lineEnding"),G}function G(N){return I.enter("codeFencedFence"),Oe(N)?Be(I,H,"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(N):H(N)}function H(N){return N===s?(I.enter("codeFencedFenceSequence"),V(N)):E(N)}function V(N){return N===s?(O++,I.consume(N),V):O>=a?(I.exit("codeFencedFenceSequence"),Oe(N)?Be(I,W,"whitespace")(N):W(N)):E(N)}function W(N){return N===null||_e(N)?(I.exit("codeFencedFence"),w(N)):E(N)}}}function fO(e,t,o){let r=this;return n;function n(a){return a===null?o(a):(e.enter("lineEnding"),e.consume(a),e.exit("lineEnding"),i)}function i(a){return r.parser.lazy[r.now().line]?o(a):t(a)}}var eu={name:"codeIndented",tokenize:gO},hO={tokenize:xO,partial:!0};function gO(e,t,o){let r=this;return n;function n(c){return e.enter("codeIndented"),Be(e,i,"linePrefix",5)(c)}function i(c){let p=r.events[r.events.length-1];return p&&p[1].type==="linePrefix"&&p[2].sliceSerialize(p[1],!0).length>=4?a(c):o(c)}function a(c){return c===null?l(c):_e(c)?e.attempt(hO,a,l)(c):(e.enter("codeFlowValue"),s(c))}function s(c){return c===null||_e(c)?(e.exit("codeFlowValue"),a(c)):(e.consume(c),s)}function l(c){return e.exit("codeIndented"),t(c)}}function xO(e,t,o){let r=this;return n;function n(a){return r.parser.lazy[r.now().line]?o(a):_e(a)?(e.enter("lineEnding"),e.consume(a),e.exit("lineEnding"),n):Be(e,i,"linePrefix",5)(a)}function i(a){let s=r.events[r.events.length-1];return s&&s[1].type==="linePrefix"&&s[2].sliceSerialize(s[1],!0).length>=4?t(a):_e(a)?n(a):o(a)}}var S0={name:"codeText",tokenize:yO,resolve:_O,previous:CO};function _O(e){let t=e.length-4,o=3,r,n;if((e[o][1].type==="lineEnding"||e[o][1].type==="space")&&(e[t][1].type==="lineEnding"||e[t][1].type==="space")){for(r=o;++r<t;)if(e[r][1].type==="codeTextData"){e[o][1].type="codeTextPadding",e[t][1].type="codeTextPadding",o+=2,t-=2;break}}for(r=o-1,t++;++r<=t;)n===void 0?r!==t&&e[r][1].type!=="lineEnding"&&(n=r):(r===t||e[r][1].type==="lineEnding")&&(e[n][1].type="codeTextData",r!==n+2&&(e[n][1].end=e[r-1][1].end,e.splice(n+2,r-n-2),t-=r-n-2,r=n+2),n=void 0);return e}function CO(e){return e!==96||this.events[this.events.length-1][1].type==="characterEscape"}function yO(e,t,o){let r=this,n=0,i,a;return s;function s(m){return e.enter("codeText"),e.enter("codeTextSequence"),l(m)}function l(m){return m===96?(e.consume(m),n++,l):(e.exit("codeTextSequence"),c(m))}function c(m){return m===null?o(m):m===32?(e.enter("space"),e.consume(m),e.exit("space"),c):m===96?(a=e.enter("codeTextSequence"),i=0,u(m)):_e(m)?(e.enter("lineEnding"),e.consume(m),e.exit("lineEnding"),c):(e.enter("codeTextData"),p(m))}function p(m){return m===null||m===32||m===96||_e(m)?(e.exit("codeTextData"),c(m)):(e.consume(m),p)}function u(m){return m===96?(e.consume(m),i++,u):i===n?(e.exit("codeTextSequence"),e.exit("codeText"),t(m)):(a.type="codeTextData",p(m))}}var Nf=class{constructor(t){this.left=t?[...t]:[],this.right=[]}get(t){if(t<0||t>=this.left.length+this.right.length)throw new RangeError("Cannot access index `"+t+"` in a splice buffer of size `"+(this.left.length+this.right.length)+"`");return t<this.left.length?this.left[t]:this.right[this.right.length-t+this.left.length-1]}get length(){return this.left.length+this.right.length}shift(){return this.setCursor(0),this.right.pop()}slice(t,o){let r=o??Number.POSITIVE_INFINITY;return r<this.left.length?this.left.slice(t,r):t>this.left.length?this.right.slice(this.right.length-r+this.left.length,this.right.length-t+this.left.length).reverse():this.left.slice(t).concat(this.right.slice(this.right.length-r+this.left.length).reverse())}splice(t,o,r){let n=o||0;this.setCursor(Math.trunc(t));let i=this.right.splice(this.right.length-n,Number.POSITIVE_INFINITY);return r&&tu(this.left,r),i.reverse()}pop(){return this.setCursor(Number.POSITIVE_INFINITY),this.left.pop()}push(t){this.setCursor(Number.POSITIVE_INFINITY),this.left.push(t)}pushMany(t){this.setCursor(Number.POSITIVE_INFINITY),tu(this.left,t)}unshift(t){this.setCursor(0),this.right.push(t)}unshiftMany(t){this.setCursor(0),tu(this.right,t.reverse())}setCursor(t){if(!(t===this.left.length||t>this.left.length&&this.right.length===0||t<0&&this.left.length===0))if(t<this.left.length){let o=this.left.splice(t,Number.POSITIVE_INFINITY);tu(this.right,o.reverse())}else{let o=this.right.splice(this.left.length+this.right.length-t,Number.POSITIVE_INFINITY);tu(this.left,o.reverse())}}};function tu(e,t){let o=0;if(t.length<1e4)e.push(...t);else for(;o<t.length;)e.push(...t.slice(o,o+1e4)),o+=1e4}function zf(e){let t={},o=-1,r,n,i,a,s,l,c,p=new Nf(e);for(;++o<p.length;){for(;o in t;)o=t[o];if(r=p.get(o),o&&r[1].type==="chunkFlow"&&p.get(o-1)[1].type==="listItemPrefix"&&(l=r[1]._tokenizer.events,i=0,i<l.length&&l[i][1].type==="lineEndingBlank"&&(i+=2),i<l.length&&l[i][1].type==="content"))for(;++i<l.length&&l[i][1].type!=="content";)l[i][1].type==="chunkText"&&(l[i][1]._isInFirstContentOfListItem=!0,i++);if(r[0]==="enter")r[1].contentType&&(Object.assign(t,bO(p,o)),o=t[o],c=!0);else if(r[1]._container){for(i=o,n=void 0;i--&&(a=p.get(i),a[1].type==="lineEnding"||a[1].type==="lineEndingBlank");)a[0]==="enter"&&(n&&(p.get(n)[1].type="lineEndingBlank"),a[1].type="lineEnding",n=i);n&&(r[1].end=Object.assign({},p.get(n)[1].start),s=p.slice(n,o),s.unshift(r),p.splice(n,o-n+1,s))}}return vr(e,0,Number.POSITIVE_INFINITY,p.slice(0)),!c}function bO(e,t){let o=e.get(t)[1],r=e.get(t)[2],n=t-1,i=[],a=o._tokenizer||r.parser[o.contentType](o.start),s=a.events,l=[],c={},p,u,m=-1,d=o,f=0,h=0,C=[h];for(;d;){for(;e.get(++n)[1]!==d;);i.push(n),d._tokenizer||(p=r.sliceStream(d),d.next||p.push(null),u&&a.defineSkip(d.start),d._isInFirstContentOfListItem&&(a._gfmTasklistFirstContentOfListItem=!0),a.write(p),d._isInFirstContentOfListItem&&(a._gfmTasklistFirstContentOfListItem=void 0)),u=d,d=d.next}for(d=o;++m<s.length;)s[m][0]==="exit"&&s[m-1][0]==="enter"&&s[m][1].type===s[m-1][1].type&&s[m][1].start.line!==s[m][1].end.line&&(h=m+1,C.push(h),d._tokenizer=void 0,d.previous=void 0,d=d.next);for(a.events=[],d?(d._tokenizer=void 0,d.previous=void 0):C.pop(),m=C.length;m--;){let x=s.slice(C[m],C[m+1]),_=i.pop();l.push([_,_+x.length-1]),e.splice(_,2,x)}for(l.reverse(),m=-1;++m<l.length;)c[f+l[m][0]]=f+l[m][1],f+=l[m][1]-l[m][0]-1;return c}var I0={tokenize:vO,resolve:IO},SO={tokenize:wO,partial:!0};function IO(e){return zf(e),e}function vO(e,t){let o;return r;function r(s){return e.enter("content"),o=e.enter("chunkContent",{contentType:"content"}),n(s)}function n(s){return s===null?i(s):_e(s)?e.check(SO,a,i)(s):(e.consume(s),n)}function i(s){return e.exit("chunkContent"),e.exit("content"),t(s)}function a(s){return e.consume(s),e.exit("chunkContent"),o.next=e.enter("chunkContent",{contentType:"content",previous:o}),o=o.next,n}}function wO(e,t,o){let r=this;return n;function n(a){return e.exit("chunkContent"),e.enter("lineEnding"),e.consume(a),e.exit("lineEnding"),Be(e,i,"linePrefix")}function i(a){if(a===null||_e(a))return o(a);let s=r.events[r.events.length-1];return!r.parser.constructs.disable.null.includes("codeIndented")&&s&&s[1].type==="linePrefix"&&s[2].sliceSerialize(s[1],!0).length>=4?t(a):e.interrupt(r.parser.constructs.flow,o,t)(a)}}function Vf(e,t,o,r,n,i,a,s,l){let c=l||Number.POSITIVE_INFINITY,p=0;return u;function u(x){return x===60?(e.enter(r),e.enter(n),e.enter(i),e.consume(x),e.exit(i),m):x===null||x===32||x===41||Zp(x)?o(x):(e.enter(r),e.enter(a),e.enter(s),e.enter("chunkString",{contentType:"string"}),h(x))}function m(x){return x===62?(e.enter(i),e.consume(x),e.exit(i),e.exit(n),e.exit(r),t):(e.enter(s),e.enter("chunkString",{contentType:"string"}),d(x))}function d(x){return x===62?(e.exit("chunkString"),e.exit(s),m(x)):x===null||x===60||_e(x)?o(x):(e.consume(x),x===92?f:d)}function f(x){return x===60||x===62||x===92?(e.consume(x),d):d(x)}function h(x){return!p&&(x===null||x===41||So(x))?(e.exit("chunkString"),e.exit(s),e.exit(a),e.exit(r),t(x)):p<c&&x===40?(e.consume(x),p++,h):x===41?(e.consume(x),p--,h):x===null||x===32||x===40||Zp(x)?o(x):(e.consume(x),x===92?C:h)}function C(x){return x===40||x===41||x===92?(e.consume(x),h):h(x)}}function Rf(e,t,o,r,n,i){let a=this,s=0,l;return c;function c(d){return e.enter(r),e.enter(n),e.consume(d),e.exit(n),e.enter(i),p}function p(d){return s>999||d===null||d===91||d===93&&!l||d===94&&!s&&"_hiddenFootnoteSupport"in a.parser.constructs?o(d):d===93?(e.exit(i),e.enter(n),e.consume(d),e.exit(n),e.exit(r),t):_e(d)?(e.enter("lineEnding"),e.consume(d),e.exit("lineEnding"),p):(e.enter("chunkString",{contentType:"string"}),u(d))}function u(d){return d===null||d===91||d===93||_e(d)||s++>999?(e.exit("chunkString"),p(d)):(e.consume(d),l||(l=!Oe(d)),d===92?m:u)}function m(d){return d===91||d===92||d===93?(e.consume(d),s++,u):u(d)}}function Uf(e,t,o,r,n,i){let a;return s;function s(m){return m===34||m===39||m===40?(e.enter(r),e.enter(n),e.consume(m),e.exit(n),a=m===40?41:m,l):o(m)}function l(m){return m===a?(e.enter(n),e.consume(m),e.exit(n),e.exit(r),t):(e.enter(i),c(m))}function c(m){return m===a?(e.exit(i),l(a)):m===null?o(m):_e(m)?(e.enter("lineEnding"),e.consume(m),e.exit("lineEnding"),Be(e,c,"linePrefix")):(e.enter("chunkString",{contentType:"string"}),p(m))}function p(m){return m===a||m===null||_e(m)?(e.exit("chunkString"),c(m)):(e.consume(m),m===92?u:p)}function u(m){return m===a||m===92?(e.consume(m),p):p(m)}}function Vs(e,t){let o;return r;function r(n){return _e(n)?(e.enter("lineEnding"),e.consume(n),e.exit("lineEnding"),o=!0,r):Oe(n)?Be(e,r,o?"linePrefix":"lineSuffix")(n):t(n)}}var v0={name:"definition",tokenize:MO},TO={tokenize:EO,partial:!0};function MO(e,t,o){let r=this,n;return i;function i(d){return e.enter("definition"),a(d)}function a(d){return Rf.call(r,e,s,o,"definitionLabel","definitionLabelMarker","definitionLabelString")(d)}function s(d){return n=da(r.sliceSerialize(r.events[r.events.length-1][1]).slice(1,-1)),d===58?(e.enter("definitionMarker"),e.consume(d),e.exit("definitionMarker"),l):o(d)}function l(d){return So(d)?Vs(e,c)(d):c(d)}function c(d){return Vf(e,p,o,"definitionDestination","definitionDestinationLiteral","definitionDestinationLiteralMarker","definitionDestinationRaw","definitionDestinationString")(d)}function p(d){return e.attempt(TO,u,u)(d)}function u(d){return Oe(d)?Be(e,m,"whitespace")(d):m(d)}function m(d){return d===null||_e(d)?(e.exit("definition"),r.parser.defined.push(n),t(d)):o(d)}}function EO(e,t,o){return r;function r(s){return So(s)?Vs(e,n)(s):o(s)}function n(s){return Uf(e,i,o,"definitionTitle","definitionTitleMarker","definitionTitleString")(s)}function i(s){return Oe(s)?Be(e,a,"whitespace")(s):a(s)}function a(s){return s===null||_e(s)?t(s):o(s)}}var w0={name:"hardBreakEscape",tokenize:AO};function AO(e,t,o){return r;function r(i){return e.enter("hardBreakEscape"),e.consume(i),n}function n(i){return _e(i)?(e.exit("hardBreakEscape"),t(i)):o(i)}}var T0={name:"headingAtx",tokenize:kO,resolve:PO};function PO(e,t){let o=e.length-2,r=3,n,i;return e[r][1].type==="whitespace"&&(r+=2),o-2>r&&e[o][1].type==="whitespace"&&(o-=2),e[o][1].type==="atxHeadingSequence"&&(r===o-1||o-4>r&&e[o-2][1].type==="whitespace")&&(o-=r+1===o?2:4),o>r&&(n={type:"atxHeadingText",start:e[r][1].start,end:e[o][1].end},i={type:"chunkText",start:e[r][1].start,end:e[o][1].end,contentType:"text"},vr(e,r,o-r+1,[["enter",n,t],["enter",i,t],["exit",i,t],["exit",n,t]])),e}function kO(e,t,o){let r=0;return n;function n(p){return e.enter("atxHeading"),i(p)}function i(p){return e.enter("atxHeadingSequence"),a(p)}function a(p){return p===35&&r++<6?(e.consume(p),a):p===null||So(p)?(e.exit("atxHeadingSequence"),s(p)):o(p)}function s(p){return p===35?(e.enter("atxHeadingSequence"),l(p)):p===null||_e(p)?(e.exit("atxHeading"),t(p)):Oe(p)?Be(e,s,"whitespace")(p):(e.enter("atxHeadingText"),c(p))}function l(p){return p===35?(e.consume(p),l):(e.exit("atxHeadingSequence"),s(p))}function c(p){return p===null||p===35||So(p)?(e.exit("atxHeadingText"),s(p)):(e.consume(p),c)}}var n8=["address","article","aside","base","basefont","blockquote","body","caption","center","col","colgroup","dd","details","dialog","dir","div","dl","dt","fieldset","figcaption","figure","footer","form","frame","frameset","h1","h2","h3","h4","h5","h6","head","header","hr","html","iframe","legend","li","link","main","menu","menuitem","nav","noframes","ol","optgroup","option","p","param","search","section","summary","table","tbody","td","tfoot","th","thead","title","tr","track","ul"],M0=["pre","script","style","textarea"];var E0={name:"htmlFlow",tokenize:FO,resolveTo:BO,concrete:!0},LO={tokenize:HO,partial:!0},OO={tokenize:DO,partial:!0};function BO(e){let t=e.length;for(;t--&&!(e[t][0]==="enter"&&e[t][1].type==="htmlFlow"););return t>1&&e[t-2][1].type==="linePrefix"&&(e[t][1].start=e[t-2][1].start,e[t+1][1].start=e[t-2][1].start,e.splice(t-2,2)),e}function FO(e,t,o){let r=this,n,i,a,s,l;return c;function c(P){return p(P)}function p(P){return e.enter("htmlFlow"),e.enter("htmlFlowData"),e.consume(P),u}function u(P){return P===33?(e.consume(P),m):P===47?(e.consume(P),i=!0,h):P===63?(e.consume(P),n=3,r.interrupt?t:M):gn(P)?(e.consume(P),a=String.fromCharCode(P),C):o(P)}function m(P){return P===45?(e.consume(P),n=2,d):P===91?(e.consume(P),n=5,s=0,f):gn(P)?(e.consume(P),n=4,r.interrupt?t:M):o(P)}function d(P){return P===45?(e.consume(P),r.interrupt?t:M):o(P)}function f(P){let $="CDATA[";return P===$.charCodeAt(s++)?(e.consume(P),s===$.length?r.interrupt?t:H:f):o(P)}function h(P){return gn(P)?(e.consume(P),a=String.fromCharCode(P),C):o(P)}function C(P){if(P===null||P===47||P===62||So(P)){let $=P===47,j=a.toLowerCase();return!$&&!i&&M0.includes(j)?(n=1,r.interrupt?t(P):H(P)):n8.includes(a.toLowerCase())?(n=6,$?(e.consume(P),x):r.interrupt?t(P):H(P)):(n=7,r.interrupt&&!r.parser.lazy[r.now().line]?o(P):i?_(P):y(P))}return P===45||Wr(P)?(e.consume(P),a+=String.fromCharCode(P),C):o(P)}function x(P){return P===62?(e.consume(P),r.interrupt?t:H):o(P)}function _(P){return Oe(P)?(e.consume(P),_):L(P)}function y(P){return P===47?(e.consume(P),L):P===58||P===95||gn(P)?(e.consume(P),b):Oe(P)?(e.consume(P),y):L(P)}function b(P){return P===45||P===46||P===58||P===95||Wr(P)?(e.consume(P),b):S(P)}function S(P){return P===61?(e.consume(P),I):Oe(P)?(e.consume(P),S):y(P)}function I(P){return P===null||P===60||P===61||P===62||P===96?o(P):P===34||P===39?(e.consume(P),l=P,w):Oe(P)?(e.consume(P),I):E(P)}function w(P){return P===l?(e.consume(P),l=null,O):P===null||_e(P)?o(P):(e.consume(P),w)}function E(P){return P===null||P===34||P===39||P===47||P===60||P===61||P===62||P===96||So(P)?S(P):(e.consume(P),E)}function O(P){return P===47||P===62||Oe(P)?y(P):o(P)}function L(P){return P===62?(e.consume(P),G):o(P)}function G(P){return P===null||_e(P)?H(P):Oe(P)?(e.consume(P),G):o(P)}function H(P){return P===45&&n===2?(e.consume(P),Z):P===60&&n===1?(e.consume(P),J):P===62&&n===4?(e.consume(P),le):P===63&&n===3?(e.consume(P),M):P===93&&n===5?(e.consume(P),Q):_e(P)&&(n===6||n===7)?(e.exit("htmlFlowData"),e.check(LO,ge,V)(P)):P===null||_e(P)?(e.exit("htmlFlowData"),V(P)):(e.consume(P),H)}function V(P){return e.check(OO,W,ge)(P)}function W(P){return e.enter("lineEnding"),e.consume(P),e.exit("lineEnding"),N}function N(P){return P===null||_e(P)?V(P):(e.enter("htmlFlowData"),H(P))}function Z(P){return P===45?(e.consume(P),M):H(P)}function J(P){return P===47?(e.consume(P),a="",K):H(P)}function K(P){if(P===62){let $=a.toLowerCase();return M0.includes($)?(e.consume(P),le):H(P)}return gn(P)&&a.length<8?(e.consume(P),a+=String.fromCharCode(P),K):H(P)}function Q(P){return P===93?(e.consume(P),M):H(P)}function M(P){return P===62?(e.consume(P),le):P===45&&n===2?(e.consume(P),M):H(P)}function le(P){return P===null||_e(P)?(e.exit("htmlFlowData"),ge(P)):(e.consume(P),le)}function ge(P){return e.exit("htmlFlow"),t(P)}}function DO(e,t,o){let r=this;return n;function n(a){return _e(a)?(e.enter("lineEnding"),e.consume(a),e.exit("lineEnding"),i):o(a)}function i(a){return r.parser.lazy[r.now().line]?o(a):t(a)}}function HO(e,t,o){return r;function r(n){return e.enter("lineEnding"),e.consume(n),e.exit("lineEnding"),e.attempt(as,t,o)}}var A0={name:"htmlText",tokenize:NO};function NO(e,t,o){let r=this,n,i,a;return s;function s(M){return e.enter("htmlText"),e.enter("htmlTextData"),e.consume(M),l}function l(M){return M===33?(e.consume(M),c):M===47?(e.consume(M),S):M===63?(e.consume(M),y):gn(M)?(e.consume(M),E):o(M)}function c(M){return M===45?(e.consume(M),p):M===91?(e.consume(M),i=0,f):gn(M)?(e.consume(M),_):o(M)}function p(M){return M===45?(e.consume(M),d):o(M)}function u(M){return M===null?o(M):M===45?(e.consume(M),m):_e(M)?(a=u,J(M)):(e.consume(M),u)}function m(M){return M===45?(e.consume(M),d):u(M)}function d(M){return M===62?Z(M):M===45?m(M):u(M)}function f(M){let le="CDATA[";return M===le.charCodeAt(i++)?(e.consume(M),i===le.length?h:f):o(M)}function h(M){return M===null?o(M):M===93?(e.consume(M),C):_e(M)?(a=h,J(M)):(e.consume(M),h)}function C(M){return M===93?(e.consume(M),x):h(M)}function x(M){return M===62?Z(M):M===93?(e.consume(M),x):h(M)}function _(M){return M===null||M===62?Z(M):_e(M)?(a=_,J(M)):(e.consume(M),_)}function y(M){return M===null?o(M):M===63?(e.consume(M),b):_e(M)?(a=y,J(M)):(e.consume(M),y)}function b(M){return M===62?Z(M):y(M)}function S(M){return gn(M)?(e.consume(M),I):o(M)}function I(M){return M===45||Wr(M)?(e.consume(M),I):w(M)}function w(M){return _e(M)?(a=w,J(M)):Oe(M)?(e.consume(M),w):Z(M)}function E(M){return M===45||Wr(M)?(e.consume(M),E):M===47||M===62||So(M)?O(M):o(M)}function O(M){return M===47?(e.consume(M),Z):M===58||M===95||gn(M)?(e.consume(M),L):_e(M)?(a=O,J(M)):Oe(M)?(e.consume(M),O):Z(M)}function L(M){return M===45||M===46||M===58||M===95||Wr(M)?(e.consume(M),L):G(M)}function G(M){return M===61?(e.consume(M),H):_e(M)?(a=G,J(M)):Oe(M)?(e.consume(M),G):O(M)}function H(M){return M===null||M===60||M===61||M===62||M===96?o(M):M===34||M===39?(e.consume(M),n=M,V):_e(M)?(a=H,J(M)):Oe(M)?(e.consume(M),H):(e.consume(M),W)}function V(M){return M===n?(e.consume(M),n=void 0,N):M===null?o(M):_e(M)?(a=V,J(M)):(e.consume(M),V)}function W(M){return M===null||M===34||M===39||M===60||M===61||M===96?o(M):M===47||M===62||So(M)?O(M):(e.consume(M),W)}function N(M){return M===47||M===62||So(M)?O(M):o(M)}function Z(M){return M===62?(e.consume(M),e.exit("htmlTextData"),e.exit("htmlText"),t):o(M)}function J(M){return e.exit("htmlTextData"),e.enter("lineEnding"),e.consume(M),e.exit("lineEnding"),K}function K(M){return Oe(M)?Be(e,Q,"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(M):Q(M)}function Q(M){return e.enter("htmlTextData"),a(M)}}var Rs={name:"labelEnd",tokenize:GO,resolveTo:WO,resolveAll:UO},zO={tokenize:jO},VO={tokenize:qO},RO={tokenize:KO};function UO(e){let t=-1;for(;++t<e.length;){let o=e[t][1];(o.type==="labelImage"||o.type==="labelLink"||o.type==="labelEnd")&&(e.splice(t+1,o.type==="labelImage"?4:2),o.type="data",t++)}return e}function WO(e,t){let o=e.length,r=0,n,i,a,s;for(;o--;)if(n=e[o][1],i){if(n.type==="link"||n.type==="labelLink"&&n._inactive)break;e[o][0]==="enter"&&n.type==="labelLink"&&(n._inactive=!0)}else if(a){if(e[o][0]==="enter"&&(n.type==="labelImage"||n.type==="labelLink")&&!n._balanced&&(i=o,n.type!=="labelLink")){r=2;break}}else n.type==="labelEnd"&&(a=o);let l={type:e[i][1].type==="labelLink"?"link":"image",start:Object.assign({},e[i][1].start),end:Object.assign({},e[e.length-1][1].end)},c={type:"label",start:Object.assign({},e[i][1].start),end:Object.assign({},e[a][1].end)},p={type:"labelText",start:Object.assign({},e[i+r+2][1].end),end:Object.assign({},e[a-2][1].start)};return s=[["enter",l,t],["enter",c,t]],s=Ur(s,e.slice(i+1,i+r+3)),s=Ur(s,[["enter",p,t]]),s=Ur(s,vc(t.parser.constructs.insideSpan.null,e.slice(i+r+4,a-3),t)),s=Ur(s,[["exit",p,t],e[a-2],e[a-1],["exit",c,t]]),s=Ur(s,e.slice(a+1)),s=Ur(s,[["exit",l,t]]),vr(e,i,e.length,s),e}function GO(e,t,o){let r=this,n=r.events.length,i,a;for(;n--;)if((r.events[n][1].type==="labelImage"||r.events[n][1].type==="labelLink")&&!r.events[n][1]._balanced){i=r.events[n][1];break}return s;function s(m){return i?i._inactive?u(m):(a=r.parser.defined.includes(da(r.sliceSerialize({start:i.end,end:r.now()}))),e.enter("labelEnd"),e.enter("labelMarker"),e.consume(m),e.exit("labelMarker"),e.exit("labelEnd"),l):o(m)}function l(m){return m===40?e.attempt(zO,p,a?p:u)(m):m===91?e.attempt(VO,p,a?c:u)(m):a?p(m):u(m)}function c(m){return e.attempt(RO,p,u)(m)}function p(m){return t(m)}function u(m){return i._balanced=!0,o(m)}}function jO(e,t,o){return r;function r(u){return e.enter("resource"),e.enter("resourceMarker"),e.consume(u),e.exit("resourceMarker"),n}function n(u){return So(u)?Vs(e,i)(u):i(u)}function i(u){return u===41?p(u):Vf(e,a,s,"resourceDestination","resourceDestinationLiteral","resourceDestinationLiteralMarker","resourceDestinationRaw","resourceDestinationString",32)(u)}function a(u){return So(u)?Vs(e,l)(u):p(u)}function s(u){return o(u)}function l(u){return u===34||u===39||u===40?Uf(e,c,o,"resourceTitle","resourceTitleMarker","resourceTitleString")(u):p(u)}function c(u){return So(u)?Vs(e,p)(u):p(u)}function p(u){return u===41?(e.enter("resourceMarker"),e.consume(u),e.exit("resourceMarker"),e.exit("resource"),t):o(u)}}function qO(e,t,o){let r=this;return n;function n(s){return Rf.call(r,e,i,a,"reference","referenceMarker","referenceString")(s)}function i(s){return r.parser.defined.includes(da(r.sliceSerialize(r.events[r.events.length-1][1]).slice(1,-1)))?t(s):o(s)}function a(s){return o(s)}}function KO(e,t,o){return r;function r(i){return e.enter("reference"),e.enter("referenceMarker"),e.consume(i),e.exit("referenceMarker"),n}function n(i){return i===93?(e.enter("referenceMarker"),e.consume(i),e.exit("referenceMarker"),e.exit("reference"),t):o(i)}}var P0={name:"labelStartImage",tokenize:$O,resolveAll:Rs.resolveAll};function $O(e,t,o){let r=this;return n;function n(s){return e.enter("labelImage"),e.enter("labelImageMarker"),e.consume(s),e.exit("labelImageMarker"),i}function i(s){return s===91?(e.enter("labelMarker"),e.consume(s),e.exit("labelMarker"),e.exit("labelImage"),a):o(s)}function a(s){return s===94&&"_hiddenFootnoteSupport"in r.parser.constructs?o(s):t(s)}}var k0={name:"labelStartLink",tokenize:XO,resolveAll:Rs.resolveAll};function XO(e,t,o){let r=this;return n;function n(a){return e.enter("labelLink"),e.enter("labelMarker"),e.consume(a),e.exit("labelMarker"),e.exit("labelLink"),i}function i(a){return a===94&&"_hiddenFootnoteSupport"in r.parser.constructs?o(a):t(a)}}var ou={name:"lineEnding",tokenize:YO};function YO(e,t){return o;function o(r){return e.enter("lineEnding"),e.consume(r),e.exit("lineEnding"),Be(e,t,"linePrefix")}}var Us={name:"thematicBreak",tokenize:ZO};function ZO(e,t,o){let r=0,n;return i;function i(c){return e.enter("thematicBreak"),a(c)}function a(c){return n=c,s(c)}function s(c){return c===n?(e.enter("thematicBreakSequence"),l(c)):r>=3&&(c===null||_e(c))?(e.exit("thematicBreak"),t(c)):o(c)}function l(c){return c===n?(e.consume(c),r++,l):(e.exit("thematicBreakSequence"),Oe(c)?Be(e,s,"whitespace")(c):s(c))}}var wr={name:"list",tokenize:eB,continuation:{tokenize:tB},exit:rB},QO={tokenize:nB,partial:!0},JO={tokenize:oB,partial:!0};function eB(e,t,o){let r=this,n=r.events[r.events.length-1],i=n&&n[1].type==="linePrefix"?n[2].sliceSerialize(n[1],!0).length:0,a=0;return s;function s(d){let f=r.containerState.type||(d===42||d===43||d===45?"listUnordered":"listOrdered");if(f==="listUnordered"?!r.containerState.marker||d===r.containerState.marker:Qp(d)){if(r.containerState.type||(r.containerState.type=f,e.enter(f,{_container:!0})),f==="listUnordered")return e.enter("listItemPrefix"),d===42||d===45?e.check(Us,o,c)(d):c(d);if(!r.interrupt||d===49)return e.enter("listItemPrefix"),e.enter("listItemValue"),l(d)}return o(d)}function l(d){return Qp(d)&&++a<10?(e.consume(d),l):(!r.interrupt||a<2)&&(r.containerState.marker?d===r.containerState.marker:d===41||d===46)?(e.exit("listItemValue"),c(d)):o(d)}function c(d){return e.enter("listItemMarker"),e.consume(d),e.exit("listItemMarker"),r.containerState.marker=r.containerState.marker||d,e.check(as,r.interrupt?o:p,e.attempt(QO,m,u))}function p(d){return r.containerState.initialBlankLine=!0,i++,m(d)}function u(d){return Oe(d)?(e.enter("listItemPrefixWhitespace"),e.consume(d),e.exit("listItemPrefixWhitespace"),m):o(d)}function m(d){return r.containerState.size=i+r.sliceSerialize(e.exit("listItemPrefix"),!0).length,t(d)}}function tB(e,t,o){let r=this;return r.containerState._closeFlow=void 0,e.check(as,n,i);function n(s){return r.containerState.furtherBlankLines=r.containerState.furtherBlankLines||r.containerState.initialBlankLine,Be(e,t,"listItemIndent",r.containerState.size+1)(s)}function i(s){return r.containerState.furtherBlankLines||!Oe(s)?(r.containerState.furtherBlankLines=void 0,r.containerState.initialBlankLine=void 0,a(s)):(r.containerState.furtherBlankLines=void 0,r.containerState.initialBlankLine=void 0,e.attempt(JO,t,a)(s))}function a(s){return r.containerState._closeFlow=!0,r.interrupt=void 0,Be(e,e.attempt(wr,t,o),"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(s)}}function oB(e,t,o){let r=this;return Be(e,n,"listItemIndent",r.containerState.size+1);function n(i){let a=r.events[r.events.length-1];return a&&a[1].type==="listItemIndent"&&a[2].sliceSerialize(a[1],!0).length===r.containerState.size?t(i):o(i)}}function rB(e){e.exit(this.containerState.type)}function nB(e,t,o){let r=this;return Be(e,n,"listItemPrefixWhitespace",r.parser.constructs.disable.null.includes("codeIndented")?void 0:5);function n(i){let a=r.events[r.events.length-1];return!Oe(i)&&a&&a[1].type==="listItemPrefixWhitespace"?t(i):o(i)}}var Wf={name:"setextUnderline",tokenize:aB,resolveTo:iB};function iB(e,t){let o=e.length,r,n,i;for(;o--;)if(e[o][0]==="enter"){if(e[o][1].type==="content"){r=o;break}e[o][1].type==="paragraph"&&(n=o)}else e[o][1].type==="content"&&e.splice(o,1),!i&&e[o][1].type==="definition"&&(i=o);let a={type:"setextHeading",start:Object.assign({},e[n][1].start),end:Object.assign({},e[e.length-1][1].end)};return e[n][1].type="setextHeadingText",i?(e.splice(n,0,["enter",a,t]),e.splice(i+1,0,["exit",e[r][1],t]),e[r][1].end=Object.assign({},e[i][1].end)):e[r][1]=a,e.push(["exit",a,t]),e}function aB(e,t,o){let r=this,n;return i;function i(c){let p=r.events.length,u;for(;p--;)if(r.events[p][1].type!=="lineEnding"&&r.events[p][1].type!=="linePrefix"&&r.events[p][1].type!=="content"){u=r.events[p][1].type==="paragraph";break}return!r.parser.lazy[r.now().line]&&(r.interrupt||u)?(e.enter("setextHeadingLine"),n=c,a(c)):o(c)}function a(c){return e.enter("setextHeadingLineSequence"),s(c)}function s(c){return c===n?(e.consume(c),s):(e.exit("setextHeadingLineSequence"),Oe(c)?Be(e,l,"lineSuffix")(c):l(c))}function l(c){return c===null||_e(c)?(e.exit("setextHeadingLine"),t(c)):o(c)}}var i8={tokenize:sB};function sB(e){let t=this,o=e.attempt(as,r,e.attempt(this.parser.constructs.flowInitial,n,Be(e,e.attempt(this.parser.constructs.flow,n,e.attempt(I0,n)),"linePrefix")));return o;function r(i){if(i===null){e.consume(i);return}return e.enter("lineEndingBlank"),e.consume(i),e.exit("lineEndingBlank"),t.currentConstruct=void 0,o}function n(i){if(i===null){e.consume(i);return}return e.enter("lineEnding"),e.consume(i),e.exit("lineEnding"),t.currentConstruct=void 0,o}}var a8={resolveAll:p8()},s8=c8("string"),l8=c8("text");function c8(e){return{tokenize:t,resolveAll:p8(e==="text"?lB:void 0)};function t(o){let r=this,n=this.parser.constructs[e],i=o.attempt(n,a,s);return a;function a(p){return c(p)?i(p):s(p)}function s(p){if(p===null){o.consume(p);return}return o.enter("data"),o.consume(p),l}function l(p){return c(p)?(o.exit("data"),i(p)):(o.consume(p),l)}function c(p){if(p===null)return!0;let u=n[p],m=-1;if(u)for(;++m<u.length;){let d=u[m];if(!d.previous||d.previous.call(r,r.previous))return!0}return!1}}}function p8(e){return t;function t(o,r){let n=-1,i;for(;++n<=o.length;)i===void 0?o[n]&&o[n][1].type==="data"&&(i=n,n++):(!o[n]||o[n][1].type!=="data")&&(n!==i+2&&(o[i][1].end=o[n-1][1].end,o.splice(i+2,n-i-2),n=i+2),i=void 0);return e?e(o,r):o}}function lB(e,t){let o=0;for(;++o<=e.length;)if((o===e.length||e[o][1].type==="lineEnding")&&e[o-1][1].type==="data"){let r=e[o-1][1],n=t.sliceStream(r),i=n.length,a=-1,s=0,l;for(;i--;){let c=n[i];if(typeof c=="string"){for(a=c.length;c.charCodeAt(a-1)===32;)s++,a--;if(a)break;a=-1}else if(c===-2)l=!0,s++;else if(c!==-1){i++;break}}if(s){let c={type:o===e.length||l||s<2?"lineSuffix":"hardBreakTrailing",start:{line:r.end.line,column:r.end.column-s,offset:r.end.offset-s,_index:r.start._index+i,_bufferIndex:i?a:r.start._bufferIndex+a},end:Object.assign({},r.end)};r.end=Object.assign({},c.start),r.start.offset===r.end.offset?Object.assign(r,c):(e.splice(o,0,["enter",c,t],["exit",c,t]),o+=2)}o++}return e}function u8(e,t,o){let r=Object.assign(o?Object.assign({},o):{line:1,column:1,offset:0},{_index:0,_bufferIndex:-1}),n={},i=[],a=[],s=[],l=!0,c={consume:b,enter:S,exit:I,attempt:O(w),check:O(E),interrupt:O(E,{interrupt:!0})},p={previous:null,code:null,containerState:{},events:[],parser:e,sliceStream:h,sliceSerialize:f,now:C,defineSkip:x,write:d},u=t.tokenize.call(p,c),m;return t.resolveAll&&i.push(t),p;function d(V){return a=Ur(a,V),_(),a[a.length-1]!==null?[]:(L(t,0),p.events=vc(i,p.events,p),p.events)}function f(V,W){return pB(h(V),W)}function h(V){return cB(a,V)}function C(){let{line:V,column:W,offset:N,_index:Z,_bufferIndex:J}=r;return{line:V,column:W,offset:N,_index:Z,_bufferIndex:J}}function x(V){n[V.line]=V.column,H()}function _(){let V;for(;r._index<a.length;){let W=a[r._index];if(typeof W=="string")for(V=r._index,r._bufferIndex<0&&(r._bufferIndex=0);r._index===V&&r._bufferIndex<W.length;)y(W.charCodeAt(r._bufferIndex));else y(W)}}function y(V){l=void 0,m=V,u=u(V)}function b(V){_e(V)?(r.line++,r.column=1,r.offset+=V===-3?2:1,H()):V!==-1&&(r.column++,r.offset++),r._bufferIndex<0?r._index++:(r._bufferIndex++,r._bufferIndex===a[r._index].length&&(r._bufferIndex=-1,r._index++)),p.previous=V,l=!0}function S(V,W){let N=W||{};return N.type=V,N.start=C(),p.events.push(["enter",N,p]),s.push(N),N}function I(V){let W=s.pop();return W.end=C(),p.events.push(["exit",W,p]),W}function w(V,W){L(V,W.from)}function E(V,W){W.restore()}function O(V,W){return N;function N(Z,J,K){let Q,M,le,ge;return Array.isArray(Z)?$(Z):"tokenize"in Z?$([Z]):P(Z);function P(ce){return ut;function ut(Te){let Ie=Te!==null&&ce[Te],Pe=Te!==null&&ce.null,qe=[...Array.isArray(Ie)?Ie:Ie?[Ie]:[],...Array.isArray(Pe)?Pe:Pe?[Pe]:[]];return $(qe)(Te)}}function $(ce){return Q=ce,M=0,ce.length===0?K:j(ce[M])}function j(ce){return ut;function ut(Te){return ge=G(),le=ce,ce.partial||(p.currentConstruct=ce),ce.name&&p.parser.constructs.disable.null.includes(ce.name)?re(Te):ce.tokenize.call(W?Object.assign(Object.create(p),W):p,c,de,re)(Te)}}function de(ce){return l=!0,V(le,ge),J}function re(ce){return l=!0,ge.restore(),++M<Q.length?j(Q[M]):K}}}function L(V,W){V.resolveAll&&!i.includes(V)&&i.push(V),V.resolve&&vr(p.events,W,p.events.length-W,V.resolve(p.events.slice(W),p)),V.resolveTo&&(p.events=V.resolveTo(p.events,p))}function G(){let V=C(),W=p.previous,N=p.currentConstruct,Z=p.events.length,J=Array.from(s);return{restore:K,from:Z};function K(){r=V,p.previous=W,p.currentConstruct=N,p.events.length=Z,s=J,H()}}function H(){r.line in n&&r.column<2&&(r.column=n[r.line],r.offset+=n[r.line]-1)}}function cB(e,t){let o=t.start._index,r=t.start._bufferIndex,n=t.end._index,i=t.end._bufferIndex,a;if(o===n)a=[e[o].slice(r,i)];else{if(a=e.slice(o,n),r>-1){let s=a[0];typeof s=="string"?a[0]=s.slice(r):a.shift()}i>0&&a.push(e[n].slice(0,i))}return a}function pB(e,t){let o=-1,r=[],n;for(;++o<e.length;){let i=e[o],a;if(typeof i=="string")a=i;else switch(i){case-5:{a="\r";break}case-4:{a=`
`;break}case-3:{a=`\r
`;break}case-2:{a=t?" ":"	";break}case-1:{if(!t&&n)continue;a=" ";break}default:a=String.fromCharCode(i)}n=i===-2,r.push(a)}return r.join("")}var L0={};Y7(L0,{attentionMarkers:()=>_B,contentInitial:()=>mB,disable:()=>CB,document:()=>uB,flow:()=>fB,flowInitial:()=>dB,insideSpan:()=>xB,string:()=>hB,text:()=>gB});var uB={42:wr,43:wr,45:wr,48:wr,49:wr,50:wr,51:wr,52:wr,53:wr,54:wr,55:wr,56:wr,57:wr,62:Bf},mB={91:v0},dB={[-2]:eu,[-1]:eu,32:eu},fB={35:T0,42:Us,45:[Wf,Us],60:E0,61:Wf,95:Us,96:Hf,126:Hf},hB={38:Df,92:Ff},gB={[-5]:ou,[-4]:ou,[-3]:ou,33:P0,38:Df,42:Jp,60:[b0,A0],91:k0,92:[w0,Ff],93:Rs,95:Jp,96:S0},xB={null:[Jp,a8]},_B={null:[42,95]},CB={null:[]};function O0(e){let o=K3([L0,...(e||{}).extensions||[]]),r={defined:[],lazy:{},constructs:o,content:n(J3),document:n(t8),flow:n(i8),string:n(s8),text:n(l8)};return r;function n(i){return a;function a(s){return u8(r,i,s)}}}function B0(e){for(;!zf(e););return e}var m8=/[\0\t\n\r]/g;function F0(){let e=1,t="",o=!0,r;return n;function n(i,a,s){let l=[],c,p,u,m,d;for(i=t+(typeof i=="string"?i.toString():new TextDecoder(a||void 0).decode(i)),u=0,t="",o&&(i.charCodeAt(0)===65279&&u++,o=void 0);u<i.length;){if(m8.lastIndex=u,c=m8.exec(i),m=c&&c.index!==void 0?c.index:i.length,d=i.charCodeAt(m),!c){t=i.slice(u);break}if(d===10&&u===m&&r)l.push(-3),r=void 0;else switch(r&&(l.push(-5),r=void 0),u<m&&(l.push(i.slice(u,m)),e+=m-u),d){case 0:{l.push(65533),e++;break}case 9:{for(p=Math.ceil(e/4)*4,l.push(-2);e++<p;)l.push(-1);break}case 10:{l.push(-4),e=1;break}default:r=!0,e=1}u=m+1}return s&&(r&&l.push(-5),t&&l.push(t),l.push(null)),l}}var yB=/\\([!-/:-@[-`{-~])|&(#(?:\d{1,7}|x[\da-f]{1,6})|[\da-z]{1,31});/gi;function Gf(e){return e.replace(yB,bB)}function bB(e,t,o){if(t)return t;if(o.charCodeAt(0)===35){let n=o.charCodeAt(1),i=n===120||n===88;return Of(o.slice(i?2:1),i?16:10)}return El(o)||e}function ss(e){return!e||typeof e!="object"?"":"position"in e||"type"in e?d8(e.position):"start"in e||"end"in e?d8(e):"line"in e||"column"in e?D0(e):""}function D0(e){return f8(e&&e.line)+":"+f8(e&&e.column)}function d8(e){return D0(e&&e.start)+"-"+D0(e&&e.end)}function f8(e){return e&&typeof e=="number"?e:1}var g8={}.hasOwnProperty;function H0(e,t,o){return typeof t!="string"&&(o=t,t=void 0),SB(o)(B0(O0(o).document().write(F0()(e,t,!0))))}function SB(e){let t={transforms:[],canContainEols:["emphasis","fragment","heading","paragraph","strong"],enter:{autolink:i(R),autolinkProtocol:O,autolinkEmail:O,atxHeading:i(Nt),blockQuote:i(Te),characterEscape:O,characterReference:O,codeFenced:i(Ie),codeFencedFenceInfo:a,codeFencedFenceMeta:a,codeIndented:i(Ie,a),codeText:i(Pe,a),codeTextData:O,data:O,codeFlowValue:O,definition:i(qe),definitionDestinationString:a,definitionLabelString:a,definitionTitleString:a,emphasis:i($e),hardBreakEscape:i(Re),hardBreakTrailing:i(Re),htmlFlow:i(mt,a),htmlFlowData:O,htmlText:i(mt,a),htmlTextData:O,image:i(B),label:a,link:i(R),listItem:i(ne),listItemValue:m,listOrdered:i(q,u),listUnordered:i(q),paragraph:i(te),reference:P,referenceString:a,resourceDestinationString:a,resourceTitleString:a,setextHeading:i(Nt),strong:i(z),thematicBreak:i(ee)},exit:{atxHeading:l(),atxHeadingSequence:S,autolink:l(),autolinkEmail:ut,autolinkProtocol:ce,blockQuote:l(),characterEscapeValue:L,characterReferenceMarkerHexadecimal:j,characterReferenceMarkerNumeric:j,characterReferenceValue:de,characterReference:re,codeFenced:l(C),codeFencedFence:h,codeFencedFenceInfo:d,codeFencedFenceMeta:f,codeFlowValue:L,codeIndented:l(x),codeText:l(N),codeTextData:L,data:L,definition:l(),definitionDestinationString:b,definitionLabelString:_,definitionTitleString:y,emphasis:l(),hardBreakEscape:l(H),hardBreakTrailing:l(H),htmlFlow:l(V),htmlFlowData:L,htmlText:l(W),htmlTextData:L,image:l(J),label:Q,labelText:K,lineEnding:G,link:l(Z),listItem:l(),listOrdered:l(),listUnordered:l(),paragraph:l(),referenceString:$,resourceDestinationString:M,resourceTitleString:le,resource:ge,setextHeading:l(E),setextHeadingLineSequence:w,setextHeadingText:I,strong:l(),thematicBreak:l()}};x8(t,(e||{}).mdastExtensions||[]);let o={};return r;function r(D){let Y={type:"root",children:[]},oe={stack:[Y],tokenStack:[],config:t,enter:s,exit:c,buffer:a,resume:p,data:o},me=[],ie=-1;for(;++ie<D.length;)if(D[ie][1].type==="listOrdered"||D[ie][1].type==="listUnordered")if(D[ie][0]==="enter")me.push(ie);else{let Fe=me.pop();ie=n(D,Fe,ie)}for(ie=-1;++ie<D.length;){let Fe=t[D[ie][0]];g8.call(Fe,D[ie][1].type)&&Fe[D[ie][1].type].call(Object.assign({sliceSerialize:D[ie][2].sliceSerialize},oe),D[ie][1])}if(oe.tokenStack.length>0){let Fe=oe.tokenStack[oe.tokenStack.length-1];(Fe[1]||h8).call(oe,void 0,Fe[0])}for(Y.position={start:ls(D.length>0?D[0][1].start:{line:1,column:1,offset:0}),end:ls(D.length>0?D[D.length-2][1].end:{line:1,column:1,offset:0})},ie=-1;++ie<t.transforms.length;)Y=t.transforms[ie](Y)||Y;return Y}function n(D,Y,oe){let me=Y-1,ie=-1,Fe=!1,_t,ae,je,it;for(;++me<=oe;){let It=D[me];switch(It[1].type){case"listUnordered":case"listOrdered":case"blockQuote":{It[0]==="enter"?ie++:ie--,it=void 0;break}case"lineEndingBlank":{It[0]==="enter"&&(_t&&!it&&!ie&&!je&&(je=me),it=void 0);break}case"linePrefix":case"listItemValue":case"listItemMarker":case"listItemPrefix":case"listItemPrefixWhitespace":break;default:it=void 0}if(!ie&&It[0]==="enter"&&It[1].type==="listItemPrefix"||ie===-1&&It[0]==="exit"&&(It[1].type==="listUnordered"||It[1].type==="listOrdered")){if(_t){let at=me;for(ae=void 0;at--;){let No=D[at];if(No[1].type==="lineEnding"||No[1].type==="lineEndingBlank"){if(No[0]==="exit")continue;ae&&(D[ae][1].type="lineEndingBlank",Fe=!0),No[1].type="lineEnding",ae=at}else if(!(No[1].type==="linePrefix"||No[1].type==="blockQuotePrefix"||No[1].type==="blockQuotePrefixWhitespace"||No[1].type==="blockQuoteMarker"||No[1].type==="listItemIndent"))break}je&&(!ae||je<ae)&&(_t._spread=!0),_t.end=Object.assign({},ae?D[ae][1].start:It[1].end),D.splice(ae||me,0,["exit",_t,It[2]]),me++,oe++}if(It[1].type==="listItemPrefix"){let at={type:"listItem",_spread:!1,start:Object.assign({},It[1].start),end:void 0};_t=at,D.splice(me,0,["enter",at,It[2]]),me++,oe++,je=void 0,it=!0}}}return D[Y][1]._spread=Fe,oe}function i(D,Y){return oe;function oe(me){s.call(this,D(me),me),Y&&Y.call(this,me)}}function a(){this.stack.push({type:"fragment",children:[]})}function s(D,Y,oe){this.stack[this.stack.length-1].children.push(D),this.stack.push(D),this.tokenStack.push([Y,oe]),D.position={start:ls(Y.start),end:void 0}}function l(D){return Y;function Y(oe){D&&D.call(this,oe),c.call(this,oe)}}function c(D,Y){let oe=this.stack.pop(),me=this.tokenStack.pop();if(me)me[0].type!==D.type&&(Y?Y.call(this,D,me[0]):(me[1]||h8).call(this,D,me[0]));else throw new Error("Cannot close `"+D.type+"` ("+ss({start:D.start,end:D.end})+"): it\u2019s not open");oe.position.end=ls(D.end)}function p(){return zs(this.stack.pop())}function u(){this.data.expectingFirstListItemValue=!0}function m(D){if(this.data.expectingFirstListItemValue){let Y=this.stack[this.stack.length-2];Y.start=Number.parseInt(this.sliceSerialize(D),10),this.data.expectingFirstListItemValue=void 0}}function d(){let D=this.resume(),Y=this.stack[this.stack.length-1];Y.lang=D}function f(){let D=this.resume(),Y=this.stack[this.stack.length-1];Y.meta=D}function h(){this.data.flowCodeInside||(this.buffer(),this.data.flowCodeInside=!0)}function C(){let D=this.resume(),Y=this.stack[this.stack.length-1];Y.value=D.replace(/^(\r?\n|\r)|(\r?\n|\r)$/g,""),this.data.flowCodeInside=void 0}function x(){let D=this.resume(),Y=this.stack[this.stack.length-1];Y.value=D.replace(/(\r?\n|\r)$/g,"")}function _(D){let Y=this.resume(),oe=this.stack[this.stack.length-1];oe.label=Y,oe.identifier=da(this.sliceSerialize(D)).toLowerCase()}function y(){let D=this.resume(),Y=this.stack[this.stack.length-1];Y.title=D}function b(){let D=this.resume(),Y=this.stack[this.stack.length-1];Y.url=D}function S(D){let Y=this.stack[this.stack.length-1];if(!Y.depth){let oe=this.sliceSerialize(D).length;Y.depth=oe}}function I(){this.data.setextHeadingSlurpLineEnding=!0}function w(D){let Y=this.stack[this.stack.length-1];Y.depth=this.sliceSerialize(D).codePointAt(0)===61?1:2}function E(){this.data.setextHeadingSlurpLineEnding=void 0}function O(D){let oe=this.stack[this.stack.length-1].children,me=oe[oe.length-1];(!me||me.type!=="text")&&(me=U(),me.position={start:ls(D.start),end:void 0},oe.push(me)),this.stack.push(me)}function L(D){let Y=this.stack.pop();Y.value+=this.sliceSerialize(D),Y.position.end=ls(D.end)}function G(D){let Y=this.stack[this.stack.length-1];if(this.data.atHardBreak){let oe=Y.children[Y.children.length-1];oe.position.end=ls(D.end),this.data.atHardBreak=void 0;return}!this.data.setextHeadingSlurpLineEnding&&t.canContainEols.includes(Y.type)&&(O.call(this,D),L.call(this,D))}function H(){this.data.atHardBreak=!0}function V(){let D=this.resume(),Y=this.stack[this.stack.length-1];Y.value=D}function W(){let D=this.resume(),Y=this.stack[this.stack.length-1];Y.value=D}function N(){let D=this.resume(),Y=this.stack[this.stack.length-1];Y.value=D}function Z(){let D=this.stack[this.stack.length-1];if(this.data.inReference){let Y=this.data.referenceType||"shortcut";D.type+="Reference",D.referenceType=Y,delete D.url,delete D.title}else delete D.identifier,delete D.label;this.data.referenceType=void 0}function J(){let D=this.stack[this.stack.length-1];if(this.data.inReference){let Y=this.data.referenceType||"shortcut";D.type+="Reference",D.referenceType=Y,delete D.url,delete D.title}else delete D.identifier,delete D.label;this.data.referenceType=void 0}function K(D){let Y=this.sliceSerialize(D),oe=this.stack[this.stack.length-2];oe.label=Gf(Y),oe.identifier=da(Y).toLowerCase()}function Q(){let D=this.stack[this.stack.length-1],Y=this.resume(),oe=this.stack[this.stack.length-1];if(this.data.inReference=!0,oe.type==="link"){let me=D.children;oe.children=me}else oe.alt=Y}function M(){let D=this.resume(),Y=this.stack[this.stack.length-1];Y.url=D}function le(){let D=this.resume(),Y=this.stack[this.stack.length-1];Y.title=D}function ge(){this.data.inReference=void 0}function P(){this.data.referenceType="collapsed"}function $(D){let Y=this.resume(),oe=this.stack[this.stack.length-1];oe.label=Y,oe.identifier=da(this.sliceSerialize(D)).toLowerCase(),this.data.referenceType="full"}function j(D){this.data.characterReferenceType=D.type}function de(D){let Y=this.sliceSerialize(D),oe=this.data.characterReferenceType,me;oe?(me=Of(Y,oe==="characterReferenceMarkerNumeric"?10:16),this.data.characterReferenceType=void 0):me=El(Y);let ie=this.stack[this.stack.length-1];ie.value+=me}function re(D){let Y=this.stack.pop();Y.position.end=ls(D.end)}function ce(D){L.call(this,D);let Y=this.stack[this.stack.length-1];Y.url=this.sliceSerialize(D)}function ut(D){L.call(this,D);let Y=this.stack[this.stack.length-1];Y.url="mailto:"+this.sliceSerialize(D)}function Te(){return{type:"blockquote",children:[]}}function Ie(){return{type:"code",lang:null,meta:null,value:""}}function Pe(){return{type:"inlineCode",value:""}}function qe(){return{type:"definition",identifier:"",label:null,title:null,url:""}}function $e(){return{type:"emphasis",children:[]}}function Nt(){return{type:"heading",depth:0,children:[]}}function Re(){return{type:"break"}}function mt(){return{type:"html",value:""}}function B(){return{type:"image",title:null,url:"",alt:null}}function R(){return{type:"link",title:null,url:"",children:[]}}function q(D){return{type:"list",ordered:D.type==="listOrdered",start:null,spread:D._spread,children:[]}}function ne(D){return{type:"listItem",spread:D._spread,checked:null,children:[]}}function te(){return{type:"paragraph",children:[]}}function z(){return{type:"strong",children:[]}}function U(){return{type:"text",value:""}}function ee(){return{type:"thematicBreak"}}}function ls(e){return{line:e.line,column:e.column,offset:e.offset}}function x8(e,t){let o=-1;for(;++o<t.length;){let r=t[o];Array.isArray(r)?x8(e,r):IB(e,r)}}function IB(e,t){let o;for(o in t)if(g8.call(t,o))switch(o){case"canContainEols":{let r=t[o];r&&e[o].push(...r);break}case"transforms":{let r=t[o];r&&e[o].push(...r);break}case"enter":case"exit":{let r=t[o];r&&Object.assign(e[o],r);break}}}function h8(e,t){throw e?new Error("Cannot close `"+e.type+"` ("+ss({start:e.start,end:e.end})+"): a different token (`"+t.type+"`, "+ss({start:t.start,end:t.end})+") is open"):new Error("Cannot close document, a token (`"+t.type+"`, "+ss({start:t.start,end:t.end})+") is still open")}function jf(e){let t=this;t.parser=o;function o(r){return H0(r,{...t.data("settings"),...e,extensions:t.data("micromarkExtensions")||[],mdastExtensions:t.data("fromMarkdownExtensions")||[]})}}var _8={}.hasOwnProperty;function C8(e,t){let o=t||{};function r(n,...i){let a=r.invalid,s=r.handlers;if(n&&_8.call(n,e)){let l=String(n[e]);a=_8.call(s,l)?s[l]:r.unknown}if(a)return a.call(this,n,...i)}return r.handlers=o.handlers||{},r.invalid=o.invalid,r.unknown=o.unknown,r}var vB={}.hasOwnProperty;function N0(e,t){let o=-1,r;if(t.extensions)for(;++o<t.extensions.length;)N0(e,t.extensions[o]);for(r in t)if(vB.call(t,r))switch(r){case"extensions":break;case"unsafe":{y8(e[r],t[r]);break}case"join":{y8(e[r],t[r]);break}case"handlers":{wB(e[r],t[r]);break}default:e.options[r]=t[r]}return e}function y8(e,t){t&&e.push(...t)}function wB(e,t){t&&Object.assign(e,t)}function b8(e,t,o,r){let n=o.enter("blockquote"),i=o.createTracker(r);i.move("> "),i.shift(2);let a=o.indentLines(o.containerFlow(e,i.current()),TB);return n(),a}function TB(e,t,o){return">"+(o?"":" ")+e}function qf(e,t){return S8(e,t.inConstruct,!0)&&!S8(e,t.notInConstruct,!1)}function S8(e,t,o){if(typeof t=="string"&&(t=[t]),!t||t.length===0)return o;let r=-1;for(;++r<t.length;)if(e.includes(t[r]))return!0;return!1}function z0(e,t,o,r){let n=-1;for(;++n<o.unsafe.length;)if(o.unsafe[n].character===`
`&&qf(o.stack,o.unsafe[n]))return/[ \t]/.test(r.before)?"":" ";return`\\
`}function ru(e,t){return!!(t.options.fences===!1&&e.value&&!e.lang&&/[^ \r\n]/.test(e.value)&&!/^[\t ]*(?:[\r\n]|$)|(?:^|[\r\n])[\t ]*$/.test(e.value))}function I8(e){let t=e.options.fence||"`";if(t!=="`"&&t!=="~")throw new Error("Cannot serialize code with `"+t+"` for `options.fence`, expected `` ` `` or `~`");return t}function v8(e,t,o,r){let n=I8(o),i=e.value||"",a=n==="`"?"GraveAccent":"Tilde";if(ru(e,o)){let u=o.enter("codeIndented"),m=o.indentLines(i,MB);return u(),m}let s=o.createTracker(r),l=n.repeat(Math.max(VC(i,n)+1,3)),c=o.enter("codeFenced"),p=s.move(l);if(e.lang){let u=o.enter(`codeFencedLang${a}`);p+=s.move(o.safe(e.lang,{before:p,after:" ",encode:["`"],...s.current()})),u()}if(e.lang&&e.meta){let u=o.enter(`codeFencedMeta${a}`);p+=s.move(" "),p+=s.move(o.safe(e.meta,{before:p,after:`
`,encode:["`"],...s.current()})),u()}return p+=s.move(`
`),i&&(p+=s.move(i+`
`)),p+=s.move(l),c(),p}function MB(e,t,o){return(o?"":"    ")+e}function wc(e){let t=e.options.quote||'"';if(t!=='"'&&t!=="'")throw new Error("Cannot serialize title with `"+t+"` for `options.quote`, expected `\"`, or `'`");return t}function w8(e,t,o,r){let n=wc(o),i=n==='"'?"Quote":"Apostrophe",a=o.enter("definition"),s=o.enter("label"),l=o.createTracker(r),c=l.move("[");return c+=l.move(o.safe(o.associationId(e),{before:c,after:"]",...l.current()})),c+=l.move("]: "),s(),!e.url||/[\0- \u007F]/.test(e.url)?(s=o.enter("destinationLiteral"),c+=l.move("<"),c+=l.move(o.safe(e.url,{before:c,after:">",...l.current()})),c+=l.move(">")):(s=o.enter("destinationRaw"),c+=l.move(o.safe(e.url,{before:c,after:e.title?" ":`
`,...l.current()}))),s(),e.title&&(s=o.enter(`title${i}`),c+=l.move(" "+n),c+=l.move(o.safe(e.title,{before:c,after:n,...l.current()})),c+=l.move(n),s()),a(),c}function T8(e){let t=e.options.emphasis||"*";if(t!=="*"&&t!=="_")throw new Error("Cannot serialize emphasis with `"+t+"` for `options.emphasis`, expected `*`, or `_`");return t}V0.peek=EB;function V0(e,t,o,r){let n=T8(o),i=o.enter("emphasis"),a=o.createTracker(r),s=a.move(n);return s+=a.move(o.containerPhrasing(e,{before:s,after:n,...a.current()})),s+=a.move(n),i(),s}function EB(e,t,o){return o.options.emphasis||"*"}function Kf(e,t){let o=!1;return WC(e,function(r){if("value"in r&&/\r?\n|\r/.test(r.value)||r.type==="break")return o=!0,UC}),!!((!e.depth||e.depth<3)&&zs(e)&&(t.options.setext||o))}function M8(e,t,o,r){let n=Math.max(Math.min(6,e.depth||1),1),i=o.createTracker(r);if(Kf(e,o)){let p=o.enter("headingSetext"),u=o.enter("phrasing"),m=o.containerPhrasing(e,{...i.current(),before:`
`,after:`
`});return u(),p(),m+`
`+(n===1?"=":"-").repeat(m.length-(Math.max(m.lastIndexOf("\r"),m.lastIndexOf(`
`))+1))}let a="#".repeat(n),s=o.enter("headingAtx"),l=o.enter("phrasing");i.move(a+" ");let c=o.containerPhrasing(e,{before:"# ",after:`
`,...i.current()});return/^[\t ]/.test(c)&&(c="&#x"+c.charCodeAt(0).toString(16).toUpperCase()+";"+c.slice(1)),c=c?a+" "+c:a,o.options.closeAtx&&(c+=" "+a),l(),s(),c}R0.peek=AB;function R0(e){return e.value||""}function AB(){return"<"}U0.peek=PB;function U0(e,t,o,r){let n=wc(o),i=n==='"'?"Quote":"Apostrophe",a=o.enter("image"),s=o.enter("label"),l=o.createTracker(r),c=l.move("![");return c+=l.move(o.safe(e.alt,{before:c,after:"]",...l.current()})),c+=l.move("]("),s(),!e.url&&e.title||/[\0- \u007F]/.test(e.url)?(s=o.enter("destinationLiteral"),c+=l.move("<"),c+=l.move(o.safe(e.url,{before:c,after:">",...l.current()})),c+=l.move(">")):(s=o.enter("destinationRaw"),c+=l.move(o.safe(e.url,{before:c,after:e.title?" ":")",...l.current()}))),s(),e.title&&(s=o.enter(`title${i}`),c+=l.move(" "+n),c+=l.move(o.safe(e.title,{before:c,after:n,...l.current()})),c+=l.move(n),s()),c+=l.move(")"),a(),c}function PB(){return"!"}W0.peek=kB;function W0(e,t,o,r){let n=e.referenceType,i=o.enter("imageReference"),a=o.enter("label"),s=o.createTracker(r),l=s.move("!["),c=o.safe(e.alt,{before:l,after:"]",...s.current()});l+=s.move(c+"]["),a();let p=o.stack;o.stack=[],a=o.enter("reference");let u=o.safe(o.associationId(e),{before:l,after:"]",...s.current()});return a(),o.stack=p,i(),n==="full"||!c||c!==u?l+=s.move(u+"]"):n==="shortcut"?l=l.slice(0,-1):l+=s.move("]"),l}function kB(){return"!"}G0.peek=LB;function G0(e,t,o){let r=e.value||"",n="`",i=-1;for(;new RegExp("(^|[^`])"+n+"([^`]|$)").test(r);)n+="`";for(/[^ \r\n]/.test(r)&&(/^[ \r\n]/.test(r)&&/[ \r\n]$/.test(r)||/^`|`$/.test(r))&&(r=" "+r+" ");++i<o.unsafe.length;){let a=o.unsafe[i],s=o.compilePattern(a),l;if(a.atBreak)for(;l=s.exec(r);){let c=l.index;r.charCodeAt(c)===10&&r.charCodeAt(c-1)===13&&c--,r=r.slice(0,c)+" "+r.slice(l.index+1)}}return n+r+n}function LB(){return"`"}function j0(e,t){let o=zs(e);return!!(!t.options.resourceLink&&e.url&&!e.title&&e.children&&e.children.length===1&&e.children[0].type==="text"&&(o===e.url||"mailto:"+o===e.url)&&/^[a-z][a-z+.-]+:/i.test(e.url)&&!/[\0- <>\u007F]/.test(e.url))}q0.peek=OB;function q0(e,t,o,r){let n=wc(o),i=n==='"'?"Quote":"Apostrophe",a=o.createTracker(r),s,l;if(j0(e,o)){let p=o.stack;o.stack=[],s=o.enter("autolink");let u=a.move("<");return u+=a.move(o.containerPhrasing(e,{before:u,after:">",...a.current()})),u+=a.move(">"),s(),o.stack=p,u}s=o.enter("link"),l=o.enter("label");let c=a.move("[");return c+=a.move(o.containerPhrasing(e,{before:c,after:"](",...a.current()})),c+=a.move("]("),l(),!e.url&&e.title||/[\0- \u007F]/.test(e.url)?(l=o.enter("destinationLiteral"),c+=a.move("<"),c+=a.move(o.safe(e.url,{before:c,after:">",...a.current()})),c+=a.move(">")):(l=o.enter("destinationRaw"),c+=a.move(o.safe(e.url,{before:c,after:e.title?" ":")",...a.current()}))),l(),e.title&&(l=o.enter(`title${i}`),c+=a.move(" "+n),c+=a.move(o.safe(e.title,{before:c,after:n,...a.current()})),c+=a.move(n),l()),c+=a.move(")"),s(),c}function OB(e,t,o){return j0(e,o)?"<":"["}K0.peek=BB;function K0(e,t,o,r){let n=e.referenceType,i=o.enter("linkReference"),a=o.enter("label"),s=o.createTracker(r),l=s.move("["),c=o.containerPhrasing(e,{before:l,after:"]",...s.current()});l+=s.move(c+"]["),a();let p=o.stack;o.stack=[],a=o.enter("reference");let u=o.safe(o.associationId(e),{before:l,after:"]",...s.current()});return a(),o.stack=p,i(),n==="full"||!c||c!==u?l+=s.move(u+"]"):n==="shortcut"?l=l.slice(0,-1):l+=s.move("]"),l}function BB(){return"["}function Tc(e){let t=e.options.bullet||"*";if(t!=="*"&&t!=="+"&&t!=="-")throw new Error("Cannot serialize items with `"+t+"` for `options.bullet`, expected `*`, `+`, or `-`");return t}function E8(e){let t=Tc(e),o=e.options.bulletOther;if(!o)return t==="*"?"-":"*";if(o!=="*"&&o!=="+"&&o!=="-")throw new Error("Cannot serialize items with `"+o+"` for `options.bulletOther`, expected `*`, `+`, or `-`");if(o===t)throw new Error("Expected `bullet` (`"+t+"`) and `bulletOther` (`"+o+"`) to be different");return o}function A8(e){let t=e.options.bulletOrdered||".";if(t!=="."&&t!==")")throw new Error("Cannot serialize items with `"+t+"` for `options.bulletOrdered`, expected `.` or `)`");return t}function $f(e){let t=e.options.rule||"*";if(t!=="*"&&t!=="-"&&t!=="_")throw new Error("Cannot serialize rules with `"+t+"` for `options.rule`, expected `*`, `-`, or `_`");return t}function P8(e,t,o,r){let n=o.enter("list"),i=o.bulletCurrent,a=e.ordered?A8(o):Tc(o),s=e.ordered?a==="."?")":".":E8(o),l=t&&o.bulletLastUsed?a===o.bulletLastUsed:!1;if(!e.ordered){let p=e.children?e.children[0]:void 0;if((a==="*"||a==="-")&&p&&(!p.children||!p.children[0])&&o.stack[o.stack.length-1]==="list"&&o.stack[o.stack.length-2]==="listItem"&&o.stack[o.stack.length-3]==="list"&&o.stack[o.stack.length-4]==="listItem"&&o.indexStack[o.indexStack.length-1]===0&&o.indexStack[o.indexStack.length-2]===0&&o.indexStack[o.indexStack.length-3]===0&&(l=!0),$f(o)===a&&p){let u=-1;for(;++u<e.children.length;){let m=e.children[u];if(m&&m.type==="listItem"&&m.children&&m.children[0]&&m.children[0].type==="thematicBreak"){l=!0;break}}}}l&&(a=s),o.bulletCurrent=a;let c=o.containerFlow(e,r);return o.bulletLastUsed=a,o.bulletCurrent=i,n(),c}function k8(e){let t=e.options.listItemIndent||"one";if(t!=="tab"&&t!=="one"&&t!=="mixed")throw new Error("Cannot serialize items with `"+t+"` for `options.listItemIndent`, expected `tab`, `one`, or `mixed`");return t}function L8(e,t,o,r){let n=k8(o),i=o.bulletCurrent||Tc(o);t&&t.type==="list"&&t.ordered&&(i=(typeof t.start=="number"&&t.start>-1?t.start:1)+(o.options.incrementListMarker===!1?0:t.children.indexOf(e))+i);let a=i.length+1;(n==="tab"||n==="mixed"&&(t&&t.type==="list"&&t.spread||e.spread))&&(a=Math.ceil(a/4)*4);let s=o.createTracker(r);s.move(i+" ".repeat(a-i.length)),s.shift(a);let l=o.enter("listItem"),c=o.indentLines(o.containerFlow(e,s.current()),p);return l(),c;function p(u,m,d){return m?(d?"":" ".repeat(a))+u:(d?i:i+" ".repeat(a-i.length))+u}}function O8(e,t,o,r){let n=o.enter("paragraph"),i=o.enter("phrasing"),a=o.containerPhrasing(e,r);return i(),n(),a}var $0=RC(["break","delete","emphasis","footnote","footnoteReference","image","imageReference","inlineCode","inlineMath","link","linkReference","mdxJsxTextElement","mdxTextExpression","strong","text","textDirective"]);function B8(e,t,o,r){return(e.children.some(function(a){return $0(a)})?o.containerPhrasing:o.containerFlow).call(o,e,r)}function F8(e){let t=e.options.strong||"*";if(t!=="*"&&t!=="_")throw new Error("Cannot serialize strong with `"+t+"` for `options.strong`, expected `*`, or `_`");return t}X0.peek=FB;function X0(e,t,o,r){let n=F8(o),i=o.enter("strong"),a=o.createTracker(r),s=a.move(n+n);return s+=a.move(o.containerPhrasing(e,{before:s,after:n,...a.current()})),s+=a.move(n+n),i(),s}function FB(e,t,o){return o.options.strong||"*"}function D8(e,t,o,r){return o.safe(e.value,r)}function H8(e){let t=e.options.ruleRepetition||3;if(t<3)throw new Error("Cannot serialize rules with repetition `"+t+"` for `options.ruleRepetition`, expected `3` or more");return t}function N8(e,t,o){let r=($f(o)+(o.options.ruleSpaces?" ":"")).repeat(H8(o));return o.options.ruleSpaces?r.slice(0,-1):r}var z8={blockquote:b8,break:z0,code:v8,definition:w8,emphasis:V0,hardBreak:z0,heading:M8,html:R0,image:U0,imageReference:W0,inlineCode:G0,link:q0,linkReference:K0,list:P8,listItem:L8,paragraph:O8,root:B8,strong:X0,text:D8,thematicBreak:N8};var V8=[DB];function DB(e,t,o,r){if(t.type==="code"&&ru(t,r)&&(e.type==="list"||e.type===t.type&&ru(e,r)))return!1;if("spread"in o&&typeof o.spread=="boolean")return e.type==="paragraph"&&(e.type===t.type||t.type==="definition"||t.type==="heading"&&Kf(t,r))?void 0:o.spread?1:0}var Ws=["autolink","destinationLiteral","destinationRaw","reference","titleQuote","titleApostrophe"],R8=[{character:"	",after:"[\\r\\n]",inConstruct:"phrasing"},{character:"	",before:"[\\r\\n]",inConstruct:"phrasing"},{character:"	",inConstruct:["codeFencedLangGraveAccent","codeFencedLangTilde"]},{character:"\r",inConstruct:["codeFencedLangGraveAccent","codeFencedLangTilde","codeFencedMetaGraveAccent","codeFencedMetaTilde","destinationLiteral","headingAtx"]},{character:`
`,inConstruct:["codeFencedLangGraveAccent","codeFencedLangTilde","codeFencedMetaGraveAccent","codeFencedMetaTilde","destinationLiteral","headingAtx"]},{character:" ",after:"[\\r\\n]",inConstruct:"phrasing"},{character:" ",before:"[\\r\\n]",inConstruct:"phrasing"},{character:" ",inConstruct:["codeFencedLangGraveAccent","codeFencedLangTilde"]},{character:"!",after:"\\[",inConstruct:"phrasing",notInConstruct:Ws},{character:'"',inConstruct:"titleQuote"},{atBreak:!0,character:"#"},{character:"#",inConstruct:"headingAtx",after:`(?:[\r
]|$)`},{character:"&",after:"[#A-Za-z]",inConstruct:"phrasing"},{character:"'",inConstruct:"titleApostrophe"},{character:"(",inConstruct:"destinationRaw"},{before:"\\]",character:"(",inConstruct:"phrasing",notInConstruct:Ws},{atBreak:!0,before:"\\d+",character:")"},{character:")",inConstruct:"destinationRaw"},{atBreak:!0,character:"*",after:`(?:[ 	\r
*])`},{character:"*",inConstruct:"phrasing",notInConstruct:Ws},{atBreak:!0,character:"+",after:`(?:[ 	\r
])`},{atBreak:!0,character:"-",after:`(?:[ 	\r
-])`},{atBreak:!0,before:"\\d+",character:".",after:`(?:[ 	\r
]|$)`},{atBreak:!0,character:"<",after:"[!/?A-Za-z]"},{character:"<",after:"[!/?A-Za-z]",inConstruct:"phrasing",notInConstruct:Ws},{character:"<",inConstruct:"destinationLiteral"},{atBreak:!0,character:"="},{atBreak:!0,character:">"},{character:">",inConstruct:"destinationLiteral"},{atBreak:!0,character:"["},{character:"[",inConstruct:"phrasing",notInConstruct:Ws},{character:"[",inConstruct:["label","reference"]},{character:"\\",after:"[\\r\\n]",inConstruct:"phrasing"},{character:"]",inConstruct:["label","reference"]},{atBreak:!0,character:"_"},{character:"_",inConstruct:"phrasing",notInConstruct:Ws},{atBreak:!0,character:"`"},{character:"`",inConstruct:["codeFencedLangGraveAccent","codeFencedMetaGraveAccent"]},{character:"`",inConstruct:"phrasing",notInConstruct:Ws},{atBreak:!0,character:"~"}];function U8(e){return e.label||!e.identifier?e.label||"":Gf(e.identifier)}function W8(e){if(!e._compiled){let t=(e.atBreak?"[\\r\\n][\\t ]*":"")+(e.before?"(?:"+e.before+")":"");e._compiled=new RegExp((t?"("+t+")":"")+(/[|\\{}()[\]^$+*?.-]/.test(e.character)?"\\":"")+e.character+(e.after?"(?:"+e.after+")":""),"g")}return e._compiled}function G8(e,t,o){let r=t.indexStack,n=e.children||[],i=[],a=-1,s=o.before;r.push(-1);let l=t.createTracker(o);for(;++a<n.length;){let c=n[a],p;if(r[r.length-1]=a,a+1<n.length){let u=t.handle.handlers[n[a+1].type];u&&u.peek&&(u=u.peek),p=u?u(n[a+1],e,t,{before:"",after:"",...l.current()}).charAt(0):""}else p=o.after;i.length>0&&(s==="\r"||s===`
`)&&c.type==="html"&&(i[i.length-1]=i[i.length-1].replace(/(\r?\n|\r)$/," "),s=" ",l=t.createTracker(o),l.move(i.join(""))),i.push(l.move(t.handle(c,e,t,{...l.current(),before:s,after:p}))),s=i[i.length-1].slice(-1)}return r.pop(),i.join("")}function j8(e,t,o){let r=t.indexStack,n=e.children||[],i=t.createTracker(o),a=[],s=-1;for(r.push(-1);++s<n.length;){let l=n[s];r[r.length-1]=s,a.push(i.move(t.handle(l,e,t,{before:`
`,after:`
`,...i.current()}))),l.type!=="list"&&(t.bulletLastUsed=void 0),s<n.length-1&&a.push(i.move(HB(l,n[s+1],e,t)))}return r.pop(),a.join("")}function HB(e,t,o,r){let n=r.join.length;for(;n--;){let i=r.join[n](e,t,o,r);if(i===!0||i===1)break;if(typeof i=="number")return`
`.repeat(1+i);if(i===!1)return`

<!---->

`}return`

`}var NB=/\r?\n|\r/g;function q8(e,t){let o=[],r=0,n=0,i;for(;i=NB.exec(e);)a(e.slice(r,i.index)),o.push(i[0]),r=i.index+i[0].length,n++;return a(e.slice(r)),o.join("");function a(s){o.push(t(s,n,!s))}}function $8(e,t,o){let r=(o.before||"")+(t||"")+(o.after||""),n=[],i=[],a={},s=-1;for(;++s<e.unsafe.length;){let p=e.unsafe[s];if(!qf(e.stack,p))continue;let u=e.compilePattern(p),m;for(;m=u.exec(r);){let d="before"in p||!!p.atBreak,f="after"in p,h=m.index+(d?m[1].length:0);n.includes(h)?(a[h].before&&!d&&(a[h].before=!1),a[h].after&&!f&&(a[h].after=!1)):(n.push(h),a[h]={before:d,after:f})}}n.sort(zB);let l=o.before?o.before.length:0,c=r.length-(o.after?o.after.length:0);for(s=-1;++s<n.length;){let p=n[s];p<l||p>=c||p+1<c&&n[s+1]===p+1&&a[p].after&&!a[p+1].before&&!a[p+1].after||n[s-1]===p-1&&a[p].before&&!a[p-1].before&&!a[p-1].after||(l!==p&&i.push(K8(r.slice(l,p),"\\")),l=p,/[!-/:-@[-`{-~]/.test(r.charAt(p))&&(!o.encode||!o.encode.includes(r.charAt(p)))?i.push("\\"):(i.push("&#x"+r.charCodeAt(p).toString(16).toUpperCase()+";"),l++))}return i.push(K8(r.slice(l,c),o.after)),i.join("")}function zB(e,t){return e-t}function K8(e,t){let o=/\\(?=[!-/:-@[-`{-~])/g,r=[],n=[],i=e+t,a=-1,s=0,l;for(;l=o.exec(i);)r.push(l.index);for(;++a<r.length;)s!==r[a]&&n.push(e.slice(s,r[a])),n.push("\\"),s=r[a];return n.push(e.slice(s)),n.join("")}function X8(e){let t=e||{},o=t.now||{},r=t.lineShift||0,n=o.line||1,i=o.column||1;return{move:l,current:a,shift:s};function a(){return{now:{line:n,column:i},lineShift:r}}function s(c){r+=c}function l(c){let p=c||"",u=p.split(/\r?\n|\r/g),m=u[u.length-1];return n+=u.length-1,i=u.length===1?i+m.length:1+m.length+r,p}}function Y0(e,t={}){let o={enter:n,indentLines:q8,associationId:U8,containerPhrasing:WB,containerFlow:GB,createTracker:X8,compilePattern:W8,safe:jB,stack:[],unsafe:[...R8],join:[...V8],handlers:{...z8},options:{},indexStack:[],handle:void 0};N0(o,t),o.options.tightDefinitions&&o.join.push(UB),o.handle=C8("type",{invalid:VB,unknown:RB,handlers:o.handlers});let r=o.handle(e,void 0,o,{before:`
`,after:`
`,now:{line:1,column:1},lineShift:0});return r&&r.charCodeAt(r.length-1)!==10&&r.charCodeAt(r.length-1)!==13&&(r+=`
`),r;function n(i){return o.stack.push(i),a;function a(){o.stack.pop()}}}function VB(e){throw new Error("Cannot handle value `"+e+"`, expected node")}function RB(e){let t=e;throw new Error("Cannot handle unknown node `"+t.type+"`")}function UB(e,t){if(e.type==="definition"&&e.type===t.type)return 0}function WB(e,t){return G8(e,this,t)}function GB(e,t){return j8(e,this,t)}function jB(e,t){return $8(this,e,t)}function Xf(e){let t=this;t.compiler=o;function o(r){return Y0(r,{...t.data("settings"),...e,extensions:t.data("toMarkdownExtensions")||[]})}}var Zf=v(sM(),1);var Jo=class extends Error{constructor(t,o,r){super(),typeof o=="string"&&(r=o,o=void 0);let n="",i={},a=!1;if(o&&("line"in o&&"column"in o?i={place:o}:"start"in o&&"end"in o?i={place:o}:"type"in o?i={ancestors:[o],place:o.position}:i={...o}),typeof t=="string"?n=t:!i.cause&&t&&(a=!0,n=t.message,i.cause=t),!i.ruleId&&!i.source&&typeof r=="string"){let l=r.indexOf(":");l===-1?i.ruleId=r:(i.source=r.slice(0,l),i.ruleId=r.slice(l+1))}if(!i.place&&i.ancestors&&i.ancestors){let l=i.ancestors[i.ancestors.length-1];l&&(i.place=l.position)}let s=i.place&&"start"in i.place?i.place.start:i.place;this.ancestors=i.ancestors||void 0,this.cause=i.cause||void 0,this.column=s?s.column:void 0,this.fatal=void 0,this.file,this.message=n,this.line=s?s.line:void 0,this.name=ss(i.place)||"1:1",this.place=i.place||void 0,this.reason=this.message,this.ruleId=i.ruleId||void 0,this.source=i.source||void 0,this.stack=a&&i.cause&&typeof i.cause.stack=="string"?i.cause.stack:"",this.actual,this.expected,this.note,this.url}};Jo.prototype.file="";Jo.prototype.name="";Jo.prototype.reason="";Jo.prototype.message="";Jo.prototype.stack="";Jo.prototype.column=void 0;Jo.prototype.line=void 0;Jo.prototype.ancestors=void 0;Jo.prototype.cause=void 0;Jo.prototype.fatal=void 0;Jo.prototype.place=void 0;Jo.prototype.ruleId=void 0;Jo.prototype.source=void 0;var ui={basename:qB,dirname:KB,extname:$B,join:XB,sep:"/"};function qB(e,t){if(t!==void 0&&typeof t!="string")throw new TypeError('"ext" argument must be a string');nu(e);let o=0,r=-1,n=e.length,i;if(t===void 0||t.length===0||t.length>e.length){for(;n--;)if(e.codePointAt(n)===47){if(i){o=n+1;break}}else r<0&&(i=!0,r=n+1);return r<0?"":e.slice(o,r)}if(t===e)return"";let a=-1,s=t.length-1;for(;n--;)if(e.codePointAt(n)===47){if(i){o=n+1;break}}else a<0&&(i=!0,a=n+1),s>-1&&(e.codePointAt(n)===t.codePointAt(s--)?s<0&&(r=n):(s=-1,r=a));return o===r?r=a:r<0&&(r=e.length),e.slice(o,r)}function KB(e){if(nu(e),e.length===0)return".";let t=-1,o=e.length,r;for(;--o;)if(e.codePointAt(o)===47){if(r){t=o;break}}else r||(r=!0);return t<0?e.codePointAt(0)===47?"/":".":t===1&&e.codePointAt(0)===47?"//":e.slice(0,t)}function $B(e){nu(e);let t=e.length,o=-1,r=0,n=-1,i=0,a;for(;t--;){let s=e.codePointAt(t);if(s===47){if(a){r=t+1;break}continue}o<0&&(a=!0,o=t+1),s===46?n<0?n=t:i!==1&&(i=1):n>-1&&(i=-1)}return n<0||o<0||i===0||i===1&&n===o-1&&n===r+1?"":e.slice(n,o)}function XB(...e){let t=-1,o;for(;++t<e.length;)nu(e[t]),e[t]&&(o=o===void 0?e[t]:o+"/"+e[t]);return o===void 0?".":YB(o)}function YB(e){nu(e);let t=e.codePointAt(0)===47,o=ZB(e,!t);return o.length===0&&!t&&(o="."),o.length>0&&e.codePointAt(e.length-1)===47&&(o+="/"),t?"/"+o:o}function ZB(e,t){let o="",r=0,n=-1,i=0,a=-1,s,l;for(;++a<=e.length;){if(a<e.length)s=e.codePointAt(a);else{if(s===47)break;s=47}if(s===47){if(!(n===a-1||i===1))if(n!==a-1&&i===2){if(o.length<2||r!==2||o.codePointAt(o.length-1)!==46||o.codePointAt(o.length-2)!==46){if(o.length>2){if(l=o.lastIndexOf("/"),l!==o.length-1){l<0?(o="",r=0):(o=o.slice(0,l),r=o.length-1-o.lastIndexOf("/")),n=a,i=0;continue}}else if(o.length>0){o="",r=0,n=a,i=0;continue}}t&&(o=o.length>0?o+"/..":"..",r=2)}else o.length>0?o+="/"+e.slice(n+1,a):o=e.slice(n+1,a),r=a-n-1;n=a,i=0}else s===46&&i>-1?i++:i=-1}return o}function nu(e){if(typeof e!="string")throw new TypeError("Path must be a string. Received "+JSON.stringify(e))}var Y8={cwd:QB};function QB(){return"/"}function Mc(e){return!!(e!==null&&typeof e=="object"&&"href"in e&&e.href&&"protocol"in e&&e.protocol&&e.auth===void 0)}function Z8(e){if(typeof e=="string")e=new URL(e);else if(!Mc(e)){let t=new TypeError('The "path" argument must be of type string or an instance of URL. Received `'+e+"`");throw t.code="ERR_INVALID_ARG_TYPE",t}if(e.protocol!=="file:"){let t=new TypeError("The URL must be of scheme file");throw t.code="ERR_INVALID_URL_SCHEME",t}return JB(e)}function JB(e){if(e.hostname!==""){let r=new TypeError('File URL host must be "localhost" or empty on darwin');throw r.code="ERR_INVALID_FILE_URL_HOST",r}let t=e.pathname,o=-1;for(;++o<t.length;)if(t.codePointAt(o)===37&&t.codePointAt(o+1)===50){let r=t.codePointAt(o+2);if(r===70||r===102){let n=new TypeError("File URL path must not include encoded / characters");throw n.code="ERR_INVALID_FILE_URL_PATH",n}}return decodeURIComponent(t)}var Z0=["history","path","basename","stem","extname","dirname"],iu=class{constructor(t){let o;t?Mc(t)?o={path:t}:typeof t=="string"||eF(t)?o={value:t}:o=t:o={},this.cwd="cwd"in o?"":Y8.cwd(),this.data={},this.history=[],this.messages=[],this.value,this.map,this.result,this.stored;let r=-1;for(;++r<Z0.length;){let i=Z0[r];i in o&&o[i]!==void 0&&o[i]!==null&&(this[i]=i==="history"?[...o[i]]:o[i])}let n;for(n in o)Z0.includes(n)||(this[n]=o[n])}get basename(){return typeof this.path=="string"?ui.basename(this.path):void 0}set basename(t){J0(t,"basename"),Q0(t,"basename"),this.path=ui.join(this.dirname||"",t)}get dirname(){return typeof this.path=="string"?ui.dirname(this.path):void 0}set dirname(t){Q8(this.basename,"dirname"),this.path=ui.join(t||"",this.basename)}get extname(){return typeof this.path=="string"?ui.extname(this.path):void 0}set extname(t){if(Q0(t,"extname"),Q8(this.dirname,"extname"),t){if(t.codePointAt(0)!==46)throw new Error("`extname` must start with `.`");if(t.includes(".",1))throw new Error("`extname` cannot contain multiple dots")}this.path=ui.join(this.dirname,this.stem+(t||""))}get path(){return this.history[this.history.length-1]}set path(t){Mc(t)&&(t=Z8(t)),J0(t,"path"),this.path!==t&&this.history.push(t)}get stem(){return typeof this.path=="string"?ui.basename(this.path,this.extname):void 0}set stem(t){J0(t,"stem"),Q0(t,"stem"),this.path=ui.join(this.dirname||"",t+(this.extname||""))}fail(t,o,r){let n=this.message(t,o,r);throw n.fatal=!0,n}info(t,o,r){let n=this.message(t,o,r);return n.fatal=void 0,n}message(t,o,r){let n=new Jo(t,o,r);return this.path&&(n.name=this.path+":"+n.name,n.file=this.path),n.fatal=!1,this.messages.push(n),n}toString(t){return this.value===void 0?"":typeof this.value=="string"?this.value:new TextDecoder(t||void 0).decode(this.value)}};function Q0(e,t){if(e&&e.includes(ui.sep))throw new Error("`"+t+"` cannot be a path: did not expect `"+ui.sep+"`")}function J0(e,t){if(!e)throw new Error("`"+t+"` cannot be empty")}function Q8(e,t){if(!e)throw new Error("Setting `"+t+"` requires `path` to be set too")}function eF(e){return!!(e&&typeof e=="object"&&"byteLength"in e&&"byteOffset"in e)}var J8=function(e){let r=this.constructor.prototype,n=r[e],i=function(){return n.apply(i,arguments)};return Object.setPrototypeOf(i,r),i};var tF={}.hasOwnProperty,rx=class e extends J8{constructor(){super("copy"),this.Compiler=void 0,this.Parser=void 0,this.attachers=[],this.compiler=void 0,this.freezeIndex=-1,this.frozen=void 0,this.namespace={},this.parser=void 0,this.transformers=zC()}copy(){let t=new e,o=-1;for(;++o<this.attachers.length;){let r=this.attachers[o];t.use(...r)}return t.data((0,Zf.default)(!0,{},this.namespace)),t}data(t,o){return typeof t=="string"?arguments.length===2?(ox("data",this.frozen),this.namespace[t]=o,this):tF.call(this.namespace,t)&&this.namespace[t]||void 0:t?(ox("data",this.frozen),this.namespace=t,this):this.namespace}freeze(){if(this.frozen)return this;let t=this;for(;++this.freezeIndex<this.attachers.length;){let[o,...r]=this.attachers[this.freezeIndex];if(r[0]===!1)continue;r[0]===!0&&(r[0]=void 0);let n=o.call(t,...r);typeof n=="function"&&this.transformers.use(n)}return this.frozen=!0,this.freezeIndex=Number.POSITIVE_INFINITY,this}parse(t){this.freeze();let o=Yf(t),r=this.parser||this.Parser;return ex("parse",r),r(String(o),o)}process(t,o){let r=this;return this.freeze(),ex("process",this.parser||this.Parser),tx("process",this.compiler||this.Compiler),o?n(void 0,o):new Promise(n);function n(i,a){let s=Yf(t),l=r.parse(s);r.run(l,s,function(p,u,m){if(p||!u||!m)return c(p);let d=u,f=r.stringify(d,m);rF(f)?m.value=f:m.result=f,c(p,m)});function c(p,u){p||!u?a(p):i?i(u):o(void 0,u)}}}processSync(t){let o=!1,r;return this.freeze(),ex("processSync",this.parser||this.Parser),tx("processSync",this.compiler||this.Compiler),this.process(t,n),tv("processSync","process",o),r;function n(i,a){o=!0,Hh(i),r=a}}run(t,o,r){ev(t),this.freeze();let n=this.transformers;return!r&&typeof o=="function"&&(r=o,o=void 0),r?i(void 0,r):new Promise(i);function i(a,s){let l=Yf(o);n.run(t,l,c);function c(p,u,m){let d=u||t;p?s(p):a?a(d):r(void 0,d,m)}}}runSync(t,o){let r=!1,n;return this.run(t,o,i),tv("runSync","run",r),n;function i(a,s){Hh(a),n=s,r=!0}}stringify(t,o){this.freeze();let r=Yf(o),n=this.compiler||this.Compiler;return tx("stringify",n),ev(t),n(t,r)}use(t,...o){let r=this.attachers,n=this.namespace;if(ox("use",this.frozen),t!=null)if(typeof t=="function")l(t,o);else if(typeof t=="object")Array.isArray(t)?s(t):a(t);else throw new TypeError("Expected usable value, not `"+t+"`");return this;function i(c){if(typeof c=="function")l(c,[]);else if(typeof c=="object")if(Array.isArray(c)){let[p,...u]=c;l(p,u)}else a(c);else throw new TypeError("Expected usable value, not `"+c+"`")}function a(c){if(!("plugins"in c)&&!("settings"in c))throw new Error("Expected usable value but received an empty preset, which is probably a mistake: presets typically come with `plugins` and sometimes with `settings`, but this has neither");s(c.plugins),c.settings&&(n.settings=(0,Zf.default)(!0,n.settings,c.settings))}function s(c){let p=-1;if(c!=null)if(Array.isArray(c))for(;++p<c.length;){let u=c[p];i(u)}else throw new TypeError("Expected a list of plugins, not `"+c+"`")}function l(c,p){let u=-1,m=-1;for(;++u<r.length;)if(r[u][0]===c){m=u;break}if(m===-1)r.push([c,...p]);else if(p.length>0){let[d,...f]=p,h=r[m][1];Sm(h)&&Sm(d)&&(d=(0,Zf.default)(!0,h,d)),r[m]=[c,d,...f]}}}},nx=new rx().freeze();function ex(e,t){if(typeof t!="function")throw new TypeError("Cannot `"+e+"` without `parser`")}function tx(e,t){if(typeof t!="function")throw new TypeError("Cannot `"+e+"` without `compiler`")}function ox(e,t){if(t)throw new Error("Cannot call `"+e+"` on a frozen processor.\nCreate a new processor first, by calling it: use `processor()` instead of `processor`.")}function ev(e){if(!Sm(e)||typeof e.type!="string")throw new TypeError("Expected node, got `"+e+"`")}function tv(e,t,o){if(!o)throw new Error("`"+e+"` finished async. Use `"+t+"` instead")}function Yf(e){return oF(e)?e:new iu(e)}function oF(e){return!!(e&&typeof e=="object"&&"message"in e&&"messages"in e)}function rF(e){return typeof e=="string"||nF(e)}function nF(e){return!!(e&&typeof e=="object"&&"byteLength"in e&&"byteOffset"in e)}var Qf=nx().use(jf).use(Xf).freeze();var iF={blockquote:cs,break:cF,code:mi,definition:mi,delete:cs,emphasis:cs,footnoteReference:mi,footnoteDefinition:mi,heading:lF,html:mi,image:rv,imageReference:rv,inlineCode:nv,list:cs,listItem:cs,link:cs,linkReference:cs,strong:cs,table:mi,tableCell:mi,text:nv,thematicBreak:mi,toml:mi,yaml:mi},aF={},ov=[];function Ec(e){let t={...iF},o=e||aF,r=o.keep||ov,n=o.remove||ov,i=-1;for(;++i<n.length;){let c=n[i];typeof c=="string"?t[c]=mi:t[c[0]]=c[1]}let a={};if(r.length===0)a=t;else{let c;for(c in t)r.includes(c)||(a[c]=t[c]);for(i=-1;++i<r.length;)if(c=r[i],!Object.hasOwn(t,c))throw new Error("Unknown node type `"+c+"` in `keep`, use a replace tuple with a handle instead: `remove: [['"+c+"', handle]]`")}return function(c){return s(c)};function s(c){let p=c.type,u=c;if(Object.hasOwn(a,p)){let m=a[p];m&&(u=m(u)||void 0)}return u=Array.isArray(u)?l(u):u,u&&"children"in u&&(u.children=l(u.children)),u}function l(c){let p=-1,u=[];for(;++p<c.length;){let m=s(c[p]);Array.isArray(m)?u.push(...l(m)):m&&u.push(m)}return sF(u)}}function sF(e){let t=-1,o=[],r;for(;++t<e.length;){let n=e[t];r&&n.type===r.type&&"value"in n&&"value"in r?r.value+=n.value:(o.push(n),r=n)}return o}function rv(e){let t="title"in e?e.title:"",o=e.alt||t||"";return o?{type:"text",value:o}:void 0}function nv(e){return{type:"text",value:e.value}}function lF(e){return{type:"paragraph",children:e.children}}function cs(e){return e.children}function cF(){return{type:"text",value:`
`}}function mi(){}var iv=async(e,t,o)=>{if(o){let r=hl('.markdown-body[data-testid="chat-ai-message--markdown"]',t);if(!r)return iv(e,t,!1);Cm(e,r,[])}else{let r=np(e,!1,[]),n=await Qf().use(Ec).process(r);await navigator.clipboard.writeText(n.toString())}},pF=()=>{let{AIMessage:e}=ot(),{t}=k(),{chatHubLoading:o}=yt(),{pageUrl:r}=I3(),[n,i]=(0,uo.useState)(!1),a=(0,uo.useMemo)(()=>{let p=I2();return W3[p]||null},[r]),[s,l]=(0,uo.useState)(void 0),c=async(p,u)=>{let m=p.currentTarget,d=s;a&&m&&(s&&(Qc(s)||(l(void 0),d=void 0)),await iv(e,m,u),await a.insertContent(e,u,d)),Pf()};return(0,uo.useEffect)(()=>{if(a){let p=d=>{if(d.target instanceof HTMLElement&&a.selectors){let f=d.target;a.selectors.some(h=>f.matches(h))&&l(f)}},u=()=>{if(a.selectors.length){let d=!1;for(let f of a.selectors){let h=document.querySelector(f);if(h&&Qc(h)){d=!0;break}}i(d)}};u();let m=setInterval(u,1e3);return window.addEventListener("focus",p,{capture:!0}),()=>{window.removeEventListener("focus",p,{capture:!0}),clearInterval(m)}}},[a]),!a||!n?null:uo.default.createElement(uo.default.Fragment,null,uo.default.createElement(Ct,{disabled:o,sx:{p:0},onClick:p=>{c(p,!0)},"data-testid":"maxai-client--ai-message--next-action--insert-result-to-input-with-format-item"},uo.default.createElement(g,{width:"100%"},uo.default.createElement(g,{direction:"row",alignItems:"center",width:"100%",sx:{px:1},gap:1},uo.default.createElement(X,{icon:"InsertBelow",sx:{flexShrink:0,fontSize:"20px",color:"text.secondary"}}),uo.default.createElement(pa,{TooltipProps:{disableInteractive:!0},width:0,flex:1,lineClamp:1,fontSize:"16px",whiteSpace:"normal",color:"text.primary",fontWeight:400,sx:{height:"40px",lineHeight:"40px"}},t("package__features:chat__chat_with_any_content__next_actions__insert_content_with_format__title"))),uo.default.createElement(wt,null))),uo.default.createElement(Ct,{disabled:o,sx:{p:0},onClick:p=>{c(p,!1)},"data-testid":"maxai-client--ai-message--next-action--insert-result-to-input-without-format-item"},uo.default.createElement(g,{width:"100%"},uo.default.createElement(g,{direction:"row",alignItems:"center",width:"100%",sx:{px:1},gap:1},uo.default.createElement(X,{icon:"ArrowInsert",sx:{flexShrink:0,fontSize:"20px",color:"text.secondary"}}),uo.default.createElement(pa,{TooltipProps:{disableInteractive:!0},width:0,flex:1,lineClamp:1,fontSize:"16px",whiteSpace:"normal",color:"text.primary",fontWeight:400,sx:{height:"40px",lineHeight:"40px"}},t("package__features:chat__chat_with_any_content__next_actions__insert_content_without_format__title"))),uo.default.createElement(wt,null))))},av=pF;var Ui=v(A()),uF=e=>{let{nextActions:t}=e,{chatHubLoading:o}=yt(),{askAIWithShortcutsV2:r}=ze(),{AIMessage:n}=ot(),i=async a=>{let s=Vm(a);if(s.actions){let l=[],c=Dn(n,!1);c=c.replace(dl,""),l.push({type:"SET_VARIABLE_MAP",parameters:{VariableMap:{[Ue.PRESET_VARIABLE__SELECTED_TEXT.name]:c}}}),l.push(...s.actions),await r(l,{disabledMaxAIDocumentIds:!0,keepLoadingAfterExecution:!0})}};return Ui.default.createElement(Si,{in:!0,timeout:150},Ui.default.createElement(g,{sx:{mt:"0!important"}},t.length>0&&Ui.default.createElement(av,null),t.map((a,s)=>{let l=s===t.length-1;if(!a.input?.prompt_action)return null;let c=a.input.prompt_action;return Ui.default.createElement(Ct,{key:c.prompt_id,disabled:o,sx:{p:0},onClick:async()=>{await i(c)},"data-testid":`maxai-client--ai-message--next-action--use-prompt-action-item-${s}`},Ui.default.createElement(g,{width:"100%"},Ui.default.createElement(g,{direction:"row",alignItems:"center",width:"100%",sx:{px:1},gap:1},c.prompt_icon&&Ui.default.createElement(X,{icon:c.prompt_icon,sx:{flexShrink:0,fontSize:"20px",color:"text.secondary"}}),Ui.default.createElement(pa,{TooltipProps:{disableInteractive:!0},width:0,flex:1,lineClamp:1,fontSize:"16px",whiteSpace:"normal",color:"text.primary",fontWeight:400,sx:{height:"40px",lineHeight:"40px"}},Ra(c.prompt_id,c.prompt_title))),!l&&Ui.default.createElement(wt,null)))})))},sv=uF;var xn=v(A());var Jf=new Map,lv=(e,t)=>{window.dispatchEvent(new CustomEvent(e,{detail:{...t,appVersion:uh,runTimeEnv:qc}}))},cv=(e,t)=>{if(Jf.get(t))return;let o=r=>{let{appVersion:n,runTimeEnv:i}=r.detail||{};n===uh&&i===qc&&t(r)};Jf.set(t,o),window.addEventListener(e,o)},pv=(e,t)=>{let o=Jf.get(t);o&&(Jf.delete(t),window.removeEventListener(e,o))};var uv=v(oM());var Wi=v(A()),mF=({order:e,title:t,disabled:o,onClick:r})=>Wi.default.createElement(Ct,{disabled:o,sx:{p:0},onClick:r,"data-testid":`maxai-client--ai-message--next-action--related-question-item-${e}`},Wi.default.createElement(g,{width:"100%"},Wi.default.createElement(wt,null),Wi.default.createElement(g,{direction:"row",alignItems:"center",width:"100%",sx:{px:1},gap:1},Wi.default.createElement(pa,{TooltipProps:{disableInteractive:!0},lineClamp:1,fontSize:"16px",whiteSpace:"normal",color:"text.primary",fontWeight:400,sx:{height:"40px",lineHeight:"40px"}},t),Wi.default.createElement(uv.default,{sx:{ml:"auto",mr:0,fontSize:"24px",color:"text.primary"}})))),dF=e=>{let{nextActions:t}=e,{chatHubLoading:o}=yt();return Array.isArray(t)?Wi.default.createElement(Si,{in:!0,timeout:150},Wi.default.createElement(g,null,t.map((r,n)=>r.input?.content?Wi.default.createElement(mF,{order:n+1,title:r.input.content,key:r.input.content,disabled:o,onClick:async()=>{lv("MAXAI_CLIENT__CHAT_INPUT__SEND_MESSAGE",{value:r.input.content})}}):null))):null},mv=dF;var fF=e=>{let{nextActions:t,nextActionsStatus:o}=e,{t:r}=k(),{variant:n}=eo(),{isLoading:i}=ot(),{relatedQuestions:a,usePromptActionPrompts:s}=(0,xn.useMemo)(()=>{let l=[],c=[];return t.forEach(p=>{switch(p.type){case"UsePromptAction":{c.push(p);break}case"FollowUpQuery":{l.push(p);break}case"FocusedSearch":}}),{usePromptActionPrompts:c,relatedQuestions:l}},[t]);return!i&&t.length===0||n==="share"?null:xn.default.createElement(xn.default.Fragment,null,xn.default.createElement(wt,{sx:{mt:"32px!important"}}),o&&o!=="complete"&&xn.default.createElement(g,{direction:"row",alignItems:"center",spacing:1},xn.default.createElement(F,{sx:{display:"inline-block",width:"12px",height:"12px",margin:"0 0 0 4px !important",borderRadius:"50%",backgroundColor:l=>l.palette.mode==="dark"?"#fff":"#000"}})),o==="complete"&&a.length>0&&xn.default.createElement(xn.default.Fragment,null,xn.default.createElement(Ri,{title:{title:r("package__features:chat__chat_with_any_content__next_actions__related__title"),titleIcon:"Stacks"}})),a.length>0&&xn.default.createElement(mv,{nextActions:a}),xn.default.createElement(sv,{nextActions:s}))},dv=fF;var fv=v(On());var fa=v(A()),hF=e=>{let{message:t}=e,{metadata:o}=ot(),{variant:r}=eo(),{isPayingUser:n}=vt(),{showPricingHooksPopup:i}=wl(),{updateMessage:a}=Li(),s=o.embeddedPaywall,l=async p=>{if(!s)return;ti("click",{conversationId:t.conversationId,paywallType:"response",paywallReason:"ProChat",buttonType:"upgrade",targetElement:p?.currentTarget});let u=await Os.sendUserAction(s.cta_action_name);u?.paywall&&i(t.conversationId,u.paywall)},c=()=>{if(!s)return;let p=qo([{},t,{originalMessage:{metadata:{embeddedPaywall:{status:"hidden"}}}}]);a(t.conversationId,p),Os.sendUserAction(s.close_action_name)};return r==="share"||n||!s||s.status==="hidden"?null:fa.default.createElement(g,{spacing:1,direction:"row",alignItems:"center",sx:{border:"1px solid",borderColor:"border.main",borderRadius:1,px:1.5,py:"10px"}},fa.default.createElement(ll,{sx:{color:"text.primary",fontSize:"20px"}}),fa.default.createElement(g,{flex:1,spacing:.5},fa.default.createElement(T,{fontSize:"14px",fontWeight:500,color:"text.primary"},s.title),fa.default.createElement(T,{fontSize:"14px",color:"text.secondary"},s.message)),fa.default.createElement(Ce,{variant:"contained",onClick:l},s.cta_button_title),fa.default.createElement(fe,{onClick:c,sx:{width:36,height:36}},fa.default.createElement(fv.default,{sx:{fontSize:20}})))},e1=hF;var r1=v(A());var Gn=v(A()),gF=e=>{let{contentType:t="text"}=e;return t==="image"?Gn.default.createElement(g,{mt:1,width:"60%",minWidth:Zc-16-16},Gn.default.createElement(g,{width:"100%",sx:{position:"relative",paddingBottom:"100%",bgcolor:"#F4F4F7",borderRadius:"8px",alignItems:"center",justifyContent:"center"}},Gn.default.createElement(F,{sx:{position:"absolute",top:0,left:0,width:"100%",height:"100%"}}),Gn.default.createElement("img",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%,-50%)"},width:64,height:64,src:$c("/images/art/creating-image.gif"),alt:"Creating image"}))):Gn.default.createElement(g,{mt:1},Gn.default.createElement(Co,{animation:"wave",height:10}),Gn.default.createElement(Co,{animation:"wave",height:10}),Gn.default.createElement(Co,{animation:"wave",height:10}),Gn.default.createElement(Co,{animation:"wave",height:10}),Gn.default.createElement(Co,{animation:"wave",height:10}),Gn.default.createElement(Co,{animation:"wave",height:10}))},hv=gF;var no=v(A());var xv=v(pm()),_v=v(gv());var au=v(A()),yF=e=>{let{collapsed:t,disabled:o,onClick:r,children:n}=e,i=typeof t=="boolean"&&!o;return au.default.createElement(g,{direction:"row",onClick:i?r:void 0,sx:{width:"max-content",alignItems:"center",color:a=>a.palette.mode==="dark"?"rgba(255, 255, 255, 0.7)":"rgba(0, 0, 0, 0.7)","&:hover":i?{cursor:"pointer",color:a=>a.palette.mode==="dark"?"rgba(255, 255, 255, 0.8)":"rgba(0, 0, 0, 0.6)"}:void 0}},au.default.createElement(T,{fontSize:16,fontWeight:400},n||""),i?t?au.default.createElement(xv.default,{sx:{fontSize:20,color:"inhert"}}):au.default.createElement(_v.default,{sx:{fontSize:20,color:"inhert"}}):null)},Ac=yF;var bF=e=>{let{message:t}=e,{t:o}=k(),{isDarkMode:r}=Zr(),{metadata:n,content:i}=ot(),[a,s]=(0,no.useState)(!0),[l,c]=(0,no.useState)(1),p=(0,no.useMemo)(()=>$o(void 0,n.AIModel),[n.AIModel]),u=(0,no.useMemo)(()=>{let m=n?.AIModel,d=n?.processingText,f=n?.thinkingText,h=n?.copilot,C=_m(t);return f?C?"reasoningText":"reasonedText":C?h?"skeleton":d?"processingText":m?MC(m)&&p?.disableStreaming?"countdown":"understandingText":"point":"empty"},[n,i.contentType,p]);return(0,no.useEffect)(()=>{if(u==="reasoningText"&&s(!1),u==="reasonedText"&&s(!0),u==="countdown"){c(1);let m=setInterval(()=>{c(d=>d+1)},1e3);return()=>clearInterval(m)}},[u]),u==="empty"?null:no.default.createElement(g,{spacing:1},u==="skeleton"&&no.default.createElement(hv,{contentType:i.contentType}),u==="processingText"&&no.default.createElement(Ac,null,t.originalMessage?.metadata?.processingText||""),u==="countdown"&&no.default.createElement(Ac,{collapsed:a,onClick:()=>s(!a),disabled:!n.thinkingText},o("package__features:chat__ai_message__think_for_x_seconds",{COUNTDOWN:l})),u==="understandingText"&&no.default.createElement(Ac,{collapsed:a,onClick:()=>s(!a),disabled:!n.thinkingText},o("package__features:chat__ai_message__understanding_text")),u==="reasoningText"&&no.default.createElement(Ac,{collapsed:a,onClick:()=>s(!a),disabled:!n.thinkingText},o("package__features:chat__ai_message__reasoning_text")),u==="reasonedText"&&no.default.createElement(Ac,{collapsed:a,onClick:()=>s(!a),disabled:!n.thinkingText},o("package__features:chat__ai_message__reasoned_text",{AI_MODEL:p?.title||n.AIModel||""})),n?.thinkingText&&!a&&no.default.createElement(F,{className:`markdown-body ${r?"markdown-body-dark":""}`,sx:{borderLeft:"2px solid",borderColor:"border.main",pl:1}},no.default.createElement(F,{sx:{fontSize:14,color:m=>m.palette.mode==="dark"?"rgba(255,255,255,0.6)":"rgba(0,0,0,0.6)","& a":{color:"inherit!important",fontSize:14,textDecoration:"none!important",pointerEvents:"none"}}},no.default.createElement(no.Suspense,{fallback:no.default.createElement(Br,{loading:!0})},no.default.createElement(Na,{message:t,enableTextToStreaming:n.AIModel==="deepseek-r1"},n.thinkingText)))))},Cv=bF;var bv=v(A());var yv=v(A()),SF=e=>{let{loading:t,children:o,sx:r,...n}=e;return yv.default.createElement(T,{sx:t?{position:"relative","&::after":{content:'""',animation:"dots 1.5s infinite"},"@keyframes dots":{"0%":{content:'"."'},"25%":{content:'".."'},"50%":{content:'"..."'},"75%":{content:'".."'},"100%":{content:'"."'}},...r}:r,...n},o?.replace("...",""))},Pc=SF;var IF=e=>{let{t}=k(),{metadata:o,processingStep:r}=ot();return r==="RESPONDING"||r==="RESPONDED"?null:bv.default.createElement(Pc,{fontSize:16,color:"text.tertiary",loading:!0},o.processingText||t("package__features:chat__ai_message__understanding_text"))},Sv=IF;var ht=v(A());var Iv=v(kh()),vv=v(pm());var er=v(A()),vF=To(x_)(({theme:e})=>({position:"relative",borderRadius:e.shape.borderRadius,"&::before":{display:"none"},[`&.${yl.expanded}`]:{margin:0}})),wF=To(C_)(()=>({color:"text.secondary",minHeight:"auto",padding:0,[`&.${yl.expanded}`]:{minHeight:"auto",padding:0},[`& .${yl.content}`]:{margin:0},[`& .${yl.content}.${yl.expanded}`]:{margin:0},"&:hover":{cursor:"pointer",opacity:.8}})),TF=To(__)({padding:0}),MF=e=>{let{size:t}=e;return er.default.createElement(F,{position:"relative",width:t,height:t,zIndex:1},er.default.createElement(F,{position:"absolute",width:t,height:t,sx:{bgcolor:o=>o.palette.mode==="light"?"rgb(235,235,235)":"rgb(185,185,185)",borderRadius:"50%",animation:"anim 1.0s infinite ease-in-out","@keyframes anim":{"0%,100%":{transform:"scale(1.1)"},"50%":{transform:"scale(0.9)"}}}}),er.default.createElement(F,{position:"absolute",width:t/2,height:t/2,sx:{left:"50%",top:"50%",transform:"translate(-50%, -50%)",bgcolor:"text.primary",borderRadius:"50%"}}))},EF=e=>{let{title:t,icon:o,loading:r,customize:n,extraNode:i,titleSx:a,iconSx:s,headerSx:l,contentSx:c,children:p,...u}=e,m=o;m||(m=er.default.createElement(F,{display:"flex",justifyContent:"center",alignItems:"center",width:20,height:20},r?er.default.createElement(MF,{size:16}):er.default.createElement(Iv.default,{sx:{fontSize:16,color:"text.tertiary"}})));let d=()=>n?p:p?er.default.createElement(er.default.Fragment,null,er.default.createElement(F,{sx:{position:"absolute",left:"9.5px",top:"22px",bottom:"4px",width:"1px",bgcolor:"text.tertiary"}}),er.default.createElement(g,{gap:.5,pl:"28px",pb:.5,sx:c},p)):null;return er.default.createElement(vF,{variant:"outlined",...u},er.default.createElement(wF,{expandIcon:er.default.createElement(vv.default,{sx:{fontSize:"24px"}})},er.default.createElement(g,{flex:1,height:"32px",direction:"row",alignItems:"center",justifyContent:"space-between",sx:l},er.default.createElement(Ri,{title:{title:t,titleIcon:m},fontSx:{fontSize:16,color:"text.secondary",...a},iconSx:s}),er.default.createElement(g,{direction:"row",alignItems:"center"},i))),er.default.createElement(TF,null,d()))},o1=EF;var AF=e=>{let{message:t}=e,{t:o}=k(),{isDarkMode:r}=Zr(),{metadata:n,processingStep:i}=ot(),[a,s]=(0,ht.useState)(!0),[l,c]=(0,ht.useState)(!1),[p,u]=(0,ht.useState)(!1),[m,d]=(0,ht.useState)(!1),{chatHubLoading:f}=yt(),h=st({expanded:l}),C=(0,ht.useMemo)(()=>$o(void 0,n.AIModel),[n.AIModel]),x=n.preprocessingTrackers||[],_=n.thinkingText,y=typeof _=="string"||i==="REASONING",b=(0,ht.useCallback)(()=>{h.current.expanded||(s(!1),clearTimeout(h.current.timeout),h.current.timeout=setTimeout(()=>{s(!0)},100))},[]);(0,ht.useEffect)(()=>(i==="ANALYZING"&&(b(),c(!0),u(!0)),i==="REASONING"&&(b(),c(!0),u(!1),d(!0)),i==="RESPONDING"&&c(!1),i==="RESPONDED"&&c(!1),()=>{clearTimeout(h.current.timeout)}),[i]);let S=()=>x.length?x.map((w,E)=>{let O=i=="ANALYZING"&&E===x.length-1,L=w.status.replace("...","");return ht.default.createElement(Pc,{key:E,fontSize:14,color:O?"text.primary":"text.tertiary",loading:O,noWrap:!0},L)}):null,I=()=>_?ht.default.createElement(F,{className:`markdown-body ${r?"markdown-body-dark":""}`},ht.default.createElement(F,{sx:{fontSize:14,color:i==="REASONING"?"text.primary":"text.tertiary","& a":{color:"inherit!important",fontSize:14,textDecoration:"none!important",pointerEvents:"none"}}},ht.default.createElement(ht.Suspense,{fallback:ht.default.createElement(Br,{loading:!0})},ht.default.createElement(Na,{message:t,enableTextToStreaming:n.AIModel==="deepseek-r1"},_)))):null;return ht.default.createElement(o1,{title:"Pro chat",icon:ht.default.createElement(ll,{sx:{color:"text.primary"}}),sx:{px:1,py:.5},titleSx:{color:"text.primary",fontWeight:500},slotProps:{transition:f?{timeout:0}:{}},expanded:l,customize:!0,onChange:()=>{let w=!l;c(w),b(),w&&(y?(u(!1),d(!0)):u(!0))},extraNode:ht.default.createElement(ht.default.Fragment,null,ht.default.createElement(Or,{size:16,model:n.AIModel||""}),ht.default.createElement(T,{sx:{mx:.5,fontSize:12,color:w=>w.palette.mode==="dark"?"rgba(255, 255, 255, 0.87)":"rgba(0, 0, 0, 0.87)"}},$o(void 0,n.AIModel)?.title))},ht.default.createElement(g,null,ht.default.createElement(o1,{title:ht.default.createElement(Pc,{loading:i==="ANALYZING"},i==="ANALYZING"?o("package__features:chat__ai_message__analyzing_text"):o("package__features:chat__ai_message__analyzed_text")),expanded:p,loading:i==="ANALYZING",onChange:()=>u(!p),slotProps:{transition:a&&!f?{}:{timeout:0}},sx:{border:"none"},headerSx:{py:0}},S()),y?ht.default.createElement(o1,{title:ht.default.createElement(Pc,{loading:i==="REASONING"},i==="REASONING"?o("package__features:chat__ai_message__reasoning_text"):o("package__features:chat__ai_message__reasoned_text",{AI_MODEL:C?.title||n.AIModel||""})),expanded:m,loading:i==="REASONING",onChange:()=>d(!m),slotProps:{transition:a&&!f?{}:{timeout:0}},sx:{border:"none"},headerSx:{py:0}},I()):null))},wv=AF;var PF=e=>{let{metadata:t}=ot();return t.chatMode==="pro_chat"?r1.default.createElement(wv,{...e}):t.chatMode==="free_chat"?r1.default.createElement(Sv,{...e}):t.thinkingText||!t.isComplete?r1.default.createElement(Cv,{...e}):null},ix=PF;var Mv=v(Tv());var mo=v(A()),BF=mo.default.memo(({knowledgeSources:e})=>{let[t,o]=(0,mo.useState)(!1),r=()=>{o(!t)},{t:n}=k();return mo.default.createElement(sn,{variant:"outlined",sx:{borderRadius:"8px",padding:"12px",width:"100%",overflow:"hidden",position:"relative",border:"0px",bgcolor:i=>i.palette.mode==="dark"?"rgba(59, 61, 62, 1)":"rgba(244, 244, 244, 1)"}},mo.default.createElement(F,{display:"flex",alignItems:"center",mb:2},mo.default.createElement("img",{src:`https://t2.gstatic.com/faviconV2?client=SOCIAL&type=FAVICON&fallback_opts=TYPE,SIZE,URL&url=http://${e.title}.com&size=64`,alt:"Logo",style:{width:40,height:40,borderRadius:"8px",marginRight:"8px"}}),mo.default.createElement(F,{flex:1},mo.default.createElement(g,{direction:"row",justifyContent:"space-between",sx:{}},mo.default.createElement(T,{sx:{fontSize:16,fontWeight:600,lineHeight:"150%"},component:"div"},e.title),mo.default.createElement(Ce,{onClick:r,sx:{color:"text.primary",height:"25px",borderRadius:"13px",bgcolor:i=>i.palette.mode==="dark"?"rgba(255, 255, 255, 0.16)":"rgba(0, 0, 0, 0.08)"}},mo.default.createElement(Mv.default,{sx:{fontSize:"16px",transition:"all 0.2s",transform:t?"rotate(0deg)":"rotate(180deg)",marginRight:"3px",marginLeft:"-3px"}}),n(t?"package__features:chat__ai_message__knowledge__hide":"package__features:chat__ai_message__knowledge__show_all"))),mo.default.createElement(T,{variant:"body2",color:"textSecondary"},e.titleDescription))),mo.default.createElement(wt,null),mo.default.createElement(F,{sx:{marginTop:"8px",maxHeight:t?"1000px":"140px",overflow:"hidden"}},e?.knowledgePanelList&&e?.knowledgePanelList.map(i=>mo.default.createElement(F,{className:"knowledge-source-item",key:i.title,mx:1,my:1,sx:{display:"flex",alignItems:"flex-start"}},mo.default.createElement(T,{variant:"body2",sx:{fontWeight:"600",fontSize:"14px",width:"130px",minWidth:"130px",maxWidth:"130px",lineHeight:1.6}},i.title),mo.default.createElement(F,{flex:1},i.content&&i.content.map((a,s)=>mo.default.createElement(mo.default.Fragment,{key:s},a.type==="a"?mo.default.createElement(Ti,{target:"_blank",href:a.href,sx:{display:"inline",fontSize:"14px",color:l=>l.palette.mode==="dark"?"rgba(255, 255, 255, 0.7)":"rgba(0, 0, 0, 0.6)",textDecorationColor:l=>l.palette.mode==="dark"?"rgba(255, 255, 255, 0.7)":"rgba(0, 0, 0, 0.6)"}},a.text):mo.default.createElement(T,{sx:{display:"inline",fontSize:"14px",color:l=>l.palette.mode==="dark"?"rgba(255, 255, 255, 0.7)":"rgba(0, 0, 0, 0.6)"}},a.text))))))))}),Ev=BF;var Pv=v(aM());var jn=v(A());var Fo=v(A()),FF=To("div")({display:"flex",justifyContent:"center",alignItems:"center",maxWidth:870,maxHeight:"100%",width:"100%"}),DF=To("img")({borderRadius:8,width:"auto",height:"auto",objectFit:"cover",maxWidth:"100%",maxHeight:"98vh",minWidth:100}),HF=To("img",{shouldForwardProp:e=>e!=="selected"})(({theme:e,selected:t})=>({boxSizing:"border-box",objectFit:"cover",width:"100%",maxHeight:"100%"})),NF=(0,Fo.memo)(HF),zF=({images:e,selectedImage:t,setSelectedImage:o})=>{let[r]=(0,Fo.useState)([]),n=(0,Fo.useMemo)(()=>e.filter(s=>!r.includes(s.src)),[r,e]),i=()=>{o(void 0)},a=s=>{s.currentTarget.style.display="none"};return t?Fo.default.createElement(Fo.default.Fragment,null,Fo.default.createElement(w_,{open:!!t,onClose:i,fullScreen:!0,PaperProps:{style:{backgroundColor:"transparent",boxShadow:"none"}},slotProps:{backdrop:{style:{backgroundColor:"rgba(0, 0, 0, 0.8)"}}}},Fo.default.createElement(T_,{sx:{overflowX:"hidden",display:"flex",justifyContent:"center",alignItems:"center",height:"100%",padding:0},onClick:()=>i()},Fo.default.createElement(F,{display:"flex",alignItems:"center",height:"100%",width:"100%"},Fo.default.createElement(F,{flexGrow:1,flexShrink:1,display:"flex",justifyContent:"center",alignItems:"center",pr:2,pl:2,height:"100%"},Fo.default.createElement(FF,null,Fo.default.createElement(DF,{onClick:s=>{s.stopPropagation()},src:t,onError:a}))),Fo.default.createElement(F,{sx:{pt:2,pb:2},boxSizing:"border-box",height:"100%"},Fo.default.createElement(F,{onClick:s=>s.stopPropagation(),sx:{flexShrink:0,gap:1,overflowY:"auto",maxHeight:"100%",boxSizing:"border-box",pt:2,pb:2,marginRight:"32px",width:"284px",alignContent:"flex-start",justifyContent:"center"}},Fo.default.createElement(E_,{variant:"masonry",cols:2,gap:8},n.map(s=>Fo.default.createElement(A_,{key:s.src},Fo.default.createElement(NF,{src:s.src,alt:s.alt,selected:t===s.src,onClick:l=>{l.stopPropagation(),o(s.src)},onError:l=>{l.currentTarget.parentElement&&(l.currentTarget.parentElement.style.display="none"),l.currentTarget.style.display="none"},sx:{border:"2px solid",borderColor:t===s.src?"primary.main":"transparent",borderRadius:.5}})))))))))):null},kc=zF;var _n=v(A()),VF=e=>{let{message:t,images:o,loading:r,handleUpdateMessageOnImageError:n}=e,[i,a]=(0,_n.useState)([]),[s,l]=(0,_n.useState)(),c=f_(i,300,[]);(0,_n.useEffect)(()=>{if(r||c.length===0)return;let u=setTimeout(()=>{let m=De(t),d=m.originalMessage?.metadata?.searchResults;if(!d)return;let f=!1;d.forEach(h=>{h.images=h.images?.filter(C=>c.includes(C.src)?(f=!0,!1):!0)}),f&&n(m)},400);return()=>{clearTimeout(u)}},[r,c]);let p=(0,_n.useMemo)(()=>a_(o.filter(u=>!i.includes(u.src)),"src"),[i,o]);return _n.default.createElement(_n.default.Fragment,null,p.map(u=>_n.default.createElement(F,{component:"div",key:u.src,sx:{img:{border:m=>m.palette.mode==="dark"?"1px solid  rgba(255, 255, 255, 0.16)":"1px solid rgba(0, 0, 0, 0.08)"}}},_n.default.createElement(Ai,{width:64,height:64,imgStyle:{borderRadius:"8px",cursor:"pointer",objectFit:"cover",display:"block",overflow:"hidden"},onImageClick:()=>{l(u.src)},src:u.src,alt:u.alt||"",onError:()=>{a(m=>[...new Set([...m,u.src])])}}))),_n.default.createElement(kc,{images:p.map(u=>({src:u.src,alt:u.alt})),selectedImage:s,setSelectedImage:l}))},Av=VF;var RF=e=>{let{loading:t,message:o,images:r,videos:n,knowledgePanels:i}=e,{openVideoPopup:a}=hC(),{updateMessage:s}=Li();return jn.default.createElement(jn.default.Fragment,null,(r.length>0||n.length>0)&&jn.default.createElement(g,{className:"media_sources",spacing:1},r.length>0&&jn.default.createElement(g,{spacing:1,direction:"row",className:"image_sources",sx:{overflowX:"scroll","&::-webkit-scrollbar":{display:"none",width:0,background:"transparent"}}},jn.default.createElement(Av,{key:o?.conversationId,message:o,loading:t,images:r,handleUpdateMessageOnImageError:l=>{l.conversationId&&s(l.conversationId,l)}})),n.length>0&&jn.default.createElement(g,{spacing:1,direction:"row",className:"image_sources",sx:{overflowX:"scroll","&::-webkit-scrollbar":{display:"none",width:0,background:"transparent"}}},n.map(l=>jn.default.createElement(g,{sx:{position:"relative",cursor:"pointer",img:{border:c=>c.palette.mode==="dark"?"1px solid rgba(255, 255, 255, 0.16)":"1px solid rgba(0, 0, 0, 0.08)"}},className:"videoItem",key:l.src,onClick:()=>{a(l.src,"",!0)}},jn.default.createElement(Ai,{width:114,height:64,imgStyle:{borderRadius:"8px",cursor:"pointer",objectFit:"cover",display:"block",overflow:"hidden"},src:l.imgSrc||l.poster||"",alt:""}),jn.default.createElement(F,{sx:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",height:16,width:16,color:"white",p:2,borderRadius:"50%",lineHeight:0,bgcolor:"#00000080",backdropFilter:"blur(4px)"}},jn.default.createElement(Pv.default,{sx:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",fontSize:16}})))))),i.length>0&&jn.default.createElement(Ev,{knowledgeSources:i[0]}))},kv=RF;var en=v(A());var Cn=v(A()),UF=e=>{let{contextMenuList:t=[],onSelectActions:o,onClose:r,placement:n,query:i,onChange:a}=e,{t:s}=k(),l=(0,Cn.useRef)(null),{contextMenuPath:c}=co(),p=(0,Cn.useRef)(null),u=()=>{p.current?.querySelector("input")?.focus()},m=()=>{u()},d=C=>{u(),C&&C.actions&&c&&(o?.(C.actions),r?.())},[f,h]=(0,Cn.useState)(null);return Cn.default.createElement(g,{direction:n?.startsWith("top")?"column-reverse":"column",height:"100%",ref:h},Cn.default.createElement(Pa,{mouseEvent:"onClick",onClickAway:()=>{r?.()}},Cn.default.createElement(Ut,{value:i,onChange:C=>a(C.target.value),"aria-autocomplete":"none",ref:p,"data-testid":"context-menu-use-prompt--textfield",autoFocus:!0,sx:{width:300,bgcolor:"background.paper",borderRadius:1,"& input":{py:1,px:2,borderRadius:1,fontSize:"16px"}},onKeyDownCapture:C=>{l.current?.proxyKeyboardEvent(C.nativeEvent)&&(C.preventDefault(),C.stopPropagation()),C.key==="Escape"&&(r?.(),C.preventDefault(),C.stopPropagation());let x=l.current?.getSelectedItem();C.key==="Enter"&&x&&(d(x),r?.(),C.preventDefault(),C.stopPropagation())},onKeyDown:C=>{C.stopPropagation()},onKeyUp:C=>{C.stopPropagation()},inputProps:{autoComplete:"off"}})),f&&Cn.default.createElement(Qd,{ref:l,menuList:t,menuWidth:300,menuMaxHeight:"350px",defaultPlacement:n,onClickGroup:m,referenceElement:Cn.default.createElement(F,{position:"relative",left:0,top:n?.startsWith("top")?"4px":"-4px"}),root:f,open:!0,onClickItem:d,zIndex:1e4,noOptionFallback:Cn.default.createElement(T,{width:"100%",p:1,textAlign:"left",color:C=>C.palette.text.secondary,fontSize:"14px"},s("package__features:context_menu__button__use__prompt_no_options"))}),t.length>0&&Cn.default.createElement(F,{sx:{bgcolor:C=>C.palette.background.default,height:"10px",width:"100%"}}))},Lv=UF;var WF=e=>{let{className:t,sx:o,disabled:r,message:n,open:i,onOpenChange:a}=e,s="max-ai__actions__button--use-prompt",[l,c]=(0,en.useState)(null),{t:p}=k(),{contextMenuPath:u}=co(),{askAIWithShortcutsV2:m}=ze(),{context:d,placement:f,floatingStyles:h,refs:C}=Da({open:i,strategy:"fixed",onOpenChange(L){a(L)},placement:"bottom-start",middleware:[Uu(8),Gu({fallbackPlacements:["top-start","top-end","bottom-end"]}),Wu()],whileElementsMounted:xl}),x=mm(d),_=fm(d),{getReferenceProps:y,getFloatingProps:b}=Tl([x,_]),[S,I]=(0,en.useState)(""),{liteContextMenuActionsItems:w}=Hl(S,{enabledVisibilitySettings:!0,enabledFavorite:!0}),E=async L=>{let G="";n&&(typeof n=="string"?G=n:(G=Dn(n,!1),G=G.replace(dl,"")));let H=[{type:"SET_VARIABLE",parameters:{Variable:{key:"SELECTED_TEXT",value:G||" ",label:"Selected text",isBuiltIn:!0,overwrite:!0}}},{type:"SET_VARIABLE",parameters:{Variable:{key:"VARIABLE_MODAL_KEY",value:"Sidebar",overwrite:!0,isBuiltIn:!0}}}];await m(De(L),{beforeActions:H,disabledMaxAIDocumentIds:!0,keepLoadingAfterExecution:!0})},O=(0,en.useMemo)(()=>w.flatMap(L=>{if(L.type==="group"){let G=`context_menu__prompt__${L.prompt_id}`,H=`package__features:${G}`,V=p(H),W=Ci?V==="package__features:"+G:V===G;return(!V||V===L.prompt_id||W||G===H)&&(V=L.prompt_title),[V+"__CONTEXT_MENU_LABEL_SLOT_PLACEHOLDER__"+L.prompt_id,...L.children??[]]}return[L]}),[w,p]);return en.default.createElement(en.default.Fragment,null,en.default.createElement(fe,{tooltipProps:{placement:"top"},title:p("package__features:context_menu__button__use__prompt"),sx:{p:"6px",...o},"data-testid":s,className:t,onClick:L=>{c(l?null:L.currentTarget)},disabled:r,buttonRefBind:C.setReference,...y()},en.default.createElement(X,{sx:{fontSize:"20px"},icon:"Rewrite"})),i&&en.default.createElement(F,{ref:C.setFloating,style:h,...b(),sx:{width:300,height:400,zIndex:9999}},en.default.createElement(Lv,{placement:f,onSelectActions:E,onClose:()=>{I(""),a(!1)},query:S,onChange:L=>I(L),contextMenuList:O})))},GF=function(e){return en.default.createElement(qa,{defaultContextMenuPath:"/rewrite"},en.default.createElement(WF,{...e}))},Ov=GF;var Gr=v(A());var Fv=v(Bv()),su=v(A()),jF=e=>{let{message:t,...o}=e,{t:r}=k(),[n,i]=(0,su.useState)(!1),a=LC(t),s=async()=>{i(!0),await Promise.all(a.map(async l=>{let c=l.uploadedUrl;if(!c)return;let p=kC(c);if(p){let u=p.endsWith(".webp")?p.replace(".webp",".png"):p;c=(await M2.fetchDocument(u)).data?.s3?.doc_url||c}try{let u=await e_(Xr.fetch(c,{method:"GET",parse:"blob",headers:{"Content-Type":"image/png"}}),2e4,{success:!1}),m=!1;if(u.success&&u?.data?.contentType)try{let d=t.text;ln(t)&&(d=t.originalMessage?.metadata?.title?.title||""),(0,Fv.saveAs)(C2(u.data.base64,"image/png"),`${d}.png`),m=!0}catch{}if(!m){let d=document.createElement("a");d.href=c,d.download="download",d.click(),d.remove()}}catch{}})).then().catch().finally(()=>{i(!1)})};return a.length===0?null:su.default.createElement(fe,{title:r("package__features:chat__ai_message__download_image"),onClick:s,disabled:n,...o,sx:{p:"6px",borderRadius:"4px",...o.sx}},su.default.createElement(X,{icon:n?"Loading":"FileDownload",sx:{fontSize:"20px"}}))},Dv=jF;var lu=v(A()),qF=e=>{let{message:t,...o}=e,{t:r}=k(),[n,i]=(0,lu.useState)(!1),a=async s=>{let l=hl(".maxai-ai-message__image__content__box img",s.currentTarget);if(l?.src){i(!0);try{let c=new Image;await new Promise(p=>{let u=async m=>{if(m){let d=new ClipboardItem({"image/png":m});navigator.clipboard.write([d]).then(function(){p(!0)}).catch(function(f){p(!1)})}else p(!1)};try{let m=new URL(l.src);c.src=m.href+"&#",c.crossOrigin="anonymous",c.onload=()=>{let d=document.createElement("canvas");d.width=c.naturalWidth,d.height=c.naturalHeight;let f=d.getContext("2d");f&&(f.drawImage(c,0,0),d.toBlob(u))},c.onerror=async()=>{let d=await gl.proxyFetch(l.src,{method:"GET",parse:"blob",blobContentType:"image/png"});if(d?.data){let f=d.data;await u(f)}else p(!1)}}catch{p(!1)}})}catch{}finally{i(!1)}}};return lu.default.createElement(fe,{title:r("package__common:copy_image"),disabled:n,onClick:a,...o,sx:{p:"6px",...o.sx}},lu.default.createElement(X,{icon:n?"Loading":"Copy",sx:{fontSize:"20px"}}))},Hv=qF;var Uo=v(A()),Nv=[k2,O2,L2,Xc],KF=(e,t)=>t==="free_chat"?Nv:Nv.filter(o=>o.value!==e),$F=e=>{let{message:t}=e,{isLastMessage:o}=ot(),{conversation:r}=Pi(),[n,i]=(0,Uo.useState)(!1),a=t.originalMessage?.metadata?.AIModel||"",s=t.originalMessage?.metadata?.chatMode,l=(0,Uo.useMemo)(()=>r?.type!=="Chat"||!o||!n?null:{suggestions:KF(a,s)},[t.messageId,r?.type,o,a,s,n]);return(0,Uo.useEffect)(()=>{r?.lastMessageId&&r.id?vs(r.id).then(c=>{c.lastRunActions.length>0?i(!0):i(!1)}):i(!1)},[r?.lastMessageId,r?.id]),l?Uo.default.createElement(XF,{suggestionAIModels:l.suggestions}):null},XF=e=>{let{t}=k(),{conversationId:o,conversationType:r}=ue(),{switchConversationModel:n}=ct(),i=ye(o),{suggestionAIModels:a}=e,s=a[a.length-1],l=_r.use.setChatAIModelAndProvider(),{isPayingUser:c}=vt(),{chatMode:p,updateChatMode:u}=Ya(),[m,d]=(0,Uo.useState)(!1),f=async C=>{try{if(!o||!C)return;if(p!=="pro_chat")if(c)await u("pro_chat");else{d(!0);return}let{lastRunActionsParams:x,lastRunActions:_}=await vs(o);l({AIProvider:C.AIProvider,AIModel:C.value}),await n(r,C.AIProvider,C.value);let{setShortcuts:y,runShortcuts:b}=Om(o);y(_),await b(x)}catch{}finally{}},h=(0,Uo.useMemo)(()=>a.map(C=>({value:C.value,label:C.title,icon:Uo.default.createElement(Or,{model:C.value})})),[a]);return h.length===0?null:Uo.default.createElement(Uo.default.Fragment,null,Uo.default.createElement(fe,{disabled:i,placement:"top-start",options:h,testid:"maxai--chat-message--compare-answers",sx:{p:"6px"},OptionsCardProps:{sx:{width:"240px"},title:t("package__features:chat__chat_message_tools__compare_answers__title")},onSelectOption:C=>{let x=a.find(_=>_.value===C);x&&f(x)},defaultOptionValue:s.value,autoClosePopoverOnSelectDefaultOption:!0},Uo.default.createElement(Or,{model:s.value})),Uo.default.createElement(Et,{trigger:m,placement:"top-start",anchorElementSelectors:'[data-testid="maxai--chat-pro-chat-switch"]',onClose:()=>{d(!1)},ctaButtonText:t("package__features:onboarding__onboarding_popover__cta_button__try_it"),onCTAButtonClick:async()=>{await u("pro_chat")}},Uo.default.createElement(g,{spacing:.5},Uo.default.createElement(T,{fontSize:20,lineHeight:1.4,color:"text.primary",fontWeight:700,textAlign:"left"},"Pro chat"),Uo.default.createElement(T,{fontSize:14,lineHeight:1.4,color:"text.primary",fontWeight:400,textAlign:"left"},t("package__features:onboarding__onboarding_popover__pro_chat__compare_models__description",{NAME:"Pro chat"})))))},zv=$F;var Gs=v(A()),YF=e=>{let{message:t}=e,{t:o}=k(),{isLastMessage:r}=ot(),n=t.conversationId||"",i=ye(n),{regenerate:a}=ze(),[s,l]=(0,Gs.useState)(!1);return(0,Gs.useEffect)(()=>{r&&vs(n).then(({lastRunActions:p})=>{l(p.length>0)})},[r]),r&&s?Gs.default.createElement(fe,{placement:"top",disabled:i,title:o("package__features:chat__ai_message__tools__regenerate_button"),onClick:()=>a(n),testid:"sidebar_actions__regenerate",sx:{p:"6px"}},Gs.default.createElement(X,{sx:{fontSize:"20px"},icon:"Regenerate"})):null},Vv=YF;var Rv=v(Q2()),Uv=async(e,t=!1)=>{if(e&&e?.title){let o=await ym(e,t),r=new Blob([o],{type:"text/plain;charset=utf-8"}),n=URL.createObjectURL(r),i=document.createElement("a");i.href=n,i.download=`MaxAI_Chat_${(0,Rv.default)().format("YYYY_MM_DD_HH:mm")}.txt`,i.click(),URL.revokeObjectURL(n)}};var Ve=v(A()),ZF=e=>`${qr}/share?id=${e}`,QF=()=>{let{t:e}=k(),{conversation:t,updateConversation:o,getConversation:r}=Pi(),n=t?.share?.id,[i,a]=(0,Ve.useState)(!1),[s,l]=(0,Ve.useState)(!1),c=t?.share?.enable===!0,p=(0,Ve.useRef)(null),[u,m]=(0,Ve.useState)(!1),d=(0,Ve.useMemo)(()=>[{value:"download",icon:Ve.default.createElement(X,{icon:"FileDownload"}),label:e("package__features:chat__ai_message__tools__download_this_chat")},{value:"share",icon:Ve.default.createElement(X,{icon:c?"IosShare":"Lock"}),label:e("package__features:chat__ai_message__tools__share_this_chat")}],[e,c]),f=(x=e("package__features:chat__navbar__conversation_share__share_panel__error_tip"))=>{Qi.error(x,{anchorOrigin:{vertical:"top",horizontal:"center"}})},h=async()=>{if(!t?.id)return;let x="";if(n)m(!0),c||await C(!0),x=n;else try{if(!x){l(!0);let y=await r(t.id);if(!y){f();return}await nr.getService().checkUpdate(t.id),await cn.getService().checkUpdate(t.id);let b=(await nr.getService().shareConversation(y.id,!0))?.share;b?.id&&b.enable&&(x=b.id,await o(y.id,{share:{enable:!0,id:b.id}}))}}catch{f()}finally{m(!0),l(!1)}let _=ZF(x);navigator.clipboard.writeText(_)},C=async x=>{if(t?.id)try{a(!0);let _=(await nr.getService().shareConversation(t.id,x))?.share;_?.id?await o(t.id,{share:{enable:_.enable,id:_.id}}):f()}catch{f()}finally{a(!1)}};return Ve.default.createElement(Ve.default.Fragment,null,Ve.default.createElement(fe,{placement:"top-start",buttonRefBind:x=>{p.current=x},loading:s,defaultOptionValue:"share",options:d,onSelectOption:async x=>{x==="download"&&await Uv(t),x==="share"&&await h()},testid:"maxai--conversation--share-button",sx:{width:"max-content",height:32,p:"6px",gap:"4px"},OptionsCardProps:{sx:{width:"max-content",minWidth:200}}},Ve.default.createElement(X,{icon:c?"IosShare":"Lock"}),Ve.default.createElement(T,{noWrap:!0,fontSize:"14px",lineHeight:"21px",fontWeight:500,component:"div"},e("package__features:chat__navbar__conversation_share__share_button__title"))),Ve.default.createElement(em,{open:u,anchorEl:p.current,onClose:()=>{m(!1)},anchorOrigin:{vertical:"top",horizontal:"left"},transformOrigin:{vertical:"bottom",horizontal:"left"},slotProps:{paper:{elevation:0,sx:{overflow:"unset",background:"transparent"}}}},Ve.default.createElement(g,{sx:{borderBottom:"8px solid transparent"}},Ve.default.createElement(Kr,{sx:{py:1,px:2,width:"320px",boxSizing:"border-box",display:"flex",flexDirection:"column",gap:1,border:"1px solid",borderColor:"border.main",boxShadow:"0px 4px 6px -2px rgba(16, 24, 40, 0.03);0px 12px 16px -4px rgba(16, 24, 40, 0.08);"}},Ve.default.createElement(T,{fontSize:16,fontWeight:500},e("package__features:chat__navbar__conversation_share__share_panel__title")),Ve.default.createElement(g,{sx:{"& > button":{border:"1px solid",width:"100%",p:1,borderColor:"border.main",borderRadius:"0 0 8px 8px",alignItems:"center",justifyContent:"start","&:not(:last-child)":{borderBottom:"none",borderRadius:"8px 8px 0 0"}}}},Ve.default.createElement(Ce,{"data-testid":"maxai--conversation--share-private-button",disabled:i,onClick:async()=>{await C(!1)}},Ve.default.createElement(g,{width:"100%"},Ve.default.createElement(g,{direction:"row",alignItems:"center",gap:1},i?Ve.default.createElement(Ft,{size:16}):Ve.default.createElement(X,{icon:"Lock",sx:{fontSize:"16px"}}),Ve.default.createElement(T,{textAlign:"left",fontSize:"14px",color:"text.primary"},e("package__features:chat__navbar__conversation_share__share_panel__private_button__title")),!c&&Ve.default.createElement(X,{icon:"GreenCircleCheck",sx:{ml:"auto",mr:0,fontSize:"20px"}})),Ve.default.createElement(T,{textAlign:"left",fontSize:"12px",color:"text.secondary"},e("package__features:chat__navbar__conversation_share__share_panel__private_button__description")))),Ve.default.createElement(Ce,{disabled:i,onClick:async()=>{await C(!0)}},Ve.default.createElement(g,{width:"100%"},Ve.default.createElement(g,{direction:"row",alignItems:"center",gap:1},i?Ve.default.createElement(Ft,{size:16}):Ve.default.createElement(X,{icon:"Share",sx:{fontSize:"16px"}}),Ve.default.createElement(T,{textAlign:"left",fontSize:"14px",color:"text.primary"},e("package__features:chat__navbar__conversation_share__share_panel__public_button__title")),c&&Ve.default.createElement(X,{icon:"GreenCircleCheck",sx:{ml:"auto",mr:0,fontSize:"20px"}})),Ve.default.createElement(T,{textAlign:"left",fontSize:"12px",color:"text.secondary"},e("package__features:chat__navbar__conversation_share__share_panel__public_button__description"))))),c&&Ve.default.createElement(g,{direction:"row",alignItems:"center",gap:1},Ve.default.createElement(X,{icon:"GreenCircleCheck",sx:{fontSize:"16px"}}),Ve.default.createElement(T,{textAlign:"left",fontSize:"12px",color:"#379837"},e("package__features:chat__navbar__conversation_share__share_panel__copied_tip")))))))},Wv=QF;var yn=v(A());var JF=e=>{let{message:t,onCopy:o}=e,{t:r}=k(),n=be(f=>f.chatDocuments),i=(0,yn.useRef)(null),[a,s]=(0,yn.useState)(""),l=async f=>{let h=i.current;if(!h)return;let C=hl('.markdown-body[data-testid="chat-ai-message--markdown"]',h);C&&(Cm(t,C,n),m(f))},c=async f=>{let h=np(t,!0,n),C=await Qf().use(Ec).process(h);navigator.clipboard.writeText(C.toString()),m(f)},p=async f=>{let h=np(t,!0,n);navigator.clipboard.writeText(h),m(f)},u=(0,yn.useRef)(),m=f=>{clearTimeout(u.current),o?.(),s(f),u.current=setTimeout(()=>{s("")},1e3)},d=(0,yn.useMemo)(()=>[{value:"copy_with_formatting",testid:"ai-message-tools__copy-with-formatting",icon:yn.default.createElement(X,{icon:a==="copy_with_formatting"?"Check":"CopyWithFormatting",sx:{fontSize:"20px"}}),title:r(a==="copy_with_formatting"?"package__common:copied":"package__common:copy_to_clipboard"),label:r("package__common:copy_with_formatting"),ButtonProps:{tooltipProps:{placement:"left"}}},{value:"copy_without_formatting",testid:"ai-message-tools__copy-without-formatting",icon:yn.default.createElement(X,{icon:a==="copy_without_formatting"?"Check":"CopyWithoutFormatting",sx:{fontSize:"20px"}}),title:r(a==="copy_without_formatting"?"package__common:copied":"package__common:copy_to_clipboard"),label:r("package__common:copy_without_formatting"),ButtonProps:{tooltipProps:{placement:"left"}}},{value:"copy_as_plain_text",testid:"ai-message-tools__copy-as-plain-text",icon:yn.default.createElement(X,{icon:a==="copy_as_plain_text"?"Check":"CopyTextOnly",sx:{fontSize:"20px"}}),title:r(a==="copy_as_plain_text"?"package__common:copied":"package__common:copy_to_clipboard"),label:r("package__common:copy"),ButtonProps:{tooltipProps:{placement:"left"}}}],[r,a]);return yn.default.createElement(fe,{placement:"top-start",defaultOptionValue:"copy_as_plain_text",testid:"ai-message-tools__hover-to-copy",options:d,buttonRefBind:f=>{i.current=f},disabledOnSelectOptionAutoClosePopup:!0,onClick:()=>{p("copy_as_plain_text")},onSelectOption:f=>{f==="copy_with_formatting"&&l("copy_with_formatting"),f==="copy_without_formatting"&&c("copy_without_formatting"),f==="copy_as_plain_text"&&p("copy_as_plain_text")},sx:{p:"6px"},OptionsCardProps:{sx:{width:"max-content",minWidth:"240px"}}},yn.default.createElement(X,{icon:"CopyTextOnly",sx:{fontSize:"20px"}}))},Gv=JF;var eD=e=>{let{message:t,...o}=e,{AIMessage:r}=vS(),{renderTools:n}=r||{},{conversationId:i,variant:a}=eo(),s=ye(i),l=t.originalMessage?.content?.contentType||"text",c=Gr.default.useRef(null),p=t.originalMessage?.metadata?.navMetadata?.key==="transcript"||t.originalMessage?.metadata?.videoTranscripts?.length||t.originalMessage?.metadata?.videoTimestamped?.length,u=a==="normal"&&l==="text"&&!p,{setUsePromptOpen:m,usePromptOpen:d,isLastMessage:f}=(0,Gr.useContext)(Tf),h={shareConversationButton:f&&Gr.default.createElement(Wv,null),imageCopyButton:l==="image"&&Gr.default.createElement(Hv,{message:t}),textCopyButton:l==="text"&&Gr.default.createElement(Gv,{message:t}),attachmentsDownloadButton:t&&Gr.default.createElement(Dv,{message:t}),usePromptButton:u&&Gr.default.createElement(Ov,{disabled:s,message:t,open:d,onOpenChange:m,iconButton:!0,className:"max-ai__actions__button--use-max-ai",sx:{color:x=>x.palette.mode==="dark"?"rgba(255, 255, 255, 0.7)":"rgba(0, 0, 0, 0.6)"}}),regenerateButton:a==="normal"&&Gr.default.createElement(Vv,{message:t}),modelSuggestions:a==="normal"&&Gr.default.createElement(zv,{message:t}),divider:Gr.default.createElement(wt,{sx:{minWidth:"1px",maxWidth:"1px",minHeight:"14px",maxHeight:"14px"},orientation:"vertical"})},C=n?n(h,t,{isLastMessage:f}):Gr.default.createElement(Gr.default.Fragment,null,h.shareConversationButton,h.imageCopyButton,h.textCopyButton,h.attachmentsDownloadButton,h.usePromptButton,h.regenerateButton,h.modelSuggestions);return Gr.default.createElement(g,{direction:"row",alignItems:"center",spacing:1,ref:c,...o,sx:{position:"relative",marginTop:"8px!important",...o.sx}},C)},jv=eD;var qv=v(pm());var Ae=v(A());function tD(e){return typeof e=="string"?e.split(","):Array.isArray(e)&&typeof e[0]=="string"?e:[]}var cu={px:1,borderRadius:"8px",height:"25px",display:"flex",alignItems:"center",border:"0px",bgcolor:e=>e.palette.mode==="dark"?"rgba(59, 61, 62, 1)":"rgba(244, 244, 244, 1)"},oD=({copilotType:e,copilot:t,messageIsComplete:o})=>{let r=t.steps.findIndex(u=>u.status==="loading"),[n,i]=(0,Ae.useState)(),a=(()=>{let u=r===-1?t.steps:t.steps.slice(0,r+1);return e==="art"&&(u=u.map(m=>m.title==="Optimizing art prompt"||m.title==="Generating art"?{...m,value:void 0}:m)),u})(),s=(0,Ae.useMemo)(()=>a.some(u=>u.status==="loading"),[a]),l=typeof n>"u"?s:n,c=u=>u?m=>m.palette.mode==="dark"?"#fff":"#000":m=>m.palette.mode==="dark"?"rgba(255, 255, 255, 0.5)":"rgba(0, 0, 0, 0.38)",p=(u,m)=>!(a.length-1!==m&&u.status==="complete");return Ae.default.createElement(g,{direction:"column",spacing:1,sx:{border:u=>u.palette.mode==="dark"?"1px solid rgba(255, 255, 255, 0.16)":"1px solid rgba(0, 0, 0, 0.08)",padding:"8px 10px",borderRadius:"8px"}},t.title&&Ae.default.createElement(g,{direction:"row",justifyContent:"space-between",sx:{userSelect:"none","&:hover":{cursor:"pointer"}},onClick:()=>i(!l)},Ae.default.createElement(Ri,{title:t.title}),Ae.default.createElement(qv.default,{sx:{transform:l?"rotate(180deg)":"rotate(0deg)",fontSize:"24px",transition:"all 0.2s"}})),l&&Ae.default.createElement(Ae.default.Fragment,null,Ae.default.createElement(wt,{sx:{borderColor:u=>u.palette.mode==="dark"?"rgba(255, 255, 255, 0.16)":"rgba(0, 0, 0, 0.08)"}}),a.map((u,m)=>Ae.default.createElement(g,{spacing:.5,key:u.title},Ae.default.createElement(g,{spacing:1,direction:"row",alignItems:"center"},Ae.default.createElement(g,{alignItems:"center",justifyContent:"center",width:16,height:16},!o&&u.status==="loading"?Ae.default.createElement(Ft,{size:16,sx:{color:c(!0)}}):Ae.default.createElement(X,{sx:{color:c(!1),fontSize:20},icon:"CheckCircle"})),Ae.default.createElement(T,{fontSize:14,fontWeight:500,color:c(!o&&u.status==="loading"),noWrap:!0,sx:{p:0,pl:"6px"}},u.title)),(u.value||!p(u,m))&&Ae.default.createElement(g,{direction:"row"},Ae.default.createElement(F,{sx:{minHeight:"14px",marginLeft:"7px",width:"2px",borderRadius:"2px",bgcolor:d=>p(u,m)?"transparent":d.palette.mode==="dark"?"rgba(255, 255, 255, 0.16)":"rgba(0, 0, 0, 0.08)"}}),u.value&&Ae.default.createElement(g,{spacing:1,direction:"row",alignItems:"center",sx:{flex:"1!important"}},Ae.default.createElement(g,{alignItems:"center",justifyContent:"center",width:16,height:16}),(u.valueType==="text"||u.valueType===void 0)&&Ae.default.createElement(sn,{variant:"outlined",sx:cu},Ae.default.createElement(ve,{title:String(u.value)},Ae.default.createElement(T,{fontSize:14,color:"text.primary",noWrap:!0,maxWidth:256},String(u.value)))),u.valueType==="tags"&&Ae.default.createElement(g,{gap:1,direction:"row",alignItems:"center",flexWrap:"wrap",sx:{flex:"1!important"}},tD(u.value).map((d,f)=>Ae.default.createElement(sn,{key:d+f,variant:"outlined",sx:cu},Ae.default.createElement(ve,{title:d},Ae.default.createElement(T,{noWrap:!0,maxWidth:160,fontSize:14,color:h=>h.palette.mode==="dark"?"rgba(255, 255, 255, 0.7)":"rgba(0, 0, 0, 0.6)"},d))))),u.valueType==="source"&&Ae.default.createElement(rD,{sources:u.value})))))))},rD=({sources:e})=>{let{t}=k(),[o,r]=(0,Ae.useState)(!1),n=(0,Ae.useMemo)(()=>o?e:e.slice(0,3),[o]);return Ae.default.createElement(g,{gap:1,direction:"row",alignItems:"center",flexWrap:"wrap",width:0,sx:{flex:"1!important"}},n.map((i,a)=>Ae.default.createElement(sn,{key:`${i.title}-${a}`,variant:"outlined",sx:{...cu,"&:hover":{background:s=>s.palette.mode==="dark"?"rgba(255, 255, 255, 0.16)":"rgba(0, 0, 0, 0.08)"}}},Ae.default.createElement(Im,{citation:{content:"",search_result_index:1,source:{doc_id:"",type:"search_results",engine:"",...i}}},Ae.default.createElement(Ti,{href:i.url,target:"_blank",underline:"none",maxWidth:200},Ae.default.createElement(g,{direction:"row",alignItems:"center",spacing:.5},Ae.default.createElement(F,{width:16,height:16,borderRadius:"50%",overflow:"hidden",flexShrink:0},Ae.default.createElement("img",{src:i.favicon||kn(i.url),alt:i?.from,width:"100%",height:"100%"})),Ae.default.createElement(T,{fontSize:12,color:"text.secondary",noWrap:!0},i?.from)))))),e.length>3&&!o&&Ae.default.createElement(sn,{variant:"outlined",sx:{...cu,"&:hover":{background:i=>i.palette.mode==="dark"?"rgba(255, 255, 255, 0.16)":"rgba(0, 0, 0, 0.08)",cursor:"pointer"}},onClick:()=>r(!0)},Ae.default.createElement(g,{height:"100%",direction:"row",alignItems:"center",spacing:.5},Ae.default.createElement(T,{fontSize:12,color:"text.secondary",noWrap:!0},`+ ${e.length-3} ${t("package__features:chat__ai_message__sources__more")}`))),e.length>3&&o&&Ae.default.createElement(sn,{variant:"outlined",sx:{...cu,"&:hover":{background:i=>i.palette.mode==="dark"?"rgba(255, 255, 255, 0.16)":"rgba(0, 0, 0, 0.08)",cursor:"pointer"}},onClick:()=>r(!1)},Ae.default.createElement(g,{height:"100%",direction:"row",alignItems:"center",spacing:.5,color:"text.secondary"},Ae.default.createElement(T,{fontSize:12,color:"text.secondary",noWrap:!0},t("package__features:chat__ai_message__sources__hide")))))},Kv=oD;var Qe=v(A());var $v=v(On());var to=v(A()),i1=(e=1)=>({overflow:"hidden",display:"-webkit-box","-webkit-box-orient":"vertical","-webkit-line-clamp":String(e)}),nD=({searchResult:e,searchResultIndex:t,key:o})=>to.default.createElement(sn,{key:o,sx:{marginBottom:"16px",borderRadius:"8px",border:"1px solid",backgroundColor:"initial",boxShadow:"initial",borderColor:r=>r.palette.mode==="dark"?"rgba(255, 255, 255, 0.16)":"rgba(0, 0, 0, 0.08)","&:hover":{cursor:"pointer",bgcolor:r=>r.palette.mode==="dark"?"rgba(255, 255, 255, 0.08)":"rgba(0, 0, 0, 0.04)"}}},to.default.createElement(v_,null,to.default.createElement(Ti,{href:e.url,target:"_blank",underline:"none"},to.default.createElement(g,{sx:{gap:"6px",p:"16px"}},to.default.createElement(g,{direction:"row",alignItems:"center",justifyContent:"space-between",sx:{gap:"16px"}},to.default.createElement(T,{sx:{fontSize:"16px",fontWeight:"500",lineHeight:"24px",height:"24px",color:"text.primary",...i1()}},e.title)),to.default.createElement(g,{sx:{flexDirection:"row",alignItems:"center",gap:"4px"}},to.default.createElement(F,{component:"img",src:kn(e.redirectedUrl||e.url),alt:e.from,sx:{width:"16px",height:"16px",borderRadius:"50%",objectFit:"cover",objectPosition:"center",border:"1px solid",borderColor:r=>r.palette.mode==="dark"?"rgba(255, 255, 255, 0.16)":"rgba(0, 0, 0, 0.08)"}}),to.default.createElement(T,{sx:{fontSize:"12px",fontWeight:"500",lineHeight:"18px",color:"text.secondary",...i1()}},e.from),to.default.createElement(T,{sx:{fontSize:"12px",fontWeight:"500",lineHeight:"18px",color:"text.secondary"}},"\xB7 ",t+1)),to.default.createElement(T,{sx:{fontSize:"14px",fontWeight:"400",lineHeight:"21px",color:"text.secondary",...i1(4)}},e.body))))),iD=({open:e,onClose:t,searchResults:o,metadataTitle:r})=>{let n=(0,to.useMemo)(()=>!vi(),[]),{t:i}=k();return to.default.createElement(Sl,{anchor:n?"right":"bottom",disableScrollLock:!0,disableEnforceFocus:!0,open:e,onClose:t,sx:{zIndex:1502,position:n?"fixed":"absolute",[`& .${bl.paper}`]:{position:"absolute",borderRadius:n?"16px 0 0 16px":"16px 16px 0 0",minHeight:"80vh",maxHeight:n?"100vh":"80vh",bgcolor:"background.paper",backgroundImage:"unset"}},slotProps:{backdrop:{sx:{position:"absolute"}}}},to.default.createElement(g,{sx:{maxWidth:n?"520px":"100%",height:"100%",overflow:"hidden",borderRadius:"16px, 16px, 0px, 0px"}},to.default.createElement(g,{sx:{p:"16px",position:"relative"}},to.default.createElement(T,{sx:{fontSize:"24px",fontWeight:"700",lineHeight:"34px"}},`${o.length} ${i("package__features:chat__ai_message__sources__modal__title")}`),to.default.createElement(T,{sx:{fontSize:"16px",fontWeight:"400",lineHeight:"24px",color:"text.secondary",...i1()}},r?.title),to.default.createElement(Xe,{onClick:t,sx:{position:"absolute",top:"12px",right:"12px"}},to.default.createElement($v.default,{sx:{fontSize:24}}))),to.default.createElement(wt,null),to.default.createElement(F,{sx:{flex:1,height:"0px",p:"16px",pd:0,overflowY:"auto"}},o.map((a,s)=>to.default.createElement(nD,{key:s,searchResult:a,searchResultIndex:s})))))},Xv=iD;var aD=e=>{let t=Aa(),{searchResults:o,loading:r}=e,[n,i]=(0,Qe.useState)(!1),a=(0,Qe.useMemo)(()=>t==="xs"||t==="sm"?6:t==="md"?4:t==="lg"||t==="xl"?3:6,[t]),s=(0,Qe.useMemo)(()=>12/a,[a]),l=(0,Qe.useMemo)(()=>o.length>s?o.slice(0,s-1):o,[n,o]),c=(0,Qe.useMemo)(()=>o.length>s?o.slice(s-1).map(u=>kn(u.redirectedUrl||u.url)).filter(Boolean):[],[n,o,s]),{t:p}=k();return Qe.default.createElement(Qe.default.Fragment,null,Qe.default.createElement(ei,{container:!0,spacing:1,sx:{ml:"-8px!important"}},r?Array(6).fill("").map((u,m)=>Qe.default.createElement(ei,{item:!0,xs:a,key:m},Qe.default.createElement(Co,{variant:"rounded",width:"100%",height:60}))):Qe.default.createElement(Qe.default.Fragment,null,l.map((u,m)=>Qe.default.createElement(ei,{item:!0,xs:a,key:m,className:"sourceGrid"},Qe.default.createElement(Im,{citation:{content:"",search_result_index:1,source:{doc_id:"",type:"search_results",...u,from:u?.from||"",engine:u?.engine||"",searchQuery:u?.searchQuery||""}}},Qe.default.createElement(sn,{variant:"outlined",sx:{backgroundColor:d=>d.palette.mode==="dark"?"rgba(59, 61, 62, 1)":"rgba(244, 244, 244, 1)",borderRadius:"8px",border:"0px","&:hover":{background:d=>d.palette.mode==="dark"?"rgba(255, 255, 255, 0.16)":"rgba(0, 0, 0, 0.08)"}}},Qe.default.createElement(Ti,{href:u.url,target:"_blank",underline:"none"},Qe.default.createElement(g,{p:1,spacing:.5,className:"test"},Qe.default.createElement(T,{fontSize:14,color:"text.primary",noWrap:!0,sx:{p:0}},u.title),Qe.default.createElement(g,{direction:"row",alignItems:"center",spacing:.5},Qe.default.createElement(F,{width:16,height:16,borderRadius:"50%",overflow:"hidden",flexShrink:0},Qe.default.createElement("img",{src:kn(u.url),alt:u?.from,width:"100%",height:"100%"})),Qe.default.createElement(T,{fontSize:12,color:"text.secondary",noWrap:!0},u?.from),Qe.default.createElement(T,{fontSize:12,color:"text.secondary",flexShrink:0},"\xB7 ",m+1)))))))),o.length>s&&Qe.default.createElement(ei,{item:!0,xs:a,onClick:()=>{i(!0)}},Qe.default.createElement(sn,{variant:"outlined",sx:{backgroundColor:u=>u.palette.mode==="dark"?"rgba(59, 61, 62, 1)":"rgba(244, 244, 244, 1)",borderRadius:"8px",border:"0px","&:hover":{cursor:"pointer",background:u=>u.palette.mode==="dark"?"rgba(255, 255, 255, 0.16)":"rgba(0, 0, 0, 0.08)"}}},Qe.default.createElement(g,{p:1,spacing:1},Qe.default.createElement(g,{direction:"row",spacing:1},c.map((u,m)=>Qe.default.createElement(F,{key:m+(u||""),width:16,height:16,borderRadius:"50%",overflow:"hidden",flexShrink:0},Qe.default.createElement("img",{src:u,width:"100%",height:"100%"})))),Qe.default.createElement(g,{direction:"row",alignItems:"center",spacing:.5},Qe.default.createElement(T,{fontSize:12,color:"text.secondary",flexShrink:0},p("package__features:chat__ai_message__sources__view")," ",c.length," ",p("package__features:chat__ai_message__sources__more")))))))),Qe.default.createElement(Xv,{open:n,onClose:()=>i(!1),searchResults:o,metadataTitle:e.metadataTitle}))},Yv=aD;var sD={whiteSpace:"pre-wrap",width:"100%",boxSizing:"border-box",wordBreak:"break-word",color:"text.primary"},lD=e=>{let{message:t,order:o,loading:r=!1,hasError:n}=e,{t:i}=k(),{content:a,metadata:s,isAutoHideTools:l,isLoading:c}=ot(),[p,u]=Ke.default.useState(!1);(0,Ke.useEffect)(()=>{if(a.status==="complete"){let I=setTimeout(()=>{u(!0)},Iy);return()=>clearTimeout(I)}else u(!1)},[a.status]);let m=a.status==="complete"?p:a.status===void 0?!c:!1,d=(a.status==="complete"?p:!0)&&!n&&s?.nextActions,{copilotComplete:f,searchImages:h,searchVideos:C,knowledgePanels:x}=(0,Ke.useMemo)(()=>{let I=s.copilot?s.copilot.steps.every(L=>L.status==="complete"):!0,w=[],E=[],O=[];return s.searchResults?.forEach(L=>{L.images&&w.push(...L.images),L.videos&&E.push(...L.videos),L.knowledgePanel&&O.push(L.knowledgePanel)}),{copilotComplete:I,searchImages:w,searchVideos:E,knowledgePanels:O}},[s]),_=s.includeHistory===!1,y=s.isTriggeredContentReview===!0,[b,S]=(0,Ke.useState)(!1);return Ke.default.createElement(F,{component:"div",className:"chat-message chat-message--AI",sx:{[`& .${wf}`]:{opacity:l&&!b?0:1},"&:hover":{[`& .${wf}`]:{opacity:1}}},onMouseEnter:()=>{S(!0)},onMouseLeave:()=>{S(!1)}},_&&!y&&o!==1&&Ke.default.createElement(Ef,{message:t}),Ke.default.createElement(g,{className:"chat-message--text",sx:sD},Ke.default.createElement(g,{spacing:3},Ke.default.createElement(e1,{message:t}),!n&&s.title&&Ke.default.createElement(Ri,{title:s.title,fontSx:{fontWeight:"700",fontSize:"24px",color:"text.primary",whiteSpace:s.shareType==="search"||s.shareType==="art"?"":"nowrap",textOverflow:"ellipsis",overflow:"hidden"}}),!n&&s.copilot&&Ke.default.createElement(Kv,{copilotType:s.shareType,copilot:s.copilot,messageIsComplete:!!s.isComplete}),!n&&f&&s.searchResults&&s.searchResults.length>0&&Ke.default.createElement(g,{spacing:1,marginBottom:"8px !important"},Ke.default.createElement(g,{direction:"row",alignItems:"center",spacing:1},Ke.default.createElement(Kc,{icon:"CaptivePortal",sx:{fontSize:"18px"}}),Ke.default.createElement(T,{fontSize:"18px"},"Sources")),Ke.default.createElement(Yv,{metadataTitle:s.title,searchResults:s.searchResults,loading:!1})),f&&a.title?.title!=="noneShowContent"&&Ke.default.createElement(g,{spacing:2},s.chatMode?Ke.default.createElement(Ke.default.Fragment,null,Ke.default.createElement(ix,{message:t,loading:r}),Ke.default.createElement(h0,{message:t}),Ke.default.createElement(x0,{message:t,hasError:n})):Ke.default.createElement(Ke.default.Fragment,null,Ke.default.createElement(h0,{message:t}),Ke.default.createElement(ix,{message:t,loading:r}),!n&&(h.length>0||C.length>0||x.length>0)&&Ke.default.createElement(kv,{message:t,images:h,videos:C,knowledgePanels:x,loading:r}),Ke.default.createElement(x0,{message:t,hasError:n}))),!c||m?Ke.default.createElement(jv,{className:wf,message:t}):Ke.default.createElement(F,{height:"16px"}),s.nextActions&&d&&Ke.default.createElement(dv,{nextActions:s.nextActions,nextActionsStatus:s.nextActionsStatus}))),y&&s.isComplete&&o!==1&&Ke.default.createElement(wt,{sx:{mt:2}},Ke.default.createElement(T,{color:"text.secondary",fontSize:"12px"},i("package__features:chat__ai_message__context_triggered_content_review"))))},Zv=lD;var cD=e=>lx.default.createElement(Mf,{...e},lx.default.createElement(Zv,{...e})),Qv=_c(cD);var Ot=v(A());var pu=v(A());var js=v(A()),pD=e=>{let{message:t}=e,{t:o}=k(),r=t.conversationId||"",n=Xo(r),i=t?.messageId===n?.lastMessageId,a=ye(r),{regenerate:s}=ze(),[l,c]=(0,js.useState)(!1);return(0,js.useEffect)(()=>{i&&vs(r).then(({lastRunActions:u})=>{c(u.length>0)})},[i]),i&&l?js.default.createElement(fe,{placement:"top",disabled:a,title:o("package__features:chat__ai_message__tools__regenerate_button"),onClick:()=>s(r),testid:"sidebar_actions__regenerate",sx:{p:"6px"}},js.default.createElement(X,{sx:{fontSize:"20px"},icon:"Regenerate"})):null},Jv=pD;var uD=e=>{let{message:t}=e,{conversationId:o,variant:r}=eo(),n=xr(o),i=wi(n),a=t.meta?.systemMessageType||t.extra?.systemMessageType||"normal",s=t.meta?.status||t.extra?.status||"success",l=(0,pu.useMemo)(()=>t.type==="system"&&s==="error"&&i?.messageId===t.messageId?!0:s!=="success"&&a==="normal"&&i?.messageId===t.messageId&&t.parentMessageId,[t.type,t.parentMessageId,t.messageId,i?.messageId,s,a]);return pu.default.createElement(g,{direction:"row",alignItems:"center",flexWrap:"wrap",gap:1,className:"chat-system--message-tools"},r==="chatHub"||!l?null:pu.default.createElement(Jv,{message:t}))},cx=uD;var mD=Ot.default.lazy(()=>import("./STG6GUDU.js")),dD=e=>{let{message:t,loading:o,sx:r}=e,{isDarkMode:n}=Zr(),i=Mt(),a=t?.extra?.systemMessageType==="needUpgrade"||t?.meta?.systemMessageType==="needUpgrade",s=t.meta.chatMode,l=t.meta.paywallData,c=t.meta?.AIModel||t.originalMessage?.metadata?.AIModel,p=(0,Ot.useMemo)(()=>Dn(t,!1),[t]),u=(0,Ot.useMemo)(()=>a?{width:"100%",whiteSpace:"pre-wrap",wordBreak:"break-word",gap:1,"& > div[data-permission-scene-type]":{mb:1}}:{whiteSpace:"pre-wrap",width:"100%",wordBreak:"break-word",borderRadius:"8px",bgcolor:"background.paper"},[a]),m=(0,Ot.useMemo)(()=>i?.id==="USE_CHAT_GPT_AI_ROOT_Context_Menu_Portal",[i]),d=()=>c?s==="free_chat"?Ot.default.createElement(ma,null):Ot.default.createElement(yc,{AIProvider:$o(void 0,c,{fallback:!1,checkValid:!0})?.AIProvider,AIModel:c}):Ot.default.createElement(ma,null);return Ot.default.createElement(g,{className:"chat-message chat-message--text",gap:1,sx:{boxSizing:"border-box",...u,...r}},a&&l?Ot.default.createElement(Ot.default.Fragment,null,m?null:d(),Ot.default.createElement(vy,{paywallData:l}),Ot.default.createElement(cx,{message:t,loading:o})):Ot.default.createElement(Ot.default.Fragment,null,d(),Ot.default.createElement(b_,{severity:t?.meta?.status||"info",sx:{p:1,[`& .${y_.message}`]:{p:0,width:"100%"},"& > div:first-of-type":{display:"none"},"& .markdown-body":{"& > p:first-of-type":{mt:0}}},icon:Ot.default.createElement(Ot.default.Fragment,null)},Ot.default.createElement(F,null,Ot.default.createElement(g,{direction:"row",alignItems:"flex-start",spacing:1.5,mb:2},Ot.default.createElement("div",{className:`markdown-body ${n?"markdown-body-dark":""}`},Ot.default.createElement(Ot.Suspense,{fallback:Ot.default.createElement(Br,{sx:{my:0},loading:!0})},Ot.default.createElement(mD,{message:t},p)))))),Ot.default.createElement(cx,{message:t,loading:o})))},a1=_c(dD);var Lc=v(A()),fD=e=>{let{chatDocument:t,size:o=20}=e,r="";return t.maxAIDocumentType==="image"?r=t.link||t.preUploadMetadata?.previewIcon||"":t.maxAIDocumentType&&["page_content__webpage","page_content__email","page_content__youtube"].includes(t.maxAIDocumentType)?r=t.link?kn(t.link):t.preUploadMetadata?.previewIcon||"":r=t.preUploadMetadata?.previewIcon||"",t.status==="uploading"||t.status==="downloading"?Lc.default.createElement(F,{sx:{display:"inline-flex",justifyContent:"center",alignItems:"center",padding:"3px",width:o,height:o,borderRadius:"4px",boxSizing:"border-box",overflow:"hidden",bgcolor:n=>n.palette.mode==="dark"?"rgba(255, 255, 255, 0.08)":"rgba(0, 0, 0, 0.08)","& > span > svg":{color:"rgba(255, 255, 255, 0.6)"}}},Lc.default.createElement(Ft,{size:o-6})):r?Lc.default.createElement("img",{style:{borderRadius:"4px",overflow:"hidden",objectFit:"cover",userSelect:"none"},src:r,alt:t.title,width:o,height:o,draggable:!1}):t.maxAIDocumentType==="page_content__webpage"||t.maxAIDocumentType==="page_content__email"||t.maxAIDocumentType==="page_content__youtube"?Lc.default.createElement("img",{style:{borderRadius:"4px",overflow:"hidden",objectFit:"cover",userSelect:"none"},src:kn(t.link||"",32),alt:t.title,width:o,height:o,draggable:!1}):Lc.default.createElement(GC,{size:o,documentType:t.maxAIDocumentType||"chat_file",chatDocument:t})},s1=fD;var t9=v(A()),hD=e=>{let{variant:t="primary",size:o="medium",sx:r,...n}=e;return t9.default.createElement(Xu,{size:o,sx:{borderRadius:"4px",fontSize:"12px",padding:"2px 4px","& > span":{padding:0},...o==="medium"&&{height:"22px"},...t==="third"&&{padding:"2px 8px",fontSize:"14px",fontWeight:500,lineHeight:"20px",bgcolor:i=>i.palette.mode==="dark"?"rgba(255, 255, 255, 0.08)":"rgba(0, 0, 0, 0.04)",color:i=>i.palette.mode==="dark"?"rgba(255, 255, 255, 0.3)":"rgba(0, 0, 0, 0.38)"},...r},...n})},l1=hD;var px=v(p1());var bn=v(A()),CD=e=>{let t=()=>{r||p?.()},{mode:o="normal",disabled:r,icon:n,showClose:i,text:a,tags:s,dataTestId:l,sx:c,onClick:p,onClose:u}=e;return o==="image"?bn.default.createElement(g,{onClick:t,sx:{width:"32px",height:"32px",boxSizing:"border-box",position:"relative",borderRadius:"8px",cursor:"pointer",...r&&{pointerEvents:"none",opacity:.5},"&:hover":{"& > div:last-of-type":{display:"flex"}},...c},direction:"row",alignItems:"center","data-testid":l,"data-button-clicked-name":l},bn.default.createElement(F,{sx:{position:"absolute",top:0,left:0,width:"100%",height:"100%",borderRadius:"8px",border:"1px solid",borderColor:m=>m.palette.mode==="dark"?"rgba(255, 255, 255, 0.12)":"rgba(0, 0, 0, 0.12)"}}),n&&bn.default.createElement(g,{sx:{height:"32px",flexShrink:0,borderRadius:"9px",overflow:"hidden","& > svg":{width:"32px",height:"32px",fontSize:"32px",userSelect:"none"},"& > img":{width:"32px",height:"32px",userSelect:"none"}}},n),i&&bn.default.createElement(F,{component:"div",onClick:m=>{m.stopPropagation(),u&&u()},"data-button-clicked-name":l+"--close-button","data-testid":l+"--close-button",sx:{position:"absolute",right:"-8px",top:"-8px",width:"16px",height:"16px",display:"none",zIndex:10,overflow:"visible",cursor:"pointer",color:"text.primary",fill:m=>m.palette.mode==="dark"?"rgba(255, 255, 255, 0.6)":"rgba(0, 0, 0, 0.6)"}},bn.default.createElement(px.default,{sx:{fontSize:"16px"}}))):bn.default.createElement(g,{onClick:t,sx:{height:"32px",boxSizing:"border-box",position:"relative",borderRadius:"8px",border:"1px solid",borderColor:"border.main",maxWidth:"184px",padding:"4px",gap:"8px",cursor:"pointer","&:hover":{"& > div:last-of-type":{display:"flex"},background:m=>m.palette.mode==="dark"?"#343434":"rgba(0, 0, 0, 0.04)"},...r&&{pointerEvents:"none",opacity:.5},...c},direction:"row",alignItems:"center","data-testid":l,"data-button-clicked-name":l},n&&bn.default.createElement(g,{sx:{height:"24px",flexShrink:0,borderRadius:"5px",overflow:"hidden","& > svg":{width:"24px",height:"24px",fontSize:"24px"},"& > img":{width:"24px",height:"24px"}}},n),bn.default.createElement(T,{component:"div",fontSize:"14px",color:"text.primary",textAlign:"left",noWrap:!0},a),s&&bn.default.createElement(g,{sx:{display:"flex",flexWrap:"wrap",gap:"4px"}},s.map(m=>bn.default.createElement(l1,{key:m,sx:{color:"text.secondary"},label:m}))),i&&bn.default.createElement(F,{component:"div",onClick:m=>{m.stopPropagation(),u&&u()},"data-button-clicked-name":l+"--close-button","data-testid":l+"--close-button",sx:{position:"absolute",right:"-8px",top:"-8px",width:"16px",height:"16px",display:"none",zIndex:10,overflow:"visible",cursor:"pointer",color:"text.primary",fill:m=>m.palette.mode==="dark"?"rgba(255, 255, 255, 0.6)":"rgba(0, 0, 0, 0.6)"}},bn.default.createElement(px.default,{sx:{fontSize:"16px"}})))},o9=CD;var di=v(A()),yD=e=>{let{t}=k(),{dataTestId:o,chatDocument:r,onClick:n,showClose:i,onClose:a,disabled:s}=e,l=r.maxAIDocumentId,c=r.status,p=r.link===window.location.href,{downloadDocument:u,document:m}=Em(l),d=!!m,f=()=>{if(n)return n();r.maxAIDocumentId&&!ws(r.maxAIDocumentId)&&!p&&((r.maxAIDocumentType==="page_content__webpage"||r.maxAIDocumentType==="page_content__email")&&r.link?Fh.previewWebpage(r.link,{title:r.title||"Chat file",url:r.link}):Fh.previewDocument(r.maxAIDocumentId,{title:r.title||"Chat file",url:r.link}))};(0,di.useEffect)(()=>{l&&!ws(l)&&c==="success"&&!d&&u(l)},[l,c,d]);let h=p?[t("package__features:home_view__chat_with_any_content__chat__chat_document_selector__chip__current__title")]:[],C=(0,di.useMemo)(()=>{let x=r.maxAIDocumentType==="image",_=x?"image":"normal",y=di.default.createElement(s1,{size:x?32:24,chatDocument:r}),b=r.title,S=s||r.status==="downloading"||r.status==="uploading"||r.status==="error",I;if(HC(r.maxAIDocumentType)||(S=!0,I={opacity:1,cursor:"not-allowed",pointerEvents:"auto"}),m?.doc_type)switch(m.doc_type){case"search_results":try{let w=DC(m,m.doc_type),E=w?.sources?.length||0,O=(w?.sources?.map(L=>bs(L.redirectedUrl||L.url)?kn(L.redirectedUrl||L.url):L.url)||[]).filter(L=>rm(L));b=t("package__features:home_view__chat_with_any_content__chat__chat_document_selector__chip__web_source__title",{sourcesCount:E}),E===0&&(S=!0),y=di.default.createElement(bD,{maxCount:3,images:O})}catch{}}return{icon:y,text:b,disabled:S,mode:_,sx:I}},[r,m,s]);return di.default.createElement(o9,{dataTestId:o,text:C.text,onClick:f,icon:C.icon,disabled:C.disabled,tags:h,showClose:i,onClose:a,mode:C.mode,sx:C.sx})},bD=e=>{let{images:t,maxCount:o=999}=e,r=-8,n=Math.min(o,t.length),i=24*n+r*(n-1);return di.default.createElement(g,{direction:"row",sx:{width:`${i}px`,height:"24px",position:"relative"}},t.slice(0,n).map((a,s)=>di.default.createElement(g,{key:s,sx:{position:"absolute",zIndex:1+s,width:"24px",height:"24px",flexShrink:0,border:"1.5px solid",borderColor:"border.main",borderRadius:"12px",overflow:"hidden",boxSizing:"border-box",bgcolor:"background.paper",left:`${s*(24+r)}px`,"& > img":{width:"100%",height:"100%",borderRadius:"50%",objectFit:"cover"}}},di.default.createElement("img",{draggable:!1,alt:"",key:s,src:a}))))},Oc=yD;var uu=v(A()),SD=({message:e})=>{let t=e?.meta?.messageChatDocuments||[];return t.length===0?null:uu.default.createElement(g,{width:"100%",direction:"column",gap:1},uu.default.createElement(g,{direction:"row",gap:1,width:"100%",justifyContent:"flex-end",flexWrap:"wrap"},t.map(o=>uu.default.createElement(ID,{key:o.id||o.maxAIDocumentId,chatDocument:o}))))},ID=e=>{let{chatDocument:t}=e,o=t.maxAIDocumentId?ws(t.maxAIDocumentId):!0;return uu.default.createElement(Oc,{disabled:o,chatDocument:t})},r9=SD;var n9=(e,t)=>{let o=e.indexOf(t);if(o===-1)return"";let r=e.indexOf(`
`,o);return r===-1?"":e.substring(o,r).replace(t,"").trim()},vD=e=>{e.length;let t=e.find(i=>i.name===Ue.PRESET_VARIABLE__CURRENT_WEBSITE_DOMAIN.name)?.default_value||"",o=[],r=e.find(i=>i.name===Ue.PRESET_VARIABLE__INSTANT_REPLY__WEBSITE_TYPE.name)?.default_value,n=e.find(i=>i.name===Ue.PRESET_VARIABLE__INSTANT_REPLY__TARGET_CONTEXT.name)?.default_value||e.find(i=>i.name===Ue.PRESET_VARIABLE__INSTANT_REPLY__FULL_CONTEXT.name)?.default_value||"";if(r&&n)switch(r){case"EMAIL":{let i=n9(n,"**Subject:**");i?o.push(`Email content of "${i}".`):o.push(`Email content of "${n}"`);break}case"SOCIAL_MEDIA":{let i=n.indexOf("**Comment:**");if(i!==-1){let a=n.slice(i).replace("**Comment:**","").trim();o.push(a)}else if(t.includes("youtube.com")){let a=n9(n,"**Post title:**");a&&o.push(`Video content of "${a}".`)}else{let a=n.indexOf("**Post caption/description:**");if(a!==-1){let s=n.slice(a).replace("**Post caption/description:**","").trim();o.push(s)}}break}case"CHAT_APP_WEBSITE":{let i=n.indexOf("**Content:**");if(i!==-1){let a=n.slice(i).replace("**Content:**","").replace(`
+`,`
`).trim();o.push(a)}break}case"UNKNOWN":default:}return o.join(`
`)};function mu(e=[],t=[]){let o,r=e.find(n=>n.key==="Selected text"||n.key==="Draft"||n.key.endsWith("draft"));return r&&(o=r.value),o||(o=vD(t)),{text:o,userVariables:e.filter(n=>n.key!=="Draft"&&n.key!=="Selected text"&&!n.key.endsWith("draft"))}}var fo=v(A());var wD=To(({className:e,...t})=>fo.default.createElement(Pn,{...t,classes:{popper:e}}))(({theme:e})=>({[`& > .${Pr.tooltip}`]:{background:e.palette.mode==="dark"?"#2C2C2C":"#ffffff",color:"rgba(0, 0, 0, 0.87)",fontSize:12,boxShadow:"0px 12px 16px -4px rgba(0, 0, 0, 0.08), 0px 4px 6px -2px rgba(0, 0, 0, 0.03)",maxWidth:"none",borderRadius:e.spacing(1),border:`1px solid ${e.palette.border.main}`,backgroundClip:"padding-box"},[`& .${Pr.arrow}`]:{color:e.palette.mode==="dark"?"#2C2C2C":"#ffffff","&::before":{border:`1px solid ${e.palette.border.main}`,background:e.palette.mode==="dark"?"#2C2C2C":"#ffffff",backgroundClip:"padding-box"}}})),TD=(0,fo.forwardRef)(function({variable:t,sx:o,container:r,children:n,virtualRect:i,popperSx:a,suffix:s,anchorElSx:l,descriptionEl:c},p){let[u,m]=(0,fo.useState)(!1),d=(0,fo.useRef)(null);(0,fo.useImperativeHandle)(p,()=>({close:()=>m(!1)}));let f=t.key==="Selected Text"||t.key==="Draft"?"Context":t.key,h={container:r,className:"maxai-variable-tooltip",sx:{zIndex:2147483619,...a},transition:!0};return i&&(h.anchorEl={getBoundingClientRect(){return i}}),fo.default.createElement(Pa,{onClickAway:C=>{u&&C.target instanceof HTMLElement&&(d.current?.contains(C.target)||d.current===C.target)||m(!1)}},fo.default.createElement(g,{direction:"row",width:"100%",sx:o},fo.default.createElement(wD,{open:u,PopperProps:h,title:fo.default.createElement(g,{direction:"column",maxHeight:"min(500px, 40vh)",overflow:"hidden",height:"max-content"},fo.default.createElement(g,{direction:"row",width:"100%",gap:1.25,p:1.25,ref:d,boxSizing:"border-box",flexGrow:1,overflow:"hidden"},fo.default.createElement(F,{width:"2px",minWidth:"2px",bgcolor:C=>C.palette.mode==="dark"?"rgba(255, 255, 255, 0.12)":"rgba(0, 0, 0, 0.12)"}),fo.default.createElement(g,{direction:"column",flexGrow:1,overflow:"hidden"},fo.default.createElement(g,{direction:"row",gap:1.25,alignItems:"center",maxWidth:"100%"},fo.default.createElement(T,{fontSize:"14px",overflow:"hidden",textOverflow:"ellipsis",noWrap:!0,color:C=>C.palette.mode==="dark"?"rgba(255, 255, 255, 0.50)":"rgba(0, 0, 0, 0.38)"},f),fo.default.createElement(Fr,{sx:{padding:"5px",fontSize:"20px",borderRadius:"4px",color:"text.secondary"},defaultIconSx:{fontSize:"15px"},PopperProps:{placement:"top",container:r},copyText:t.value})),c,fo.default.createElement(T,{width:"100%",whiteSpace:"pre-wrap",color:"text.primary",textAlign:"left",lineHeight:"24px",fontSize:"16px",flexGrow:1,overflow:"auto"},t.value))),s),placement:"top",arrow:!0,disableFocusListener:!0,disableHoverListener:!0,disableTouchListener:!0},fo.default.createElement(F,{onClick:()=>{m(!u)},sx:l},typeof n=="function"?n({variable:t,open:u}):n))))}),Bc=TD;var c9=v(ux());var Bt=v(A()),fx=v(A());var du=v(A());var PD=/(\.py|\.ipynb|\.js|\.jsx|\.html|\.css|\.java|\.cs|\.php|\.c|\.cpp|\.cxx|\.h|\.hpp|\.rs|\.R|\.Rmd|\.swift|\.go|\.rb|\.kt|\.kts|\.ts|\.tsx|\.m|\.scala|\.rs|\.dart|\.lua|\.pl|\.pm|\.t|\.sh|\.bash|\.zsh|\.csv|\.log|\.ini|\.config|\.json|\.yaml|\.yml|\.toml|\.lua|\.sql|\.bat|\.md|\.coffee|\.tex|\.latex)/,kD=({filetype:e,filename:t,sx:o})=>(e=e.toLowerCase(),e.endsWith("pdf")?du.default.createElement(s2,{sx:o}):t.endsWith(".txt")?du.default.createElement(l2,{sx:o}):PD.test(t)?du.default.createElement(a2,{sx:o}):du.default.createElement(c2,{sx:o})),m1=kD;var i9=v(mx());var gt=v(A()),FD={borderRadius:e=>e.spacing(1),border:e=>`1px solid ${e.palette.border.main}`,background:e=>e.palette.background.default,display:"flex",flexDirection:"row",position:"relative",p:1.25,gap:1.5,height:"62px",boxSizing:"border-box",width:"282px",minWidth:"282px",overflow:"hidden"},DD={height:"40px",width:"40px",fontSize:"40px",cursor:"pointer"},a9={fontWeight:500,textOverflow:"ellipsis",whiteSpace:"nowrap",overflow:"hidden",fontSize:"14px"},HD={...a9,color:e=>e.palette.mode==="dark"?"rgba(255, 255, 255, 0.38)":"rgba(0, 0, 0, 0.38)"},Fc=228,dx=200,ND=({message:e})=>{let[t,o]=(0,gt.useState)(void 0),[r,n,i]=(0,gt.useMemo)(()=>{let m=(e.meta?.attachments||[]).filter(h=>h.uploadStatus==="success"),d=m.filter(h=>h.icon==="image"),f=m.filter(h=>h.icon!=="image");return[d,f.map(h=>({...h,attachmentExtractedContent:AC(h,e)})),m]},[e,e.meta?.attachments]),[a,s]=(0,gt.useState)({width:`${Fc}px`,height:`${Fc/1.5}px`}),l=(0,gt.useMemo)(()=>r.length===1?a:r.length>3?{width:"64px",height:"64px"}:{width:"112px",height:"112px"},[r]),c=m=>{if(r.length!==1)return;let{naturalWidth:d,naturalHeight:f}=m,h=d/f;if(h>=1&&h<=1.5){let C=`${Fc/1.5}px`,x=`${Fc}px`;s({width:x,height:C})}else if(h>1.5){let C=`${Fc/2}px`,x=`${Fc}px`;s({width:x,height:C})}else if(h<1&&h>=.75){let C=`${dx}px`;s({width:"228px",height:C})}else{let C=`${dx}px`,x=`${dx*.75}px`;s({width:x,height:C})}},p=(0,gt.useMemo)(()=>r.map(m=>({src:m.uploadedUrl||m.base64Data||m.blobUrl||"",alt:m.fileName})),[r]),u=(0,gt.useRef)(null);if(i.length!==0)return gt.default.createElement(g,{width:"100%",direction:"column",gap:1},r.length>0&&gt.default.createElement(g,{gap:1,direction:"row",justifyContent:"flex-end",overflow:"auto",width:"100%"},r.map(m=>gt.default.createElement(Ai,{key:m.id,width:l.width,height:l.height,alt:m.fileName,onLoaded:c,SkeletonSx:{borderRadius:d=>d.spacing(1),width:l.width,height:l.height,overflow:"hidden"},src:m.uploadedUrl||m.base64Data||m.blobUrl||"",imageSx:{borderRadius:d=>d.spacing(1),width:l.width,height:l.height,overflow:"hidden",objectFit:"cover",cursor:"pointer",border:d=>`1px solid ${d.palette.mode==="dark"?"rgba(255, 255, 255, 0.08)":"rgba(0,0,0,0.08)"}`},onImageClick:()=>{o(m.uploadedUrl||m.base64Data||m.blobUrl||"")}}))),gt.default.createElement(kc,{images:p,selectedImage:t,setSelectedImage:o}),n.length>0&&gt.default.createElement(g,{direction:"column",gap:1,width:"100%",alignItems:"flex-end",ref:u},n.map(m=>gt.default.createElement(zD,{key:m.id,file:m,getFilesContainer:()=>u.current}))))},zD=(0,gt.memo)(function({file:t,container:o,getFilesContainer:r}){let{t:n}=k(),i=(0,gt.useRef)(null),[a,s]=(0,gt.useState)(null),[l,c]=(0,gt.useState)(360);return gt.default.createElement(F,{ref:i,onClick:()=>{let p=r?.()??null;if(i.current&&p){let u=p.getBoundingClientRect(),m=i.current.getBoundingClientRect(),d=m.left+20,f=u.left+u.width/2,h=Math.max(f,d);c(h===f?Math.min(u.width-40,600):Math.max((m.right-m.left-20)*2,140)),s(new DOMRect(h,m.top,1,m.height))}}},gt.default.createElement(Bc,{variable:{key:t.fileName,value:t.attachmentExtractedContent},anchorElSx:FD,virtualRect:a,sx:{width:"fit-content",cursor:"pointer"},container:o,popperSx:{width:l},descriptionEl:gt.default.createElement(g,{direction:"column"},gt.default.createElement(T,{textAlign:"left",fontSize:"14px",color:"text.secondary",noWrap:!0,flexShrink:0},`${T2(t.fileSize||0)} \u2022 ${t.fileType}`),gt.default.createElement(T,{textAlign:"left",fontSize:"12px",color:"text.secondary",noWrap:!0,flexShrink:0,display:"flex",alignItems:"center",gap:1},gt.default.createElement(i9.default,{sx:{fontSize:"12px",color:"inherit"}}),n("package__features:chat__user_message__contexts__file__preview__tips")))},gt.default.createElement(m1,{filename:t.fileName,filetype:t.fileType,sx:DD}),gt.default.createElement(g,{direction:"column",overflow:"hidden",flexGrow:1},gt.default.createElement(T,{sx:a9},t.fileName),gt.default.createElement(T,{sx:HD},t.fileType.toUpperCase()))))}),s9=ND;var Sn=v(A()),VD=["www.linkedin.com"],RD=({variable:e,container:t,getMessageContainer:o,zIndex:r})=>{let n=(0,Sn.useRef)(null),[i,a]=(0,Sn.useState)(null),[s,l]=(0,Sn.useState)(360);return Sn.default.createElement(g,{direction:"row",width:"100%",gap:"4px",sx:{"& .maxai-user-message-variable-copy-icon":{transition:"opacity 0.2s ease-in-out",opacity:0},"&:hover .maxai-user-message-variable-copy-icon":{opacity:1}}},Sn.default.createElement(F,null,Sn.default.createElement(Fr,{tooltipPlacement:"top",tabIndex:-1,sx:{padding:"6px",fontSize:"20px",borderRadius:"8px",color:"text.secondary"},defaultIconSx:{},className:"maxai-user-message-variable-copy-icon",PopperProps:{container:t,sx:{zIndex:r}},copyText:e.value,onCopy:()=>{VD.includes(window.location.host)&&qc.includes("extension")&&setTimeout(()=>{gl.hideSidebar()},1)}})),Sn.default.createElement(Bc,{variable:e,container:t,sx:{flexGrow:1,overflow:"hidden"},virtualRect:i,popperSx:{width:s,boxSizing:"border-box",zIndex:r},anchorElSx:{width:"100%"}},Sn.default.createElement(g,{direction:"column",gap:1,ref:n,sx:{width:"100%",p:1,borderRadius:c=>c.spacing(.5),background:c=>c.palette.mode==="dark"?"rgba(255, 255, 255, 0.04)":"rgba(0, 0, 0, 0.04)",boxSizing:"border-box"},onClick:()=>{let c=o?.()??null;if(n.current&&c){let p=c.getBoundingClientRect(),u=n.current.getBoundingClientRect(),m=u.left+20,d=p.left+p.width/2,f=Math.max(d,m);if(f===d){let h=Math.min(p.width-40,600);l(h)}else l(Math.max((u.right-u.left-20)*2,140));a(new DOMRect(f,u.top,1,u.height))}}},Sn.default.createElement(T,{color:c=>c.palette.mode==="dark"?"rgba(255, 255, 255, 0.38)":"rgba(0, 0, 0, 0.38)",fontSize:"14px"},e.key),Sn.default.createElement(T,{whiteSpace:"nowrap",textOverflow:"ellipsis",overflow:"hidden",fontSize:"14px",color:"text.primary"},e.value))))},f1=RD;var ps=v(A()),UD=({iconSx:e,message:t,formatMessageContent:o,...r})=>{let{t:n}=k(),{inputMediator:i}=ue(),a=Mt(),{askAIWithShortcutsV2:s}=ze(),{chatHubLoading:l}=yt(),c=t.meta?.MaxAIPromptActionConfig?.prompt_id,p=(0,ps.useMemo)(()=>t.meta?.MaxAIPromptActionConfig===void 0,[t.meta?.MaxAIPromptActionConfig]),u=(0,ps.useMemo)(()=>t.meta?.MaxAIPromptActionConfig&&Vm(t.meta?.MaxAIPromptActionConfig),[t.meta?.MaxAIPromptActionConfig]),m=(0,ps.useMemo)(()=>["AI_RESPONSE_LANGUAGE",Ue.PRESET_VARIABLE__INTERFACE_LANGUAGE.name,Ue.PRESET_VARIABLE__SYSTEM_CURRENT_DATE.name,Ue.PRESET_VARIABLE__REFINE_DRAFT__FOLLOW_UP_INSTRUCTION.name,Ue.PRESET_VARIABLE__INSTANT_REPLY__WEBSITE_TYPE.name,Ue.PRESET_VARIABLE__INSTANT_REPLY__DRAFT_CONTEXT.name,Ue.PRESET_VARIABLE__INSTANT_REPLY__TARGET_CONTEXT.name,Ue.PRESET_VARIABLE__INSTANT_REPLY__FULL_CONTEXT.name,Ue.PRESET_VARIABLE__INSTANT_REPLY__SOCIAL_MEDIA__POST_DRAFT.name,Ue.PRESET_VARIABLE__INSTANT_REPLY__EMAIL__DRAFT.name,Ue.PRESET_VARIABLE__INSTANT_REPLY__CHAT_APP__MESSAGE_DRAFT.name,Ue.PRESET_VARIABLE__CURRENT_WEBSITE_DOMAIN.name,Ue.PRESET_VARIABLE__CURRENT_WEBPAGE_URL.name,Ue.PRESET_VARIABLE__AI_RESPONSE_WRITING_STYLE.name,Ue.PRESET_VARIABLE__AI_RESPONSE_TONE.name,Ue.OUTPUT_PRESET_VARIABLE__CHAT_COMPLETE.name],[]),d=(0,ps.useMemo)(()=>{if(t.meta?.disableEditQuestion)return!1;if(p)return!0;let h=u?.origin?.variables;return h&&h?.some(x=>x.name==="KEY_POINTS")?!0:c&&X_.includes(c)?!1:!!h?.filter(x=>x.name&&!m.includes(x.name))?.length},[p,u?.origin?.variables,m,t.meta?.disableEditQuestion,c]),f=async()=>{if(p){Pf(),i.updateInputValue(o);let h=i.ref;h&&(h.focus(),h.setSelectionRange(h.value.length,h.value.length));return}else if(u){let h=u.actions;if(h.length>0){let C=u?.origin?.variables;if(C){let _=C.reduce((y,b)=>(y&&!m.includes(b.name)?y[b.name]={key:b.name,value:b.default_value,overwrite:!0,isBuiltIn:!0,label:b.label||b.hint||b.name}:y&&c==="47070ec6-8700-43fd-a519-20fe3841df38"&&(b.name==="MAXAI__INSTANT_REPLY__TARGET_CONTEXT"||b.name==="MAXAI__INSTANT_REPLY__FULL_CONTEXT")&&(y[b.name]={key:b.name,value:b.default_value,overwrite:!0,isBuiltIn:!0,label:b.label||b.hint||b.name}),y??{}),{});h.unshift({type:"SET_VARIABLE_MAP",parameters:{VariableMap:_}})}let x=h.find(_=>_.type==="SET_VARIABLES_MODAL");if(x){if(x.parameters.SetVariablesModalConfig={...x.parameters.SetVariablesModalConfig,disableAutoExecuteWhenAllVariableHaveValue:!0},c==="47070ec6-8700-43fd-a519-20fe3841df38"){let b=ny[0].parameters.SetVariablesModalConfig;b&&(x.parameters.SetVariablesModalConfig={...x.parameters.SetVariablesModalConfig,...b})}let _=x.parameters?.MaxAIPromptActionConfig?.variables.find(b=>b.name==="SELECTED_TEXT"),y="8c0c38d4-1dfe-498e-8229-05e758b2dc03"===c;_&&(_.hidden=!1,y&&(_.hidden=!0))}await s(h,{isClearInput:!0,isFocusInput:!0}),WD(a)}}};return d?ps.default.createElement(Fm,{title:n("package__features:chat__user_message__action__edit"),...r,onClick:f,sx:{mr:.5,p:"6px",borderRadius:1,color:"text.secondary",...r.sx},disabled:l},ps.default.createElement(X,{icon:"DefaultIcon",sx:{fontSize:"20px",...e}})):null},l9=UD;function WD(e){if(e){let t=e.querySelector('*[data-testid="maxai--chat-box--chat-input--main"] textarea');if(t&&t?.focus){t.focus(),t.setSelectionRange(t.value.length,t.value.length);return}let o=e.querySelector("*[data-testid^=custom-variable--] textarea");if(o&&o?.focus){o.focus(),o.setSelectionRange(o.value.length,o.value.length);return}}}var h1="maxai-client--user-message--action-icon--visible-on-hover",GD={whiteSpace:"pre-wrap",wordBreak:"break-word",p:e=>e.spacing(1.5),bgcolor:e=>e.palette.secondary.main,borderRadius:e=>e.spacing(1),color:"text.primary",maxWidth:"100%",width:"auto",flexWrap:"wrap",overflow:"hidden"},jD={width:"auto",maxWidth:"100%",flexDirection:"row",justifyContent:"flex-end",gap:"2px",[`& .${h1}`]:{width:"32px",height:"32px",transition:"opacity 0.2s ease-in-out",opacity:0},[`&:hover .${h1}`]:{opacity:1}},qD=e=>{let{message:t,order:o,container:r}=e,{t:n}=k(),{inputMediator:i}=ue(),a=t.meta?.MaxAIPromptActionConfig===void 0,s=(0,fx.useMemo)(()=>!t.meta?.includeHistory&&o!==1,[t,o]),{quote:l,userVariables:c,formatMessageContent:p}=(0,fx.useMemo)(()=>{let _=Dn(t,!1),y=[],b=mu(t.meta?.contexts,t.meta?.MaxAIPromptActionConfig?.variables),S=b?.text??"";return S||t.meta?.MaxAIPromptActionConfig?.variables?.find(I=>I.name==="SELECTED_TEXT")&&(S=" "),b?.userVariables.forEach(I=>{I.key===Ue.PRESET_VARIABLE__COMPOSE_KEY_POINTS.hint||I.key===Ue.PRESET_VARIABLE__REPLY_KEY_POINTS.hint||I.key===Ue.PRESET_VARIABLE__REFINE_DRAFT__FOLLOW_UP_INSTRUCTION.hint?_=I.value:y.push(I)}),{formatMessageContent:_,userVariables:y,quote:S}},[t]),[u,m]=(0,Bt.useState)(null),[d,f]=(0,Bt.useState)(360),h=(0,Bt.useRef)(null),C=(0,Bt.useRef)(null),x=()=>{i.updateInputValue(p);let _=i.ref;_&&(_.focus(),_.setSelectionRange(_.value.length,_.value.length))};return Bt.default.createElement(g,{className:"chat-message chat-message--user",direction:"column",gap:1,ref:h,width:"100%"},s&&Bt.default.createElement(Ef,{message:t}),!!l&&Bt.default.createElement(Bt.default.Fragment,null,Bt.default.createElement(F,{sx:{display:"flex",flexDirection:"row",justifyContent:"flex-end",width:"100%"}},Bt.default.createElement(Bc,{variable:{key:"Quote",value:l},sx:{maxWidth:"100%",width:"auto"},virtualRect:u,popperSx:{width:d,boxSizing:"border-box"},container:r},Bt.default.createElement(g,{gap:1,direction:"row",color:_=>_.palette.mode==="dark"?"rgba(255, 255, 255, 0.38)":"rgba(0, 0, 0, 0.38)",width:"100%",ref:C,onClick:()=>{if(C.current&&h.current){let _=h.current.getBoundingClientRect(),y=C.current.getBoundingClientRect(),b=y.left+40,S=_.left+_.width/2,I=Math.max(S,b);if(I===S){let w=Math.min(_.width-40,600);f(w)}else f(Math.min(Math.max((y.width-20)*2,140),_.width-40,600));m(new DOMRect(I,y.top,1,y.height))}}},Bt.default.createElement(c9.default,{sx:{fontSize:"18px"}}),Bt.default.createElement(jC,{maxLine:2,fontSize:"14px",flex:1},l))))),Bt.default.createElement(r9,{message:t}),Bt.default.createElement(s9,{message:t}),Bt.default.createElement(g,{direction:"row",justifyContent:"flex-end",width:"100%",paddingLeft:_=>_.spacing(6)},Bt.default.createElement(g,{sx:jD},Bt.default.createElement(F,null,Bt.default.createElement(l9,{message:t,formatMessageContent:p,tabIndex:-1,className:h1,PopperProps:{disablePortal:!0}})),Bt.default.createElement(F,null,Bt.default.createElement(Fr,{tabIndex:-1,sx:{mr:.5,p:"6px",borderRadius:1,color:"text.secondary"},className:h1,PopperProps:{disablePortal:!0},copyText:p})),Bt.default.createElement(F,{className:"chat-message--text",sx:GD},Bt.default.createElement(T,{fontSize:"16px"},p),Bt.default.createElement(g,{width:"100%",direction:"column",gap:1},c.map((_,y)=>Bt.default.createElement(f1,{variable:_,key:`${_.key}-${y}`,getMessageContainer:()=>h.current,container:r})))))))},p9=_c(qD);var m9=v(On()),d9=v(u9());var qt=v(A()),YD=({message:e,sx:t})=>{let[o,r]=(0,qt.useState)(!1),[n,i]=(0,qt.useState)(new Set),[a,s]=(0,qt.useState)(""),l=(0,qt.useMemo)(()=>JSON.stringify(e,null,2),[e]);return qt.default.createElement(qt.default.Fragment,null,qt.default.createElement(F,{position:"absolute",top:16,right:16,zIndex:1,sx:t},qt.default.createElement(Pn,{open:o,title:qt.default.createElement(g,null,e&&qt.default.createElement(g,{sx:{gap:1,flexDirection:"row"}},qt.default.createElement(Yu,{size:"small",sx:{width:"auto",flex:1,color:"#fff"},options:Object.keys(e),onChange:(c,p)=>{s(p??"")},renderInput:c=>qt.default.createElement(Ut,{...c,variant:"outlined"})}),qt.default.createElement(Ce,{size:"small",variant:"contained",onClick:()=>{a&&i(c=>{let p=new Set(c);return p.add(a),p})}},"\u6DFB\u52A0\u76D1\u89C6\u5B57\u6BB5")),qt.default.createElement(g,{sx:{flexDirection:"row",gap:1,justifyContent:"space-between",alignItems:"center"}},qt.default.createElement(Fr,{copyText:l,sx:{color:"#fff"}}),qt.default.createElement(Xe,{onClick:()=>r(!1)},qt.default.createElement(m9.default,{sx:{color:"#fff"}}))),qt.default.createElement("pre",{style:{fontSize:"12px",maxHeight:"500px",overflowY:"auto"}},l))},qt.default.createElement(Xe,{onClick:()=>r(c=>!c),sx:{fontSize:24}},qt.default.createElement(d9.default,null)))),n?.size>0&&qt.default.createElement(F,{sx:{borderRadius:1,border:"1px solid #ccc",p:1,background:"#f0f0f0"}},Array.from(n)?.map(c=>qt.default.createElement("div",{key:c},c,":"," ",JSON.stringify(c.split(".").reduce((p,u)=>p?.[u],e))))))},ZD=e=>nl?qt.default.createElement(YD,{...e}):null,x1=ZD;var QD=e=>{let{message:t,sx:o,order:r,loading:n,onChangeHeight:i,...a}=e,s=(0,In.useRef)(null),l=(0,In.useRef)(0);return py(t),(0,In.useEffect)(()=>{if(s.current){let c=s.current,p=()=>{if(!c)return;let m=c.offsetHeight;m&&m!==l.current&&Math.abs(m-l.current)>10&&(l.current=m,i?.(m,t.messageId))},u=new ResizeObserver(()=>{p()});return u.observe(c),()=>{u.disconnect()}}},[i]),In.default.createElement(F,{"data-message-id":t.messageId,"data-scroll-position":t.type==="system"?"bottom":"top",ref:s,sx:{padding:c=>`${c.spacing(2.25)} ${c.spacing(1.5)}`,position:"relative",boxSizing:"border-box",maxWidth:"var(--max-width)",width:"100%",mx:"auto",color:"text.primary",userSelect:"text","& .chat-message--text":{textAlign:"left",fontSize:"16px",lineHeight:1.4,fontWeight:400},...o},...a},In.default.createElement(x1,{message:t}),Ji(t)&&In.default.createElement(a1,{message:t}),ln(t)&&In.default.createElement(Qv,{order:r,loading:n??!1,message:t}),xm(t)&&In.default.createElement(p9,{order:r,message:t}))},f9=(0,In.memo)(QD);var Ge=v(A());var h9=v(cM());var _1=v(A()),JD=e=>{let{onClick:t,container:o}=e,{t:r}=k();return _1.default.createElement(Xe,{onClick:()=>t(),sx:{position:"absolute",bottom:"16px",left:"50%",transform:"translateX(-50%)",bgcolor:"background.paper",padding:0,border:"1px solid",width:"32px",height:"32px",borderColor:n=>n.palette.mode==="dark"?"rgb(64,64,64)":"rgb(234,234,234)",boxShadow:"0px 12px 16px -4px rgba(0, 0, 0, 0.08), 0px 4px 6px -2px rgba(0, 0, 0, 0.03)","&:hover":{bgcolor:n=>n.palette.mode==="dark"?"rgb(64,64,64)":"rgb(234,234,234)"}}},_1.default.createElement(ve,{PopperProps:{container:o},title:r("package__features:chat__message_list__scroll_to_bottom__title"),placement:"top"},_1.default.createElement(h9.default,{sx:{boxSizing:"border-box",padding:"8px",fontSize:"32px"}})))},C1=JD;var eH="message-list-scroll-container",hx=4*24+2*16,g9=e=>{let t=e.scrollTop,o=e.scrollHeight,r=e.clientHeight;return Math.abs(r+t-o)>10},tH=(e,t,o,r)=>{if(!e)return;let n=e.querySelectorAll("[data-message-id]"),i=Array.from(n).findIndex(s=>s.getAttribute("data-message-id")===t),a=n[i];if(a){let s=a.getAttribute("data-scroll-position")||"bottom";e.scrollTo(0,s==="bottom"?e?.scrollHeight:a.offsetTop-hx),o?.()}r?.()},oH=e=>{let{conversationId:t}=ue(),{conversationId:o=t,sx:r,emptyNode:n,children:i}=e,a=ty(o),s=Xo(o),l=(0,Ge.useRef)(null),[c,p]=(0,Ge.useState)(0),u=(0,Ge.useRef)(oi(tH,50,{leading:!1,trailing:!0})),m=(0,Ge.useRef)(null),d=(0,Ge.useRef)(null),{messages:f,isLoading:h,isFetchingNextPage:C,hasNextPage:x,fetchNextPage:_,lastMessageId:y,previousPageLastMessageId:b}=JC(o),[S,I]=(0,Ge.useState)(!1),w=(0,Ge.useRef)(!1);(0,Ge.useEffect)(()=>{w.current=!1},[o]);let[E,O]=(0,Ge.useState)(!1);(0,Ge.useLayoutEffect)(()=>{O(!1)},[o]);let L=h||!E,G=(0,Ge.useRef)(!1),H=(0,Ge.useCallback)(()=>{C||!x||G.current||(G.current=!0,_().then().catch())},[C,x,_]),V=st(H),W=()=>{let P=l.current;P&&(P.scrollTo(0,P.scrollHeight),I(!1))},N=(0,Ge.useCallback)(()=>{if(!m.current){O(!0);return}let P=l.current;if(P&&I(g9(P)),d.current===m.current){O(!0);return}let $=m.current;u.current(l.current,m.current,()=>{d.current=$,w.current=!0,G.current&&(G.current=!1)},()=>{setTimeout(()=>{O(!0)},100)})},[]);(0,Ge.useEffect)(()=>{let P=l.current;if(!P)return;let $=ce=>{if(I(g9(P)),ce.deltaY<0){P.scrollTop<=P.offsetHeight/10&&V.current();return}},j=new ResizeObserver(()=>{let ce=P.clientHeight;p(ce)});j.observe(P);let de=oi($,100),re=kr($,300);return P.addEventListener("wheel",de),P.addEventListener("wheel",re),P.addEventListener("scroll",de),P.addEventListener("scroll",re),()=>{P.removeEventListener("wheel",de),P.removeEventListener("wheel",re),P.removeEventListener("scroll",de),P.removeEventListener("scroll",re),j.disconnect()}},[l.current,o]);let Z=(0,Ge.useRef)(null);qu(()=>{Z.current=m.current}),(0,Ge.useEffect)(()=>{Z.current&&(wi(f)?.messageId!==Z.current&&W(),Z.current=null)},[f]),(0,Ge.useEffect)(()=>{let P=a?.messageId||"";if(P&&y!==P)m.current=P;else if(y&&y!==m.current){if(s?.type==="Summary"&&w.current)return;m.current=y}},[a?.messageId,y]),(0,Ge.useEffect)(()=>{b&&G.current&&(m.current=b)},[b]),(0,Ge.useEffect)(()=>{d.current=null},[o]);let J=(0,Ge.useRef)({}),K=(0,Ge.useMemo)(()=>{a&&(J.current[o]=a);let P=De(f),$=J.current[o],j=$?.messageId;if(!j)return{writingMessageId:"",currentMessages:P};let de=f.findIndex(re=>re.messageId===j);if(de>-1){let re=!1;if(a&&a.updated_at&&P[de].updated_at){if(new Date(a.updated_at).getTime()<new Date(P[de].updated_at).getTime())return{writingMessageId:j,currentMessages:P};re=!0}return!a&&!re?(delete J.current[o],{writingMessageId:"",currentMessages:P}):(P[de]=qo([P[de],a]),{writingMessageId:j,currentMessages:P})}else if($){let re=wi(f);re&&Ji(re)?delete J.current[o]:P=[...f,$]}return{writingMessageId:j,currentMessages:P}},[o,a,f]),Q=(0,Ge.useMemo)(()=>!(h||C||x||K.currentMessages.length||K.writingMessageId||s?.lastMessageId),[h,C,x,K.currentMessages.length,K.writingMessageId,s?.lastMessageId]),M=wi(f)?.type,le=(0,Ge.useMemo)(()=>({flex:1,height:"0",overflowY:"auto",display:Q?"none":"block","&:focus":{outline:"none"},"& .maxai__message-item":{"&:last-of-type":{minHeight:M==="system"?"unset":c===0?`calc(100vh - ${hx+200}px)`:`calc(${c}px - ${hx}px)`}},...r}),[c,M,r,Q]),ge=Ge.default.createElement(g,{"data-testid":"maxai--chat-panel--message-list",key:o,sx:{height:0,flex:1,width:"100%",position:"relative",display:Q?"none":"flex","& *":{boxSizing:"border-box"},...r}},Ge.default.createElement(x1,{message:s,sx:{left:0,right:"inherit"}}),Q&&n,L&&Ge.default.createElement("div",{style:{position:"absolute",top:0,left:0,right:0,bottom:0,zIndex:2}},Ge.default.createElement(Br,{loading:!0,sx:{backgroundColor:"background.default"}})),Ge.default.createElement(F,{ref:l,id:eH,tabIndex:-1,sx:le},C&&Ge.default.createElement(g,{width:"100%",alignItems:"center",justifyContent:"center",sx:{my:"16px"}},Ge.default.createElement(Ft,{size:16,sx:{m:"0 auto"}})),K.currentMessages.map((P,$)=>Ge.default.createElement(f9,{key:`${P.messageId}_${$}`,className:`maxai__message-item maxai__message-item--${P.type}`,"data-testid":`maxai__message-item-${$+1}`,message:P,order:$+1,onChangeHeight:N,loading:K.writingMessageId===P.messageId}))),S&&!Q&&Ge.default.createElement(C1,{onClick:()=>W()}));return i?i({isShowHomeView:Q,isLoading:h,isFetchingNextPage:C,hasNextPage:x,messages:K.currentMessages,listNode:ge}):ge},Dc=oH;var Yn=v(A());var Xn=v(A());var fi=v(A()),rH=()=>{let{t:e}=k(),{localSettings:t,setLocalSettings:o}=lt(),r=t.sidebarSettings?.search?.copilot,{conversationId:n}=ue(),i=ye(n);return fi.default.createElement(ve,{title:fi.default.createElement(g,null,fi.default.createElement(g,{gap:.5,direction:"row"},fi.default.createElement(T,{fontSize:"16px",color:"rgba(255, 255, 255, .87)",fontWeight:500},"Pro"),fi.default.createElement(T,{fontSize:"16px",color:"#d9a7ff",fontWeight:500},"search")),fi.default.createElement(T,{fontSize:"14px",color:"rgba(255, 255, 255, .87)"},e("package__features:chat__app__search_advanced__copilot__description")))},fi.default.createElement(g,{onClick:()=>{i||o({sidebarSettings:{search:{copilot:!r}}})},direction:"row",alignItems:"center",gap:.5,sx:{py:.5,px:1,cursor:i?"not-allowed":"pointer"}},fi.default.createElement(g,{alignItems:"center",justifyContent:"center",p:"2px"},fi.default.createElement(kl,{disabled:i,checked:r,height:16,color:"primary"})),fi.default.createElement(T,{fontSize:"14px",color:r?"primary.main":"text.primary"},"Pro")))},x9=rH;var I9=v(va());var Do=v(A());var y9=v(On());var Tr=v(A());var tn=v(A());var _9=v(A()),y1=[{betaFeature:"appearance_v2",optionTitle:"package__features:beta_features__modal__option__appearance_v2__title",betaFeatureCardTitle:"package__features:beta_features__modal__feature_card__appearance_v2__title",betaFeatureCardImages:[$c("/images/beta-features/appearance/1.png")],betaFeatureCardDescription:"package__features:beta_features__modal__feature_card__appearance_v2__description",onButtonText:"package__features:beta_features__modal__feature_card__appearance_v2__on",offButtonText:"package__features:beta_features__modal__feature_card__appearance_v2__off"},{betaFeature:"enabled_artifacts",optionTitle:"package__features:beta_features__modal__option__artifacts__title",betaFeatureCardTitle:"package__features:beta_features__modal__feature_card__artifacts__title",betaFeatureCardImages:[$c("/images/beta-features/artifacts/1.png")],betaFeatureCardDescription:"package__features:beta_features__modal__feature_card__artifacts__description",onButtonText:"package__features:beta_features__modal__feature_card__common__on",offButtonText:"package__features:beta_features__modal__feature_card__common__off"}],us=(0,_9.createContext)({mode:"full",selectedBetaFeature:y1[0].betaFeature,betaFeatureOptions:y1,openBetaFeature:()=>{},handleSelectBetaFeature:()=>{},closeBetaFeature:()=>{},open:!1});var nH=e=>{let{betaFeature:t,onChange:o}=e,{t:r}=k(),{selectedBetaFeature:n,betaFeatureOptions:i}=(0,tn.useContext)(us),a=i.find(s=>s.betaFeature===n);return!a||a.betaFeature!==t?null:tn.default.createElement(g,{gap:1.5,width:"100%"},a.betaFeatureCardImages[0]&&tn.default.createElement("img",{alt:r(a.betaFeatureCardTitle),width:"100%",src:a.betaFeatureCardImages[0]}),tn.default.createElement(g,{gap:1},tn.default.createElement(g,{direction:"row",alignItems:"center",gap:1},tn.default.createElement(T,{width:0,flex:1,noWrap:!0,fontSize:"16px",fontWeight:"400",color:"text.primary",textAlign:"left"},r(a.betaFeatureCardTitle)),tn.default.createElement(g,{onClick:async()=>{let s=!a?.enabled;a?.setEnabled?.(s),o?.(s)},direction:"row",alignItems:"center",gap:.5,sx:{flexShrink:0,py:.5,px:1,cursor:"pointer"}},tn.default.createElement(T,{fontSize:"14px",fontWeight:"400",color:"text.primary"},r(a.offButtonText)),tn.default.createElement(g,{alignItems:"center",justifyContent:"center",p:"2px"},tn.default.createElement(kl,{checked:a.enabled,height:16})),tn.default.createElement(T,{fontSize:"14px",fontWeight:"400",color:"text.primary"},r(a.onButtonText)))),tn.default.createElement(T,{fontSize:"14px",fontWeight:"400",color:"text.secondary"},r(a.betaFeatureCardDescription))))},gx=nH;var Hc=v(A());var iH=()=>{let{t:e}=k(),{selectedBetaFeature:t,betaFeatureOptions:o,handleSelectBetaFeature:r}=(0,Hc.useContext)(us);return Hc.default.createElement(Qu,{sx:{width:"100%"}},o.map(n=>Hc.default.createElement(Ju,{sx:{p:"8px 12px"},key:n.betaFeature,selected:t===n.betaFeature,onClick:()=>r(n.betaFeature)},Hc.default.createElement(T,{fontSize:"14px",fontWeight:500,color:"text.primary"},e(n.optionTitle)))))},C9=iH;var aH=()=>{let{t:e}=k(),{mode:t,open:o,closeBetaFeature:r}=(0,Tr.useContext)(us),{appSettings:n,setAppSettings:i}=Yr(),a=Mt(),{betaSettings:s,updateBetaSettings:l}=Yo();return Tr.default.createElement(Ii,{container:a,open:o,onClose:c=>{c.stopPropagation(),r()},sx:{position:t==="full"?"fixed":"absolute"},slotProps:{root:{onClick:c=>{c.stopPropagation()}},backdrop:{sx:{position:t==="full"?"fixed":"absolute"}}}},Tr.default.createElement(Zu,{sx:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",borderRadius:1,bgcolor:c=>c.palette.mode==="dark"?"#3d3d3d":"#fff",maxWidth:"768px!important",width:t==="full"?"100%":"448px",p:"0!important"}},Tr.default.createElement(g,null,Tr.default.createElement(g,{direction:"row",alignItems:"center",justifyContent:"space-between",sx:{p:"8px 16px",borderBottom:"1px solid",borderColor:"border.main",boxSizing:"border-box"}},Tr.default.createElement(T,{fontSize:"16px",fontWeight:600,lineHeight:"20px",color:"text.primary"},e("package__features:beta_features__modal__title")),Tr.default.createElement(Xe,{"aria-label":"close",sx:{width:30,height:30},onClick:()=>{r()}},Tr.default.createElement(y9.default,{sx:{width:20,height:20}}))),Tr.default.createElement(g,{sx:{flexDirection:t==="lite"?"column":"row"}},Tr.default.createElement(g,{sx:{p:"12px 16px",width:t==="lite"?"100%":"208px",boxSizing:"border-box"}},Tr.default.createElement(C9,null)),Tr.default.createElement(g,{sx:{p:"12px 16px",width:t==="lite"?"100%":"0",flex:1,boxSizing:"border-box"}},Tr.default.createElement(gx,{betaFeature:"enabled_artifacts",onChange:async()=>{await i({userSettings:{features:{artifacts:{enabled:!n.userSettings?.features?.artifacts?.enabled}}}})}}),Tr.default.createElement(gx,{betaFeature:"appearance_v2",onChange:async()=>{await l({appearance_v2_enabled:!s?.appearance_v2_enabled})}}))))))},b9=aH;var S9=e=>{let{sx:t}=e;return Do.default.createElement(I9.default,{sx:{...t}},Do.default.createElement("svg",{width:"18",height:"18",viewBox:"0 0 18 18",fill:"none",xmlns:"http://www.w3.org/2000/svg"},Do.default.createElement("g",null,Do.default.createElement("path",{d:"M3.74989 15.75C3.11239 15.75 2.65927 15.4656 2.39052 14.8969C2.12177 14.3281 2.18739 13.8 2.58739 13.3125L6.74989 8.25V3.75H5.99989C5.78739 3.75 5.60927 3.67813 5.46552 3.53437C5.32177 3.39062 5.24989 3.2125 5.24989 3C5.24989 2.7875 5.32177 2.60938 5.46552 2.46562C5.60927 2.32187 5.78739 2.25 5.99989 2.25H11.9999C12.2124 2.25 12.3905 2.32187 12.5343 2.46562C12.678 2.60938 12.7499 2.7875 12.7499 3C12.7499 3.2125 12.678 3.39062 12.5343 3.53437C12.3905 3.67813 12.2124 3.75 11.9999 3.75H11.2499V8.25L15.4124 13.3125C15.8124 13.8 15.878 14.3281 15.6093 14.8969C15.3405 15.4656 14.8874 15.75 14.2499 15.75H3.74989ZM5.24989 13.5H12.7499L10.1999 10.5H7.79989L5.24989 13.5ZM3.74989 14.25H14.2499L9.74989 8.775V3.75H8.24989V8.775L3.74989 14.25Z",fill:"currentColor"}))))},sH=e=>{let{mode:t,buttonSize:o="small",sx:r,...n}=e,{t:i}=k(),{userSettings:a}=Yr(),{betaSettings:s}=Yo(),{loaded:l,features:c}=$C(),[p,u]=(0,Do.useState)(!1),[m,d]=(0,Do.useState)(void 0),f=(0,Do.useMemo)(()=>t||(vi()?"lite":"full"),[t]),h=(0,Do.useMemo)(()=>De(y1).map(S=>(S.enabled=!1,S.hasBetaFeatureAccess=!1,l&&c[S.betaFeature]&&S.betaFeature==="enabled_artifacts"&&(S.enabled=a?.features?.artifacts?.enabled,S.hasBetaFeatureAccess=!0),S)).filter(S=>S.hasBetaFeatureAccess),[c,l,a,s?.appearance_v2_enabled]),C=h.find(S=>S.enabled),x=S=>{let I=h.find(E=>E.hasBetaFeatureAccess),w=S||I?.betaFeature;w&&(d(w),u(!0))},b={mode:f,open:p,selectedBetaFeature:m,handleSelectBetaFeature:S=>{d(S)},betaFeatureOptions:h,openBetaFeature:x,closeBetaFeature:()=>{d(void 0),u(!1)}};return h.find(S=>S.hasBetaFeatureAccess)?Do.default.createElement(us.Provider,{value:b},o==="small"?Do.default.createElement(Ts,{"data-testid":"maxai--chat--beta-features-button",title:i("package__features:beta_features__toggle_button__title"),color:"primary",sx:{position:"relative",...r},onClick:()=>{x()},...n},Do.default.createElement(F,{component:"svg",sx:{position:"absolute",opacity:C?1:0,top:"4px",right:"4px",width:"6px",height:"6px",borderRadius:"50%",bgcolor:"currentColor",color:"inherit"}}),Do.default.createElement(S9,{sx:{fontSize:"20px"}})):Do.default.createElement(Ts,{"data-testid":"maxai--chat--beta-features-button",onClick:()=>{x()},color:"primary",sx:{position:"relative",width:"100%",justifyContent:"flex-start",padding:"8px 10px",height:"unset",gap:"12px",display:"flex",alignItems:"center","& > :not(div)":{flexShrink:0}},...n},Do.default.createElement(F,{component:"svg",sx:{position:"absolute",opacity:C?1:0,top:"4px",left:"28px",width:"6px",height:"6px",borderRadius:"50%",bgcolor:"currentColor",color:"inherit"}}),Do.default.createElement(S9,{sx:{fontSize:"20px"}}),Do.default.createElement(T,{component:"div",flex:1,width:0,fontSize:"14px",color:"inherit",fontWeight:400,textAlign:"left"},i("package__features:beta_features__toggle_button__title"))),Do.default.createElement(b9,null)):null},v9=sH;var w9=v(A());var lH=()=>{let e="feedback",{userInfo:t,subscriptionType:o}=vt(),{syncSurveyStatus:r}=Yl(!1),n=Zt(md),i=Zt(dd),a=(0,w9.useMemo)(()=>!(!i||t===null||o!=="yearly"&&o!=="oneTimePayment"||n[e]),[t,o,i,e,n]);return Cl(r),{loaded:i,canShowSurvey:a}},T9=lH;var M9=v(va());var vn=v(A()),cH=({sx:e})=>{let t="feedback",o=`${qr}/survey/feedback/`,{isLogin:r}=Ko(),{t:n}=k(),{canShowSurvey:i}=T9(),{syncSurveyStatus:a}=Yl(!1),[s,l]=(0,vn.useState)(!1),c=()=>{l(!0),window.open(o),u_("survey_card_clicked",{survey_type:t})};return Cl(()=>{s&&(a(void 0,!0),l(!1))}),!r||!i?null:vn.default.createElement(vn.default.Fragment,null,vn.default.createElement(ve,{placement:"top",title:n("package__features:chat__chat_input__feedback_button__description")},vn.default.createElement("div",null,vn.default.createElement(an,{"data-testid":"maxai--chat--feedback-button",sx:{borderRadius:1,p:"6px",bgcolor:p=>p.palette.mode==="dark"?"rgba(178, 115, 255, 0.16)":"rgba(118, 1, 211, 0.08)","&:hover":{bgcolor:p=>p.palette.mode==="dark"?"rgba(178, 115, 255, 0.24)":"rgba(118, 1, 211, 0.12)"},...e},onClick:c},vn.default.createElement(pH,{sx:{fontSize:20}}),vn.default.createElement(T,{ml:.5,my:0,fontSize:12,fontWeight:400,lineHeight:1.5,color:"text.primary",sx:{userSelect:"none",opacity:1}},n("package__features:chat__chat_input__feedback_button"))))))},E9=cH,pH=({sx:e})=>vn.default.createElement(M9.default,{viewBox:"0 0 20 20",sx:e},vn.default.createElement("svg",{width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},vn.default.createElement("path",{d:"M4.8127 6.80792H15.1877M4.8127 10.0007H15.1877M4.46686 14.0898V16.9173L8.15621 14.0898H16.5724C17.5269 14.0898 18.3002 13.3151 18.3002 12.3606V4.81315C18.3002 3.85865 17.5255 3.08398 16.571 3.08398H3.42936C2.47486 3.08398 1.7002 3.85865 1.7002 4.81315V12.3606C1.7002 13.3151 2.47486 14.0898 3.42936 14.0898H4.46686Z",stroke:"currentColor",strokeOpacity:"0.87",strokeWidth:"1.60645"})));var wn=v(A()),uH=()=>{let{t:e}=k(),{inputMediator:t}=ue(),{selectedType:o,changeMyOwnToolsType:r,resetMyOwnToolsType:n}=pn(),{chatHubLoading:i}=yt(),a={SUGGESTED:"PromptMyOwnTools",MY_OWN_TOOLS:"PromptMyOwnTools",REWRITE:"Rewrite"},{changeContextMenuPath:s,changeMode:l}=co(),{rewriteDisabled:c}=dy(),p=(0,wn.useMemo)(()=>o!=="SUGGESTED",[o]),u=(0,wn.useMemo)(()=>[{value:"REWRITE",testid:"maxai--chat-my-own-tools-button--rewrite",label:e("package__features:chat__inputbox__button__my_own_tools__menu__rewrite"),title:c?e("package__features:home_view__chat_with_any_content__tab__rewrite__disabled_title"):null,disabled:c,ButtonProps:{key:`REWRITE-${c}`,tooltipProps:{placement:"right",disabled:!1}},icon:wn.default.createElement(X,{icon:"Rewrite"})},{value:"MY_OWN_TOOLS",testid:"maxai--chat-my-own-tools-button--my-own-tools",label:e("package__features:chat__inputbox__button__my_own_tools__menu__my_own_tools"),icon:wn.default.createElement(X,{icon:"PromptMyOwnTools"})}],[e,c]),m=(0,wn.useMemo)(()=>u.find(f=>f.value===o),[o,u]),d=f=>{let h=f;o===h?n():r(h),t.updateInputValue(""),t.focus()};return(0,wn.useEffect)(()=>{let f=my(o);s(f||null),l("list")},[o]),wn.default.createElement(wn.default.Fragment,null,wn.default.createElement(Ts,{disabled:i,testid:"maxai--chat-my-own-tools-button",defaultOptionValue:"MY_OWN_TOOLS",options:p?void 0:u,placement:"top-start",onClick:()=>{p&&n()},onMouseUp:()=>{t.focus()},onSelectOption:f=>{d(f)},OptionsCardProps:{sx:{width:"144px",marginLeft:"-12px"}},sx:{height:"32px",lineHeight:1.5,...p?{borderRadius:"16px",padding:"0 6px",gap:"6px",bgcolor:f=>f.palette.mode==="dark"?"rgba(32, 59, 88, 1)!important":"rgba(213, 239, 255, 1)!important",color:f=>f.palette.mode==="dark"?"rgba(0, 173, 255, 1)!important":"rgba(48, 123, 201, 1)!important",fontSize:"12px","&:hover":{bgcolor:f=>f.palette.mode==="dark"?"rgba(29, 54, 80, 1)!important":"rgba(181, 221, 247, 1)!important",color:f=>f.palette.mode==="dark"?"rgba(0, 173, 255, 1)!important":"rgba(48, 123, 201, 1)!important"}}:{}}},wn.default.createElement(X,{icon:a[o]||a.SUGGESTED,sx:{...p?{color:"inherit !important"}:{}}}),p&&m&&m.label))},A9=uH;Z7();Q7();var ha=v(A()),P9=v(sl()),mH=e=>{let{rootContainer:t,customElementName:o,children:r,style:n,checkVisibility:i=!0,onSetContainer:a}=e,[s,l]=(0,ha.useState)(null),c=(0,ha.useRef)(null);return(0,ha.useEffect)(()=>{if(t&&!s){if(i&&!Qc(t))return;let p="customElements"in window,u=document.createElement(p?o:"div");n&&(u.style.cssText=n),t.insertBefore(u,t.firstChild);let m=u.attachShadow({mode:"open"}),d=document.createElement("style"),f=document.createElement("div");m.appendChild(d),m.appendChild(f);let h=String(o).toLowerCase().replace(/_/g,"-");c.current=t2({key:`${h}-emotion-cache`,prepend:!0,container:d}),l(C=>(C&&C.getRootNode()?.host?.remove(),f))}else s&&!t&&l(null);return()=>{}},[t,s,o,i,n]),(0,ha.useEffect)(()=>{a&&s&&a(s)},[s,a]),!s||!c.current?null:(0,P9.createPortal)(ha.default.createElement(o2,{value:c.current},r),s)},k9=mH;var O9=v(pM());var Mr=v(A());var b1=v(A()),qs=v(A()),dH=e=>{let{onChange:t}=e,[o,r]=(0,qs.useState)(!1),n=(0,qs.useRef)([0,0]),[i,a]=(0,qs.useState)([0,0,0,0]),s=u=>{n.current=[u.clientX,u.clientY],r(!0)},l=u=>{if(o){let[m,d]=n.current,[f,h]=[u.clientX,u.clientY],[C,x,_,y]=[Math.min(m,f),Math.min(d,h),Math.abs(m-f),Math.abs(d-h)];a([C,x,_,y])}},c=async u=>{r(!1);let m=await e.getScreenshot();if(m){let d=document.createElement("canvas"),f=d.getContext("2d"),h=new Image;h.src=m,h.onload=()=>{let C=window.innerWidth,x=h.naturalWidth/C,[_,y,b,S]=i.map(w=>w*x);d.width=b,d.height=S,f?.drawImage(h,_,y,b,S,0,0,b,S);let I=d.toDataURL("image/png");d.toBlob(async w=>{if(w)t?.({image:I,rect:i,imageFile:new File([w],"screenshot.png",{type:"image/png"})});else{let E=await _2(I,"screenshot.png");t?.({image:I,rect:i,imageFile:E})}})}}},p=(0,qs.useMemo)(()=>{let[,,u,m]=[0,0,window.innerWidth,window.innerHeight],[d=0,f=0,h=0,C=0]=i;return[[0,0,h+d,f],[d+h,0,u-d-h,f+C],[0,f,d,m-f],[d,f+C,u-d,m-f-C]]},[i]);return b1.default.createElement(F,{onMouseDown:s,onMouseMove:l,onMouseUp:c,position:"fixed",sx:{width:"100vw",height:"100vh",top:0,left:0,zIndex:2147483647,cursor:"crosshair"}},b1.default.createElement(F,{sx:{position:"absolute",top:`${i[1]}px`,left:`${i[0]}px`,width:`${i[2]}px`,height:`${i[3]}px`,outline:"3px dashed",outlineColor:"#9065B0"}}),p.map((u,m)=>b1.default.createElement(F,{key:u.join(","),sx:{position:"absolute",top:u[1],left:u[0],width:u[2],height:u[3],backgroundColor:"rgba(0,0,0,0.3)"}})))},L9=dH;var fH=e=>{let{getScreenshot:t,disabled:o,tooltip:r,sx:n}=e,i=Mr.default.useRef(null),{t:a}=k(),[s,l]=(0,Mr.useState)(null),{uploadFiles:c}=km(),{setChatDocuments:p,handleUploadFilesToChatDocuments:u}=Am(),{betaSettings:m}=Yo(),{chatHubLoading:d}=yt(),{isUnavailableUploadSource:f}=pn(),h=o??(d||f);(0,Mr.useEffect)(()=>{function _(y){if(y.key==="Escape"){s?.remove(),l(null),e.onCropEnd?.();return}}return s&&window.addEventListener("keydown",_,!0),()=>{window.removeEventListener("keydown",_,!0)}},[s]);let C=(0,Mr.useMemo)(()=>r||(f?a("package__features:chat__inputbox__button__ai_screenshot__rewrite_disabled_tooltip"):h?"":a("package__features:chat__inputbox__button__ai_screenshot__tooltip")),[r,a,f,h]);return Mr.default.createElement(Mr.default.Fragment,null,Mr.default.createElement(ve,{placement:"bottom",title:C,disableInteractive:!0},Mr.default.createElement(F,null,Mr.default.createElement(fe,{buttonRefBind:_=>i.current=_,disabled:h,"data-testid":"maxai-take-screenshot",onClick:async()=>{if(!await nt({emitEvent:!0})||!J2("7.4.1"))return;e.onCropStart?.();let _=document.createElement("div");_.style.width="100vw",_.style.height="100vh",_.style.position="fixed",_.style.zIndex="2147483647",document.body.appendChild(_),l(_)},sx:n},Mr.default.createElement(O9.default,{sx:{transform:"rotate(-90deg)",fontSize:"20px"}})))),s&&!h&&Mr.default.createElement(k9,{customElementName:"max-ai-screenshot",rootContainer:s},Mr.default.createElement(L9,{getScreenshot:t||(()=>gl.getCurrentTabScreenshot()),onChange:async({imageFile:_})=>{if(s?.remove(),l(null),e.onCropEnd?.(),e.onFile){e.onFile(_);return}m?.appearance_v2_enabled?(i.current&&i.current?.getAttribute("data-keep-context")?i.current?.removeAttribute("data-keep-context"):p(y=>y.map(b=>({...b,selected:!1}))),await u([_])):await c([_])}})))},B9=fH;var ga=v(A()),hH=({sx:e})=>{let{loaded:t,subscriptionType:o}=vt(),{isLogin:r}=Ko(),{t:n}=k(),{getPlansInfoByType:i}=sm(),{showPricingUpgradeContentPopup:a}=fC(),s=i("elite_yearly"),l=!1,c=nC(),p=m=>{ti("click",{conversationId:"",paywallType:"proactive",paywallReason:"proactive",buttonType:"upgrade",targetElement:m.currentTarget}),a()},u=(0,ga.useMemo)(()=>(o==="monthly"||o==="quarterly")&&s.discount_title?n("package__features:pricing__save_to",{NUM:s.discount_title}):n("package__common:upgrade"),[n,o,s.discount_title]);return!t||!r||o==="yearly"||o==="oneTimePayment"?null:ga.default.createElement(ga.default.Fragment,null,ga.default.createElement(ve,{title:c},ga.default.createElement(an,{"data-testid":"maxai--chat--upgrade-plan-button",variant:"contained",sx:{borderRadius:1,p:"6px",pr:"8px",...e},loading:l,onClick:p},ga.default.createElement(Lu,{sx:{fontSize:20,color:"inherit"}}),ga.default.createElement(T,{ml:.5,my:0,fontSize:14,fontWeight:500,lineHeight:"20px",color:"text.primary",sx:{userSelect:"none",opacity:l?0:1,color:"inherit"}},u))))},F9=hH;var hi=v(A()),gH=e=>{let{...t}=e,{conversationId:o}=ue(),{t:r}=k(),n=Xo(o),i=ye(o),{files:a,uploadFiles:s}=Lm(),l=(0,hi.useRef)(null),c=(0,hi.useMemo)(()=>$o(n?.meta.AIProvider,n?.meta.AIModel),[n?.meta.AIProvider,n?.meta.AIModel]),{maxCount:p=1,accept:u="",acceptTooltip:m}=c?.uploadFileConfig||{},d=a.some(h=>h.uploadStatus==="uploading"),f=async h=>{let C=h.target.files;!C||!n||await s(Array.from(C)).catch()};return hi.default.createElement(hi.default.Fragment,null,hi.default.createElement(fe,{title:m?.(r)||r("package__features:chat__inputbox__button__upload__tooltip"),"data-testid":"chat-file-upload-button",onClick:async()=>{await nt({emitEvent:!0})&&(d||l.current&&(l.current.value="",l.current.click()))},loading:d,disabled:i,loadingNode:hi.default.createElement(Ft,{size:16,sx:{fontSize:"16px"}}),...t},hi.default.createElement(X,{icon:"Attachment",sx:{transform:"rotate(-45deg)",fontSize:"20px"}})),hi.default.createElement("input",{multiple:p>1,onChange:f,ref:l,accept:u,hidden:!0,style:{display:"none"},type:"file"}))},D9=gH;var io=v(A());var xH=e=>{let{headerNode:t,headerLeftNode:o,headerRightNode:r,footerNode:n,footerLeftNode:i,footerRightNode:a,minLine:s=3,error:l,textareaProps:c,sx:p,defaultValue:u,sendButtonProps:m}=e,{t:d}=k(),{conversationType:f,conversationId:h}=ue(),{askAIQuestionV2:C,askAIQuestion:x}=ze(),{getConversationLoading:_}=ct(),{uploadFiles:y}=km(),{handleUploadFilesToChatDocuments:b}=Am(),{betaSettings:S}=Yo(),I=Ha(),w=(0,io.useMemo)(()=>{if(f==="Summary")switch(t_()){case"PAGE_SUMMARY":return d("package__features:chat__input__summary_page__placeholder");case"YOUTUBE_VIDEO_SUMMARY":return d("package__features:chat__input__summary_video__placeholder");case"DEFAULT_EMAIL_SUMMARY":return d("package__features:chat__input__summary_email__placeholder");case"PDF_CRX_SUMMARY":return d("package__features:chat__input__summary_pdf__placeholder");default:return d("package__features:chat__input__summary_page__placeholder")}return d(f==="Search"?"package__features:chat__input__search__placeholder":f==="Art"?"package__features:chat__input__art__placeholder":"package__features:chat__input__chat__placeholder")},[f,d]),E=I.getInputValue();(0,io.useEffect)(()=>{let K=Q=>{let M=Q.detail?.value;M&&(S?.appearance_v2_enabled?C({type:"user",text:M,meta:{includeHistory:!0}}):x({type:"user",text:M,meta:{includeHistory:!0}}))};return cv("MAXAI_CLIENT__CHAT_INPUT__SEND_MESSAGE",K),()=>{pv("MAXAI_CLIENT__CHAT_INPUT__SEND_MESSAGE",K)}},[C,x]);let O=async()=>{if(!I.isComposing){if(!await nt({emitEvent:!0})){I.focus();return}await _(h)||E&&(S?.appearance_v2_enabled?C({type:"user",text:E,meta:{includeHistory:!0}}):x({type:"user",text:E,meta:{includeHistory:!0}}))}};(0,io.useEffect)(()=>{if(I.ref){let K=I.getInputValue();I.focus(),I.ref?.setSelectionRange(K.length,K.length)}},[h,I]),(0,io.useEffect)(()=>{u&&I.updateInputValue(u)},[u]);let[L,G]=(0,io.useState)(!1),[H,V]=(0,io.useState)(!1),W=io.default.createElement(io.default.Fragment,null,a,io.default.createElement(ic,{value:{isVoiceInput:L,setIsVoiceInput:G}},io.default.createElement(sc,{voiceButtonProps:{onStartRecording:()=>{V(!0)},onStopRecording:K=>{K!=="done"&&V(!1)},onSpeechToTextFinally:()=>{V(!1)}},...m}))),{disabled:N,...Z}=c||{},J=N||H;return io.default.createElement(g,{direction:"column",width:"100%",borderRadius:1,border:"1px solid",borderColor:`${l?"rgb(239, 83, 80)":"border.main"}`,boxShadow:"0px 1px 2px 0px rgba(0, 0, 0, 0.05)",boxSizing:"border-box",sx:{"& > *":{order:1},...p}},t,io.default.createElement(g,{"data-testid":"maxai--chat-box--chat-input--main",spacing:1,sx:{p:"10px"}},o||r?io.default.createElement(F,{display:"flex",alignItems:"center",justifyContent:"space-between"},io.default.createElement(g,{direction:"row",spacing:.5},o),io.default.createElement(g,{direction:"row",spacing:.5},r)):null,io.default.createElement(lc,{ref:K=>I.bindRef(K),"data-testid":"chat-input-textarea","data-disabled-button-clicked":!0,value:E,placeholder:w,minLine:s,onChangeText:K=>I.updateInputValue(K),onPasteFiles:K=>{K.length>0&&(S?.appearance_v2_enabled?b(K):y(K))},onPaste:K=>I.emit("onPaste",K),onEnter:O,onCompositionStart:()=>I.setIsComposing(!0),onCompositionEnd:()=>I.setIsComposing(!1),stopPropagation:!0,disabled:J,...Z}),i||W?io.default.createElement(F,{display:"flex",alignItems:"center",justifyContent:"space-between"},!L&&io.default.createElement(g,{direction:"row",spacing:1},i),io.default.createElement(g,{direction:"row",spacing:1,flex:1,justifyContent:"flex-end",overflow:"hidden"},W)):null),n)},H9=xH;var q9=v(A());var R9=v(N9()),U9=v(z9()),_x=v(p1());var Ne=v(A()),W9={borderRadius:1,border:e=>`1px solid ${e.palette.border.main}`,background:e=>e.palette.background.default,flexDirection:"row",position:"relative",mt:1,p:1,gap:1.5,height:"62px",boxSizing:"border-box",width:"282px",minWidth:"282px",overflowY:"visible","& > .chat-file-list-cancel-icon":{opacity:0,transition:"opacity 0.1s ease-in-out",position:"absolute",top:0,right:0,transform:"translate3d(50%, -50%, 0)",fontSize:"14px",zIndex:10,overflow:"visible",cursor:"pointer",color:"text.primary",fill:e=>e.palette.mode==="dark"?"rgba(255, 255, 255, 0.6)":"rgba(0, 0, 0, 0.6)"},"& > .chat-file-list-cancel-icon:hover":{opacity:1},"&:hover > .chat-file-list-cancel-icon":{opacity:1}},vH={...W9,p:0,width:"62px",minWidth:"62px",border:"1px solid rgba(0, 0, 0, 0.08)",borderRadius:e=>e.spacing(.5),position:"relative"},V9={height:"40px",width:"40px",fontSize:"40px",cursor:"pointer",color:"text.primary"},G9={fontWeight:500,color:"text.primary",textOverflow:"ellipsis",whiteSpace:"nowrap",overflow:"hidden",fontSize:"14px",width:"100%"},wH={...G9,color:e=>e.palette.mode==="dark"?"rgba(255, 255, 255, 0.38)":"rgba(0, 0, 0, 0.38)"},xx=To(Ce)(({theme:e})=>({background:e.palette.mode==="dark"?"rgba(144, 101, 176, 0.2)":"#F9F5FF",color:"#9065B0",borderRadius:"8px",padding:"4px 8px"})),TH=e=>{let{files:t,onRemoveFiles:o,loading:r,onSendMessage:n,sx:i}=e,[a,s]=(0,Ne.useState)(!1),[l,c]=(0,Ne.useState)(!1),[p,u]=(0,Ne.useState)(!1),m=(0,Ne.useRef)(null),{t:d}=k(),{inputMediator:f}=ue(),h=()=>{if(!m.current)return;let L=m.current;s(L.scrollWidth!==L.offsetWidth),c(L.scrollLeft-24<=0),u(L.scrollLeft+L.offsetWidth+24>=L.scrollWidth)},C=L=>{n?.(L),f.focus()},x=()=>{if(!m.current)return;let L=Array.from(m.current.children);for(let G of L){if(!(G instanceof HTMLElement))continue;let H=G.offsetLeft-10;if(H>m.current.scrollLeft){m.current.scrollTo({left:H,behavior:"smooth"});break}}},_=()=>{if(!m.current)return;let L=Array.from(m.current.children).reverse();for(let G of L){if(!(G instanceof HTMLElement))continue;let H=G.offsetLeft-10;if(H<m.current.scrollLeft){m.current.scrollTo({left:H,behavior:"smooth"});break}}},y=(0,Ne.useRef)([]),b=async L=>{if(!y.current.includes(L.id)){y.current.push(L.id);try{await o?.([L])}catch{}finally{y.current=y.current.filter(G=>G!==L.id)}}},[S,I]=(0,Ne.useState)(void 0),w=(0,Ne.useMemo)(()=>t.filter(L=>L.icon==="image").map(L=>({src:L.uploadedUrl||L.base64Data||L.blobUrl||"",alt:L.fileName})),[t]);if((0,Ne.useEffect)(()=>{t.length>0&&h()},[t]),(0,Ne.useEffect)(()=>{if(!m.current)return;let L=m.current,G=new ResizeObserver(()=>h());return G.observe(L),()=>{G.unobserve(L),G.disconnect()}},[t.length===0]),t.length===0)return null;let E=!!t.find(L=>L.icon!=="image"),O=!!t.find(L=>L.uploadStatus==="uploading");return Ne.default.createElement(g,{spacing:1,sx:{mt:"-8px",...i}},Ne.default.createElement(F,{width:"100%",position:"relative",sx:{boxSizing:"border-box",overflow:"visible","& .chat-file-list-overflow-icon":{opacity:0,transition:"opacity 0.1s ease-in-out"},"&:hover .chat-file-list-overflow-icon":{opacity:1}}},Ne.default.createElement(g,{direction:"row",onScroll:h,ref:m,tabIndex:-1,sx:{gap:1,overflowX:"auto",boxSizing:"border-box",width:"100%",height:"100%",overflowY:"hidden",scrollbarColor:"auto","&::-webkit-scrollbar":{height:0,width:0,background:"transparent",display:"none"},"&::-webkit-scrollbar-thumb":{background:"transparent"}}},t.map((L,G)=>L.icon==="image"?Ne.default.createElement(F,{key:`${L.id}-${G}`,sx:vH},Ne.default.createElement(Ai,{width:"60px",height:"100%",alt:L.fileName,src:L.uploadedUrl||L.base64Data||L.blobUrl||"",SkeletonSx:{borderRadius:H=>H.spacing(.5)},imageSx:{borderRadius:H=>H.spacing(.5),height:"60px",width:"60px",objectFit:"cover",cursor:"pointer"},onImageClick:()=>{I(L.uploadedUrl||L.base64Data||L.blobUrl||"")}}),Ne.default.createElement(_x.default,{className:"chat-file-list-cancel-icon",onClick:()=>b(L)}),L.uploadStatus==="uploading"&&Ne.default.createElement(F,{sx:{position:"absolute",zIndex:1,top:0,left:0,display:"flex",justifyContent:"center",alignItems:"center",height:"100%",width:"100%",bgcolor:"transparent",backdropFilter:"blur(2px)",borderRadius:H=>H.spacing(.5)}},Ne.default.createElement(Ft,{size:40,thickness:4}))):Ne.default.createElement(g,{sx:W9,key:`${L.id}-${G}`},L.uploadStatus==="uploading"?Ne.default.createElement(F,{sx:V9},Ne.default.createElement(Ft,{size:40,thickness:4})):Ne.default.createElement(m1,{filename:L.fileName,filetype:L.fileType,sx:V9}),Ne.default.createElement(g,{direction:"column",flexGrow:1,overflow:"hidden"},Ne.default.createElement(T,{sx:G9},L.fileName),Ne.default.createElement(T,{sx:wH},L.fileType)),Ne.default.createElement(_x.default,{className:"chat-file-list-cancel-icon",onClick:()=>b(L)})))),a&&!l&&Ne.default.createElement(F,{className:"chat-file-list-overflow-icon",onClick:_,sx:{backdropFilter:"blur(1px)",background:"rgba(0, 0, 0, 0.60)",boxShadow:"0px 1px 2px 0px rgba(0, 0, 0, 0.05)",position:"absolute",left:"0",top:"50%",transform:"translate3d(50%, -50%, 0)",borderRadius:"8px",cursor:"pointer",padding:"4px 0",height:"24px",width:"16px"}},Ne.default.createElement(R9.default,{sx:{fontSize:L=>L.spacing(2),color:"white"}})),Ne.default.createElement(kc,{images:w,selectedImage:S,setSelectedImage:I}),a&&!p&&Ne.default.createElement(F,{className:"chat-file-list-overflow-icon",onClick:x,sx:{backdropFilter:"blur(1px)",background:"rgba(0, 0, 0, 0.60)",boxShadow:"0px 1px 2px 0px rgba(0, 0, 0, 0.05)",position:"absolute",right:"0",top:"50%",transform:"translate3d(-50%, -50%, 0)",borderRadius:"8px",cursor:"pointer",padding:"4px 0",height:"24px",width:"16px"}},Ne.default.createElement(U9.default,{sx:{fontSize:L=>L.spacing(2),color:"white"}}))),Ne.default.createElement(g,{direction:"row",gap:1},E?Ne.default.createElement(xx,{disabled:r||O,onClick:()=>{C("Summarize")},"data-testid":"chat-input--file-prompt--summarize"},d("package__features:chat__input__file_prompt__summarize__title")):Ne.default.createElement(Ne.default.Fragment,null,Ne.default.createElement(xx,{disabled:r||O,onClick:()=>{C("Extract text")},"data-testid":"chat-input--file-prompt--extract-text"},d("package__features:chat__input__file_prompt__extract_text__title")),Ne.default.createElement(xx,{disabled:r||O,onClick:()=>{C?.("Explain content")},"data-testid":"chat-input--file-prompt--explain-content"},d("package__features:chat__input__file_prompt__explain_content__title")))))},j9=TH;var MH=e=>{let{conversationId:t}=ue(),o=ye(t),{files:r,removeFiles:n}=Lm(),{askAIQuestion:i}=ze();return q9.default.createElement(j9,{files:r,loading:o,onRemoveFiles:n,onSendMessage:a=>{i({type:"user",text:a,conversationId:t,meta:{includeHistory:!1}})},...e})},K9=MH;var $9=v(nM());var lr=v(A()),v1=[{title:"package__features:home_view__chat_with_any_content__chat__chat_document_selector__add_sources__file__title",icon:lr.default.createElement(ea,{sx:{fontSize:"20px"},icon:"File"}),addContextType:"files",testid:"maxai--chat-document-selector--modal--preset-button--files"},{title:"package__features:home_view__chat_with_any_content__chat__chat_document_selector__add_sources__text__title",icon:lr.default.createElement(ea,{sx:{fontSize:"20px"},icon:"Text"}),addContextType:"text",testid:"maxai--chat-document-selector--modal--preset-button--text"},{title:"package__features:home_view__chat_with_any_content__chat__chat_document_selector__choose_sources__urls__title",icon:lr.default.createElement(ea,{sx:{fontSize:"20px"},icon:"URLs"}),addContextType:"urls",testid:"maxai--chat-document-selector--modal--preset-button--urls"}],X9=[{chatDocumentId:P2,title:"package__features:home_view__chat_with_any_content__chat__chat_document_selector__chip__search__title",icon:lr.default.createElement(ea,{sx:{fontSize:"20px"},icon:"Search"}),addContextType:"search",testid:"maxai--chat-document-selector--modal--preset-button--search"}],EH=e=>{let{t}=k(),{chatDocuments:o}=ki(),{dataList:r,activeIndex:n,onSelect:i,showEnterIcon:a=!1}=e;return lr.default.createElement(Mi,{sx:{p:0,overflowY:"auto",position:"relative",width:"100%",gap:"2px"}},r.map((s,l)=>{let c=n===l,p=o.find(d=>d.id===s.chatDocumentId),u=p?.selected,m=location.href===p?.link?[t("package__features:home_view__chat_with_any_content__chat__chat_document_selector__chip__current__title")]:[];return lr.default.createElement(Ct,{disabled:s.disabled,key:l,selected:c,onClick:()=>i&&i(s,l,r),sx:{p:"1px 0",width:"calc(100% - 12px)",left:"6px",borderRadius:"6px",minHeight:"unset"},"data-testid":s.testid||`maxai--chat-document-selector--modal--existing-document-button--${p?.maxAIDocumentType||"chat_file"}`},lr.default.createElement(ve,{zIndex:2147483621,title:s.tooltip||"",placement:"left",PopperProps:{modifiers:[{name:"flip",enabled:!0,options:{fallbackPlacements:["top","right"]}}],sx:{[`&.${Pr.popper}[data-popper-placement*="left"] > .${Pr.tooltip}`]:{mr:"20px"}}}},lr.default.createElement(g,{direction:"row",sx:{alignItems:"center",p:1,borderRadius:"8px",gap:"12px",position:"relative",width:"100%","& > button:last-of-type":{display:"none"},"&:hover":{"& > button:last-of-type":{display:"block"}}}},u&&lr.default.createElement(F,{sx:{position:"absolute",width:"3px",height:"100%",left:"-6px",top:0,backgroundColor:"primary.main"}}),lr.default.createElement(ep,{sx:{width:"20x",height:"20px",minWidth:"20px!important",flexShrink:0}},p?lr.default.createElement(s1,{size:20,chatDocument:p}):s.icon),lr.default.createElement(g,{direction:"row",gap:"4px",width:0,flex:1},lr.default.createElement(T,{width:0,flex:1,noWrap:!0,sx:{textAlign:"left",fontSize:"14px",color:"text.primary"}},t(s.title)," ",s.disabled?" (TODO)":""),lr.default.createElement(g,{direction:"row",gap:"4px",alignItems:"center",component:"div",flexShrink:0},m.map(d=>lr.default.createElement(l1,{key:d,sx:{color:"text.secondary"},label:d})))),c&&a&&lr.default.createElement($9.default,{sx:{flexShrink:0,fontSize:"16px",color:"text.secondary"}}),s.suffix)))}))},Y9=EH;var Ks=v(A()),AH=e=>{let{onAddContextClick:t,disabled:o}=e,{t:r}=k(),{selectedChatDocuments:n,toggleSelectedChatDocument:i,setChatDocuments:a}=Al(),{chatHubLoading:s}=yt(),l=(0,Ks.useMemo)(()=>fl(n,["createdAt"],["desc"]).sort((p,u)=>p.link===window.location.href?-1:u.link===window.location.href?1:0),[n]),c=p=>{p.status==="uploading"?a(u=>u.filter(m=>m.id!==p.id)):i(p.id)};return l.length>0?Ks.default.createElement(Ks.default.Fragment,null,l.map(p=>Ks.default.createElement(Oc,{disabled:s,dataTestId:"maxai--chat-document-selector--selected-document-button",key:p.id,onClose:()=>{c(p)},showClose:!0,chatDocument:p}))):Ks.default.createElement(T,{fontSize:"14px",sx:{color:o?"action.disabled":"text.secondary",userSelect:"none"},onClick:t},r("package__features:home_view__chat_with_any_content__chat__chat_document_selector__add_sources__title"))},Z9=AH;var J9=v(Q9()),ew=v(On());var Ht=v(A()),OH=e=>{let{t}=k(),o=pl(),{controlsRef:r,show:n,onClose:i,onConfirm:a,onBack:s,children:l,title:c,confirmBtnText:p,confirmBtnTextId:u,confirmBtnSx:m,cancelBtnText:d,cancelBtnSx:f,confirmBtnDisabled:h,modalSx:C,wrapSx:x,footerVariant:_,BackdropTransparent:y,disableScrollLock:b=!0,variant:S="default",isFixed:I,footerSlot:w}=e,[E,O]=Ht.default.useState(null),[L,G]=(0,Ht.useState)(_),[H,V]=(0,Ht.useState)(!1),W=(0,Ht.useCallback)(K=>{i(K)},[i]);(0,Ht.useEffect)(()=>{!L&&n&&E&&(E.clientWidth<=680?G("vertical"):G("horizontal"))},[n,E]);let N=(0,Ht.useCallback)(async()=>{V(!0),await a?.()!==!1&&W(),V(!1)},[a,W,V]);(0,Ht.useImperativeHandle)(r,()=>({clickConfirm:N}));let Z=(0,Ht.useMemo)(()=>{let K={danger:{backgroundColor:"rgba(237, 80, 80, 1)",color:"rgba(255, 255, 255, 1)","&:hover":{backgroundColor:"rgba(237, 99, 99, 1)",color:"rgba(255, 255, 255, 1)"}},default:{}};return K[S]||K.default},[S]),J=I===void 0?o:I;return Ht.default.createElement(Ii,{sx:{position:J?"fixed":"absolute",...C},disableScrollLock:b,open:n,onClose:(K,Q)=>W(Q),slotProps:{root:{onClick:K=>{K.stopPropagation()}},backdrop:{sx:{position:J?"fixed":"absolute",...y?{backgroundColor:"transparent"}:{}}}}},Ht.default.createElement(F,{ref:O,sx:{outline:"none",position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:"calc(100% - 32px)",minWidth:"min(448px, calc(100% - 32px))",maxWidth:"min(calc(1168px - 32px), calc(100% - 32px))",maxHeight:"calc(100% - 32px)",overflow:"auto",backgroundColor:"background.paper",boxSizing:"border-box",borderRadius:"16px",...x}},Ht.default.createElement(g,{sx:{flexDirection:"row",justifyContent:"space-between",alignItems:"flex-start"}},Ht.default.createElement(T,{sx:{fontSize:"24px",fontWeight:700,lineHeight:"34px",textAlign:"left",color:"text.primary",margin:"24px",display:"flex",alignItems:"center",gap:"4px"}},s&&Ht.default.createElement(Xe,{sx:{color:"text.secondary"},onClick:()=>{s(),W("backButton")}},Ht.default.createElement(J9.default,null)),c),Ht.default.createElement(Xe,{sx:{margin:"8px"},onClick:()=>W()},Ht.default.createElement(ew.default,{sx:{color:"text.secondary"}}))),l,Ht.default.createElement(g,{sx:{padding:"24px",alignItems:"center",flexDirection:L==="vertical"?"column":"row",justifyContent:"end",gap:"8px"}},w||Ht.default.createElement(Ht.default.Fragment,null,Ht.default.createElement(Ce,{variant:"text",color:"secondary",sx:{color:"text.secondary",padding:"10px 16px",lineHeight:"20px",width:L==="vertical"?"100%":"auto",order:L==="vertical"?1:0,"&:hover":{bgcolor:K=>K.palette.mode==="light"?"rgba(0, 0, 0, 0.1)":"rgba(255, 255, 255, 0.1)"},...f},onClick:()=>W()},d||t("package__features:home_view__chat_with_any_content__chat__chat_document_selector__modal__cancel__title")),Ht.default.createElement(an,{"data-testid":u,disabled:h,variant:"contained",onClick:N,loading:H,sx:{padding:"10px 16px",lineHeight:"20px",width:L==="vertical"?"100%":"auto",order:L==="vertical"?0:1,...Z,...m}},p||t("package__features:home_view__chat_with_any_content__chat__chat_document_selector__modal__done__title"))))))},Gi=OH;var qn=v(A()),BH=To(S_)(({theme:e})=>({fontFamily:e.typography.fontFamily,width:"100%",display:"block",padding:"16px",boxSizing:"border-box",fontSize:"16px",backgroundColor:"transparent",border:"none",outline:"none",resize:"none",lineHeight:"1.5",color:e.palette.text.primary,scrollbarColor:e.palette.mode==="dark"?"rgba(255, 255, 255, 0.6) transparent":"rgba(0, 0, 0, 0.6) transparent"})),tw=(0,qn.forwardRef)(({minHeight:e,maxHeight:t,style:o,...r},n)=>{let i=(0,qn.useRef)(null),[a,s]=(0,qn.useState)(null);(0,qn.useEffect)(()=>{if(i.current){let p=window.getComputedStyle(i.current),u=parseInt(p.lineHeight,10)||parseInt(p.height,10),m=parseInt(p.paddingTop,10),d=parseInt(p.paddingBottom,10);s({lineHeight:u,paddingY:m+d})}},[]);let{minRows:l,maxRows:c}=(0,qn.useMemo)(()=>{if(!a||!e)return{minRows:void 0,maxRows:void 0};let{lineHeight:p,paddingY:u}=a,m=Math.max(Math.ceil((e-u)/p),1),d=t?Math.max(Math.ceil((t-u)/p),m):void 0;return{minRows:m,maxRows:d}},[a,e,t]);return qn.default.createElement(BH,{ref:p=>{typeof n=="function"?n(p):n&&(n.current=p),i.current=p},minRows:l,maxRows:c,style:o,...r})});tw.displayName="MaxAITextareaAutosize";var ow=tw;var Tn=v(A()),FH=e=>{let{t}=k(),o=Tn.default.useRef(null),[r,n]=(0,Tn.useState)(""),{show:i,BackdropTransparent:a,onClose:s,onConfirm:l,onBack:c}=e,p=f=>{n(""),s(f)};(0,Tn.useEffect)(()=>{i&&(setTimeout(()=>{o.current?.focus()},0),setTimeout(()=>{o.current?.focus()},100))},[i]);let u=(0,Tn.useCallback)(f=>{n(f.target.value)},[]),m=(0,Tn.useCallback)(()=>{l?.(r),p()},[l,r,p]),d=(0,Tn.useCallback)(f=>{f.key!=="Escape"&&f.stopPropagation()},[]);return Tn.default.createElement(Gi,{confirmBtnTextId:"maxai--project--paste-text-modal--confirm-button",show:i,BackdropTransparent:a,onClose:p,title:t("package__features:home_view__chat_with_any_content__chat__chat_document_selector__paste_text__title"),confirmBtnDisabled:r.trim()==="",onConfirm:m,onBack:c},Tn.default.createElement(g,{sx:{borderTop:"1px solid",borderBottom:"1px solid",borderColor:"border.main"}},Tn.default.createElement(ow,{ref:o,value:r,onChange:u,onKeyDown:d,placeholder:t("package__features:home_view__chat_with_any_content__chat__chat_document_selector__paste_text__placeholder"),minHeight:269,maxHeight:511})))},rw=FH;var nw=v(mx());var T1=v(A()),DH=e=>{let{errorText:t,showIcon:o,icon:r,iconSize:n,sx:i}=e;return T1.default.createElement(F,{sx:{display:"inline-flex",alignItems:"center",gap:"4px",fontSize:"12px",textAlign:"left",fontWeight:400,color:"error.main",...i}},o&&r?r:T1.default.createElement(nw.default,{sx:{color:"inherit",fontSize:n||16}}),T1.default.createElement(T,{color:"inherit",fontSize:"inherit",fontWeight:"inherit"},t))},iw=DH;var Io=v(A()),HH={INVALID_URL:"package__features:home_view__chat_with_any_content__chat__chat_document_selector__paste_url__error__invalid_url",EXISTS_URL:"package__features:home_view__chat_with_any_content__chat__chat_document_selector__paste_url__error__exists_url",TOO_MUCH_URL:"package__features:home_view__chat_with_any_content__chat__chat_document_selector__paste_url__error__too_much_url"},aw=()=>({INVALID_URL:!1,EXISTS_URL:!1,TOO_MUCH_URL:!1}),NH=e=>{let{t}=k(),{show:o,BackdropTransparent:r,onClose:n,onChange:i,onBack:a}=e,[s,l]=(0,Io.useState)(""),[c,p]=(0,Io.useState)(aw),{chatDocuments:u}=ki(),[m,d]=(0,Io.useState)([]),f=(0,Io.useRef)(null),h=(0,Io.useRef)(!1),C=(0,Io.useMemo)(()=>{let b=Object.keys(c).find(S=>c[S]);return b?t(HH[b]):""},[c,t]),x=(0,Io.useMemo)(()=>m.length===0||C!=="",[m,C]),_=b=>{let S=u.map(E=>E.link).concat(m.map(E=>E.link)),I=b.map(E=>E.startsWith("http")?E:`https://${E}`).filter(E=>!S.includes(E));if(I.length===0){p(E=>({...E,EXISTS_URL:!0}));return}p(E=>({...E,EXISTS_URL:!1}));let w=I.map(E=>({id:rr(),status:"idle",title:E,link:E,maxAIDocumentType:"page_content__webpage"}));d(E=>E.concat(w))};return(0,Io.useEffect)(()=>{o&&(setTimeout(()=>{f.current?.focus()},0),setTimeout(()=>{f.current?.focus()},100))},[o]),(0,Io.useEffect)(()=>{m.length>E2?p(b=>({...b,TOO_MUCH_URL:!0})):p(b=>({...b,TOO_MUCH_URL:!1}))},[m]),Io.default.createElement(Gi,{confirmBtnTextId:"maxai--project--paste-url-modal--confirm-button",show:o,BackdropTransparent:r,onClose:b=>{l(""),d([]),n(b),p(aw)},title:t("package__features:home_view__chat_with_any_content__chat__chat_document_selector__paste_url__modal__title"),confirmBtnText:t("package__features:home_view__chat_with_any_content__chat__chat_document_selector__modal__done__title"),cancelBtnText:t("package__features:home_view__chat_with_any_content__chat__chat_document_selector__modal__cancel__title"),confirmBtnDisabled:x,onConfirm:()=>(i?.(m.map(b=>b.link)),!0),onBack:a},Io.default.createElement(g,{sx:{padding:"24px",gap:"8px",maxHeight:"264px",boxSizing:"border-box",borderTop:"1px solid",borderBottom:"1px solid",borderColor:"border.main"}},m.length>0&&Io.default.createElement(g,{direction:"row",gap:"8px",flexWrap:"wrap"},m.map(b=>Io.default.createElement(Oc,{showClose:!0,key:b.id,onClose:()=>{d(S=>S.filter(I=>I.id!==b.id))},chatDocument:b}))),Io.default.createElement(F,{component:"textarea",ref:f,value:s,onCompositionStart:b=>{h.current=!0},onCompositionEnd:b=>{h.current=!1,l(b.currentTarget.value)},onKeyDown:b=>{if(b.key!=="Escape"&&b.stopPropagation(),b.key==="Enter"||b.code==="Space"){if(h.current)return;let S=s.trim();bs(S)&&(_([S]),p(I=>({...I,INVALID_URL:!1})),l(""),b.preventDefault())}},onChange:b=>{l(b.target.value)},onPaste:b=>{let w=b.clipboardData.getData("text").trim().split(`
`).filter(E=>bs(E));w.length>0?(_(w),p(E=>({...E,INVALID_URL:!1}))):p(E=>({...E,INVALID_URL:!0})),l(""),b.preventDefault()},placeholder:t("package__features:home_view__chat_with_any_content__chat__chat_document_selector__paste_url__placeholder"),sx:{fontFamily:b=>b.typography.fontFamily,display:"block",width:"100%",height:"232px",padding:"0",fontSize:"16px",boxSizing:"border-box",border:"none",outline:"none",backgroundColor:"transparent",resize:"none",color:"text.primary",lineHeight:"1.5",scrollbarColor:b=>b.palette.mode==="dark"?"rgba(255, 255, 255, 0.6) transparent":"rgba(0, 0, 0, 0.6) transparent"}})),C&&Io.default.createElement(g,{sx:{gap:"4px",padding:"16px"}},Io.default.createElement(iw,{errorText:C})))},sw=NH;var Cx=v(A()),zH=e=>{let{chatDocuments:t}=ki(),o=(0,Cx.useMemo)(()=>{let r=De(X9);return fl(t,["createdAt"],["asc"]).forEach(i=>{if(i.hidden)return;let a={title:i.title,tooltip:i.title,addContextType:"document",link:i.link,chatDocumentId:i.id};a.link===window.location.href?r.unshift(a):r.push(a)}),r},[t]);return(0,Cx.useMemo)(()=>{if(!e)return{showTitle:!0,chatDocumentsMenuList:o,filteredMenuList:v1,matchCount:v1.length};let r=v1.filter(i=>i.title.toLowerCase().includes(e.toLowerCase()));if(r.length)return{showTitle:!1,chatDocumentsMenuList:[],filteredMenuList:r,matchCount:r.length};let n=o.filter(i=>i.title.toLowerCase().includes(e.toLowerCase()));return{showTitle:!1,chatDocumentsMenuList:[],filteredMenuList:n,matchCount:n.length}},[e,o])},lw=zH;var uw=v(va());var Se=v(A());var oo=v(A()),cw=v(On());var VH=[{value:"prompt",testId:"input--big-text-paste-selector--prompt",labelI18nKey:"package__features:chat__big_text_paste__options__prompt"},{value:"source",testId:"input--big-text-paste-selector--source",labelI18nKey:"package__features:chat__big_text_paste__options__source"}],RH=(0,oo.forwardRef)((e,t)=>{let{t:o}=k(),[r,n]=(0,oo.useState)(!1),[i,a]=(0,oo.useState)(""),s=(0,oo.useRef)(),l=(0,oo.useCallback)(()=>{n(!1),s.current?.resolve(!1)},[]),c=(0,oo.useCallback)(u=>{n(!1),s.current?.resolve(u)},[]),p=(0,oo.useCallback)(async u=>(n(!0),a(u),new Promise((m,d)=>{s.current={resolve:m,reject:d}})),[]);return(0,oo.useImperativeHandle)(t,()=>({confirmSelect:p})),oo.default.createElement(Ii,{open:r,onClose:l,sx:{position:"absolute"},slotProps:{backdrop:{sx:{position:"absolute"}}}},oo.default.createElement(F,{sx:{outline:"none",position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",minWidth:"min(448px, calc(100% - 32px))",maxWidth:"min(calc(1168px - 32px), calc(100% - 32px))",maxHeight:"calc(100% - 32px)",overflow:"auto",backgroundColor:"background.paper",boxSizing:"border-box",borderRadius:"16px",width:"448px",padding:"24px"}},oo.default.createElement(g,{sx:{flexDirection:"row",justifyContent:"center",alignItems:"center",position:"relative",height:"24px"}},oo.default.createElement(i2,{sx:{color:"text.primary"}}),oo.default.createElement(Xe,{sx:{position:"absolute",right:0,top:0,width:"24px",height:"24px"},onClick:l},oo.default.createElement(cw.default,{sx:{color:"text.secondary"}}))),i&&oo.default.createElement(F,{sx:{boxSizing:"border-box",padding:"12px",border:u=>`1px solid ${u.palette.border.main}`,borderRadius:"8px",marginTop:"16px"}},oo.default.createElement(T,{sx:{width:"100%",overflow:"hidden",textOverflow:"ellipsis",display:"-webkit-box",WebkitLineClamp:3,WebkitBoxOrient:"vertical",fontWeight:400,fontSize:"16px",lineHeight:"150%",color:"text.tertiary"}},i)),oo.default.createElement(g,{sx:{gap:1,marginTop:"24px"}},VH.map(u=>oo.default.createElement(Ce,{variant:"contained",onClick:()=>c(u.value),"data-testid":u.testId,sx:{padding:"10px 16px",lineHeight:"20px"}},o(u.labelI18nKey))))))}),pw=RH;var UH=e=>{let{t}=k(),{hideFileList:o=!1}=e,r=Se.default.useRef(null),n=(0,Se.useRef)(null),{createNewPrompt:i}=Bi(),{setTemplate:a}=Va(),[s,l]=(0,Se.useState)(!1),[c,p]=(0,Se.useState)(!1),[u,m]=(0,Se.useState)(!1),[d,f]=(0,Se.useState)(0),[h,C]=(0,Se.useState)(""),x=be(re=>re.conversationType),{chatHubLoading:_}=yt(),{isWaitingSelectFile:y,setIsWaitingSelectFile:b,chatDocuments:S,toggleSelectedChatDocument:I,handleUploadFilesToChatDocuments:w,handleUploadLinksToChatDocuments:E,toggleMaxAISearchFeature:O}=Al(),L=(0,Se.useMemo)(()=>S.map(re=>re.link),[S]),G=(0,Se.useRef)(L);(0,Se.useEffect)(()=>{G.current=L},[L]);let{isUnavailableUploadSource:H,changeMyOwnToolsType:V}=pn(),W=(0,Se.useMemo)(()=>_||H,[H,_]),{showTitle:N,chatDocumentsMenuList:Z,filteredMenuList:J,matchCount:K}=lw(h),Q=(0,Se.useCallback)(re=>{let ce=re.key==="ArrowUp",ut=re.key==="ArrowDown",Te=0,Ie=K-1;return K&&(ce||ut)?(re.preventDefault(),re.stopPropagation(),f(Pe=>ce?Pe-1<0?Ie:Pe-1:Pe+1>Ie?Te:Pe+1),!0):!1},[K]),M=(0,Se.useRef)(Q);(0,Se.useEffect)(()=>{M.current=Q},[K]);let le=(0,Se.useRef)(s);(0,Se.useEffect)(()=>{f(0),le.current=s},[J,s]),(0,Se.useEffect)(()=>{let re=Qt(x).ref;if(re&&!1){let Ie=qe=>{if(qe.key==="@"){l(!0);return}if(qe.key==="Escape"){l(!1);return}le.current&&M.current(qe)},Pe=qe=>{let $e=qe.key==="ArrowUp",Nt=qe.key==="ArrowDown";if(($e||Nt)&&le.current&&K>0)return;let Re=re.selectionStart,mt=re.value;if(Re){let B=mt.slice(0,Re),R=[],q=B.indexOf("@");for(;q!==-1;)R.push(q),q=B.indexOf("@",q+1);let ne=R.reverse().find(te=>te<Re);if(ne!==void 0){let te=B.slice(ne+1);l(!0),C(te);return}}C(""),l(!1)};return re.addEventListener("keydown",Ie,{capture:!0}),re.addEventListener("keyup",Pe,{capture:!0}),()=>{re.removeEventListener("keydown",Ie,{capture:!0}),re.removeEventListener("keyup",Pe,{capture:!0})}}let ut=async Ie=>{if(W)return;let Pe=Ie.clipboardData?.getData("text").trim();if(Pe){if(Pe.length>=8e3){if(Ie.preventDefault(),Ie.stopPropagation(),!await nt({emitEvent:!0}))return;let qe=Qt(x);switch(await n.current?.confirmSelect(Pe)){case"prompt":{V("MY_OWN_TOOLS"),i(),a(qe.getInputValue()+Pe);return}break;case"source":{Ie.preventDefault(),Ie.stopPropagation();let $e=new File([Pe],t("package__features:home_view__chat_with_any_content__chat__chat_document_selector__chip__pasted__title",{fileName:"text.txt"}),{type:"text/plain"});await w([$e]);return}default:break}}if(bs(Pe,!0)&&!G.current.includes(Pe)){Ie.preventDefault(),Ie.stopPropagation(),await E([Pe]);return}}},Te=Ie=>{Ie===""&&b(!1)};return Qt(x).addListener("onPaste",ut),Qt(x).subscribe(Te),()=>{Qt(x).removeListener("onPaste",ut),Qt(x).unsubscribe(Te)}},[x,W]);let ge=()=>{if(W)return;b(!1),l(!s);let re=Qt(x).ref;re&&re.focus()},P=async()=>{let re=await y2({accept:A2});re.length>0&&(await w(re),l(!1))},$=async()=>{p(!0)},j=async()=>{m(!0)},de=async re=>{if(await nt({emitEvent:!0}))switch(re){case"file":await P();break;case"text":await $();break;case"url":await j();break}};return Se.default.createElement(F,{sx:{position:"relative"}},Se.default.createElement(g,{direction:"row",alignItems:"center",gap:"8px",flexWrap:"wrap"},Se.default.createElement(ve,{placement:"top",title:H?t("package__features:home_view__chat_with_any_content__chat__chat_document_selector__button__unavailable__tooltip"):void 0,disableInteractive:!0},Se.default.createElement(g,null,Se.default.createElement(fe,{disabled:W,key:y.toString(),"data-testid":"maxai--chat-document-selector--button",title:t("package__features:home_view__chat_with_any_content__chat__chat_document_selector__button_title"),onClick:ge,buttonRefBind:re=>{r.current=re},actived:y,sx:{color:re=>re.palette.mode==="dark"?"#ffffff":"rgba(0, 0, 0, 0.87)"},tooltipProps:y?{disableInteractive:!1,open:!0,placement:"top"}:{disableInteractive:!0}},Se.default.createElement(uw.default,null,Se.default.createElement("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},Se.default.createElement("path",{d:"M13.1002 3.8002C13.1002 3.19268 12.6077 2.7002 12.0002 2.7002C11.3927 2.7002 10.9002 3.19268 10.9002 3.8002V10.9002H3.8002C3.19268 10.9002 2.7002 11.3927 2.7002 12.0002C2.7002 12.6077 3.19268 13.1002 3.8002 13.1002H10.9002V20.2002C10.9002 20.8077 11.3927 21.3002 12.0002 21.3002C12.6077 21.3002 13.1002 20.8077 13.1002 20.2002V13.1002H20.2002C20.8077 13.1002 21.3002 12.6077 21.3002 12.0002C21.3002 11.3927 20.8077 10.9002 20.2002 10.9002H13.1002V3.8002Z",fill:"currentColor"})))))),!o&&Se.default.createElement(Z9,{disabled:W,onAddContextClick:ge})),Se.default.createElement(Ml,{placement:"bottom-start",fallbackPlacements:["top-start"],disableScrollLock:!0,onClose:()=>{l(!1)},open:s&&K>0,anchorEl:r.current,PaperProps:{sx:{border:"none"}}},Se.default.createElement(g,{"data-testid":"maxai--chat-document-selector--card",sx:{borderRadius:1,maxWidth:"360px",minWidth:"240px",width:"fit-content",maxHeight:"264px",boxSizing:"border-box",border:"1px solid",borderColor:"border.main",py:"4px",bgcolor:re=>re.palette.mode==="dark"?"rgba(61, 61, 61, 1)":"#fff",alignItems:"center",justifyContent:"center","& > div":{boxSizing:"border-box",width:"100%"}}},Se.default.createElement(g,{sx:{flexShrink:0}},N&&Se.default.createElement(T,{px:"8px",textAlign:"left",fontSize:"12px",lineHeight:"32px",height:"32px",color:"text.secondary",flexShrink:0,noWrap:!0},t("package__features:home_view__chat_with_any_content__chat__chat_document_selector__add_sources__title")),Se.default.createElement(g,{direction:"row",alignItems:"center",px:1},Se.default.createElement(fe,{sx:{height:"36px"},onClick:()=>de("url")},Se.default.createElement(ea,{icon:"URLs"}),Se.default.createElement("span",null,t("package__features:home_view__chat_with_any_content__chat__chat_document_selector__add_sources__url__title"))),Se.default.createElement(fe,{sx:{height:"36px"},onClick:()=>de("text")},Se.default.createElement(ea,{icon:"Text"}),Se.default.createElement("span",null,t("package__features:home_view__chat_with_any_content__chat__chat_document_selector__add_sources__text__title"))),Se.default.createElement(fe,{sx:{height:"36px"},onClick:()=>de("file")},Se.default.createElement(ea,{icon:"File"}),Se.default.createElement("span",null,t("package__features:home_view__chat_with_any_content__chat__chat_document_selector__add_sources__file__title"))))),Se.default.createElement(wt,{sx:{my:"4px",width:"100%",flexShrink:0}}),Z.length>0&&Se.default.createElement(g,{width:"100%",sx:{flex:1,height:0}},Se.default.createElement(T,{sx:{flexShrink:0},textAlign:"left",fontSize:"12px",lineHeight:"32px",height:"32px",color:"text.secondary",flexShrink:0,noWrap:!0,px:"8px"},t("package__features:home_view__chat_with_any_content__chat__chat_document_selector__choose_sources__title")),Se.default.createElement(Y9,{onSelect:re=>{if(re.addContextType==="search"){O();return}re.chatDocumentId&&I(re.chatDocumentId)},dataList:Z})))),Se.default.createElement(rw,{show:c,onClose:()=>{p(!1)},onConfirm:async re=>{let ce=new File([re],t("package__features:home_view__chat_with_any_content__chat__chat_document_selector__chip__pasted__title",{fileName:"text.txt"}),{type:"text/plain"});await w([ce])}}),Se.default.createElement(sw,{show:u,onClose:()=>{m(!1)},onChange:async re=>{await E(re)}}),Se.default.createElement(pw,{ref:n}))},mw=UH;var ao=v(A()),WH=e=>{let{renderHeaderNode:t,renderFooterLeftNode:o,renderFooterRightNode:r,renderFooterNode:n,...i}=e,{conversationType:a}=ue(),s={screenshotButton:a==="Chat"&&ao.default.createElement(B9,null),uploadFileButton:a==="Chat"&&ao.default.createElement(D9,null),betaFeaturesButton:a==="Chat"&&ao.default.createElement(v9,null),upgradePlanButton:ao.default.createElement(F9,null),feedbackButton:ao.default.createElement(E9,null),myOwnToolsButton:ao.default.createElement(A9,null)},l={searchProToggle:a==="Search"&&ao.default.createElement(x9,null),artProToggle:null},c={documentSelector:ao.default.createElement(mw,null),uploadFileList:ao.default.createElement(K9,null)},p={autoSuggestion:ao.default.createElement(Af,null)},u=o?o(s):ao.default.createElement(ao.default.Fragment,null,s.screenshotButton,s.uploadFileButton,s.betaFeaturesButton,s.upgradePlanButton),m=r?r(l):ao.default.createElement(ao.default.Fragment,null,l.searchProToggle,l.artProToggle),d=t?t(c):ao.default.createElement(ao.default.Fragment,null,c.documentSelector,c.uploadFileList),f=n?n(p):ao.default.createElement(ao.default.Fragment,null,p.autoSuggestion),[h,C]=(0,ao.useState)(!1);return ao.default.createElement(H9,{minLine:3,headerNode:ao.default.createElement(g,{sx:{p:"10px 10px 0 10px",...d?{mb:"-2px"}:{},"&:empty":{p:0}}},d),footerLeftNode:u,footerRightNode:m,footerNode:f,...i,sx:{boxShadow:x=>h?x.palette.mode==="dark"?"0px 0px 0px 1px rgba(255, 255, 255, 0.12)":"0px 0px 0px 1px rgba(0, 0, 0, 0.12)":void 0,...i.sx},textareaProps:{onFocus:()=>C(!0),onBlur:()=>C(!1),...i.textareaProps}})},dw=WH;var $s=v(A());var Cw=v(fw()),yw=v(hw()),bw=v(gw()),Sw=v(xw()),Iw=v(_w());var on=v(A()),iN=(e,t=24)=>{try{let[o,r]=e.split(":").map(Number),n=!1;r>o&&(e=`${r}:${o}`,n=!0);let i={"1:1":on.default.createElement(Iw.default,{sx:{fontSize:t,transform:n?"rotate(90deg)":"none"}}),"3:2":on.default.createElement(Cw.default,{sx:{fontSize:t,transform:n?"rotate(90deg)":"none"}}),"5:4":on.default.createElement(yw.default,{sx:{fontSize:t,transform:n?"rotate(90deg)":"none"}}),"7:5":on.default.createElement(bw.default,{sx:{fontSize:t,transform:n?"rotate(90deg)":"none"}}),"16:9":on.default.createElement(Sw.default,{sx:{fontSize:t,transform:n?"rotate(90deg)":"none"}})};return i[e]||i["1:1"]}catch{return null}},aN=()=>{let{t:e}=k(),{localSettings:t,setLocalSettings:o}=lt(),r=t.thirdProviderSettings?.MAXAI_DALLE,[n,i]=(0,on.useState)(!1),a=ul.aspectRatios.map(s=>({label:s.label(e),value:s.value,origin:s}))||[];return on.default.createElement(ka,{"data-testid":"maxai-chat--advanced--settings--art--aspect-ratio"},on.default.createElement(La,{sx:{fontSize:16,color:"text.primary"}},e("package__features:art__text_to_image__advanced__aspect_ratio__title")),on.default.createElement(Ba,{sx:{fontSize:"16px",[`& .${Oa.icon}`]:{fontSize:24}},MenuProps:{elevation:1,anchorOrigin:{vertical:"top",horizontal:"left"},transformOrigin:{vertical:"bottom",horizontal:"left"}},size:"small",open:n,onClose:()=>i(!1),onOpen:()=>i(!0),label:e("package__features:art__text_to_image__advanced__aspect_ratio__title"),value:r?.aspectRatio||"1:1",onChange:async(s,l)=>{let c=a.find(p=>p.value===s.target.value);c&&o({thirdProviderSettings:{MAXAI_DALLE:{generateCount:r?.generateCount||1,contentType:r?.contentType||"image",aspectRatio:c.value,resolution:c.origin.resolution||[1024,1024]}}})}},a.map((s,l)=>on.default.createElement(Ct,{key:l,"data-value":s.value,value:s.value},on.default.createElement(g,{direction:"row",alignItems:"center",spacing:1},iN(s.value),on.default.createElement(T,{component:"span",fontSize:14,color:"text.primary",textAlign:"left",noWrap:!0},s.label,` (${s.value})`))))))},vw=aN;var ji=v(A()),sN=()=>{let{t:e}=k(),{localSettings:t,setLocalSettings:o}=lt(),r=t.thirdProviderSettings?.MAXAI_DALLE,[n,i]=(0,ji.useState)(!1),a=ul.contentTypes.map(s=>({label:s.label(e),value:s.value,origin:s}))||[];return ji.default.createElement(ka,{"data-testid":"maxai-chat--advanced--settings--art--content-type"},ji.default.createElement(La,{sx:{fontSize:16,color:"text.primary"}},e("package__features:art__text_to_image__advanced__content_type__title")),ji.default.createElement(Ba,{sx:{fontSize:"16px",[`& .${Oa.icon}`]:{fontSize:24}},MenuProps:{elevation:1,anchorOrigin:{vertical:"top",horizontal:"left"},transformOrigin:{vertical:"bottom",horizontal:"left"}},size:"small",open:n,onClose:()=>i(!1),onOpen:()=>i(!0),label:e("package__features:art__text_to_image__advanced__content_type__title"),value:r?.contentType||"vivid",onChange:(s,l)=>{l.props.disabled||o({thirdProviderSettings:{MAXAI_DALLE:{generateCount:r?.generateCount||1,aspectRatio:r?.aspectRatio||"1:1",resolution:r?.resolution||[1024,1024],contentType:s.target.value}}})}},a.map((s,l)=>ji.default.createElement(Ct,{key:l,"data-value":s.value,value:s.value},ji.default.createElement(g,{direction:"row",alignItems:"center",spacing:1},s.origin?.exampleImage?ji.default.createElement("img",{width:24,height:24,alt:`${s.value} example`,src:s.origin?.exampleImage}):null,ji.default.createElement(T,{component:"span",fontSize:14,color:"text.primary",textAlign:"left",noWrap:!0},s.label))))))},ww=sN;var lN=()=>{let{t:e}=k();return $s.default.createElement(g,{spacing:1},$s.default.createElement(g,{direction:"row",mb:1},$s.default.createElement(T,{fontSize:"16px",fontWeight:600,color:"text.primary"},e("package__features:chat__art__text_to_image__advanced__title"))),$s.default.createElement(g,{spacing:2},$s.default.createElement(vw,null),$s.default.createElement(ww,null)))},Tw=lN;var Xs=v(A());var ms=v(A()),cN=[{value:"sogou",label:"Sogou Search"},{value:"brave",label:"Brave Search"},{value:"yandex",label:"Yandex Search"},{value:"naver",label:"Naver Search"},{value:"bing",label:"Bing Search"},{value:"yahoo",label:"Yahoo Search"},{value:"baidu",label:"Baidu Search"},{value:"google",label:"Google Search"}],pN=e=>{let{t}=k(),{localSettings:o,setLocalSettings:r}=lt(),[n,i]=(0,ms.useState)(!1);return ms.default.createElement(ka,null,ms.default.createElement(La,{sx:{fontSize:16,color:"text.primary"}},t("package__features:chat__app__search_advanced__search_engine__title")),ms.default.createElement(Ba,{sx:{fontSize:"16px",[`& .${Oa.icon}`]:{fontSize:24}},MenuProps:{elevation:1,anchorOrigin:{vertical:"top",horizontal:"left"},transformOrigin:{vertical:"bottom",horizontal:"left"}},"data-testid":"chat-search--engine-selector",size:"small",open:n,onClose:()=>i(!1),onOpen:()=>i(!0),label:t("package__features:chat__app__search_advanced__search_engine__title"),value:o.sidebarSettings?.search?.searchEngine||"google",onChange:(a,s)=>{s.props.disabled||r({sidebarSettings:{search:{searchEngine:a.target.value}}})},...e},cN.map((a,s)=>ms.default.createElement(Ct,{key:s,"data-value":a.value,value:a.value},ms.default.createElement(T,{component:"span",fontSize:14,color:"text.primary",textAlign:"left",noWrap:!0},a.label)))))},Mw=pN;var ds=v(A()),uN=Array.from({length:10},(e,t)=>t+1).map(e=>({value:e,label:`${e} result${e===1?"":"s"}`})),mN=()=>{let{t:e}=k(),{localSettings:t,setLocalSettings:o}=lt(),[r,n]=(0,ds.useState)(!1);return ds.default.createElement(ka,null,ds.default.createElement(La,{sx:{fontSize:16,color:"text.primary"}},e("package__features:chat__app__search_advanced__search_results__title")),ds.default.createElement(Ba,{sx:{fontSize:"16px",[`& .${Oa.icon}`]:{fontSize:24}},MenuProps:{elevation:1,anchorOrigin:{vertical:"top",horizontal:"left"},transformOrigin:{vertical:"bottom",horizontal:"left"}},"data-testid":"chat-search--results-count-selector",size:"small",open:r,onClose:()=>n(!1),onOpen:()=>n(!0),label:e("package__features:chat__app__search_advanced__search_results__title"),value:t.sidebarSettings?.search?.maxResultsCount||6,onChange:(i,a)=>{a.props.disabled||o({sidebarSettings:{search:{maxResultsCount:lm(i.target.value)?i.target.value:6}}})}},uN.map((i,a)=>ds.default.createElement(Ct,{key:a,"data-value":i.value,value:i.value},ds.default.createElement(T,{component:"span",fontSize:14,color:"text.primary",textAlign:"left",noWrap:!0},i.label)))))},Ew=mN;var dN=()=>{let{t:e}=k();return Xs.default.createElement(g,{spacing:1},Xs.default.createElement(g,{direction:"row",mb:1},Xs.default.createElement(T,{fontSize:"16px",fontWeight:600,color:"text.primary"},e("package__features:chat__app__search_advanced__title"))),Xs.default.createElement(g,{spacing:2},Xs.default.createElement(Mw,null),Xs.default.createElement(Ew,null)))},Aw=dN;var cr=v(A()),fN=e=>{let{conversationType:t,conversationId:o}=ue(),{conversationType:r=t,children:n,...i}=e,{t:a}=k(),s=ye(o),[l,c]=(0,cr.useState)(null),p=f=>{c(f.currentTarget)},u=()=>{c(null)},m=!!l,d=(0,cr.useRef)(null);return["Search","Art"].includes(r)?cr.default.createElement(cr.default.Fragment,null,cr.default.createElement(Ts,{title:a("package__features:chat__inputbox__button__advanced_options__tooltip"),id:"MaxAIAIAdvanced","data-button-clicked-name":"maxai-advanced-button","aria-owns":m?"mouse-over-popover":void 0,"aria-haspopup":"true",disabled:s,onClick:p,...i,sx:{position:"relative",...i.sx},testid:`maxai-chat--advanced--settings-button--${r.toLowerCase()}`},cr.default.createElement(X,{icon:"Tune",sx:{color:"text.primary",fontSize:"20px"}})),cr.default.createElement(em,{open:m,anchorEl:l,id:"mouse-over-popover",elevation:2,anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"bottom",horizontal:"right"},onClose:u,disableScrollLock:!0},cr.default.createElement(F,{ref:d,sx:{borderRadius:1,border:"1px solid #EBEBEB",boxShadow:"0px 4px 8px 0px rgba(0, 0, 0, 0.16)",width:402,display:"flex",alignItems:"stretch",justifyContent:"center",flexDirection:"row"}},cr.default.createElement(g,{spacing:1,p:1,width:"100%"},r==="Search"&&cr.default.createElement(Aw,null),r==="Art"&&cr.default.createElement(Tw,null),n,cr.default.createElement(g,{sx:{minHeight:"28px"},width:"100%",spacing:1,alignItems:"center",direction:"row",justifyContent:"end",flexDirection:"row"},cr.default.createElement(Xe,{onClick:f=>{f.stopPropagation(),u()}},cr.default.createElement(X,{icon:"Close",sx:{fontSize:"24px"}}))))))):null},Pw=fN;var Kn=v(A()),hN=e=>{let{anchorElementSelectors:t='[data-testid="maxai-chat-history-button"]',placement:o="left-end",...r}=e,{t:n}=k(),[i,a]=Kn.default.useState(!1),[s,l]=Kn.default.useState(!0),c=be(d=>d.conversationIds),p=xr(c[0]),u=ye(c[0]),m=(0,Kn.useCallback)(async()=>{let d=await Ze.getOnboardingDataByKey(Op),f=await nr.cachedChatConversationService.getCacheConversationsByType("Chat");d&&p.length<=0&&u===!1&&f.length>0&&setTimeout(()=>{a(!0)},1e3)},[p,u]);return(0,Kn.useEffect)(()=>{Ze.getOnboardingDataByKey(Rg).then(d=>l(!!d))},[]),(0,Kn.useEffect)(()=>{s||m()},[s,m]),s?null:Kn.default.createElement(Et,{placement:o,trigger:i,anchorElementSelectors:t,keepPollingCheckAnchorEl:!0,onShow:()=>{Ze.setOnboardingData(Rg,!0)},CtaButtonProps:{"data-button-clicked-name":"Onboarding > Chat history > Got it"},...r},Kn.default.createElement(g,{spacing:.5},Kn.default.createElement(T,{fontSize:20,lineHeight:1.4,color:"text.primary",fontWeight:700,textAlign:"left"},n("package__features:onboarding__onboarding_popover__chat_history__title")),Kn.default.createElement(T,{fontSize:14,lineHeight:1.4,color:"text.primary",fontWeight:400,textAlign:"left"},n("package__features:onboarding__onboarding_popover__chat_history__description"))))},kw=hN;var $t=v(A());var O1=v(A());var Nc=v(A());var Kt=v(A());var yx=v(A()),gN=e=>{let{open:t,displaysText:o,onDelete:r,...n}=e,{t:i}=k(),a=i("package__features:chat__conversation_item__delete_chat__dialog__title");return yx.default.createElement(Gi,{show:t,onClose:s=>{n.onClose?.({},s)},title:a,onConfirm:()=>r?.(),confirmBtnText:i("package__common:delete"),wrapSx:{width:"448px"},confirmBtnSx:{backgroundColor:"rgba(237, 80, 80, 1)",color:"rgba(255, 255, 255, 1)","&:hover":{backgroundColor:"rgba(237, 99, 99, 1)",color:"rgba(255, 255, 255, 1)"}}},yx.default.createElement(T,{fontSize:"16px",color:"text.primary",px:"24px"},i("package__features:chat__conversation_item__delete_chat__description")))},L1=gN;var ho=v(A()),xN=e=>{let{conversation:t,displaysText:o,disabled:r,onClose:n,onClickRename:i,onClickDelete:a,sx:s}=e,{deleteConversation:l}=ct(),{t:c}=k(),[p,u]=(0,ho.useState)(null),m=!!p,[d,f]=(0,ho.useState)(!1),h=x=>{x.preventDefault(),x.stopPropagation(),u(null),n?.()},C=async()=>{a?a():await l(t.id)&&f(!1)};return ho.default.createElement(ho.default.Fragment,null,ho.default.createElement(ve,{placement:"top",title:c("package__common:more")},ho.default.createElement(F,{sx:s},ho.default.createElement(Xe,{disabled:r,onClick:x=>{x.preventDefault(),x.stopPropagation(),u(x.currentTarget)},sx:{p:.5},"data-testid":"chat-conversation--more-actions-button"},ho.default.createElement(X,{icon:"More",size:16})))),ho.default.createElement(Ei,{anchorEl:p,id:`${t.id}_MORE_ACTIONS_MENU`,open:m,onClose:h,onClick:h,slotProps:{paper:{elevation:0,sx:{overflow:"visible",filter:"drop-shadow(0px 2px 8px rgba(0,0,0,0.32))",mt:1}}},anchorOrigin:{vertical:"bottom",horizontal:"left"},transformOrigin:{vertical:"top",horizontal:"right"}},ho.default.createElement(Ct,{"data-testid":"chat-conversation--rename-chat-button",onClick:x=>{i?.(),h(x)}},ho.default.createElement(ep,null,ho.default.createElement(X,{icon:"DefaultIcon",size:16})),ho.default.createElement(tp,{sx:{fontSize:"14px",color:"text.primary"}},ho.default.createElement(T,{sx:{fontSize:"14px",color:"text.primary"},component:"span"},c("package__common:rename")))),ho.default.createElement(Ct,{"data-testid":"chat-conversation--delete-chat-button",onClick:x=>{f(!0),h(x)},sx:{color:"#f44336"}},ho.default.createElement(ep,null,ho.default.createElement(X,{icon:"Delete",size:16,sx:{color:"#f44336"}})),ho.default.createElement(tp,{sx:{fontSize:"14px"}},ho.default.createElement(T,{sx:{fontSize:"14px"},component:"span"},c("package__features:chat__conversation_item__delete_chat__button__title"))))),ho.default.createElement(L1,{displaysText:o,open:d,onClose:x=>{x?.stopPropagation?.(),f(!1)},onDelete:()=>C()}))},Lw=xN;var Ys=v(A()),_N=e=>{let{keyword:t,sx:o,children:r}=e,n=(0,Ys.useRef)(null),i=(0,Ys.useMemo)(()=>{if(!t||!r)return[];let a=[],s=new RegExp(t,"gi"),l=0,c=s.exec(r);for(;c!==null;){let m=r.slice(l,c.index);m&&a.push({match:!1,content:m}),a.push({match:!0,content:t}),l=c.index+t.length,c=s.exec(r)}let p=r.slice(l,r.length);p&&a.push({match:!1,content:p});let u=a[0];if(!u.match&&a.length>1&&u.content.length>15){let f=u.content.length-15;a.some(C=>(C!==u&&(f+=C.content.length),f>15))&&(u.content=`...${u.content.slice(-4)}`)}return a},[t,r]);return Ys.default.createElement(T,{ref:n,color:"text.primary",fontSize:"14px",lineHeight:"24px",noWrap:!0,width:0,flex:1,textAlign:"left",sx:o},i.length?i.map(a=>Ys.default.createElement("span",{style:a.match?{background:"rgba(215, 164, 253, 0.4)"}:void 0},a.content)):r)},Ow=_N;var CN=e=>{let{conversation:t,keyword:o,selected:r,onClick:n,sx:i,style:a,icon:s,label:l,order:c}=e,[p,u]=(0,Kt.useState)(!1),{editingNameRef:m,editing:d,setEditing:f,updateConversationName:h}=Mm(),{displaysText:C,displaysTime:x}=Tm({...t,name:m.current||t.name}),_=(0,Kt.useMemo)(()=>{let S=t.meta?.AIProvider||"USE_CHAT_GPT_PLUS",I=t.meta?.AIModel||"";return $o(S,I)?.title||I},[]),y=()=>{if(s)return s;let S=t.last_msg||t.match_message;if(S?.originalMessage?.metadata?.chatMode==="free_chat"||S?.meta?.chatMode==="free_chat")return Kt.default.createElement(Ln,{sx:{fontSize:22}});let I=S?.originalMessage?.metadata?.AIModel||S?.meta?.AIModel;return I?Kt.default.createElement(Or,{size:24,provider:t.meta.AIProvider,model:I}):Kt.default.createElement(Ln,{sx:{fontSize:22}})},b=()=>l||Kt.default.createElement(Kt.default.Fragment,null,Kt.default.createElement(Xu,{sx:{flexShrink:0,width:"unset",fontSize:"12px",padding:"0!important",height:"16px!important","& > span":{padding:"0 6px"}},label:t.type==="ContextMenu"?"Rewrite":t.type,size:"small"}),Kt.default.createElement(T,{noWrap:!0,flex:1,textAlign:"left",width:0,color:"text.secondary",fontSize:"12px",lineHeight:"16px"},_));return Kt.default.createElement(g,{id:`conversation-item-${t.id}`,"data-testid":c?`conversation-item-${c}`:"conversation-item",spacing:1,style:a,sx:i},Kt.default.createElement(g,{direction:"row",alignItems:"center",px:"12px",py:"8px",onMouseOver:()=>{u(!0)},onMouseOut:()=>{u(!1)},onClick:()=>n?.(t),sx:{cursor:"pointer",borderRadius:"6px",userSelect:"none",...r||d?{bgcolor:S=>S.palette.mode==="dark"?"#383838":"#F0F0F0"}:{"&:hover":{bgcolor:S=>S.palette.mode==="dark"?"rgba(255, 255, 255, .1)":"rgba(0, 0, 0, 0.04)"}},"&:hover .conversation-list-row-more-action-button":{opacity:1}},spacing:2},Kt.default.createElement(g,{width:"24px",height:"24px",alignItems:"center",justifyContent:"center"},y()),Kt.default.createElement(g,{width:0,flex:1},Kt.default.createElement(g,{direction:"row",alignItems:"center",justifyContent:"space-between",gap:1},Kt.default.createElement(g,{direction:"row",gap:1,alignItems:"center",flex:1,width:0},b()),Kt.default.createElement(T,{flexShrink:0,color:"text.secondary",fontSize:"12px",lineHeight:"16px"},x)),Kt.default.createElement(g,{position:"relative",direction:"row",alignItems:"center"},d?Kt.default.createElement(Pa,{mouseEvent:"onMouseDown",onClickAway:()=>h(t)},Kt.default.createElement(Ut,{onClick:S=>{S.stopPropagation()},"data-testid":"maxai--conversation--rename-chat--input",size:"small",ref:S=>{S&&setTimeout(()=>{S.querySelector("input")?.focus()},0)},defaultValue:t.name,onChange:S=>{S.stopPropagation(),m.current=S.target.value.trim()},onKeyDownCapture:S=>{S.stopPropagation(),S.key==="Enter"&&h(t)},onPaste:S=>{S.stopPropagation()},sx:{width:"100%",mt:"1.5px",mb:"-5.625px","& input":{p:"2px 2px 2px 4px",fontSize:"14px"}}})):Kt.default.createElement(Ow,{keyword:o},C),Kt.default.createElement(Lw,{conversation:t,displaysText:C,onClose:()=>u(!1),onClickRename:()=>f(!0),sx:r||p?null:{position:"absolute",right:0,opacity:0}})))))},Bw=(0,Kt.memo)(CN,Rm);var Mn=v(A());var Dw=v(A());function yN(e){var t=e.lastRenderedStartIndex,o=e.lastRenderedStopIndex,r=e.startIndex,n=e.stopIndex;return!(r>o||n<t)}function bN(e){for(var t=e.isItemLoaded,o=e.itemCount,r=e.minimumBatchSize,n=e.startIndex,i=e.stopIndex,a=[],s=null,l=null,c=n;c<=i;c++){var p=t(c);p?l!==null&&(a.push(s,l),s=l=null):(l=c,s===null&&(s=c))}if(l!==null){for(var u=Math.min(Math.max(l,s+r-1),o-1),m=l+1;m<=u&&!t(m);m++)l=m;a.push(s,l)}if(a.length)for(;a[1]-a[0]+1<r&&a[0]>0;){var d=a[0]-1;if(!t(d))a[0]=d;else break}return a}var SN=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},IN=function(){function e(t,o){for(var r=0;r<o.length;r++){var n=o[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(t,o,r){return o&&e(t.prototype,o),r&&e(t,r),t}}(),vN=function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)},Fw=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:e},wN=function(e){vN(t,e);function t(){var o,r,n,i;SN(this,t);for(var a=arguments.length,s=Array(a),l=0;l<a;l++)s[l]=arguments[l];return i=(r=(n=Fw(this,(o=t.__proto__||Object.getPrototypeOf(t)).call.apply(o,[this].concat(s))),n),n._lastRenderedStartIndex=-1,n._lastRenderedStopIndex=-1,n._memoizedUnloadedRanges=[],n._onItemsRendered=function(c){var p=c.visibleStartIndex,u=c.visibleStopIndex;n._lastRenderedStartIndex=p,n._lastRenderedStopIndex=u,n._ensureRowsLoaded(p,u)},n._setRef=function(c){n._listRef=c},r),Fw(n,i)}return IN(t,[{key:"resetloadMoreItemsCache",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this._memoizedUnloadedRanges=[],r&&this._ensureRowsLoaded(this._lastRenderedStartIndex,this._lastRenderedStopIndex)}},{key:"componentDidMount",value:function(){}},{key:"render",value:function(){var r=this.props.children;return r({onItemsRendered:this._onItemsRendered,ref:this._setRef})}},{key:"_ensureRowsLoaded",value:function(r,n){var i=this.props,a=i.isItemLoaded,s=i.itemCount,l=i.minimumBatchSize,c=l===void 0?10:l,p=i.threshold,u=p===void 0?15:p,m=bN({isItemLoaded:a,itemCount:s,minimumBatchSize:c,startIndex:Math.max(0,r-u),stopIndex:Math.min(s-1,n+u)});(this._memoizedUnloadedRanges.length!==m.length||this._memoizedUnloadedRanges.some(function(d,f){return m[f]!==d}))&&(this._memoizedUnloadedRanges=m,this._loadUnloadedRanges(m))}},{key:"_loadUnloadedRanges",value:function(r){for(var n=this,i=this.props.loadMoreItems||this.props.loadMoreRows,a=function(c){var p=r[c],u=r[c+1],m=i(p,u);m?.then(function(){if(yN({lastRenderedStartIndex:n._lastRenderedStartIndex,lastRenderedStopIndex:n._lastRenderedStopIndex,startIndex:p,stopIndex:u})){if(n._listRef==null)return;typeof n._listRef.resetAfterIndex=="function"?n._listRef.resetAfterIndex(p,!0):(typeof n._listRef._getItemStyleCache=="function"&&n._listRef._getItemStyleCache(-1),n._listRef.forceUpdate())}})},s=0;s<r.length;s+=2)a(s)}}]),t}(Dw.PureComponent),Hw=wN;var bx=e=>{let{keyword:t,conversations:o,isLoading:r,isNextPageLoading:n,hasNextPage:i,loadNextPage:a,selectedIds:s,itemSize:l=60,onSelectItem:c,onRenderItem:p,emptyNode:u,sx:m}=e,d=i?o.length+1:o.length,f=!r&&!n&&o.length===0,h=(0,Mn.useCallback)(()=>{n||a()},[n,a]),C=_=>!i||_<o.length,x=(0,Mn.useCallback)(_=>{_?c?.(_):h()},[h,c]);return Mn.default.createElement(g,{flex:1,height:0,spacing:1,p:1,boxSizing:"border-box",className:"conversation-list",sx:m},Mn.default.createElement(Br,{loading:r},Mn.default.createElement(Hw,{isItemLoaded:C,itemCount:d,loadMoreItems:h},({onItemsRendered:_,ref:y})=>Mn.default.createElement(tb,null,({height:b,width:S})=>Mn.default.createElement(eb,{height:b,width:S,style:{flex:1},itemData:o,itemSize:l,itemCount:d,onItemsRendered:_,ref:y,className:"maxai--conversation-list",...e},I=>{let w=I.data[I.index];return w&&p?p(w,{conversation:w,keyword:t,selected:s?.includes(w.id),onClick:x,style:I.style,order:I.index+1}):w?Mn.default.createElement(Bw,{conversation:w,keyword:t,selected:s?.includes(w.id),onClick:x,style:I.style,order:I.index+1}):(r||n)&&Mn.default.createElement(g,{style:I.style,width:"100%",alignItems:"center",justifyContent:"center",sx:{my:"16px"}},Mn.default.createElement(Ft,{size:16,sx:{m:"0 auto"}}))})))),f?u:null)},Tve=Mn.default.memo(bx);var TN=e=>{let{conversationIds:t,conversationType:o}=be(_=>({conversationIds:_.conversationIds.slice(0,_.layout),conversationType:_.conversationType})),{switchConversation:r,asyncUpdateConversation:n}=ct(),{conversationType:i=o,selectedIds:a=t,onSelectItem:s,queryOptions:l,onClose:c,onChangeConversations:p,...u}=e,{conversations:m,isLoading:d,isFetchingNextPage:f,fetchNextPage:h,hasNextPage:C}=ey(i,l),x=(0,Nc.useCallback)(async _=>{if(a.includes(_.id)){c?.();return}_.id&&(await nr.getService().addOrUpdateConversation(_.id,_,{syncToRemote:!1,isPartialUpdate:!1,updateUpdatedAt:!0}),_.updated_at=new Date().toISOString(),await r(_.id,_),s?.(_),n(_.id))},[a,s,c]);return(0,Nc.useEffect)(()=>{p&&p(m)},[m,p]),Nc.default.createElement(bx,{conversations:m,keyword:l?.keyword,isLoading:d,isNextPageLoading:f,hasNextPage:C,loadNextPage:h,selectedIds:a,onSelectItem:x,...u})},Nw=TN;var Sx=v(A()),MN=e=>{let{sx:t}=e,{t:o}=k();return Sx.default.createElement(g,{"data-testid":"conversation-empty-view",alignItems:"center",justifyContent:"center",height:"40px",sx:t},Sx.default.createElement(T,{fontSize:14,lineHeight:1.5,textAlign:"center",color:"text.tertiary"},o("package__features:chat__history_view__empty__title")))},zw=MN;var tr=v(A());var En=v(A()),EN=e=>{let{conversation:t,displaysText:o,onClose:r,onClickRename:n,onClickDelete:i,sx:a}=e,{deleteConversation:s}=ct(),{t:l}=k(),[c,p]=(0,En.useState)(null),[u,m]=(0,En.useState)(!1),d=h=>{h.preventDefault(),h.stopPropagation(),p(null),r?.()},f=async()=>{i?i():await s(t.id)&&m(!1)};return En.default.createElement(En.default.Fragment,null,En.default.createElement(fe,{title:l("package__common:more"),placement:"top",tooltipProps:{disableInteractive:!0},onClick:h=>{h.stopPropagation(),p(h.currentTarget)},sx:{...a}},En.default.createElement(X,{icon:"More",size:16})),En.default.createElement(Ei,{anchorEl:c,open:!!c,onClose:d,onClick:d,slotProps:{paper:{elevation:0,sx:{overflow:"unset",background:"transparent"}}}},En.default.createElement(Ol,{offset:{top:0,right:0,bottom:0,left:0},options:[{value:"rename",testid:"chat-conversation--rename-chat-button",icon:En.default.createElement(X,{icon:"DefaultIcon"}),label:l("package__common:rename")},{value:"delete",testid:"chat-conversation--delete-chat-button",icon:En.default.createElement(X,{icon:"Delete",sx:{color:"rgba(255, 14, 39, 1)!important"}}),label:l("package__common:delete"),labelSx:{color:"rgba(255, 14, 39, 1)!important"}}],sx:{width:200},onSelectOption:h=>{h==="rename"?n?.():h==="delete"&&m(!0),p(null)}})),En.default.createElement(L1,{displaysText:o,open:u,onClose:h=>{h?.stopPropagation?.(),m(!1)},onDelete:()=>f()}))},Vw=EN;var AN=e=>{let{conversation:t,selected:o,onClick:r,sx:n,style:i,order:a}=e,[s,l]=(0,tr.useState)(!1),{editingNameRef:c,editing:p,setEditing:u,updateConversationName:m}=Mm(),{displaysText:d,displaysTime:f}=Tm({...t,name:c.current||t.name}),h=()=>{let C=t.last_msg||t.match_message;if((C?.meta?.chatMode||C?.originalMessage?.metadata?.chatMode)==="free_chat")return tr.default.createElement(Ln,{sx:{fontSize:22}});let _=C?.originalMessage?.metadata?.AIModel||C?.meta?.AIModel||t.meta.AIModel;return _?tr.default.createElement(Or,{size:24,provider:t.meta.AIProvider,model:_}):tr.default.createElement(Ln,{sx:{fontSize:22}})};return tr.default.createElement(g,{id:`conversation-item-${t.id}`,"data-testid":a?`conversation-item-${a}`:"conversation-item",spacing:1,style:i,sx:n},tr.default.createElement(g,{direction:"row",alignItems:"center",pl:1.5,pr:1,height:40,onMouseOver:()=>{l(!0)},onMouseOut:()=>{l(!1)},onClick:()=>r?.(t),sx:{cursor:"pointer",borderRadius:"6px",userSelect:"none",...o||p?{bgcolor:C=>C.palette.mode==="dark"?"#383838":"#F0F0F0"}:{"&:hover":{bgcolor:C=>C.palette.mode==="dark"?"rgba(255, 255, 255, .1)":"rgba(0, 0, 0, 0.04)"}}},spacing:2},tr.default.createElement(g,{width:"24px",height:"24px",alignItems:"center",justifyContent:"center"},h()),tr.default.createElement(g,{width:0,flex:1,position:"relative",direction:"row",alignItems:"center",gap:"2px"},p?tr.default.createElement(Pa,{mouseEvent:"onMouseDown",onClickAway:()=>m(t)},tr.default.createElement(Ut,{onClick:C=>{C.stopPropagation()},variant:"standard","data-testid":"maxai--conversation--rename-chat--input",size:"small",ref:C=>{C&&setTimeout(()=>{C.querySelector("input")?.focus()},0)},defaultValue:d,onChange:C=>{C.stopPropagation(),c.current=C.target.value.trim()},onKeyDownCapture:C=>{C.stopPropagation(),C.key==="Enter"&&m(t),C.key==="Escape"&&u(!1)},onPaste:C=>{C.stopPropagation()},sx:{flex:1,"& input":{fontSize:"14px"}}})):tr.default.createElement(T,{color:"text.primary",fontSize:"14px",lineHeight:"24px",noWrap:!0,width:0,flex:1,textAlign:"left"},d),tr.default.createElement(T,{flexShrink:0,color:"text.secondary",fontSize:"12px",lineHeight:"16px",sx:{display:o||s?"none":"block",textAlign:"right",width:"40px"}},f),tr.default.createElement(g,{flexDirection:"row",sx:{width:"40px",justifyContent:"flex-end",...o||s?null:{position:"absolute",right:0,opacity:0}}},tr.default.createElement(Vw,{conversation:t,displaysText:d,onClose:()=>l(!1),onClickRename:()=>u(!0)})))))},Rw=(0,tr.memo)(AN,Rm);var Ix=v(A()),PN=e=>{let{open:t,onClose:o,onConfirm:r}=e,{t:n}=k(),i=n("package__features:chat__conversation_list__delete_all_chat__dialog__title"),a=n("package__features:chat__conversation_list__delete_all_chat__dialog__description");return Ix.default.createElement(Gi,{show:t,onClose:o,title:i,onConfirm:r,confirmBtnText:n("package__common:delete"),wrapSx:{width:"auto"},confirmBtnSx:{backgroundColor:"rgba(237, 80, 80, 1)",color:"rgba(255, 255, 255, 1)","&:hover":{backgroundColor:"rgba(237, 99, 99, 1)",color:"rgba(255, 255, 255, 1)"}}},Ix.default.createElement(T,{fontSize:"16px",color:"text.primary",px:"24px"},a))},Uw=PN;var $n=v(A()),kN=e=>{let{onDeleted:t,deleteOption:o,...r}=e,{t:n}=k(),{layout:i,conversationType:a,setConversationIds:s}=be(h=>({layout:h.layout,conversationType:h.conversationType,setConversationIds:h.setConversationIds})),{createConversation:l,deleteConversationsByType:c}=ct(),[p,u]=(0,$n.useState)(null),[m,d]=(0,$n.useState)(!1),f=async()=>{try{await c(a);let C=(await l(a,{reason:"initCreate"})).filter((x,_)=>_<i).map(x=>x.id);s(C),t?.()}catch{}finally{d(!1)}};return $n.default.createElement($n.default.Fragment,null,$n.default.createElement(fe,{title:n("package__common:more"),placement:"left",onClick:h=>{u(h.currentTarget)},...r},$n.default.createElement(X,{icon:"More",size:20})),$n.default.createElement(Ei,{anchorEl:p,open:!!p,onClose:()=>{u(null)},slotProps:{paper:{elevation:0,sx:{overflow:"unset",background:"transparent"}}}},$n.default.createElement(Ol,{offset:{top:0,right:0,bottom:0,left:0},options:[{value:"delete",icon:$n.default.createElement(X,{icon:"Delete",sx:o?.disabled?null:{color:"rgba(255, 14, 39, 1)!important"}}),label:n("package__features:chat__conversation_list__delete_all_chat__button__title"),labelSx:o?.disabled?null:{color:"rgba(255, 14, 39, 1)!important"},testid:"maxai-clear-all-chat-button",...o}],sx:{width:200},onSelectOption:h=>{h==="delete"&&d(!0),u(null)}})),$n.default.createElement(Uw,{open:m,onClose:()=>d(!1),onConfirm:f}))},Ww=kN;var Gw=v(p1()),jw=v(Lh());var Zs=v(A()),LN=e=>{let{value:t,onChangeValue:o,InputProps:r,...n}=e,{t:i}=k();return Zs.default.createElement(Ut,{size:"small",id:"filter-conversations",value:t,placeholder:i("package__common:search"),InputProps:{startAdornment:Zs.default.createElement(Bn,{position:"start",sx:{mr:"4px"}},Zs.default.createElement(jw.default,{sx:{fontSize:"24px"}})),endAdornment:t?Zs.default.createElement(Bn,{position:"end"},Zs.default.createElement(Xe,{onClick:()=>o?.(""),sx:{p:.5,mr:-.5},edge:"end"},Zs.default.createElement(Gw.default,{sx:{fontSize:"18px"}}))):null,...r,sx:{fontSize:16,pl:"6px",pr:1,"& input":{padding:0,height:36},...r?.sx}},inputProps:{autoComplete:"off"},sx:{width:"100%"},autoFocus:!0,onChange:a=>{let s=a.target.value.replaceAll(/\<|\>|\*/g,"");o?.(s)},onKeyUp:a=>{a.stopPropagation()},onKeyDown:a=>{a.stopPropagation()},...n})},qw=LN;var Kw=v(On()),$w=v(Lh());var go=v(A()),ON=e=>{let{onClose:t}=e,{t:o}=k(),r=be(u=>u.conversationType),[n,i]=(0,go.useState)([]),[a,s]=(0,go.useState)(""),[l,c]=(0,go.useState)(""),p=(0,go.useMemo)(()=>kr(c,500),[]);return go.default.createElement(g,{height:"100%"},go.default.createElement(g,{direction:"row",spacing:1,alignItems:"center",px:2,pt:2,position:"relative"},go.default.createElement(fe,{sx:{"& svg":{fontSize:"22px"}},onClick:t},go.default.createElement(Kw.default,null)),go.default.createElement(T,{fontSize:16,fontWeight:500,lineHeight:2,flex:1,textAlign:"center"},o("package__features:chat__inputbox__button__chat_history__tooltip")),go.default.createElement(Ww,{deleteOption:{disabled:n.length===0},onDeleted:()=>{t()},placement:"top",sx:{"& svg":{fontSize:"22px"}}})),go.default.createElement(g,{direction:"column",spacing:1,alignItems:"center",px:2,pt:2,pb:2,position:"relative"},go.default.createElement(qw,{value:a,InputProps:{startAdornment:go.default.createElement(Bn,{position:"start"},go.default.createElement($w.default,null)),sx:{pl:1}},onChangeValue:u=>{s(u),p(u)}})),go.default.createElement(wt,null),go.default.createElement(F,{flex:1,overflow:"hidden"},go.default.createElement(Nw,{key:r,conversationType:r,queryOptions:{keyword:l},itemSize:48,emptyNode:go.default.createElement(zw,null),onRenderItem:(u,m)=>go.default.createElement(Rw,{...m}),onChangeConversations:i,onSelectItem:t,onClose:t,sx:{p:2,height:"100%"}})))},Xw=ON;var BN=e=>{let{open:t,onClose:o,paperRef:r}=e;return O1.default.createElement(Sl,{open:t,onClose:o,anchor:"bottom",sx:{zIndex:1502,position:"absolute",[`& .${bl.paper}`]:{position:"absolute",borderTopRightRadius:16,borderTopLeftRadius:16,height:"90vh",bgcolor:"background.paper"}},slotProps:{backdrop:{sx:{position:"absolute"}}}},O1.default.createElement(Kr,{tabIndex:-1,onKeyDown:n=>{t&&n.key==="Escape"&&o()},ref:r,elevation:0,sx:{boxSizing:"border-box",width:"100%",height:"100%",borderRadius:0}},t&&O1.default.createElement(Xw,{onClose:o})))},Yw=BN;var FN=e=>{let{placement:t="top",sx:o,iconSx:r,onHistoryModalToggle:n}=e,{betaSettings:i}=Yo(),{t:a}=k(),{loaded:s,isLogin:l}=Ko(),[c,p]=$t.default.useState(!1),u=(0,$t.useRef)(null),{conversationId:m}=be(N=>({conversationId:N.conversationIds[0]})),d=xr(m),{conversationType:f}=ue(),{switchConversation:h,asyncUpdateConversation:C}=ct(),{chatHubLoading:x}=yt(),_=(0,$t.useCallback)(()=>{p(!1)},[]);(0,$t.useEffect)(()=>{W.current&&(_(),W.current=!1)},[f,_]);let y=a("package__features:chat__inputbox__button__chat_history__tooltip"),[b,S]=(0,$t.useState)(!1),I=d.length===0,[w,E]=(0,$t.useState)(!1),O=(0,$t.useMemo)(()=>l&&i?.appearance_v2_enabled&&I&&_i?[{testid:"maxai--chat-history-button--options--clear-history",value:"continue-last-chat",label:a("package__features:chat__chat_history_button__continue_last_chat"),icon:w?$t.default.createElement(X,{sx:{width:"20px",fontSize:"16px"},icon:"Loading"}):$t.default.createElement(X,{sx:{fontSize:"20px"},icon:"HistoryOne"}),sx:{paddingLeft:w?"14px":"10px"}},{testid:"maxai--chat-history-button--options--chat-history",value:"chat-history",label:a("package__features:chat__inputbox__button__chat_history__tooltip"),icon:$t.default.createElement(X,{icon:"History"})}]:[],[i?.appearance_v2_enabled,I,w,l,a]),L=(0,$t.useCallback)(async N=>{await nr.getService().addOrUpdateConversation(N.id,N,{syncToRemote:!1,isPartialUpdate:!1,updateUpdatedAt:!0}),N.updated_at=new Date().toISOString(),await h(N.id,N),await C(N.id)},[C,h]),G=st(n),H=!b&&w,V=(0,$t.useCallback)(async()=>{let N=null;E(!0);let Z=await nr.getService().getPaginationConversationsByType(f,{page:0,pageSize:10,sortKey:"updated_at"}),J=Z.data.filter(K=>K.lastMessageId);if(Z.success&&J.length>0&&(N=J[0]),!N){Qi.info(a("package__features:chat__conversation_list__no_conversation__title"),{autoHideDuration:1500,disableWindowBlurListener:!0}),E(!1);return}await L(N),E(!1)},[f,L,a]);(0,$t.useEffect)(()=>{c&&setTimeout(()=>{u.current?.focus()},100),G.current&&G.current(c)},[c]);let W=(0,$t.useRef)(!1);return $t.default.createElement($t.default.Fragment,null,$t.default.createElement(fe,{placement:"left-end",title:O.length<1?y:null,"data-testid":"maxai-chat-history-button",disabled:x,tooltipProps:{placement:t},sx:o,OptionsCardProps:{sx:{width:"188px"}},options:O,onPopupStateChange:N=>{S(N)},defaultOptionValue:"chat-history",onClick:async()=>{if(O.length>0||!s)return;let N=l;N||(N=await nt({emitEvent:!0})),N&&p(!0)},onSelectOption:async N=>{N==="chat-history"?(setTimeout(()=>{u.current?.focus()},100),p(!0)):N==="continue-last-chat"&&await V()}},$t.default.createElement(X,{icon:H?"Loading":"History",sx:{fontSize:"20px",scale:H?"0.8":"1",...r}})),$t.default.createElement(Yw,{open:c,onClose:_,paperRef:u}),$t.default.createElement(kw,null))},Zw=FN;var pr=v(A()),DN=e=>{let{anchorElementSelectors:t='[data-testid="sidebar-nav--new-chat-button"]',placement:o="left-end",...r}=e,{t:n}=k(),[i,a]=pr.default.useState(!1),[s,l]=pr.default.useState(!0),c=be(f=>f.conversationIds),p=xr(c[0]),u=ye(c[0]),m=(0,pr.useRef)(!1),d=(0,pr.useCallback)(async()=>{let f=await Ze.getOnboardingDataByKey(Lp),h=await Ze.getOnboardingDataByKey(Yd),C=f&&h,x=p.find(y=>y.type==="ai"),_=x&&x.originalMessage?.metadata?.chatMode==="pro_chat";(C||_)&&p.length>0&&u===!1&&m.current===!0&&a(!0)},[p,u]);return(0,pr.useEffect)(()=>{Ze.getOnboardingDataByKey(Op).then(f=>l(!!f))},[]),(0,pr.useEffect)(()=>{s||d()},[s,d]),(0,pr.useEffect)(()=>{u&&(m.current=!0)},[u]),s?null:pr.default.createElement(pr.default.Fragment,null,pr.default.createElement(Et,{trigger:i,placement:o,anchorElementSelectors:t,onShow:()=>{Ze.setOnboardingData(Op,!0)},CtaButtonProps:{"data-button-clicked-name":"Onboarding > New chat > Got it"},...r},pr.default.createElement(g,{spacing:.5},pr.default.createElement(T,{fontSize:20,lineHeight:1.4,color:"text.primary",fontWeight:700,textAlign:"left"},n("package__features:onboarding__onboarding_popover__new_chat__title")),pr.default.createElement(T,{fontSize:14,lineHeight:1.4,color:"text.primary",fontWeight:400,textAlign:"left"},n("package__features:onboarding__onboarding_popover__new_chat__description")))))},vx=DN;var rn=v(A());var HN=e=>{let{variant:t="text",sx:o,title:r,tooltipProps:n,...i}=e,{t:a}=k(),{createConversation:s}=ct(),{chatHubLoading:l}=yt(),{resetMyOwnToolsType:c}=pn(),{layout:p,conversationType:u,setConversationIds:m}=be(f=>({layout:f.layout,conversationType:f.conversationType,setConversationIds:f.setConversationIds})),d=async()=>{if(!await nt({emitEvent:!0}))return;let C=(await s(u,{reason:"manualClick"})).filter((x,_)=>_<p).map(x=>x.id);m(C),c()};return t==="text"?rn.default.createElement(Ce,{"data-testid":"sidebar-nav--new-chat-button",startIcon:rn.default.createElement(X,{icon:"NewChat",sx:{fontSize:"24px"}}),sx:{height:"32px",padding:"8px 12px!important",borderRadius:"8px",border:"1px solid",borderColor:f=>f.palette.mode==="dark"?"rgba(255, 255, 255, 0.12)!important":"rgba(0, 0, 0, 0.12)!important",color:f=>f.palette.mode==="dark"?"rgba(255, 255, 255)":"rgba(0, 0, 0, 0.6)",fontSize:"16px",lineHeight:"20px",...o},onClick:d,...i},a("package__features:chat__create_button__chat_action__title")):t==="outlined"?rn.default.createElement(rn.default.Fragment,null,rn.default.createElement(Ce,{"data-testid":"sidebar-nav--new-chat-button",variant:"outlined",color:"primary",startIcon:rn.default.createElement(X,{icon:"NewChat",sx:{fontSize:14}}),onClick:d,disabled:l,sx:{borderRadius:"6px",borderWidth:"1px",borderColor:f=>f.palette.text.primary,[`.${Ta.startIcon}`]:{marginRight:"10px"},...o},...i},rn.default.createElement(T,{component:"h2",sx:{fontSize:"inherit",fontWeight:"inherit"}},a("package__features:chat__create_button__chat_action__title"))),rn.default.createElement(vx,null)):rn.default.createElement(rn.default.Fragment,null,rn.default.createElement(fe,{tooltipProps:{placement:"left",...n},title:r||a("package__features:chat__navbar__button__new_chat"),testid:"sidebar-nav--new-chat-button",onClick:d,disabled:l,sx:o,...i},rn.default.createElement(X,{icon:"NewChat"})),rn.default.createElement(vx,null))},fu=HN;var Vc=v(va()),xo=v(A()),NN=e=>xo.default.createElement(Vc.default,{...e},xo.default.createElement("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},xo.default.createElement("path",{d:"M10.8004 2.00012H5.20037C4.08026 2.00012 3.52021 2.00012 3.09239 2.21811C2.71606 2.40986 2.4101 2.71582 2.21835 3.09214C2.00037 3.51996 2.00037 4.08002 2.00037 5.20012V10.8001C2.00037 11.9202 2.00037 12.4803 2.21835 12.9081C2.4101 13.2844 2.71606 13.5904 3.09239 13.7821C3.52021 14.0001 4.08026 14.0001 5.20037 14.0001H10.8004C11.9205 14.0001 12.4805 14.0001 12.9083 13.7821C13.2847 13.5904 13.5906 13.2844 13.7824 12.9081C14.0004 12.4803 14.0004 11.9202 14.0004 10.8001V5.20012C14.0004 4.08002 14.0004 3.51996 13.7824 3.09214C13.5906 2.71582 13.2847 2.40986 12.9083 2.21811C12.4805 2.00012 11.9205 2.00012 10.8004 2.00012Z",stroke:"currentColor",strokeOpacity:"0.87",strokeWidth:"1.33333",strokeLinecap:"round",strokeLinejoin:"round"}))),Qw=e=>xo.default.createElement(Vc.default,{...e},xo.default.createElement("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},xo.default.createElement("path",{d:"M8 2V14M5.2 2H10.8C11.9201 2 12.4802 2 12.908 2.21799C13.2843 2.40973 13.5903 2.71569 13.782 3.09202C14 3.51984 14 4.0799 14 5.2V10.8C14 11.9201 14 12.4802 13.782 12.908C13.5903 13.2843 13.2843 13.5903 12.908 13.782C12.4802 14 11.9201 14 10.8 14H5.2C4.07989 14 3.51984 14 3.09202 13.782C2.71569 13.5903 2.40973 13.2843 2.21799 12.908C2 12.4802 2 11.9201 2 10.8V5.2C2 4.07989 2 3.51984 2.21799 3.09202C2.40973 2.71569 2.71569 2.40973 3.09202 2.21799C3.51984 2 4.0799 2 5.2 2Z",stroke:"currentColor",strokeWidth:"1.33333",strokeLinecap:"round",strokeLinejoin:"round"}))),zN=e=>xo.default.createElement(Vc.default,{...e},xo.default.createElement("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},xo.default.createElement("path",{d:"M6 2V14M10 2V14M5.2 2H10.8C11.9201 2 12.4802 2 12.908 2.21799C13.2843 2.40973 13.5903 2.71569 13.782 3.09202C14 3.51984 14 4.0799 14 5.2V10.8C14 11.9201 14 12.4802 13.782 12.908C13.5903 13.2843 13.2843 13.5903 12.908 13.782C12.4802 14 11.9201 14 10.8 14H5.2C4.07989 14 3.51984 14 3.09202 13.782C2.71569 13.5903 2.40973 13.2843 2.21799 12.908C2 12.4802 2 11.9201 2 10.8V5.2C2 4.07989 2 3.51984 2.21799 3.09202C2.40973 2.71569 2.71569 2.40973 3.09202 2.21799C3.51984 2 4.0799 2 5.2 2Z",stroke:"currentColor",strokeWidth:"1.33333",strokeLinecap:"round",strokeLinejoin:"round"}))),VN=e=>xo.default.createElement(Vc.default,{...e},xo.default.createElement("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},xo.default.createElement("path",{d:"M2 8H14M8 2V14M5.2 2H10.8C11.9201 2 12.4802 2 12.908 2.21799C13.2843 2.40973 13.5903 2.71569 13.782 3.09202C14 3.51984 14 4.0799 14 5.2V10.8C14 11.9201 14 12.4802 13.782 12.908C13.5903 13.2843 13.2843 13.5903 12.908 13.782C12.4802 14 11.9201 14 10.8 14H5.2C4.07989 14 3.51984 14 3.09202 13.782C2.71569 13.5903 2.40973 13.2843 2.21799 12.908C2 12.4802 2 11.9201 2 10.8V5.2C2 4.07989 2 3.51984 2.21799 3.09202C2.40973 2.71569 2.71569 2.40973 3.09202 2.21799C3.51984 2 4.0799 2 5.2 2Z",stroke:"currentColor",strokeWidth:"1.33333",strokeLinecap:"round",strokeLinejoin:"round"}))),RN=e=>xo.default.createElement(Vc.default,{...e},xo.default.createElement("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},xo.default.createElement("path",{d:"M6 14L6 2M10 14V2M2 8H14M2 10.8L2 5.2C2 4.07989 2 3.51984 2.21799 3.09202C2.40973 2.71569 2.71569 2.40973 3.09202 2.21799C3.51984 2 4.0799 2 5.2 2H10.8C11.9201 2 12.4802 2 12.908 2.21799C13.2843 2.40973 13.5903 2.71569 13.782 3.09202C14 3.51984 14 4.07989 14 5.2V10.8C14 11.9201 14 12.4802 13.782 12.908C13.5903 13.2843 13.2843 13.5903 12.908 13.782C12.4802 14 11.9201 14 10.8 14H5.2C4.07989 14 3.51984 14 3.09202 13.782C2.71569 13.5903 2.40973 13.2843 2.21799 12.908C2 12.4802 2 11.9201 2 10.8Z",stroke:"currentColor",strokeWidth:"1.33333",strokeLinecap:"round",strokeLinejoin:"round"}))),UN=e=>{let{layout:t,...o}=e;switch(t){case 1:return xo.default.createElement(NN,{...o});case 2:return xo.default.createElement(Qw,{...o});case 3:return xo.default.createElement(zN,{...o});case 4:return xo.default.createElement(VN,{...o});case 6:return xo.default.createElement(RN,{...o});default:return xo.default.createElement(Qw,{...o})}},B1=UN;var jr=v(A()),WN=e=>{let{anchorElementSelectors:t='[data-testid="maxai--chat-hub--layout-selector--item--1"]',placement:o="top-start",...r}=e,{t:n}=k(),[i,a]=jr.default.useState(!1),[s,l]=jr.default.useState(!0),c=be(f=>f.conversationIds),p=xr(c[0]),u=ye(c[0]),m=(0,jr.useRef)(!1),d=(0,jr.useCallback)(async()=>{let f=await Ze.getOnboardingDataByKey(Bp),h=await Ze.getOnboardingDataByKey("ON_BOARDING__RECORD_FIRST_SELECTOR_AI_MODEL");f&&p.length>0&&u===!1&&h&&m.current===!0&&a(!0)},[p,u]);return(0,jr.useEffect)(()=>{Ze.getOnboardingDataByKey(Ug).then(f=>l(!!f))},[]),(0,jr.useEffect)(()=>{s||d()},[s,d]),(0,jr.useEffect)(()=>{u&&(m.current=!0)},[u]),s?null:jr.default.createElement(Et,{placement:o,trigger:i,anchorElementSelectors:t,onShow:()=>{Ze.setOnboardingData(Ug,!0)},CtaButtonProps:{"data-button-clicked-name":"Onboarding > Compare answers side by side > Got it"},...r},jr.default.createElement(g,{spacing:.5},jr.default.createElement(T,{fontSize:20,lineHeight:1.4,color:"text.primary",fontWeight:700,textAlign:"left"},n("package__features:onboarding__onboarding_popover__cha_hub_selector__title")),jr.default.createElement(T,{fontSize:14,lineHeight:1.4,color:"text.primary",fontWeight:400,textAlign:"left"},n("package__features:onboarding__onboarding_popover__cha_hub_selector__description"))))},Jw=WN;var Xt=v(A()),Tx=[{layout:1,tooltip:"package__features:chat__provider__chat_hub__layout__one__tooltip"},{layout:2,tooltip:"package__features:chat__provider__chat_hub__layout__two__tooltip"},{layout:3,tooltip:"package__features:chat__provider__chat_hub__layout__three__tooltip"},{layout:4,tooltip:"package__features:chat__provider__chat_hub__layout__four__tooltip"},{layout:6,tooltip:"package__features:chat__provider__chat_hub__layout__six__tooltip"}],GN=e=>{let{disabled:t,mode:o,size:r="medium",sx:n}=e,{conversationIds:i,conversationType:a,layout:s,setConversationIds:l,setLayout:c}=be(w=>({conversationIds:w.conversationIds,conversationType:w.conversationType,layout:w.layout,setConversationIds:w.setConversationIds,setLayout:w.setLayout})),{t:p}=k(),{createConversation:u}=ct(),{chatHubLoading:m}=yt(),d=t||m,f=async w=>{let E=await wm(a);if(await QC(w),i.length<w){let O=await u(a,{reason:"createChatHub",triggerChange:!1,syncToRemote:!1}),L=[...i,...O.slice(i.length).map(G=>G.id)];l(L)}c(w),e.onChange?.(w,E)},h=(0,Xt.useMemo)(()=>({p:"2px 5px",borderRadius:"8px",bgcolor:w=>w.palette.mode==="dark"?"#3B3D3E":"#E9E9EB",transition:"background-color 250ms cubic-bezier(0.4, 0, 0.2, 1)","&:hover":{bgcolor:d?w=>w.palette.mode==="dark"?"#3B3D3E":"#E9E9EB":w=>w.palette.mode==="dark"?"rgba(255, 255, 255, 0.18)":"rgba(0, 0, 0, 0.12)"},gap:r==="small"?"2px":"4px","& > button":{minWidth:"unset",color:"text.secondary",padding:r==="small"?"2px":"4px","&:hover,&.selected":{color:"text.primary",bgcolor:"background.paper"}}}),[r,n,d]),[C,x]=(0,Xt.useState)(!1),[_,y]=(0,Xt.useState)(!1),b=(0,Xt.useRef)(null),S=(0,Xt.useCallback)(w=>{y(w),w||x(!1)},[y]),I=(0,Xt.useCallback)(()=>{S(!1),b.current?.matches(":hover")&&x(!0)},[S]);if(o==="mini"){let w=Tx.find(E=>s===E.layout);return Xt.default.createElement(ts,{width:220,sx:{zIndex:2147483621},open:_,onOpenChange:S,placement:"bottom-start",isMirror:!0,modifiers:[{name:"RTLSupport",enabled:typeof document<"u"&&document.querySelector("body")?.getAttribute("dir")==="rtl",phase:"main",fn({state:E}){if(E.modifiersData.popperOffsets){let L=E.rects.reference.x+E.rects.reference.width-E.rects.popper.width;L>0&&(E.modifiersData.popperOffsets.x=L)}}},{name:"offset",options:{offset:[0,5]}},{name:"flip",options:{fallbackPlacements:["top-start"]}}],referenceElement:Xt.default.createElement(ve,{title:w?p(w.tooltip):null,open:C&&!_},Xt.default.createElement(Ce,{disableRipple:!0,disabled:d,ref:b,"data-testid":"maxai--chat-hub--layout-selector--button","aria-controls":_?"composition-menu":void 0,"aria-expanded":_?"true":void 0,"aria-haspopup":"true",onClick:()=>y(!_),sx:{position:"relative",display:"flex",justifyContent:"center",alignItems:"center",cursor:"pointer",p:.5,pl:"6px",height:32,minWidth:"auto"},onMouseEnter:()=>{_||x(!0)},onMouseLeave:()=>{_||x(!1)}},Xt.default.createElement(B1,{sx:{fontSize:18},layout:w?.layout||1}),Xt.default.createElement(X,{icon:"ExpandMore",sx:{color:"text.secondary",fontSize:"16px",transform:_?"rotate(180deg)":"rotate(0)"}})))},Xt.default.createElement(Mi,{disableListWrap:!0,"data-testid":"maxai--chat-hub--layout-selector--group",sx:{overflowY:"auto",overflowX:"hidden",flexShrink:0,py:"6px",boxSizing:"border-box",bgcolor:E=>E.palette.mode==="dark"?"rgba(61, 61, 61, 1)":"#fff",...n}},Tx.map(E=>Xt.default.createElement(Ct,{"data-testid":`maxai--chat--layout-selector--item--${E.layout}`,key:E.layout,selected:E.layout===s,onClick:()=>{f(E.layout),I()},sx:{borderRadius:"6px",mx:"6px",minHeight:"unset",p:"6px 10px 6px 8px","&:hover":{backgroundColor:O=>O.palette.mode==="dark"?"rgba(255, 255, 255, .1)":"rgba(0, 0, 0, 0.04)"},...E.layout===s&&{backgroundColor:O=>O.palette.mode==="dark"?"rgba(255, 255, 255, 0.1)":"rgba(0, 0, 0, 0.04)"}}},Xt.default.createElement(g,{alignItems:"center",direction:"row",spacing:1,sx:{flex:1,height:24}},Xt.default.createElement(B1,{sx:{fontSize:18,color:"text.primary"},layout:E.layout}),Xt.default.createElement(xc,{fontSize:"14px",lineHeight:"21px"},p(E.tooltip)))))))}return Xt.default.createElement(g,{"data-testid":"maxai--chat-hub--layout-selector--group",direction:"row",alignItems:"center",sx:h},Tx.map(w=>Xt.default.createElement(ve,{title:p(w.tooltip),key:w.layout,disableInteractive:!0},Xt.default.createElement(Ce,{"data-testid":`maxai--chat-hub--layout-selector--item--${w.layout}`,className:s===w.layout?"selected":"",disabled:d,key:w.layout,onClick:()=>f(w.layout)},Xt.default.createElement(B1,{sx:{fontSize:"16px"},layout:w.layout})))),Xt.default.createElement(Jw,null))},eT=GN;var Wo=v(A());var jN=()=>{let{conversationType:e}=ue();return e==="Art"?Wo.default.createElement(QI,null):Wo.default.createElement(rs,null)},qN=e=>{let{renderLeftNode:t,renderRightNode:o}=e,{variant:r}=eo(),n={newChatButton:Wo.default.createElement(fu,{variant:"icon"}),aiModelSelector:r!=="chatHubInput"&&Wo.default.createElement(jN,null),chatHubLayoutSelector:Wo.default.createElement(eT,null),aiLanguageSelector:Wo.default.createElement(Qa,null),proChatSwitch:Wo.default.createElement(Za,null),portalRoot:Wo.default.createElement(g,{direction:"row",alignItems:"center",gap:"4px","data-testid":"maxai--chat-box--tools--left-container--portal-root",sx:{"&:empty":{display:"none"}}})},i={advancedButton:Wo.default.createElement(Pw,null),historyButton:Wo.default.createElement(Zw,null),newChatButton:Wo.default.createElement(fu,{variant:"icon"})},a=t?t(n):Wo.default.createElement(Wo.default.Fragment,null,n.proChatSwitch,n.aiModelSelector,n.chatHubLayoutSelector,n.aiLanguageSelector,n.portalRoot),s=o?o(i):Wo.default.createElement(Wo.default.Fragment,null,i.advancedButton,i.historyButton);return Wo.default.createElement(g,{direction:"row",justifyContent:"space-between",sx:{mb:1,gap:"8px"}},Wo.default.createElement(g,{direction:"row",alignItems:"center","data-testid":"maxai--chat-box--tools--left-container",sx:{flexWrap:"wrap",gap:"4px","&:empty":{display:"none"}}},a),Wo.default.createElement(g,{direction:"row",spacing:.5,alignItems:"start","data-testid":"maxai--chat-box--tools--right-container",sx:{"&:empty":{display:"none"}}},s))},tT=qN;var KN=e=>{let{toolsProps:t,inputProps:o,footerPrefix:r,sx:n,isShowHomeView:i,updateChatBoxHeight:a}=e,{conversationId:s}=ue(),l=Xo(s),[c,p]=(0,Xn.useState)(!1),[u,m]=(0,Xn.useState)(null),{rect:d}=mC({target:u,windowScroll:!0,observeOptions:{childList:!0,subtree:!0}}),f=477,[h,C]=(0,Xn.useState)(f);return(0,Xn.useEffect)(()=>{d?.height&&(a?.(d.height),C(Math.max(d.height,c?h:f)))},[d,c]),l?.meta.AIProvider&&cm(l?.meta.AIProvider)?null:Xn.default.createElement(F,{"data-testid":"maxai--chat-panel--footer",sx:{width:"100%",display:"flex",flexDirection:"column",justifyContent:"flex-start",overflow:"hidden",alignItems:"center",flex:i?`1 1 ${h}px`:"reset",transition:"flex-basis 0.15s",zIndex:1501,backgroundColor:x=>x.palette.background.default,...n}},Xn.default.createElement(g,{ref:m,sx:{width:"100%",maxWidth:"var(--max-width)",margin:"0 auto",overflow:"hidden",p:1.5}},r,Xn.default.createElement(F3,{onShow:()=>p(!0),onClose:()=>p(!1)}),!c&&Xn.default.createElement(tT,{...t}),!c&&Xn.default.createElement(dw,{...o})))},F1=KN;var oT=v(Q2()),Mx=v(A()),$N=e=>{let{needSystemOrThirdMessage:t=!1}=e,{t:o}=k(),{conversationId:r,conversationMessages:n,getConversation:i}=Pi();return n.filter(s=>t?!0:s.type!=="system"&&s.type!=="third").length===0||!r?null:Mx.default.createElement(Fm,{title:o("package__features:chat__navbar__conversation_share__download_button__tooltip"),"data-testid":"history-text-download-button",sx:{border:s=>s.palette.mode==="dark"?"1px solid rgba(255, 255, 255, 0.12)":"1px solid rgba(0, 0, 0, 0.12)",borderRadius:"8px",padding:"6px"},onClick:async()=>{let s=await i(r);if(s?.title){let l=await ym(s,t),c=new Blob([l],{type:"text/plain;charset=utf-8"}),p=URL.createObjectURL(c),u=document.createElement("a");u.href=p,u.download=`MaxAI_Chat_${(0,oT.default)().format("YYYY_MM_DD_HH:mm")}.txt`,u.click(),URL.revokeObjectURL(p)}}},Mx.default.createElement(X,{icon:"FileDownload",sx:{fontSize:"18px",color:"text.secondary"}}))},rT=$N;var Je=v(A()),nT=e=>`${qr}/share/?id=${e}`,XN=()=>{let{t:e}=k(),{features:t,loaded:o}=XC(),{conversation:r,conversationMessages:n,updateConversation:i,getConversation:a}=Pi(),[s,l]=(0,Je.useState)(!1),[c,p]=(0,Je.useState)(!1),[u,m]=(0,Je.useState)(null),d=r?.share?.enable===!0,f=r?.share?.id,h=b=>{m(b.currentTarget)},C=()=>{m(null)},x=(b=e("package__features:chat__navbar__conversation_share__share_panel__error_tip"))=>{Qi.error(b,{anchorOrigin:{vertical:"top",horizontal:"center"}})},_=async b=>{if(r?.id)try{p(!0);let S=(await nr.getService().shareConversation(r.id,b))?.share;S?.id?await i(r.id,{share:{enable:S.enable,id:S.id}}):x()}catch{x()}finally{p(!1)}},y=async b=>{if(!r?.id)return;let S=b.currentTarget.parentElement,I="";if(f)d||await _(!0),I=f;else try{if(!I){l(!0);let O=await a(r.id);if(!O){x();return}await nr.getService().checkUpdate(r.id),await cn.getService().checkUpdate(r.id);let L=(await nr.getService().shareConversation(O.id,!0))?.share;L?.id&&L.enable&&(I=L.id,await i(O.id,{share:{enable:!0,id:L.id}}))}}catch{x()}finally{l(!1)}let w=nT(I);navigator.clipboard.writeText(w);let E=S?.querySelector('button[data-testid="maxai--conversation--share-button"]');h({currentTarget:b.currentTarget||E})};return o&&!t.chat_sync||n.length<=0?null:Je.default.createElement(g,{direction:"row",alignItems:"center",gap:1},d&&f&&Je.default.createElement(Fr,{copyText:nT(f),copyToClipboardTooltip:e("package__features:chat__navbar__conversation_share__copy_button__copy_link"),icon:Je.default.createElement(X,{icon:"Link"}),sx:{display:"flex",alignItems:"center",justifyContent:"center",border:b=>b.palette.mode==="dark"?"1px solid rgba(255, 255, 255, 0.12)":"1px solid rgba(0, 0, 0, 0.12)",borderRadius:"8px",minWidth:"unset",height:"32px",width:"32px"}}),Je.default.createElement(an,{"data-testid":"maxai--conversation--share-button",variant:"contained",sx:{display:"flex",alignItems:"center",height:"32px",gap:.5,borderRadius:"8px",padding:"8px"},loading:s,onClick:y},d?Je.default.createElement(X,{sx:{fontSize:"18px"},icon:"IosShare"}):Je.default.createElement(X,{sx:{fontSize:"18px"},icon:"Lock"}),Je.default.createElement(T,{component:"span",fontSize:"12px"},e("package__features:chat__navbar__conversation_share__share_button__title"))),Je.default.createElement(Ei,{PaperProps:{sx:{mt:1,boxShadow:"0px 4px 8px 0px rgba(0, 0, 0, 0.16)"}},elevation:1,anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},open:!!u,anchorEl:u,onClose:C},Je.default.createElement(g,{py:1,px:2,width:320,gap:1},Je.default.createElement(T,{fontSize:16,fontWeight:500},e("package__features:chat__navbar__conversation_share__share_panel__title")),Je.default.createElement(g,{sx:{"& > button":{border:"1px solid",width:"100%",p:1,borderColor:"border.main",borderRadius:"0 0 8px 8px",alignItems:"center",justifyContent:"start","&:not(:last-child)":{borderBottom:"none",borderRadius:"8px 8px 0 0"}}}},Je.default.createElement(Ce,{"data-testid":"maxai--conversation--share-private-button",disabled:c,onClick:async()=>{await _(!1)}},Je.default.createElement(g,{width:"100%"},Je.default.createElement(g,{direction:"row",alignItems:"center",gap:1},c?Je.default.createElement(Ft,{size:16}):Je.default.createElement(X,{icon:"Lock",sx:{fontSize:"16px"}}),Je.default.createElement(T,{textAlign:"left",fontSize:"14px",color:"text.primary"},e("package__features:chat__navbar__conversation_share__share_panel__private_button__title")),!d&&Je.default.createElement(X,{icon:"GreenCircleCheck",sx:{ml:"auto",mr:0,fontSize:"20px"}})),Je.default.createElement(T,{textAlign:"left",fontSize:"12px",color:"text.secondary"},e("package__features:chat__navbar__conversation_share__share_panel__private_button__description")))),Je.default.createElement(Ce,{disabled:c,onClick:async()=>{await _(!0)}},Je.default.createElement(g,{width:"100%"},Je.default.createElement(g,{direction:"row",alignItems:"center",gap:1},c?Je.default.createElement(Ft,{size:16}):Je.default.createElement(X,{icon:"Share",sx:{fontSize:"16px"}}),Je.default.createElement(T,{textAlign:"left",fontSize:"14px",color:"text.primary"},e("package__features:chat__navbar__conversation_share__share_panel__public_button__title")),d&&Je.default.createElement(X,{icon:"GreenCircleCheck",sx:{ml:"auto",mr:0,fontSize:"20px"}})),Je.default.createElement(T,{textAlign:"left",fontSize:"12px",color:"text.secondary"},e("package__features:chat__navbar__conversation_share__share_panel__public_button__description"))))),d&&Je.default.createElement(g,{direction:"row",alignItems:"center",gap:1},Je.default.createElement(X,{icon:"GreenCircleCheck",sx:{fontSize:"16px"}}),Je.default.createElement(T,{textAlign:"left",fontSize:"12px",color:"#379837"},e("package__features:chat__navbar__conversation_share__share_panel__copied_tip"))))))},iT=XN;var gi=v(A());var aT=v(A()),YN=()=>{let e=cl(),t=p2(e.breakpoints.down("md")),o=Aa();return{isMiniScreen:(0,aT.useMemo)(()=>pl()?t:o==="xs"||o==="sm",[o,t])}},D1=YN;var hu=v(A());var Ex="MAXAI_CLIENT__FEATURES__LAYOUT__WEBSITE_STATE";var sT="MAXAI_CLIENT__UI__HOME_NAVBAR_STATE",ZN="MAXAI_SIDEBAR_FOLD_STATUS",Ax=()=>({chatHistoryOpen:!0,toolbarCollapsed:!1,miniScreenToolbarOpen:!1,rightToolbarCollapsed:!1,rightMiniScreenToolbarOpen:!1}),Px=()=>{let e=Ax();try{let t=window.localStorage.getItem(Ex);if(t){let o=JSON.parse(t);Object.assign(e,o)}}catch{}try{let t=window.localStorage.getItem(sT);if(t){let o=JSON.parse(t);Object.assign(e,{chatHistoryOpen:o.conversationListPanelOpen??e.chatHistoryOpen})}}catch{}return window.localStorage.removeItem(sT),window.localStorage.removeItem(ZN),{...e,miniScreenToolbarOpen:!1,rightMiniScreenToolbarOpen:!1}},lT=e=>{let t=Px(),o=qo([t,e]);window.localStorage.setItem(Ex,JSON.stringify(o))};var kx=Jn({key:"AppWebsiteLayoutState",default:Ax(),effects:[({onSet:e})=>{e(t=>{lT(t)})}]}),QN=Jn({key:"AppWebsiteLayoutToolbarWidgetState",default:{disableExtensionAdCard:!1}});var JN=()=>{let e=Zt(kx),{isLogin:t}=Ko(),{hasExtension:o}=Vh(),{isMiniScreen:r}=D1(),n=!t||!o||r;return{...e,isMiniScreen:r,disabledCollapse:n,toolbarCollapsed:n?!1:e.toolbarCollapsed,rightToolbarCollapsed:r?!1:e.rightToolbarCollapsed}},ez=()=>{let e=ro(kx),t=()=>{e(Px())},o=(p,u)=>{e(m=>m[p]===u?m:{...m,[p]:u})};return{syncLocalState:t,setChatHistoryOpen:p=>{o("chatHistoryOpen",p)},setToolbarCollapsed:p=>{o("toolbarCollapsed",p)},setToolbarWidth:p=>{o("toolbarWidth",p)},setMiniScreenToolbarOpen:p=>{o("miniScreenToolbarOpen",p)},setRightToolbarCollapsed:p=>{o("rightToolbarCollapsed",p)},setRightToolbarWidth:p=>{o("rightToolbarWidth",p)},setRightMiniScreenToolbarOpen:p=>{o("rightMiniScreenToolbarOpen",p)}}},H1=()=>{let e=JN(),t=ez();return{...e,...t}};var N1=v(A()),tz=e=>{let{...t}=e,{chatHistoryOpen:o,setChatHistoryOpen:r}=H1(),{t:n}=k();return N1.default.createElement(ve,{placement:"bottom",title:n(o?"package__features:chat__navbar__button__hide_chat_history":"package__features:chat__navbar__button__show_chat_history")},N1.default.createElement(Xe,{"data-testid":"sidebar-nav-topbar-show-or-hide-chat-history-button",onClick:()=>r(!o),...t},N1.default.createElement(X,{icon:"LayoutLeftIcon",sx:{fontSize:"24px",color:i=>i.palette.mode==="dark"?"rgba(255, 255, 255)":"rgba(0, 0, 0, 0.6)"}})))},cT=tz;var oz=e=>{let{newChatProps:t,switchVisibilityProps:o,sx:r}=e,{isMiniScreen:n}=D1();return hu.default.createElement(g,{direction:"row",justifyContent:"space-between",alignItems:"center",sx:r},n?hu.default.createElement(F,{sx:{height:"40px"}}):hu.default.createElement(cT,{...o}),hu.default.createElement(fu,{...t,tooltipProps:{placement:"bottom",...t?.tooltipProps},sx:{p:1,height:"auto",minWidth:"auto","& svg":{fontSize:24},...t?.sx}}))},pT=oz;var uT=v(A()),rz=e=>{let{topBarProps:t}=e,{isMiniScreen:o,chatHistoryOpen:r}=H1(),{chatHubOrder:n,variant:i}=ue();return i==="chatHub"&&n>0||o||r?null:uT.default.createElement(pT,{...t,sx:{pl:1,...t?.sx},newChatProps:{variant:"icon",...t?.newChatProps}})},mT=rz;var nz=e=>{let{leftNode:t,rightNode:o,renderLeftNode:r,renderRightNode:n,sx:i}=e,a={actionsGroup:gi.default.createElement(mT,null)},s={downloadButton:gi.default.createElement(rT,null),shareButton:gi.default.createElement(iT,null)},l=r?r(a):gi.default.createElement(gi.default.Fragment,null,a.actionsGroup,t),c=n?n(s):gi.default.createElement(gi.default.Fragment,null,o,s.downloadButton,s.shareButton);return gi.default.createElement(g,{sx:{flexDirection:"row",minHeight:"72px",marginBottom:"-16px",...i}},gi.default.createElement(g,{direction:"row",alignItems:"center",gap:1,pl:1},l),gi.default.createElement(g,{direction:"row",flex:1,width:0,justifyContent:"end",alignItems:"center",gap:1,pr:1},c))},z1=nz;var iz=e=>{let{headerProps:t,messageProps:o,toolsProps:r,inputProps:n,footerPrefix:i,footerProps:a,emptyNode:s,sx:l}=e,c=be(_=>_.conversationType),{betaSettings:p}=Yo(),u=c==="ContextMenu",{conversationId:m}=eo(),d=ye(m),[f,h]=(0,Yn.useState)(0),C=_=>Yn.default.createElement(F1,{isShowHomeView:_,...a,inputProps:{...n,textareaProps:{...n?.textareaProps,disabled:n?.textareaProps?.disabled||d}},toolsProps:r,footerPrefix:i,updateChatBoxHeight:h}),x=(_,y)=>u?_?null:C:p?.appearance_v2_enabled&&y&&!_?null:C;return Yn.default.createElement(g,{className:"maxai--chat-box",sx:{flex:1,height:0,width:"100%","& *":{boxSizing:"border-box"},...d?{}:{[`.${Ll}`]:{display:"none"}},...l}},Yn.default.createElement(z1,{...t}),Yn.default.createElement(g,{sx:{flex:1,justifyContent:"center",flexDirection:"row",height:0,width:"100%"}},Yn.default.createElement(Og.Provider,{value:o||IS},Yn.default.createElement(Dc,{emptyNode:s},({isShowHomeView:_,isLoading:y,listNode:b})=>Yn.default.createElement(g,{className:"maxai--chat-box--content","data-message-empty":_,"data-message-loading":y,sx:{flex:1,width:"100%",alignItems:"center"}},Yn.default.createElement(m3,{isMessageEmpty:_,chatBoxHeight:f,sx:{display:_?"flex":"none"}}),b,x(_,y)?.(_)))),Yn.default.createElement(Vd,null)))},dT=iz;var nn=v(A()),az=({isFullscreen:e,children:t,onClose:o})=>{let{t:r}=k(),n=(0,nn.useCallback)(l=>{l.key==="Escape"&&o()},[o]);(0,nn.useEffect)(()=>(e&&document.addEventListener("keydown",n),()=>{document.removeEventListener("keydown",n)}),[e,n]);let i=(0,nn.useMemo)(()=>({width:"100%!important",height:"100%!important",maxWidth:"100%!important",maxHeight:"100%!important",position:"fixed",top:0,left:0,zIndex:1502,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",justifyContent:"center",alignItems:"center"}),[]),a=(0,nn.useMemo)(()=>({backgroundColor:"background.default",height:"95vh",padding:"24px",boxSizing:"border-box",maxHeight:"calc(100vh - 32px)",maxWidth:"768px!important",position:"relative",borderRadius:"8px",width:"calc(100vw - 32px)"}),[]),s=(0,nn.useMemo)(()=>({border:"1px solid",borderColor:"border.main",borderRadius:"8px",flex:1,height:"0"}),[]);return nn.default.createElement(F,{sx:{width:"100%",height:"100%",position:"relative",...e?i:{}},onClick:()=>o()},nn.default.createElement(g,{sx:{width:"100%",height:"100%",gap:"24px",...e?a:{}},onClick:l=>l.stopPropagation()},nn.default.createElement(g,{"data-testid":"chat-hub-chat-box-wrapper",sx:{width:"100%",height:"100%",...e?s:{}}},t),e&&nn.default.createElement(g,{sx:{flexDirection:"row",justifyContent:"flex-end"}},nn.default.createElement(Ce,{variant:"contained",onClick:()=>o()},r("package__features:chat__chat_hub_box__exit_full_screen")))))},fT=az;var or=v(A());var sz=e=>{let{headerProps:t,emptyNode:o,sx:r}=e,{t:n}=k(),i=be(p=>p.layout),[a,s]=(0,or.useState)(!1),{chatHubOrder:l}=eo(),{chatHubLoading:c}=yt();return or.default.createElement(g,{component:"div",position:"relative",sx:{width:"100%","& *":{boxSizing:"border-box"},...c?{}:{[`.${Ll}`]:{display:"none"}},...r}},or.default.createElement(fT,{isFullscreen:a,onClose:()=>s(!1)},or.default.createElement(z1,{...t}),or.default.createElement(g,{sx:{flex:1,justifyContent:"center",flexDirection:"row",height:0,width:"100%"}},or.default.createElement(g,{sx:{flex:1,width:"100%"}},or.default.createElement(Dc,{emptyNode:o},({isShowHomeView:p,listNode:u})=>or.default.createElement(or.default.Fragment,null,p&&or.default.createElement("div",{style:{flex:1}}),u)),a?null:or.default.createElement(g,{sx:{p:"12px",flexDirection:"row",justifyContent:"space-between"}},or.default.createElement(Kd,null,p=>p==="pro_chat"?or.default.createElement(JI,{order:l}):or.default.createElement("div",null)),i>1&&or.default.createElement(fe,{placement:"top",title:n("package__features:chat__chat_hub_box__full_screen"),onClick:()=>s(!a)},or.default.createElement(n2,{sx:{color:"text.secondary"}})))))))},hT=sz;var V1=v(A()),lz=e=>{let{sx:t,footerProps:o,inputProps:r,footerPrefix:n,toolsProps:i}=e;return V1.default.createElement(g,{component:"div",position:"relative",sx:{flex:1,width:"100%","& *":{boxSizing:"border-box"},...t}},V1.default.createElement(g,{sx:{flex:1,width:"100%"}},V1.default.createElement(F1,{...o,inputProps:r,toolsProps:i,footerPrefix:n})))},gT=lz;var fs=v(A());var cz=e=>{let{emptyNode:t,sx:o}=e,{conversationId:r}=eo(),n=ye(r);return fs.default.createElement(g,{sx:{flex:1,width:"100%","& *":{boxSizing:"border-box"},...n?{}:{[`.${Ll}`]:{display:"none"}},...o}},fs.default.createElement(g,{sx:{flex:1,justifyContent:"center",flexDirection:"row",height:0,width:"100%"}},fs.default.createElement(g,{sx:{flex:1,width:"100%"}},fs.default.createElement(Dc,{emptyNode:t},({listNode:i})=>fs.default.createElement(fs.default.Fragment,null,i))),fs.default.createElement(Vd,null)))},xT=cz;var hs=v(A()),pz=e=>{let{children:t,variant:o,conversationId:r,chatHubOrder:n,inputMediator:i=Qt("Chat"),...a}=e,s=(0,hs.useMemo)(()=>({variant:o,conversationId:r,chatHubOrder:n,inputMediator:i}),[o,r,n,i]);return hs.default.createElement(YC.Provider,{value:s},o==="normal"&&hs.default.createElement(dT,{...a}),o==="chatHub"&&hs.default.createElement(hT,{...a}),o==="chatHubInput"&&hs.default.createElement(gT,{...a}),o==="share"&&hs.default.createElement(xT,{...a}),o==="custom"&&t)},R1=pz;var _T=v(va());var so=v(A()),uz=()=>{let{t:e}=k(),{isChatBoxDragOver:t}=Pm();return so.default.createElement(Si,{in:t},so.default.createElement(g,{id:"chat-files-drop-box",sx:()=>({position:"absolute",top:0,left:0,right:0,bottom:0,pointerEvents:"none",p:1,backdropFilter:"blur(10px)",zIndex:2147483620,display:t?"flex":"none"})},so.default.createElement(g,{spacing:1,justifyContent:"center",alignItems:"center",sx:o=>{let r=o.palette.mode==="dark";return{height:"100%",border:"4px dashed",borderColor:"primary.main",bgcolor:"rgba(144, 101, 176, 0.16)",borderRadius:1}}},so.default.createElement(g,{direction:"row",spacing:.5,color:"primary.main",fontSize:32},so.default.createElement(mz,null)),so.default.createElement(T,{fontSize:24,fontWeight:600,color:"text.primary"},e("package__features:chat__files__drop_box__add_anything")),so.default.createElement(T,{fontSize:16,fontWeight:400,lineHeight:1.5,color:"text.primary"},e("package__features:chat__files__drop_box__drop_file_or_image_here")))))},mz=()=>so.default.createElement(_T.default,{sx:{width:156,height:118,objectFit:"contain"}},so.default.createElement("svg",{width:"156",height:"118",viewBox:"0 0 156 118",fill:"none",xmlns:"http://www.w3.org/2000/svg"},so.default.createElement("rect",{x:"107.421",y:"36.9053",width:"47.0533",height:"41.9333",rx:"8",transform:"rotate(24.35 107.421 36.9053)",fill:"#8D6FD1"}),so.default.createElement("path",{d:"M122.98 73.0592L130.332 70.2885L127.562 62.9365",fill:"#8D6FD1"}),so.default.createElement("path",{d:"M117.439 58.3553L110.087 61.1261L112.858 68.478",fill:"#8D6FD1"}),so.default.createElement("path",{d:"M122.98 73.0592L130.332 70.2885L127.562 62.9365M117.439 58.3553L110.087 61.1261L112.858 68.478M126.357 57.5131L114.062 73.9015",stroke:"white",strokeWidth:"2.29129",strokeLinecap:"round",strokeLinejoin:"round"}),so.default.createElement("rect",{x:"8.01111",y:"55.0576",width:"47.0533",height:"41.9333",rx:"8",transform:"rotate(-24.35 8.01111 55.0576)",fill:"#AE97E1"}),so.default.createElement("g",{clipPath:"url(#clip0_5257_157892)"},so.default.createElement("path",{d:"M48.0226 69.7675L48.9249 69.3592C49.7921 68.9667 50.2257 68.7705 50.3819 68.4792C50.518 68.2255 50.5365 67.9235 50.4327 67.6526C50.3135 67.3416 49.9077 67.0853 49.096 66.5725L44.5605 63.7073C43.8898 63.2836 43.5545 63.0717 43.2564 63.08C42.9958 63.0871 42.7497 63.1985 42.5723 63.3896C42.3693 63.6081 42.3072 63.9998 42.1828 64.7833L41.975 66.0931M48.0226 69.7675L36.6195 62.8393C35.9637 62.4409 35.6358 62.2416 35.3434 62.2518C35.0876 62.2606 34.8463 62.3698 34.6708 62.5561C34.4703 62.7691 34.4035 63.1469 34.27 63.9026L32.4739 74.0699C32.3038 75.0326 32.2188 75.514 32.3714 75.8132C32.5044 76.0738 32.7441 76.263 33.0265 76.3303C33.3508 76.4075 33.7925 76.2076 34.6758 75.8079L48.0226 69.7675ZM43.672 55.3998C44.3499 56.8976 43.6999 58.6545 42.2204 59.3241C40.7408 59.9937 38.9919 59.3224 38.3141 57.8246C37.6363 56.3269 38.2862 54.57 39.7658 53.9004C41.2453 53.2308 42.9942 53.9021 43.672 55.3998Z",stroke:"white",strokeWidth:"1.86158",strokeLinecap:"round",strokeLinejoin:"round"})),so.default.createElement("path",{d:"M55.2098 27.3109C55.2098 24.5692 57.4324 22.3467 60.174 22.3467H86.2361L104.852 40.9624V79.435C104.852 82.1766 102.629 84.3992 99.8876 84.3992H60.174C57.4324 84.3992 55.2098 82.1766 55.2098 79.435V27.3109Z",fill:"#7A51D5"}),so.default.createElement("path",{opacity:"0.3",d:"M86.2361 22.3467L104.852 40.9624H91.2003C88.4586 40.9624 86.2361 38.7399 86.2361 35.9982V22.3467Z",fill:"white"}),so.default.createElement("path",{d:"M70.0908 52.9502H89.9708M70.0908 57.368H89.9708M70.0908 61.7858H89.9708M70.0908 66.2035H85.553",stroke:"white",strokeWidth:"2.07083",strokeLinecap:"round",strokeLinejoin:"round"}),so.default.createElement("defs",null,so.default.createElement("clipPath",{id:"clip0_5257_157892"},so.default.createElement("rect",{width:"23.5243",height:"23.8134",fill:"white",transform:"translate(22.4647 58.4609) rotate(-24.35)"}))))),CT=uz;var U1=v(A()),dz=e=>{let{sx:t,disabled:o,className:r,containerRef:n,children:i}=e,{handleDragEnter:a,handleDragOver:s,handleDragLeave:l,handleDrop:c}=Pm(),p=be(d=>d.layout),u=(0,U1.useMemo)(()=>vi(),[]),m=p>1||u?"100%":"768px";return U1.default.createElement(g,{ref:n,component:"div",position:o?void 0:"relative",onDragEnter:o?void 0:a,onDragOver:o?void 0:s,onDragLeave:o?void 0:l,onDrop:o?void 0:c,className:r,sx:{"--max-width":m,...t}},i)},yT=dz;var xa=v(A());var Qs=v(A());var Er=v(A());var fz=()=>{let e=be(o=>o.conversationIds);return oy(e)>0?null:Er.default.createElement(Wd,{sx:{position:"relative",bottom:0,mb:1,mt:-.5,zIndex:1501}})},hz=e=>{let{footerProps:t,inputProps:o,toolsProps:r,footerPrefix:n}=e,i=be(H=>H),{conversationIds:a,conversationType:s,layout:l}=i,{askAIWithShortcuts:c,askAIWithShortcutsV2:p,stopGenerate:u}=ze(),m=st({askAIWithShortcuts:c,askAIWithShortcutsV2:p,stopGenerate:u}),d=a.slice(0,l),f=d[0],{updateConversation:h,getConversation:C}=ct(),{getDefaultValueModel:x,getChatHubDefaultValueModel:_}=Pl(),y=(0,Er.useCallback)(async H=>H===0?await x():await _(H),[x,_]),b=_r.use.chatHub(),S=_r.use.chat(),I=(0,Er.useCallback)(async(H,V)=>{if(!await C(H))return;let N=V===0?S:b[V],J=Rh(N)?await y(V):N,K=$o(J.AIProvider,J.AIModel);K&&await h(H,{meta:{AIProvider:K.AIProvider,AIModel:K.value,maxTokens:K.maxTokens}})},[h,C,y,S,b]),w=(0,Er.useCallback)(async(H,V,W)=>{let N=i.layout;V[V.length-1].type==="SET_VARIABLES_MODAL"&&(N=1);let[Z,J]=await Promise.all([H_.getLocalSettings(),BC.getBetaSettings()]);return Z.chatMode!=="pro_chat"&&(N=1,i.setLayout(1)),await Promise.all(d.slice(0,N).map(async(K,Q)=>{let M=Q===0?S:b[Q],ge=Rh(M)?await y(Q):M,P=De(V).map($=>($.parameters.ActionChatMessageOperationType==="add"&&$.parameters.ActionChatMessageConfig&&($.parameters.ActionChatMessageConfig.conversationId=K,$.parameters.ActionChatMessageType==="system"&&($.parameters.ActionChatMessageConfig.originalMessage={...$.parameters.ActionChatMessageConfig.originalMessage,metadata:{...$.parameters.ActionChatMessageConfig.originalMessage?.metadata,AIModel:ge.AIModel}})),$.parameters.AskChatGPTActionQuestion&&($.parameters.AskChatGPTActionQuestion.conversationId=K),$));return J.appearance_v2_enabled?m.current.askAIWithShortcutsV2(P,{...W,conversationId:K,disabledMaxAIDocumentIds:!0,onBeforeRun:async()=>{await I(K,Q)}}):m.current.askAIWithShortcuts(P,{...W,conversationId:K,onBeforeRun:async()=>{await I(K,Q)}})})),null},[d,S,b,y,I]),E=(0,Er.useCallback)(()=>(d.forEach(H=>{m.current.stopGenerate(H)}),!0),[d]),O=(0,Er.useMemo)(()=>m_(H=>({...i,onRunShortcutsActions:w,onStopShortcutsActions:E})),[]);(0,Er.useEffect)(()=>{O.setState({...i,onRunShortcutsActions:w,onStopShortcutsActions:E})},[i,w,E]);let{chatHubLoading:L}=yt(),G=(0,Er.useMemo)(()=>{let H=o?.(f,0,{conversationId:f});return{...H,textareaProps:{...H?.textareaProps,disabled:H?.textareaProps?.disabled||L},sendButtonProps:{...H?.sendButtonProps,loading:H?.sendButtonProps?.loading||L}}},[o,f,L]);return Er.default.createElement(Y_.Provider,{value:O},Er.default.createElement(g,{sx:{flexShrink:0,"--max-width":"768px"}},Er.default.createElement(R1,{chatHubOrder:0,inputMediator:Qt(s),variant:"chatHubInput",conversationId:f,toolsProps:r?.(f,0,{conversationId:f}),inputProps:G,footerProps:t?.(f,0,{conversationId:f}),footerPrefix:n?.(f,0,{conversationId:f})}),Er.default.createElement(fz,null)))},bT=hz;var gz=e=>{let{chatHubSlot:t,children:o,...r}=e,n=be(a=>({conversationIds:a.conversationIds,layout:a.layout,conversationType:a.conversationType})),i=(0,Qs.useMemo)(()=>{let a={flex:1,height:0,display:"flex",flexDirection:"row",flexWrap:"wrap"};return n.layout===1?{...a,"& > div":{width:"100%",maxWidth:"100%",height:"100%",borderBottom:"1px solid",borderRight:"1px solid",borderColor:"border.main",display:"none!important","&:nth-of-type(-n+1)":{display:"flex!important"}}}:n.layout===2?{...a,"& > div":{width:"50%",maxWidth:"50%",height:"100%",borderBottom:"1px solid",borderRight:"1px solid",borderColor:"border.main",display:"none!important","&:nth-of-type(-n+2)":{display:"flex!important"},"&:nth-of-type(2n)":{borderRight:"none"}}}:n.layout===3?{...a,"& > div":{width:"33.33%",maxWidth:"33.33%",height:"100%",borderBottom:"1px solid",borderRight:"1px solid",borderColor:"border.main",display:"none!important","&:nth-of-type(-n+3)":{display:"flex!important"},"&:nth-of-type(3n)":{borderRight:"none"}}}:n.layout===4?{...a,"& > div":{maxWidth:"50%",width:"50%",height:"50%",borderBottom:"1px solid",borderRight:"1px solid",borderColor:"border.main",display:"none!important","&:nth-of-type(-n+4)":{display:"flex!important"},"&:nth-of-type(2n),&:nth-of-type(4n)":{borderRight:"none"}}}:n.layout===6?{...a,"& > div":{maxWidth:"33.33%",width:"33.33%",height:"50%",borderBottom:"1px solid",borderRight:"1px solid",borderColor:"border.main",display:"none!important","&:nth-of-type(-n+6)":{display:"flex!important"},"&:nth-of-type(3n),&:nth-of-type(6n)":{borderRight:"none"}}}:a},[n.layout]);return n.conversationIds.length<=1||n.layout===1?Qs.default.createElement(g,{className:"maxai-client--chat-hub--container",flex:1,width:"100%",height:"100%",sx:{backgroundColor:"background.default"}},S2(o)?o.slice(0,1):o):Qs.default.createElement(g,{className:"maxai-client--chat-hub--container",flex:1,width:"100%",height:"100%",sx:{flexDirection:"column",backgroundColor:"background.default"}},t,Qs.default.createElement(g,{sx:i},o),Qs.default.createElement(bT,{...r}))},ST=gz;var xz=e=>{let{variant:t,leftPanelSide:o="flexbox",leftPanelContent:r,rightPanelSide:n="flexbox",rightPanelContent:i,chatHubSlot:a,chatHubSx:s,disableFileDrag:l=!1,children:c,onPanelClose:p,headerProps:u,footerProps:m,inputProps:d,toolsProps:f,footerPrefix:h,messageProps:C,sx:x}=e,{conversationIds:_,conversationType:y,layout:b}=be(w=>({conversationIds:w.conversationIds,conversationType:w.conversationType,layout:w.layout})),S=xa.default.useRef(null),I=(w,E)=>{if(!E)return null;if(w==="separateWindow"&&S.current)return xa.default.createElement(zd,{reference:S.current,sx:{top:0}},E);if(w==="flexbox")return xa.default.createElement(g,{flex:1,sx:{"&:empty":{display:"none"}}},E);if(w==="custom")return E;if(w==="drawer"&&S.current)return xa.default.createElement(Nd,{onClose:p},E)};return xa.default.createElement(yT,{className:"maxai--chat-hub",containerRef:S,disabled:l,sx:{width:"100%",height:"100%",flex:1,flexDirection:"row","& *":{boxSizing:"border-box"},...s}},!l&&xa.default.createElement(CT,null),I(o,r),xa.default.createElement(ST,{chatHubSlot:a,...e},_.map((w,E)=>xa.default.createElement(R1,{inputMediator:Qt(y),chatHubOrder:E,variant:t||(b>1?"chatHub":"normal"),conversationId:w,key:_.length===1?E:w,headerProps:u?.(w,E,{conversationId:w}),footerProps:m?.(w,E,{conversationId:w}),inputProps:d?.(w,E,{conversationId:w}),toolsProps:f?.(w,E,{conversationId:w}),footerPrefix:h?.(w,E,{conversationId:w}),messageProps:C?.(w,E,{conversationId:w}),sx:x?.(w,E,{conversationId:w})},c))),I(n,i))},IT=xz;var Ar=v(A());var gs=v(A());var _z=()=>{let[{stack:e},t]=bi(sb),o=wi(e),r=!!o,{t:n}=k(["client","common"]),i=(0,gs.useCallback)(async p=>{o&&(await ob.send("DiscardModalClose",{discardId:o.discardId,confirm:p==="confirm",cancel:p==="cancel"}),t(u=>({...u,stack:u.stack.slice(0,u.stack.length-1)})))},[o,t]),a=(0,gs.useCallback)(()=>i("confirm"),[i]),s=(0,gs.useCallback)(()=>i("cancel"),[i]),l=st(s),c=st(r);return(0,gs.useEffect)(()=>{let p=u=>{c.current&&u.key==="Escape"&&(u.stopPropagation(),u.preventDefault(),l.current?.())};return window.addEventListener("keydown",p,!0),()=>{window.removeEventListener("keydown",p)}},[c,l]),gs.default.createElement(Gi,{show:r,title:o?.content||"",onConfirm:a,onClose:s,modalSx:{zIndex:2147483621},wrapSx:{width:"288px"},variant:"danger",confirmBtnText:n("common:discard"),cancelBtnText:n("common:cancel"),isFixed:!0})},vT=_z;var he=v(A());var et=v(A());var Rc=24,wT=8,Cz=(e=window.innerHeight*.5)=>Math.max(Math.floor(e/24)||5),Js=(e,t=0,o=0,r=0,n)=>{let i=e?.parentElement?.parentElement;if(e&&i){let a=window.getComputedStyle(e),s=Number(e.getAttribute("data-min-line"))||1,l=parseInt(a.paddingTop??wT,10)+parseInt(a.paddingBottom??wT,10);e.style.cssText="height:0px";let c=e.value?e.scrollHeight:Rc*s+l,p=Math.min(Rc*Cz(n),c);r===0&&(r=e?.previousElementSibling?.offsetHeight||0);let u=Math.max(Rc*s+l,r||0);p=Math.max(u,p),e.style.cssText=`height: ${p}px`;let m=p+t+o;i.style.cssText=`height: ${m}px`}},yz=(e,t=0,o=0,r=0,n)=>{Js(e,t,o,r,n),setTimeout(()=>{Js(e,t,r,n);let i=e.value;e.focus(),e.setSelectionRange(i.length,i.length)},100)},W1=(e,t=0,o=0,r=0)=>{if(!e)return;let n="",i=document.querySelector('div[data-testid=sentinelStart][tabindex="0"]');if(i?.nextElementSibling&&i.nextElementSibling.getAttribute("tabindex")==="-1"&&(n="mui",i.nextElementSibling.removeAttribute("tabindex")),window.location.host==="www.linkedin.com"){let a=document.querySelector('div[tabindex="-1"][role="dialog"]');a&&(n="linkedin",a.removeAttribute("tabindex"),document.activeElement?.blur(),setTimeout(()=>{a.setAttribute("tabindex","-1")},100))}e.isSameNode(R_())||e.isSameNode(U_())||yz(e,t,o,r)},bz=e=>{let{defaultValue:t,onChange:o,onEnter:r,onKeydown:n,onKeydownCapture:i,loading:a,children:s,error:l=!1,InputId:c=il,stopPropagation:p=!0,placeholder:u="Ask AI...",expandNode:m,sx:d,minLine:f=1,maxHeight:h,autoFocus:C,prefixNode:x,onControlledValueChange:_}=e,y=Zt(G2),{currentSidebarConversationId:b,currentSidebarConversationType:S}=Rl(),I=Zt(Nl),w=(0,et.useRef)(null),E=(0,et.useRef)(!1),O=(0,et.useRef)(!1),[L,G]=(0,et.useState)(t||""),H=(0,et.useRef)(0),V=(0,et.useRef)(0),W=(0,et.useRef)(0),N=(0,et.useRef)(null),Z=(0,et.useRef)(null),J=(0,et.useRef)(null),K=(0,et.useMemo)(()=>oi(Js,200),[]),Q=(0,et.useRef)(ap()),M=$=>[H.current,W.current,V.current,h],le=(0,et.useCallback)($=>{let j=$.target.value;c===il?Qt("chatBoxInputMediator").updateInputValue(j):c===yi&&Qt("floatingMenuInputMediator").updateInputValue(j),G(j),o&&o(j,{includeHistory:!O.current})},[o]),ge=(0,et.useRef)({});(0,et.useEffect)(()=>{if(c===il){let $=(j,de)=>{de&&(ge.current=de),j.startsWith("``NO_HISTORY_&#``\n")&&(j=j.replace("``NO_HISTORY_&#``\n",""),O.current=!0),G(j)};return Qt("chatBoxInputMediator").subscribe($),()=>{Qt("chatBoxInputMediator").unsubscribe($)}}else if(c===yi){let $=(j,de)=>{j.startsWith("``NO_HISTORY_&#``\n")&&(j=j.replace("``NO_HISTORY_&#``\n",""),O.current=!0),G(j),de?.selectAll&&setTimeout(()=>{w.current?.focus(),w.current?.setSelectionRange(0,j.length)},50)};return Qt("floatingMenuInputMediator").subscribe($),()=>{Qt("floatingMenuInputMediator").unsubscribe($)}}},[c]),(0,et.useEffect)(()=>{O.current=!1,ge.current={}},[a]),(0,et.useEffect)(()=>{K(w.current,...M("inputValue1")),setTimeout(()=>{w.current&&Js(w.current,...M("inputValue2"))},0)},[L]),(0,et.useEffect)(()=>{let $=new ResizeObserver(re=>{for(let ce of re)setTimeout(()=>{H.current=ce.target?.offsetHeight||0,w.current&&Js(w.current,...M("children"))},30)}),j=new ResizeObserver(()=>{setTimeout(()=>{(J.current?.offsetHeight??0)!==W.current&&(W.current=J.current?.offsetHeight||0,w.current&&Js(w.current,...M()))},0)}),de=new ResizeObserver(re=>{for(let ce of re)setTimeout(()=>{V.current=ce.target?.offsetHeight||0,w.current&&Js(w.current,...M("expand"))},100)});return Z.current&&de.observe(Z.current),N.current&&$.observe(N.current),J.current&&j.observe(J.current),()=>{$.disconnect(),de.disconnect(),j.disconnect()}},[]),(0,et.useEffect)(()=>{I&&w.current&&c===yi&&W1(w.current,...M("floatingDropdownMenu"))},[I]),(0,et.useEffect)(()=>{(y.open||Q.current)&&w.current&&c===il&&!Hm()&&W1(w.current,...M("appState"))},[y.open,a,S,b]),Lr(()=>{if(c===il&&Q.current){let $=setTimeout(()=>{W1(w.current,...M("appState"))},100);return()=>clearTimeout($)}});let P=qm(_);return(0,et.useEffect)(()=>{P.current?.(L,c)},[c,L,P]),et.default.createElement(F,{component:"div",className:a?"chat-box__input--loading":"",borderRadius:"8px",border:"1px solid",borderColor:`${l?"rgb(239, 83, 80)":"border.main"}`,width:"100%",minHeight:34,sx:{display:"flex",alignItems:"center",flexDirection:"row",flexWrap:"wrap",overflow:"hidden","& .chat-box__input-skeleton":{opacity:0,zIndex:-1,position:"absolute",top:0,padding:"8px",left:0,width:"100%",display:"none"},"&.chat-box__input--loading":{maxHeight:"106.5px",overflow:"hidden",position:"relative","& textarea":{opacity:0},"& .chat-box__input-skeleton":{opacity:1,zIndex:1,display:"block"}},...d}},et.default.createElement(F,{component:"div",className:"chat-box__input-skeleton"},et.default.createElement(Co,{height:Rc})),et.default.createElement(F,{ref:J,className:"chat-box__input\u2014prefix",sx:{width:"100%"}},x),et.default.createElement(g,{alignItems:"start",width:"100%",direction:"row",sx:{"& > textarea":{p:1,maxHeight:a?Rc*f+16:"unset",color:$=>$.palette.mode==="dark"?"#fff":"rgba(0,0,0,.87)!important",my:1.5,fontSize:"16px",lineHeight:Rc+"px",background:"transparent!important",borderColor:"transparent!important",margin:"0!important",border:"0!important",outline:"0!important",boxShadow:"none!important",width:"100%",resize:"none",overflow:"hidden",overflowY:"auto",fontFamily:'"Roboto","Helvetica","Arial",sans-serif!important',"&::-webkit-scrollbar":{width:0,background:"transparent"},"&::-webkit-scrollbar-thumb":{background:"transparent"}}}},et.default.createElement(g,{ref:Z,className:"max-ai-user-input__expand",sx:{"&:has(> div)":{py:1,pl:1},alignSelf:"start"}},m),et.default.createElement("textarea",{id:c,placeholder:u,disabled:a,ref:w,value:L,rows:1,"data-min-line":f,onCopy:$=>{$.stopPropagation()},onCut:$=>{$.stopPropagation()},onKeyUp:$=>{p&&$.stopPropagation()},onKeyPress:$=>{p&&$.stopPropagation()},onKeyDown:$=>{if(!(i&&i($))){if(p){if(($.key==="ArrowUp"||$.key==="ArrowDown"||$.key==="ArrowLeft"||$.key==="ArrowRight"||$.key==="Escape")&&c===yi)return;$.stopPropagation()}if(!E.current){if(!($.key==="Enter"&&$.shiftKey)){if($.key==="Enter"){$.preventDefault();let j=$.currentTarget.value;r&&r(j,{includeHistory:!O.current,meta:ge.current}),O.current=!1,ge.current={}}else if($.code==="Space"){$.stopPropagation();return}}n&&n($)}}},onClick:$=>{W1($.currentTarget,...M("click"))},onCompositionUpdate:$=>{p&&$.stopPropagation()},onCompositionStart:$=>{p&&$.stopPropagation(),E.current=!0},onCompositionEnd:$=>{p&&$.stopPropagation(),E.current=!1,le($)},onInput:$=>{p&&$.stopPropagation(),E.current?G($.currentTarget.value):le($)},onBlur:$=>{K($.currentTarget,...M("blur"))},autoFocus:C})),et.default.createElement(g,{ref:N,width:"100%"},s))},TT=bz;var gu=v(A());var Lx=()=>{let{t:e}=k(["client"]),{setUserSettings:t,userSettings:o}=Yr(),{conversationId:r="",conversationMessages:n}=ue(),{getConversation:i}=ct(),{continueConversationInSidebar:a}=Rl(),{floatingDropdownMenuOpen:s}=Ga(),l=o?.alwaysContinueInSidebar,c=async()=>{let p=!l,u=await i(r);u?.lastMessageId&&p&&a(u.id),await t({...o,alwaysContinueInSidebar:p})};return!s||n.length?null:gu.default.createElement(Fn,{title:e(l?"floating_menu__always_unpin_to_sidebar":"floating_menu__always_pin_to_sidebar"),onClick:c,floatingMenuTooltip:!0,placement:"top"},gu.default.createElement("span",null,gu.default.createElement(fe,{"data-testid":l?"maxai--context-window--always-responses-in-contextmenu--button":"maxai--context-window--always-responses-in-sidebar--button",sx:{width:32,height:32}},gu.default.createElement(X,{icon:l?"AlwaysResponsesInContextMenu":"AlwaysResponsesInSidebar"}))))};var G1=v(A());var Ox=e=>{let{sx:t,TooltipProps:o}=e,{t:r}=k(["client"]),{hideFloatingContextMenu:n}=Ga(),{betaSettings:i}=Yo();if(i?.appearance_v2_enabled)return null;let a=async()=>{let s=nm();if(s){n(),ta();let l=await Kh(s,'button[data-testid="maxai--sidebar--contextmenu_tab"]',50,5e3);if(!l)return;l?.click(),await new Promise(p=>setTimeout(p,1e3)),(await Kh(s,'button[data-testid="maxai-chat-history-button"]',50,5e3))?.click()}};return G1.default.createElement(Fn,{title:r("client:sidebar__speed_dial__chat_history__button"),placement:"bottom",...o},G1.default.createElement(Xe,{onClick:a,"data-testid":"maxai-context-window-history-button",sx:{width:"28px",height:"28px",color:"text.primary",minWidth:"unset",borderRadius:"8px",border:"1px solid",borderColor:"border.main",...t},TouchRippleProps:{center:!1}},G1.default.createElement(X,{icon:"History",sx:{fontSize:"20px"}})))};var qi=v(A());var j1={ChatInSidebar:{value:"chat-in-sidebar",label:"client:context_menu__button__chat_in_sidebar__title",icon:qi.default.createElement(X,{icon:"ChatInSidebar"})},AlwaysChatInSidebar:{value:"always-chat-in-sidebar",label:"client:context_menu__button__always_chat_in_sidebar__title",icon:qi.default.createElement(X,{icon:"AlwaysResponsesInSidebar"})}},Bx=()=>{let{t:e}=k(),{setUserSettings:t,userSettings:o}=Yr(),{conversationId:r,conversationMessages:n}=ue(),{continueConversationInSidebar:i}=Rl(),a=(0,qi.useMemo)(()=>Object.values(j1).map(c=>({...c,label:e(c.label)})),[e]),s=(0,qi.useMemo)(()=>o?.alwaysContinueInSidebar?j1.AlwaysChatInSidebar:j1.ChatInSidebar,[o]),l=async c=>{r&&(i(r),c===j1.AlwaysChatInSidebar.value&&await t({...o,alwaysContinueInSidebar:!0}))};return n.length?qi.default.createElement(ts,{isMirror:!0,hoverOpen:!0,placement:"bottom-start",headless:!0,referenceElement:qi.default.createElement(fe,{"data-testid":"maxai-context-window-continue-chat-button",onClick:c=>{c.stopPropagation(),l(s.value)}},s.icon,qi.default.createElement(T,{sx:{fontSize:"14px"}},e(s.label))),sx:{zIndex:2147483602},modifiers:[{name:"offset",options:{offset:[0,6]}}]},qi.default.createElement(Ol,{sx:{width:"240px"},defaultValue:s.value,options:a,onSelectOption:l})):null};var Fx=v(A());var Iz=v(A());var MT=v(va()),xs=v(A());var zPe=e=>xs.default.createElement(MT.default,{...e},xs.default.createElement("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},xs.default.createElement("path",{d:"M6.38095 14.8256L5.71627 11.8449H6.39567L6.78114 13.8211L7.24333 11.8449H7.82387L8.2904 13.8233L8.67364 11.8449H9.35093L8.68626 14.8256H7.98793L7.53225 12.9908L7.08348 14.8256H6.38095Z",fill:"currentColor"}),xs.default.createElement("path",{d:"M10.9345 14.8256L10.2699 11.8449H10.9493L11.3347 13.8211L11.7969 11.8449H12.3775L12.844 13.8233L13.2272 11.8449H13.9045L13.2398 14.8256H12.5415L12.0858 12.9908L11.6371 14.8256H10.9345Z",fill:"currentColor"}),xs.default.createElement("path",{d:"M15.4881 14.8256H16.1906L16.6394 12.9908L17.0951 14.8256H17.7934L18.4581 11.8449H17.7808L17.3976 13.8233L16.931 11.8449H16.3505L15.8883 13.8211L15.5028 11.8449H14.8234L15.4881 14.8256Z",fill:"currentColor"}),xs.default.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M17.6308 10.0915H19.7672C20.2492 10.0915 20.6399 10.484 20.6399 10.9682V15.3516C20.6399 15.8358 20.2492 16.2283 19.7672 16.2283H17.7263C16.6592 18.2615 14.5343 19.6474 12.0872 19.6474C9.64007 19.6474 7.5152 18.2615 6.44802 16.2283H4.40718C3.92519 16.2283 3.53446 15.8358 3.53446 15.3516V10.9682C3.53446 10.484 3.92519 10.0915 4.40718 10.0915H6.54358C7.63879 8.15442 9.71108 6.84773 12.0872 6.84773C14.4633 6.84773 16.5356 8.15442 17.6308 10.0915ZM10.4088 7.6193C9.05129 8.02721 7.90098 8.91722 7.15483 10.0915H9.04299C9.18875 9.61479 9.36687 9.17588 9.5724 8.78527C9.81055 8.33266 10.0917 7.93482 10.4088 7.6193ZM9.59245 10.0915H11.8254V7.39749C11.1699 7.51643 10.5359 8.07982 10.0353 9.03108C9.86806 9.349 9.71911 9.70472 9.59245 10.0915ZM12.349 10.0915H14.5819C14.4553 9.70472 14.3063 9.349 14.139 9.03108C13.6385 8.07982 13.0045 7.51643 12.349 7.39749V10.0915ZM15.1314 10.0915H17.0195C16.2734 8.91722 15.1231 8.02721 13.7655 7.6193C14.0826 7.93482 14.3638 8.33266 14.602 8.78527C14.8075 9.17588 14.9856 9.61479 15.1314 10.0915ZM7.04767 16.2283C7.78831 17.4892 8.98451 18.4479 10.4088 18.8759C10.0917 18.5603 9.81055 18.1625 9.5724 17.7099C9.34191 17.2718 9.14588 16.773 8.99133 16.2283H7.04767ZM9.5372 16.2283C9.67503 16.6833 9.84308 17.0987 10.0353 17.4641C10.5359 18.4153 11.1699 18.9787 11.8254 19.0977V16.2283H9.5372ZM12.349 16.2283V19.0977C13.0045 18.9787 13.6385 18.4153 14.139 17.4641C14.3313 17.0987 14.4993 16.6833 14.6372 16.2283H12.349ZM15.183 16.2283C15.0285 16.773 14.8325 17.2718 14.602 17.7099C14.3638 18.1625 14.0826 18.5603 13.7655 18.8759C15.1899 18.4479 16.3861 17.4892 17.1267 16.2283H15.183ZM4.05809 10.9682C4.05809 10.7745 4.21439 10.6175 4.40718 10.6175H19.7672C19.96 10.6175 20.1163 10.7745 20.1163 10.9682V15.3516C20.1163 15.5453 19.96 15.7023 19.7672 15.7023H4.40718C4.21439 15.7023 4.05809 15.5453 4.05809 15.3516V10.9682Z",fill:"currentColor"}),xs.default.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M1.96355 2.72728C1.48159 2.72728 1.09082 3.11978 1.09082 3.60397V20.0858C1.09082 20.7636 1.63785 21.3131 2.31264 21.3131H21.6872C22.362 21.3131 22.909 20.7636 22.909 20.0858V3.60397C22.909 3.11978 22.5182 2.72728 22.0363 2.72728H1.96355ZM1.789 20.0858V5.88337H22.2108V20.0858C22.2108 20.3763 21.9764 20.6118 21.6872 20.6118H2.31264C2.02344 20.6118 1.789 20.3763 1.789 20.0858ZM3.18537 4.30532C3.18537 4.59584 2.95091 4.83134 2.66173 4.83134C2.37255 4.83134 2.13809 4.59584 2.13809 4.30532C2.13809 4.01481 2.37255 3.77931 2.66173 3.77931C2.95091 3.77931 3.18537 4.01481 3.18537 4.30532ZM4.58173 4.30532C4.58173 4.59584 4.34727 4.83134 4.05809 4.83134C3.76892 4.83134 3.53446 4.59584 3.53446 4.30532C3.53446 4.01481 3.76892 3.77931 4.05809 3.77931C4.34727 3.77931 4.58173 4.01481 4.58173 4.30532ZM5.45446 4.83134C5.74363 4.83134 5.97809 4.59584 5.97809 4.30532C5.97809 4.01481 5.74363 3.77931 5.45446 3.77931C5.16528 3.77931 4.93082 4.01481 4.93082 4.30532C4.93082 4.59584 5.16528 4.83134 5.45446 4.83134ZM20.1163 4.30532C20.1163 4.20849 20.1944 4.12999 20.2908 4.12999H21.6872C21.7836 4.12999 21.8617 4.20849 21.8617 4.30532C21.8617 4.40215 21.7836 4.48066 21.6872 4.48066H20.2908C20.1944 4.48066 20.1163 4.40215 20.1163 4.30532Z",fill:"currentColor"})));var Dx=v(A());var Ho=v(A());var Hx=({onRegenerate:e})=>{let{conversationId:t}=ue(),o=ye(t),r=(0,Ho.useRef)(!1),{currentFloatingContextMenuDraft:n}=Dr(),i=(0,Ho.useMemo)(()=>!!(o&&n),[o,n]),{stopGenerate:a,regenerate:s}=ze(),l=(0,Ho.useRef)(s),c=(0,Ho.useRef)(a);l.current=s,c.current=a;let p=(0,Ho.useCallback)(async u=>{u==="s"&&(r.current=!1,await c.current()),u==="r"&&(r.current=!0,await c.current(),e?.(),await l.current(t))},[t]);return(0,Ho.useEffect)(()=>{if(!i)return;let u=async m=>{let d=m.key;Hm()&&["r","s","o","c"].includes(d)&&(m.preventDefault(),m.stopPropagation(),await p(d))};return window.addEventListener("keydown",u),()=>{window.removeEventListener("keydown",u)}},[i,p]),i?Ho.default.createElement(g,{direction:"row",spacing:1,sx:{ml:"auto!important","& .usechatgpt-floating-menu__button__shortcut":{fontSize:"12px",opacity:.7,ml:"4px"}}},Ho.default.createElement(Ce,{sx:{height:"24px"},variant:"text",onClick:async()=>{await p("r")}},Ho.default.createElement(T,{component:"span",fontSize:"14px",color:"primary.main"},"Try again",Ho.default.createElement("span",{className:"usechatgpt-floating-menu__button__shortcut"},"R"))),Ho.default.createElement(Ce,{sx:{height:"24px"},variant:"text",onClick:async()=>{await p("s")}},Ho.default.createElement(T,{component:"span",fontSize:"14px",color:"primary.main"},"Stop",Ho.default.createElement("span",{className:"usechatgpt-floating-menu__button__shortcut"},"S")))):Ho.default.createElement(Ho.default.Fragment,null)};var pt=v(A());var ET=(0,pt.forwardRef)((e,t)=>{let{t:o}=k(["prompt","client"]),{draftUserMessage:r}=Dr(),n=(0,pt.useMemo)(()=>{let i=r?.meta?.MaxAIPromptActionConfig?.prompt_id;if(i)return pt.default.createElement(g,{fontSize:"14px",direction:"column",alignItems:"flex-start"},pt.default.createElement(F,null,o(`prompt:${i}`)),pt.default.createElement(F,null,o("client:floating_menu__contextmenu__click_to_retry")));let a=r?.text?.replace(/^(.*?)\s*:\s*""".*?"""/s,"$1");return a?pt.default.createElement(g,{fontSize:"14px",direction:"column",alignItems:"flex-start"},pt.default.createElement(F,null,a),pt.default.createElement(F,null,o("client:floating_menu__contextmenu__click_edit_prompt_and_retry"))):""},[r]);return pt.default.createElement(Fn,{title:n,placement:"right",floatingMenuTooltip:!0,slotProps:{popper:{modifiers:[{name:"offset",options:{offset:[0,3]}}]}}},pt.default.createElement(Xm,{...e,label:o("package__features:context_menu__prompt__6b9f9cb4-b1b1-4897-9156-903dbc52b2a1"),menuItem:e.menuItem,ref:t}))});ET.displayName="TryAgainItem";var xu=(0,pt.forwardRef)((e,t)=>{let{menuItem:o,root:r,referenceElement:n,referenceElementOpen:i,rootMenu:a,customOpen:s,onClickContextMenu:l,menuWidth:c,...p}=e,{t:u}=k(),m=(0,pt.useCallback)(f=>{let h=`context_menu__prompt__${f.prompt_id.replace(ir,"")}`,C=`package__features:${h}`,x=u(C);return x!==C&&x!==h?x:f.prompt_title},[u]),d=(0,pt.useMemo)(()=>m(o),[o.prompt_title,m]);return o.type==="group"?pt.default.createElement(cp,{zIndex:e.zIndex,ref:t,root:r,label:d,menuWidth:c,onClickContextMenu:l,referenceElement:pt.default.createElement(Xm,{...p,label:d,menuItem:o}),needAutoUpdate:p.needAutoUpdate},(o.children??[]).map(f=>pt.default.createElement(xu,{...p,root:r,key:f.prompt_id,menuItem:f}))):o.prompt_id===Bl.TRY_AGAIN?pt.default.createElement(ET,{...p,menuItem:o,ref:t}):pt.default.createElement(Xm,{...p,label:d,menuItem:o,ref:t})});xu.displayName="RenderDropdownItem";var q1=e=>pt.default.createElement(F,{"data-testid":"max-ai-context-menu-divider","aria-disabled":!0,key:`${e}_group_spector`,onClick:t=>{t.stopPropagation(),t.preventDefault()},component:"div",sx:{pointerEvents:"none",borderTop:"1px solid",borderColor:"border.main",my:.5}}),vz=e=>{let{root:t,referenceElement:o,referenceElementOpen:r,referenceElementRef:n,menuList:i,customOpen:a,needAutoUpdate:s,defaultPlacement:l,defaultFallbackPlacements:c,onClickContextMenu:p,menuWidth:u,onClickReferenceElement:m,hoverOpen:d,hoverIcon:f,isFirstLevelFlatten:h=!0,...C}=e,{t:x}=k(),_=(0,pt.useMemo)(()=>{let y=[];return i.forEach((b,S)=>{let I=`context_menu__prompt__${b.prompt_id.replace(ir,"")}`,w=`package__features:${I}`,E=x(w);E=E!==w&&E!==I?E:b.prompt_title,b.type==="group"&&h?(S>0&&y.push(q1(b.prompt_id)),y.push(pt.default.createElement(F,{key:b.prompt_id+"_group_name",component:"div","aria-disabled":!0,"data-testid":`max-ai-context-menu-group-label__${b.prompt_id}`,sx:{display:"flex",justifyContent:"space-between",alignItems:"center",width:"100%",boxSizing:"border-box",direction:"row",pl:"8px"},onMouseDownCapture:O=>{O.stopPropagation(),O.preventDefault()}},pt.default.createElement(F,{sx:{p:"6px 0 8px 0",pointerEvents:"none"}},pt.default.createElement(T,{textAlign:"left",fontSize:12,color:"text.secondary"},E)),b.prompt_id===ir&&pt.default.createElement(cc,null))),(b.children??[]).forEach((O,L)=>{Wh.includes(O.prompt_id)&&y.push(q1(b.prompt_id)),y.push(pt.default.createElement(xu,{menuWidth:u,hoverIcon:f,onClickContextMenu:p,zIndex:2147483602,needAutoUpdate:s,...C,key:O.prompt_id,menuItem:O,root:t}))})):b.type==="chat_complete"?(S>0&&y.push(q1(b.prompt_id)),y.push(pt.default.createElement(xu,{menuWidth:u,hoverIcon:f,onClickContextMenu:p,needAutoUpdate:s,key:b.prompt_id,menuItem:b,root:t,zIndex:2147483602}))):(Wh.includes(b.prompt_id)&&y.push(q1(b.prompt_id)),y.push(pt.default.createElement(xu,{menuWidth:u,hoverIcon:f,onClickContextMenu:p,needAutoUpdate:s,key:b.prompt_id,menuItem:b,root:t,zIndex:2147483602})))}),y},[i,x,h]);return pt.default.createElement(cp,{zIndex:2147483601,label:"",root:t,customOpen:a,needAutoUpdate:s,referenceElement:o,referenceElementOpen:r,referenceElementRef:n,defaultPlacement:l,defaultFallbackPlacements:c,onClickContextMenu:p,onClickReferenceElement:m,hoverOpen:d,menuWidth:u,hoverIcon:f},r===!1?null:_)},AT=vz;var Zn=v(A());var PT="context-menu-dom-event-manager";var OT=v(On()),BT=v(kT()),FT=v(LT());var Ki=v(A());var kz=({loading:e})=>{let{t}=k(["common","client"]),{hideFloatingContextMenu:o}=Km(),{floatingDropdownMenuPin:r,setFloatingDropdownMenuPin:n}=lb(),i=()=>{n(!r)};return Ki.default.createElement(Ki.default.Fragment,null,Ki.default.createElement(Fn,{title:t(r?"client:floating_menu__pin_button__pinned__title":"client:floating_menu__pin_button__unpinned__title"),placement:"top",floatingMenuTooltip:!0},Ki.default.createElement(Xe,{"data-testid":"maxai-context-window-pin-button",size:"small",sx:{width:28,height:28,color:"text.secondary","&:hover":{color:"text.primary"},padding:"0 3px"},onClick:i},r?Ki.default.createElement(BT.default,{sx:{fontSize:16,transform:"rotate(45deg)"},color:"primary"}):Ki.default.createElement(FT.default,{sx:{fontSize:16,transform:"rotate(45deg)"}}))),Ki.default.createElement(Fn,{title:t("client:floating_menu__close_button__title"),description:"Esc",placement:"top",floatingMenuTooltip:!0},Ki.default.createElement(Xe,{"data-testid":"maxai-context-window-close-button",size:"small",sx:{width:28,height:28,color:"text.secondary","&:hover":{color:"text.primary"},padding:"3px",marginRight:"-3px"},disabled:e,onClick:()=>o(!0)},Ki.default.createElement(OT.default,{sx:{fontSize:17}}))))},X1=kz;var NT=v(DT()),zT=v(HT());var el=v(A());var Nz=()=>{let{activeResponseMessageIndex:e,goToNextMessage:t,goToPreviousMessage:o,totalResponseCount:r}=Dr(),{conversationId:n}=ue(),i=ye(n),a=e===0,s=e===r-1;return r===0?null:el.default.createElement(g,{flexShrink:0,direction:"row",gap:.5,height:"32px",lineHeight:"32px",alignItems:"center"},el.default.createElement(Xe,{sx:{width:"24px",height:"24px"},disabled:i||a,onClick:o},el.default.createElement(NT.default,{sx:{fontSize:"20px",p:"2px",color:"text.secondary",cursor:"pointer",opacity:a?.4:1}})),el.default.createElement(T,{fontSize:"12px",color:"text.secondary",fontWeight:400,lineHeight:"24px"},`${e+1} of ${r}`),el.default.createElement(Xe,{sx:{width:"24px",height:"24px"},disabled:i||s,onClick:t},el.default.createElement(zT.default,{sx:{fontSize:"20px",p:"2px",color:"text.secondary",cursor:"pointer",opacity:s?.4:1}})))},VT=Nz;var zz=({showModelSelector:e,showUsageButton:t,loading:o})=>{let{conversationMessages:r}=ue(),{localSettings:n}=lt(),i=n?.chatMode==="pro_chat",a=()=>{let c=gr()?.querySelector(`#${yi}`);c&&c?.focus()},s=()=>{a()},l=()=>{a()};return Zn.default.createElement(g,{direction:"row",justifyContent:"space-between",alignItems:"center",sx:{wordBreak:"break-word",color:c=>c.palette.mode==="dark"?"#FFFFFFDE":"rgba(0,0,0,0.87)",paddingBottom:r.length?"0":"4px",paddingTop:r.length?"10px":"0"},component:"div"},Zn.default.createElement(g,{direction:"row",gap:"4px",alignItems:"center",flexWrap:"wrap"},Zn.default.createElement(Za,{hideOnboarding:!0,disabled:o}),e&&i&&Zn.default.createElement(rs,{onChanged:s,disabled:!e||o,size:"small",tooltipProps:{placement:"top"},domEventManagerId:PT}),i&&Zn.default.createElement(Qa,{onChanged:l,tooltipProps:{placement:"top"},disabled:o}),Zn.default.createElement(g,{direction:"row",alignItems:"center",gap:"4px","data-testid":"maxai--chat-box--tools--left-container--portal-root",sx:{display:i?"flex":"none","&:empty":{display:"none"}}})),Zn.default.createElement(g,{direction:"row",justifyContent:"end",alignItems:"center",sx:{alignSelf:"flex-start",height:32,gap:.5}},Zn.default.createElement(g,{direction:"row",alignItems:"center"},Zn.default.createElement(Ox,{TooltipProps:{placement:"top",floatingMenuTooltip:!0},sx:{mr:1}}),!o&&!r.length&&Zn.default.createElement(X1,{loading:o}),Zn.default.createElement(VT,null))))},RT=zz;var St=v(A());var Q1=3*24,J1=e=>{let t=e.scrollTop,o=e.scrollHeight,r=e.clientHeight;return Math.abs(r+t-o)>8},Vz=({onChange:e,contextMenuDefaultHeight:t})=>{let o=cl(),r=Zt(Nl),n=ro(ib),{conversationId:i}=ue(),a=ye(i),{currentFloatingContextMenuDraft:s,activeResponseMessage:l}=Dr(),c=(0,St.useRef)(null),p=(0,St.useRef)(null),u=(0,St.useRef)(),[m,d]=(0,St.useState)(!1),f=()=>{let _=p.current;_&&(_.scrollTo(0,_.scrollHeight),d(!1))},h=(0,St.useMemo)(()=>s.replace(/^\s+/,""),[s]);(0,St.useEffect)(()=>{a||(n(_=>({..._,lastOutput:s})),e?.(s))},[s,r,a]),(0,St.useEffect)(()=>{let _=y=>{if((y.metaKey||y.ctrlKey)&&(y.stopPropagation(),y.key==="C"||y.key==="c"||y.key==="x"||y.key==="X")){let b=window.getSelection();if(b&&b.rangeCount>0){let I=b.getRangeAt(0).toString()||b.toString();I&&(y.preventDefault(),navigator.clipboard.writeText(I))}}};p.current?.addEventListener("keydown",_,!0)},[]),(0,St.useEffect)(()=>{let _=p.current;if(!_)return;let y=new ResizeObserver(()=>{d(J1(_))});y.observe(_);let b=oi(()=>{d(J1(_))},100);return _.addEventListener("wheel",b),()=>{y.disconnect(),_.removeEventListener("wheel",b)}},[]);let C=(0,St.useRef)(a);(0,St.useEffect)(()=>{C.current=a},[a]),(0,St.useEffect)(()=>{if(l?.messageId&&u.current!==l.messageId){u.current=l.messageId;let _=p.current,y=_?.clientHeight||0,b=_?.querySelector(".markdown-body")||null;if(_){if(C.current)if(b&&_.clientHeight>Q1){let S=wC(Array.from(b.childNodes).map(I=>{let w=I;return w.clientHeight?w.clientHeight:0}));if(S>=Q1){let I=S+y-Q1;b.style.minHeight=`${I}px`,_&&_.scrollTo({top:S-Q1})}else b.style.minHeight=`${y}px`,_&&_.scrollTo({top:0})}else _.scrollTo({top:_.scrollHeight});else _.scrollTo({top:0});d(J1(_))}}else if(!l){let y=p.current?.querySelector(".markdown-body")||null;y&&(y.style.minHeight="unset")}},[l?.messageId]),(0,St.useEffect)(()=>{let _=p.current;_&&d(J1(_))},[h]);let x=l&&Ji(l);return St.default.createElement(g,{ref:c,className:"chat-message--text max-ai__writing-message-box",whiteSpace:"pre-wrap",width:"100%",sx:{position:"relative",wordBreak:"break-word",borderBottomLeftRadius:0,flex:1,overflowY:"auto",color:_=>_.palette.mode==="dark"?"#FFFFFFDE":"rgba(0,0,0,0.87)","& .markdown-body":{userSelect:"text",overflowY:"auto","*":{fontFamily:'"Roboto","Helvetica","Arial",sans-serif!important'}}},component:"div"},x&&St.default.createElement(a1,{message:l,sx:{boxSizing:"border-box",my:1}}),St.default.createElement(g,{"data-testid":"maxai--contextmenu--writing-message-box",tabIndex:-1,ref:p,sx:{flex:1,height:0,width:"100%",overflowY:"auto"}},l&&ln(l)&&St.default.createElement(Mf,{message:l},St.default.createElement(e1,{message:l})),!x&&St.default.createElement("div",{style:{textAlign:"left",overflowY:"unset",padding:h?"16px 0":"0"},className:`markdown-body ${o.palette.mode==="dark"?"markdown-body-dark":""}`},h?St.default.createElement(Na,{message:l||void 0},h):t?St.default.createElement(St.default.Fragment,null,St.default.createElement(Co,{variant:"text",sx:{fontSize:"1.5rem"}}),St.default.createElement(Co,{variant:"text",sx:{fontSize:"1.5rem"},width:"70%"}),t>218&&St.default.createElement(Co,{variant:"text",sx:{fontSize:"1.5rem"},width:"50%"})):null),m&&St.default.createElement(C1,{onClick:()=>f()})))},UT=Vz;var _s=v(A());var _u={sceneType:"FLOATING_CONTEXT_MENU_INPUT_BOX_AFTER_AI_RESPONSE",id:"ONBOARDING_TOOLTIP__FLOATING_CONTEXT_MENU_INPUT_BOX_AFTER_AI_RESPONSE",anchorElementSelectors:"div#ONBOARDING_TOOLTIP__FLOATING_CONTEXT_MENU_INPUT_BOX__REFERENCE_ELEMENT",CtaButtonClickedName:"Onboarding > ContextMenu > RewriteMenu > Got it"},Rz=e=>{let{showStateTrigger:t,...o}=e,{t:r}=k(),[n,i]=(0,_s.useState)(!1);return(0,_s.useEffect)(()=>{t?Ul(500).then(async()=>{if(!await un(_u.sceneType)){let s=gr();if(pp("FLOATING_CONTEXT_MENU_REPLACE_SELECTION_MENUITEM",s)||pp("FLOATING_CONTEXT_MENU_LIST_BOX",s))return;zn(_u.sceneType).then(()=>{i(!0)})}}):i(!1)},[t]),_s.default.createElement(Et,{hideBackdrop:!0,sx:{visibility:"hidden"},placement:"left",fallbackPlacements:["bottom-start","top-start"],offset:[0,8],trigger:n,anchorElementSelectors:_u.anchorElementSelectors,CtaButtonProps:{"data-button-clicked-name":_u.CtaButtonClickedName},arrowSx:{'&[data-custom-popover-placement*="bottom"]':{marginLeft:"15px"}},id:_u.id,...o},_s.default.createElement(g,null,_s.default.createElement(T,{fontSize:14,lineHeight:1.5},r("onboarding:onboarding_tooltip__FLOATING_CONTEXT_MENU_INPUT_BOX_AFTER_AI_RESPONSE__text1"))))},WT=Rz;var Cs=v(A());var Cu={sceneType:"FLOATING_CONTEXT_MENU_INPUT_BOX",id:"ONBOARDING_TOOLTIP__FLOATING_CONTEXT_MENU_INPUT_BOX",anchorElementSelectors:"div#ONBOARDING_TOOLTIP__FLOATING_CONTEXT_MENU_INPUT_BOX__REFERENCE_ELEMENT",CtaButtonClickedName:"Onboarding > ContextMenu > RewriteMenu > Got it"},Uz=e=>{let{showStateTrigger:t,...o}=e,{t:r}=k(),[n,i]=(0,Cs.useState)(!1);return(0,Cs.useEffect)(()=>{t?Promise.all([un(Cu.sceneType),un("FLOATING_CONTEXT_MENU_LIST_BOX")]).then(async([a,s])=>{if(!a){await Ul(50);let l=gr(),c=!!pp("FLOATING_CONTEXT_MENU_LIST_BOX",l);if(!s||c)return;zn(Cu.sceneType).then(()=>{i(!0)})}}):i(!1)},[t]),Cs.default.createElement(Et,{hideBackdrop:!0,sx:{visibility:"hidden"},placement:"left",fallbackPlacements:["bottom-start","top-start"],trigger:n,anchorElementSelectors:Cu.anchorElementSelectors,CtaButtonProps:{"data-button-clicked-name":Cu.CtaButtonClickedName},arrowSx:{'&[data-custom-popover-placement*="bottom"]':{marginLeft:"10px"}},id:Cu.id,...o},Cs.default.createElement(g,null,Cs.default.createElement(T,{fontSize:14,lineHeight:1.5},r("onboarding:onboarding_tooltip__FLOATING_CONTEXT_MENU_INPUT_BOX__text2"))))},GT=Uz;var _a=v(A());var yu={sceneType:"FLOATING_CONTEXT_MENU_REPLACE_SELECTION_MENUITEM",id:"ONBOARDING_TOOLTIP__FLOATING_CONTEXT_MENU_REPLACE_SELECTION_MENUITEM",anchorElementSelectors:`div[data-id="${Bl.REPLACE_SELECTION}"].floating-context-menu-item`,CtaButtonClickedName:"Onboarding > ContextMenu > ReplaceSelection > Got it"},Wz=e=>{let{showStateTrigger:t,...o}=e,{t:r}=k(),[n,i]=(0,_a.useState)(!1);(0,_a.useEffect)(()=>{t?un(yu.sceneType).then(s=>{s||zn(yu.sceneType).then(()=>{i(!0)})}):i(!1)},[t]);let a={bgcolor:s=>s.palette.mode==="dark"?"rgba(255, 255, 255, 0.16) !important":"rgba(0, 0, 0, 0.08) !important",color:s=>s.palette.mode==="dark"?"rgba(255, 255, 255, 0.7) !important":"rgba(0, 0, 0, 0.7) !important"};return _a.default.createElement(Et,{hideBackdrop:!0,sx:{visibility:"hidden"},placement:"right-start",fallbackPlacements:["right-end","left-start","left-end"],offset:[0,8],trigger:n,anchorElementSelectors:yu.anchorElementSelectors,CtaButtonProps:{"data-button-clicked-name":yu.CtaButtonClickedName},arrowSx:{'&[data-custom-popover-placement*="bottom"]':{marginLeft:"15px"}},id:yu.id,...o},_a.default.createElement(g,{gap:1},_a.default.createElement(T,{fontSize:14,lineHeight:1.5},r("onboarding:onboarding_tooltip__FLOATING_CONTEXT_MENU_REPLACE_SELECTION_MENUITEM__text1")),_a.default.createElement(Ea,{sx:a},"Enter")))},jT=Wz;var qT=v(uM()),KT=v(mM());var vo=v(A());var bu={sceneType:"FLOATING_CONTEXT_MENU_LIST_BOX",id:"ONBOARDING_TOOLTIP__FLOATING_CONTEXT_MENU_LIST_BOX",anchorElementSelectors:"div[role=menu].dropdown-menu",CtaButtonClickedName:"Onboarding > ContextMenu > RewriteMenu > Got it"},Gz=e=>{let{showStateTrigger:t,...o}=e,{t:r}=k(),[n,i]=(0,vo.useState)(!1),a={bgcolor:s=>s.palette.mode==="dark"?"rgba(255, 255, 255, 0.16) !important":"rgba(0, 0, 0, 0.08) !important",color:s=>s.palette.mode==="dark"?"rgba(255, 255, 255, 0.7) !important":"rgba(0, 0, 0, 0.7) !important"};return(0,vo.useEffect)(()=>{t?Ul(500).then(()=>{un(bu.sceneType).then(s=>{s||zn(bu.sceneType).then(()=>{i(!0)})})}):i(!1)},[t]),vo.default.createElement(Et,{hideBackdrop:!0,sx:{visibility:"hidden"},placement:"left",fallbackPlacements:["right","bottom","top"],trigger:n,anchorElementSelectors:bu.anchorElementSelectors,CtaButtonProps:{"data-button-clicked-name":bu.CtaButtonClickedName},id:bu.id,...o},vo.default.createElement(g,{spacing:"4px"},vo.default.createElement(g,{direction:"row",alignItems:"center",spacing:.5},vo.default.createElement(T,{fontSize:14,lineHeight:1.5},r("onboarding:onboarding_tooltip__FLOATING_CONTEXT_MENU_LIST_BOX__text1__part1")),vo.default.createElement(Ea,{sx:a},vo.default.createElement(qT.default,{sx:{fontSize:"12px",transform:"scale(1.6)"}})),vo.default.createElement(T,{fontSize:14,lineHeight:1.5},r("onboarding:onboarding_tooltip__FLOATING_CONTEXT_MENU_LIST_BOX__text1__part2"))),vo.default.createElement(g,{direction:"row",alignItems:"center",spacing:.5},vo.default.createElement(T,{fontSize:14,lineHeight:1.5},r("onboarding:onboarding_tooltip__FLOATING_CONTEXT_MENU_LIST_BOX__text2__part1")),vo.default.createElement(Ea,{sx:a},vo.default.createElement(KT.default,{sx:{fontSize:"12px",transform:"scale(1.6)"}})),vo.default.createElement(T,{fontSize:14,lineHeight:1.5},r("onboarding:onboarding_tooltip__FLOATING_CONTEXT_MENU_LIST_BOX__text2__part2"))),vo.default.createElement(g,{direction:"row",alignItems:"center",spacing:.5},vo.default.createElement(T,{fontSize:14,lineHeight:1.5},r("onboarding:onboarding_tooltip__FLOATING_CONTEXT_MENU_LIST_BOX__text3__part1")),vo.default.createElement(Ea,{sx:a},r("onboarding:onboarding_tooltip__FLOATING_CONTEXT_MENU_LIST_BOX__text3__part2")),vo.default.createElement(T,{fontSize:14,lineHeight:1.5},r("onboarding:onboarding_tooltip__FLOATING_CONTEXT_MENU_LIST_BOX__text3__part3")))))},$T=Gz;var An=v(A());var t7=v(pm()),o7=v(ux());var Yt=v(A());var Ca=v(A()),YT=v(tM());var Su=v(A());var jz=e=>{let{title:t,placement:o,TooltipProps:r,loading:n=!1,children:i,PopperProps:a,...s}=e;return Su.default.createElement(Fn,{placement:o||"top",title:t,PopperProps:{sx:{},...a},...r},Su.default.createElement("span",{className:"TextOnlyTooltip_IconButton_wrapper"},Su.default.createElement(Xe,{...s},n?Su.default.createElement(Ft,{size:16,sx:{m:"0 auto"}}):i)))},XT=jz;var qz=e=>{let{copyText:t,onCopy:o,sx:r,defaultIconSx:n,icon:i,copyToClipboardTooltip:a,copiedTooltip:s,TooltipProps:l,PopperProps:c,tooltipPlacement:p,...u}=e,{t:m}=k(["common"]),[d,f]=(0,Ca.useState)(!1),h=(0,Ca.useMemo)(()=>m(d?s||"common:copied":a||"common:copy_to_clipboard"),[m,d,a,s]);return Ca.default.createElement(YT.CopyToClipboard,{text:t,options:{message:"Copied!",format:"text/plain"},onCopy:()=>{o?.(),f(!0),setTimeout(()=>{f(!1)},1e3)}},Ca.default.createElement(XT,{title:h,sx:r,className:e.className,TooltipProps:l,PopperProps:c,placement:p,...u},d?Ca.default.createElement(X,{icon:"Check",sx:{fontSize:"20px",...n}}):i||Ca.default.createElement(X,{icon:"CopyTextOnly",sx:{fontSize:"20px",...n}}),e.children))},eh=qz;var _o=v(A());var ur=v(A()),QT=v(A());function ZT(e){return e.substring(2).toLowerCase()}function Kz(e,t){return t.documentElement.clientWidth<e.clientX||t.documentElement.clientHeight<e.clientY}function $z(e,t){typeof e=="function"?e(t):e&&(e.current=t)}function Xz(...e){return ur.useMemo(()=>e.every(t=>t==null)?null:t=>{e.forEach(o=>{$z(o,t)})},e)}var Nx=e=>{if(e){let t=nm();if(t&&t.contains(e))return t;if(t=gr(),t){let o=t.querySelector(`#${al}`);return o instanceof HTMLElement?o:t}}return document.documentElement};function Yz(e){let{children:t,disableReactTree:o=!1,mouseEvent:r="onClick",onClickAway:n,touchEvent:i="onTouchEnd"}=e,a=ur.useRef(!1),s=ur.useRef(null),l=ur.useRef(!1),c=ur.useRef(!1);ur.useEffect(()=>(setTimeout(()=>{l.current=!0},0),()=>{l.current=!1}),[]);let p=Xz(t.ref,s),u=(0,QT.useCallback)(f=>{let h=c.current;c.current=!1;let C=Nx(s.current);if(!l.current||!s.current||"clientX"in f&&Kz(f,C.ownerDocument))return;if(a.current){a.current=!1;return}let x;f.composedPath?x=f.composedPath().indexOf(s.current)>-1:x=!C.ownerDocument.documentElement.contains(f.target)||s.current.contains(f.target),!x&&(o||!h)&&n(f)},[]),m=f=>h=>{c.current=!0;let C=t.props[f];C&&C(h)},d={ref:p};return i!==!1&&(d[i]=m(i)),ur.useEffect(()=>{if(i!==!1){let f=ZT(i),h=Nx(s.current),C=()=>{a.current=!0};return h.addEventListener(f,u),h.addEventListener("touchmove",C),()=>{h.removeEventListener(f,u),h.removeEventListener("touchmove",C)}}},[u,i]),r!==!1&&(d[r]=m(r)),ur.useEffect(()=>{if(r!==!1){let f=ZT(r),h=Nx(s.current);return h.addEventListener(f,u),()=>{h.removeEventListener(f,u)}}},[u,r]),ur.createElement(ur.Fragment,null,ur.cloneElement(t,d))}var JT=Yz;var Zz=To(({className:e,...t})=>_o.default.createElement(Pn,{...t,classes:{popper:e}}))(({theme:e})=>({[`& > .${Pr.tooltip}`]:{background:e.palette.mode==="dark"?"#2C2C2C":"#ffffff",color:"rgba(0, 0, 0, 0.87)",fontSize:12,boxShadow:"0px 12px 16px -4px rgba(0, 0, 0, 0.08), 0px 4px 6px -2px rgba(0, 0, 0, 0.03)",maxWidth:"none",borderRadius:e.spacing(1),border:`1px solid ${e.palette.border.main}`,backgroundClip:"padding-box"},[`& .${Pr.arrow}`]:{color:e.palette.mode==="dark"?"#2C2C2C":"#ffffff","&::before":{border:`1px solid ${e.palette.border.main}`,background:e.palette.mode==="dark"?"#2C2C2C":"#ffffff",backgroundClip:"padding-box"}}})),Qz=(0,_o.forwardRef)(function({variable:t,sx:o,container:r,children:n,virtualRect:i,popperSx:a,suffix:s,anchorElSx:l,descriptionEl:c},p){let[u,m]=(0,_o.useState)(!1),d=(0,_o.useRef)(null);(0,_o.useImperativeHandle)(p,()=>({close:()=>m(!1)}));let f=t.key==="Selected Text"||t.key==="Draft"?"Context":t.key,h={container:r,sx:{zIndex:2147483619,...a},transition:!0};return i&&(h.anchorEl={getBoundingClientRect(){return i}}),_o.default.createElement(JT,{onClickAway:C=>{u&&C.target instanceof HTMLElement&&(d.current?.contains(C.target)||d.current===C.target)||m(!1)}},_o.default.createElement(g,{direction:"row",width:"100%",sx:o},_o.default.createElement(Zz,{open:u,PopperProps:h,title:_o.default.createElement(g,{direction:"column",maxHeight:"min(500px, 40vh)",overflow:"hidden",height:"max-content"},_o.default.createElement(g,{direction:"row",width:"100%",gap:1.25,p:1.25,ref:d,boxSizing:"border-box",flexGrow:1,overflow:"hidden"},_o.default.createElement(F,{width:"2px",minWidth:"2px",bgcolor:C=>C.palette.mode==="dark"?"rgba(255, 255, 255, 0.12)":"rgba(0, 0, 0, 0.12)"}),_o.default.createElement(g,{direction:"column",flexGrow:1,overflow:"hidden"},_o.default.createElement(g,{direction:"row",gap:1.25,alignItems:"center",maxWidth:"100%"},_o.default.createElement(T,{fontSize:"14px",overflow:"hidden",textOverflow:"ellipsis",noWrap:!0,color:C=>C.palette.mode==="dark"?"rgba(255, 255, 255, 0.50)":"rgba(0, 0, 0, 0.38)"},f),_o.default.createElement(eh,{sx:{padding:"5px",fontSize:"20px",borderRadius:"4px",color:"text.secondary"},defaultIconSx:{fontSize:"15px"},PopperProps:{container:r,placement:"top"},copyText:t.value})),c,_o.default.createElement(T,{width:"100%",whiteSpace:"pre-wrap",color:"text.primary",textAlign:"left",lineHeight:"24px",fontSize:"16px",flexGrow:1,overflow:"auto"},t.value))),s),placement:"top",arrow:!0,disableFocusListener:!0,disableHoverListener:!0,disableTouchListener:!0},_o.default.createElement(F,{onClick:()=>{m(!u)},sx:l},typeof n=="function"?n({variable:t,open:u}):n))))}),e7=Qz;var Jz=To(({className:e,...t})=>Yt.default.createElement(Pn,{...t,classes:{popper:e}}))(({theme:e})=>({[`& > .${Pr.tooltip}`]:{background:e.palette.mode==="dark"?"#2C2C2C":"#ffffff",color:"rgba(0, 0, 0, 0.87)",fontSize:12,boxShadow:"0px 12px 16px -4px rgba(0, 0, 0, 0.08), 0px 4px 6px -2px rgba(0, 0, 0, 0.03)",maxWidth:"none",borderRadius:e.spacing(1),backgroundClip:"padding-box",border:`1px solid ${e.palette.border.main}`},[`& .${Pr.arrow}`]:{color:e.palette.mode==="dark"?"#2C2C2C":"#ffffff","&::before":{border:`1px solid ${e.palette.border.main}`,background:e.palette.mode==="dark"?"#2C2C2C":"#ffffff",backgroundClip:"padding-box"}}})),eV=({quoteText:e,variables:t,container:o,title:r})=>{let{t:n}=k(["client"]),[i,a]=(0,Yt.useState)(!1),s=(0,Yt.useRef)(null),l=2147483617,c=2147483618;(0,Yt.useEffect)(()=>{let u=gr()?.querySelector(`#${al}`);if(u instanceof HTMLElement){let m=()=>{a(!1)};return u?.addEventListener("click",m),document.body.addEventListener("click",m),()=>{u?.removeEventListener("click",m),document.body.removeEventListener("click",m)}}},[]);let p=(0,Yt.useMemo)(()=>e?Yt.default.createElement(F,{sx:{display:"flex",flexDirection:"row",justifyContent:"flex-end",width:"100%"}},Yt.default.createElement(e7,{variable:{key:"Quote",value:e},sx:{width:"auto"},popperSx:{boxSizing:"border-box",zIndex:c,maxWidth:s.current?.clientWidth??"500px"},container:o},Yt.default.createElement(g,{gap:1,direction:"row",color:u=>u.palette.mode==="dark"?"rgba(255, 255, 255, 0.38)":"rgba(0, 0, 0, 0.38)",width:"100%"},Yt.default.createElement(o7.default,{sx:{fontSize:"18px"}}),Yt.default.createElement(Ty,{maxLine:2,fontSize:"14px",flex:1},e.trim())))):null,[e,c,o]);return Yt.default.createElement(Jz,{open:i,PopperProps:{container:o,sx:{zIndex:l}},disableFocusListener:!0,disableHoverListener:!0,disableTouchListener:!0,placement:"top",arrow:!0,title:Yt.default.createElement(g,{component:"div",direction:"column",maxWidth:"500px",maxHeight:"min(50vh, 500px)",ref:s,padding:"10px",boxSizing:"border-box",onClick:u=>u.stopPropagation(),sx:{boxSizing:"border-box",background:u=>u.palette.mode==="dark"?"#2C2C2C":"#ffffff"}},p,Yt.default.createElement(g,{maxWidth:"100%",width:"auto",direction:"row",sx:{"& .maxai-user-message-copy-icon":{opacity:0,transition:"opacity 0.2s ease-in-out"},"&:hover .maxai-user-message-copy-icon":{opacity:1}}},Yt.default.createElement(F,null,Yt.default.createElement(eh,{tabIndex:-1,tooltipPlacement:"top",sx:{marginRight:"5px",padding:"5px",fontSize:"20px",borderRadius:"4px",color:"text.secondary"},defaultIconSx:{fontSize:"15px"},className:"maxai-user-message-copy-icon",PopperProps:{container:o,sx:{zIndex:c}},copyText:r})),Yt.default.createElement(g,{direction:"column",gap:1,sx:{whiteSpace:"pre-wrap",wordBreak:"break-word",p:u=>u.spacing(1.5),bgcolor:u=>u.palette.background.secondary,borderRadius:u=>u.spacing(1),color:"text.primary",flexWrap:"wrap",flexGrow:1,overflow:"hidden"}},Yt.default.createElement(T,{fontSize:"16px"},r),t.map(u=>Yt.default.createElement(f1,{key:u.key,variable:u,getMessageContainer:()=>s.current,container:o,zIndex:c})))))},Yt.default.createElement(Ce,{variant:"text",sx:{gap:"4px",padding:"6px"},onClick:u=>{a(!i),u.stopPropagation()}},Yt.default.createElement(T,{color:"text.primary",fontSize:"14px",noWrap:!0},n("floating_menu__button__show_detail")),Yt.default.createElement(t7.default,{sx:{color:"#D9D9D9",height:"16px",width:"16px",transition:"all 0.2s",transform:`rotate(${i?.5:0}turn)`}})))},r7=eV;var tV=({loading:e=!1})=>{let t=(0,An.useRef)(gr()),{draftUserMessage:o}=Dr(),{conversationMessages:r}=ue(),n=(0,An.useMemo)(()=>{if(!o)return"";let a=EC(o),s=a.indexOf(`:
"""
`);return s===-1?a:a.slice(0,s)},[o]),i=(0,An.useMemo)(()=>mu(o?.meta?.contexts,o?.meta?.MaxAIPromptActionConfig?.variables),[o?.meta?.contexts,o?.meta?.MaxAIPromptActionConfig?.variables]);return An.default.createElement($u,{in:!!o},An.default.createElement(g,{direction:"row",gap:"8px",alignItems:"center",height:"auto",width:"100%",paddingBottom:"4px"},An.default.createElement(g,{direction:"row",flex:1,alignItems:"center",overflow:"hidden",gap:"8px"},An.default.createElement(T,{color:"text.primary",fontSize:"18px",fontWeight:600,lineHeight:"150%"},n),An.default.createElement(T,{overflow:"hidden",textOverflow:"ellipsis",color:a=>a.palette.mode==="dark"?"rgba(255,255,255,0.5)":"rgba(0,0,0,0.38)",flex:1,fontSize:"14px",sx:{whiteSpace:"nowrap",userSelect:"none",cursor:"default"}},i?.text)),An.default.createElement(r7,{quoteText:i?.text,variables:i?.userVariables??[],container:t.current,title:n}),r.length&&An.default.createElement(X1,{loading:e})))},n7=tV;var ya=v(A()),i7=v(A());var oV=()=>{let{currentSelection:e}=oa(),{draftUserMessage:t}=Dr(),{conversation:o,conversationId:r}=ue(),n=ye(r),i=(0,i7.useMemo)(()=>(e?.selectionElement?.editableElementSelectionText||e?.selectionElement?.selectionText||"").trim().replace(/\u200B/g,""),[e]),[a,s]=(0,ya.useState)(!1);return(0,ya.useEffect)(()=>{let l=!!(!i||n||o?.lastMessageId&&t);s(l)},[i,n,o?.lastMessageId,t]),{showDraftTextPanel:!a,draftText:i}},rV=()=>{let{showDraftTextPanel:e,draftText:t}=oV(),{conversationMessages:o}=ue();return o.length?null:ya.default.createElement($u,{in:e},ya.default.createElement(F,{sx:{display:"flex",flexDirection:"row",boxSizing:"border-box",padding:"8px",margin:"10px 0 0 0",borderRadius:"8px",alignItems:"center",gap:"8px",bgcolor:r=>r.palette.mode==="dark"?"rgba(59, 61, 62, 1)":"rgba(244, 244, 244, 1)",color:r=>r.palette.mode==="dark"?"rgba(255, 255, 255, 0.38)":"rgba(0, 0, 0, 0.38)",width:"100%"}},ya.default.createElement(Dy,{sx:{fontSize:"16px"}}),ya.default.createElement(T,{sx:{flex:1,whiteSpace:"nowrap",textOverflow:"ellipsis",fontSize:"14px",fontWeight:"400",overflow:"hidden",textAlign:"left",cursor:"default",userSelect:"none"}},t)))},a7=rV;var Go=v(A());var nV=e=>{let{anchorSize:t="10px",onStart:o,onResize:r,onStop:n,disabledResizeHeight:i}=e,a=(0,Go.useRef)(),s=(0,Go.useRef)({onStart:o,onResize:r,onStop:n});s.current.onStart=o,s.current.onResize=r,s.current.onStop=n;let l=(0,Go.useRef)(1);function c(_,y){l.current=im(),a.current=y,document.body.style.cursor="se-resize",o?.(y),_.stopPropagation(),_.preventDefault()}(0,Go.useEffect)(()=>{function _(b){a.current&&(s.current.onResize?.(b.movementX/l.current,b.movementY/l.current,a.current),b.stopPropagation())}function y(){a.current&&(s.current.onStop?.(),a.current=void 0,document.body.style.cursor="inherit")}return window.addEventListener("mousemove",_),window.addEventListener("mouseup",y),window.addEventListener("contextmenu",y),()=>{window.removeEventListener("mousemove",_),window.removeEventListener("mouseup",y),window.removeEventListener("contextmenu",y)}},[]);let{top:p,bottom:u,left:m,right:d,topLeft:f,topRight:h,bottomLeft:C,bottomRight:x}=(0,Go.useMemo)(()=>{let _={position:"absolute",height:t,width:t,background:"none",backgroundColor:"none",zIndex:1};return{top:{..._,cursor:"n-resize",width:"100%",top:0,left:0},bottom:{..._,cursor:"s-resize",width:"100%",bottom:0,left:0},left:{..._,cursor:"w-resize",height:"100%",top:0,left:0},right:{..._,cursor:"e-resize",height:"100%",top:0,right:0},topLeft:{..._,cursor:"nw-resize",top:0,left:0},topRight:{..._,cursor:"ne-resize",top:0,right:0},bottomLeft:{..._,cursor:"sw-resize",bottom:0,left:0},bottomRight:{..._,cursor:"se-resize",bottom:0,right:0}}},[t]);return Go.default.createElement(Go.default.Fragment,null,!i&&Go.default.createElement(F,{sx:p,onMouseDown:_=>c(_,"top")}),!i&&Go.default.createElement(F,{sx:u,onMouseDown:_=>c(_,"bottom")}),Go.default.createElement(F,{sx:m,onMouseDown:_=>c(_,"left")}),Go.default.createElement(F,{sx:d,onMouseDown:_=>c(_,"right")}),!i&&Go.default.createElement(F,{sx:f,onMouseDown:_=>c(_,"top-left")}),!i&&Go.default.createElement(F,{sx:h,onMouseDown:_=>c(_,"top-right")}),!i&&Go.default.createElement(F,{sx:C,onMouseDown:_=>c(_,"bottom-left")}),!i&&Go.default.createElement(F,{sx:x,onMouseDown:_=>c(_,"bottom-right")}))},s7=nV;var iV=!0,aV={x:0,y:0,top:0,left:0,right:0,bottom:0,width:0,height:0},l7=e=>{let{root:t}=e,{t:o}=k(["common","client"]),{loading:r,askAIWithContextWindow:n,inputValue:i,contextWindowList:a,isSettingCustomVariables:s,setIsSettingCustomVariables:l,setIsEditedCustomVariables:c}=cb(),{open:p}=tm(),{mode:u,changeMode:m}=co(),{refetch:d}=Nn(),{closeContextMenu:f,hideFloatingContextMenu:h}=Km(),{currentFloatingContextMenuDraft:C,activeResponseMessage:x}=Dr(),{floatingDropdownMenuPin:_}=Ga(),y=Zt(ii),b=qm(y),[S,I]=(0,he.useState)(!1),w=x||r,{defaultWidth:E,defaultHeight:O,updateLayout:L}=ub(y.rootRect),G=w&&O?Math.max(O,200):0,H=w?200:142,V=(0,he.useMemo)(()=>{let z="bottom-start",U="bottom-start";if(y.rootRect&&E){let ee=["bottom","top","left","right"];if(y.miniMenuPlacement)switch(y.miniMenuPlacement){case"bottom-end":{ee=["bottom","right","top","left"];break}case"top-start":{ee=["top","left","bottom","right"];break}case"top-end":{ee=["top","right","bottom","left"];break}}let D=Vy(y.rootRect,E,(G||H)+400,{offset:8,directions:ee});D.y>y.rootRect.top?(z="bottom-start",U="bottom-start"):D.y<y.rootRect.top&&(z="top-start",U="top-start"),D.x>y.rootRect.left+300?z="right-start":D.x<y.rootRect.left-300&&(z="left-start")}return{inputPlacement:z,contextMenuPlacement:U}},[y.rootRect,y.miniMenuPlacement,E]),W=(0,he.useRef)(null),N=(0,he.useRef)({x:0,y:0,dragged:!1}),Z=(0,he.useRef)({dx:0,dy:0,width:0,height:0,minWidth:550,maxWidth:0,minHeight:200,maxHeight:620,resized:!1,resizeDir:"",startWidth:0,startHeight:0,startLeft:0,startRight:0,startTop:0,startBottom:0});Z.current.width=E,Z.current.height=G,Z.current.minHeight=H,w||(Z.current.height=0);let J=(0,he.useCallback)((z,U,ee)=>xl(z,U,ee,{animationFrame:!0}),[]),K=(0,he.useRef)(!1),{x:Q,y:M,strategy:le,refs:ge,context:P,update:$}=Da({open:y.open,strategy:"fixed",onOpenChange:async(z,U,ee)=>{if(!(z||!y.open||K.current||S)&&!(!z&&U?.target instanceof Element&&W_()?.contains(U.target))&&!Bh("#MAX_AI_PRICING_MODAL")&&!(ee!=="escape-key"&&_)&&(ee==="outside-press"||ee==="escape-key")){if(Bh(`#${xC}`)?.getAttribute("data-status")==="open"){gC();return}if(ee==="outside-press"){let Y=gr();if(Y){let oe=new MouseEvent("click",{view:window,bubbles:!0,cancelable:!0});Y.dispatchEvent(oe)}}if(p||r||s&&ee==="outside-press")return;if(ee==="escape-key"){h(!0);return}K.current=!0,f().catch(()=>{}).finally(()=>{K.current=!1});return}},placement:V.inputPlacement,middleware:qy(N,W,Z),whileElementsMounted:J}),j=mm(P),de=dm(P,{capture:{escapeKey:!0,outsidePress:!0},outsidePressEvent:"pointerdown"}),{getFloatingProps:re}=Tl([de,j]),ce=he.default.useRef(!1),ut=(0,he.useRef)(1),Te=z=>{z.preventDefault(),ce.current=!0,ut.current=im()},{floatingPosition:Ie,startResize:Pe,handleResize:qe,stopResize:$e}=mb({x:Q,y:M,refs:ge,update:$,dragOffsetRef:N,floatingSizeOffsetRef:Z,rootRect:y.rootRect}),{refreshChatAIModelSelector:Nt}=Pl();(0,he.useEffect)(()=>{y.open?(Nt(),d()):(N.current={x:0,y:0,dragged:!1},Z.current.dx=0,Z.current.dy=0,Z.current.resized=!1,Z.current.resizeDir="",$(),m("list"))},[y.open,Nt]),(0,he.useEffect)(()=>{let z=ee=>{ce.current&&(ee.preventDefault(),ce.current=!1)},U=ee=>{if(!ce.current)return;let D=ee.movementX/ut.current,Y=ee.movementY/ut.current;N.current={x:N.current.x+D,y:N.current.y+Y,dragged:!0},W.current&&(W.current.style.marginLeft?W.current.style.marginLeft="":W.current.style.marginLeft="0.5px"),$(),ee.preventDefault()};return document.addEventListener("mousemove",U),document.addEventListener("mouseup",z),()=>{document.removeEventListener("mousemove",U),document.removeEventListener("mouseup",z)}},[$,y.open]),(0,he.useEffect)(()=>{if(y.rootRect){let z=Ry(y.rootRect);if(!iV){document.querySelector("#rangeBorderBox")?.remove();let U=document.createElement("div");U.id="rangeBorderBox",Object.assign(U.style,{position:"absolute",left:z.left+"px",top:z.top+window.scrollY+"px",width:z.width+"px",height:z.height+"px",border:"1px solid green",zIndex:"9999",pointerEvents:"none"}),document.body.appendChild(U)}}},[y.rootRect]),(0,he.useEffect)(()=>{ge.setPositionReference({getBoundingClientRect(){return De(b.current.rootRect)||aV}})},[b]);let Re=(0,he.useMemo)(()=>y.open?o(x?"client:floating_menu__input__placeholder__after_ai_response":"client:floating_menu__input__placeholder"):"",[o,y.open,x]);(0,he.useEffect)(()=>{},[E,G]),(0,he.useEffect)(()=>{w||(Z.current.dx=0,Z.current.dy=0,Z.current.resized=!1,Z.current.resizeDir=""),$()},[w]);let{draftUserMessage:mt}=Dr(),B=Qt("floatingMenuInputMediator"),R=async()=>{await nt({emitEvent:!0})&&await n()},[q,ne]=(0,he.useState)(!0),te=(0,he.useCallback)(()=>{ne(!1),setTimeout(()=>{ne(!0)},50)},[]);return he.default.createElement(um,{root:t},he.default.createElement("div",{ref:ge.setFloating,id:al,"data-testid":"maxai--floating-context-menu-reference-element","data-disabled-button-clicked":!0,onKeyUp:z=>z.stopPropagation(),onKeyDown:z=>{z.key!=="Escape"&&z.stopPropagation()},style:{position:le,zIndex:y.open?2147483601:-1,opacity:y.open?1:0,visibility:y.open?"visible":"hidden",...Ie,width:E,height:G},"aria-hidden":y.open?"false":"true",...re()},w?he.default.createElement(s7,{onStart:Pe,onResize:qe,onStop:()=>{$e(),L(w?{width:Z.current.width,height:Z.current.height}:{width:Z.current.width})}}):null,he.default.createElement(AT,{customOpen:!0,defaultPlacement:V.contextMenuPlacement,needAutoUpdate:!0,hoverOpen:!1,menuList:a,isFirstLevelFlatten:!C||!!C&&i.length!==0,referenceElementOpen:y.open,referenceElementRef:W,referenceElement:he.default.createElement(F,{ref:W,component:"div",sx:{boxSizing:"border-box",background:z=>z.palette.background.paper,borderRadius:"8px",border:z=>z.palette.mode==="dark"?"1px solid rgba(255,255,255,0.08)":"1px solid rgba(0,0,0,0.08)",boxShadow:"0px 4px 6px -2px rgba(16, 24, 40, 0.03), 0px 12px 16px -4px rgba(16, 24, 40, 0.08)",overflow:"hidden",isolation:"isolate",display:"flex",flexDirection:"column",width:"100%",padding:"10px"},onKeyDown:z=>{z.stopPropagation()}},y.open&&he.default.createElement(he.default.Fragment,null,r||s?null:he.default.createElement(F,{id:"ONBOARDING_TOOLTIP__FLOATING_CONTEXT_MENU_INPUT_BOX__REFERENCE_ELEMENT",sx:{width:10,height:10,position:"absolute",left:0,bottom:"20px",pointerEvents:"none",zIndex:-1}})),he.default.createElement(F,{sx:{position:"absolute",width:"100%",left:0,top:0,cursor:"grab",height:"28px"},onMouseDown:Te}),s?he.default.createElement(F,{sx:{flex:1}}):y.open&&he.default.createElement(he.default.Fragment,null,he.default.createElement(n7,{loading:r}),he.default.createElement(UT,{contextMenuDefaultHeight:G})),y.open&&he.default.createElement(he.default.Fragment,null,he.default.createElement(RT,{showModelSelector:y.showModelSelector,showUsageButton:!0,loading:r})),he.default.createElement(a7,null),y.open&&he.default.createElement(df,{showCloseButton:!1,onInputCustomVariable:({data:z,variables:U})=>{let ee=U?.some(D=>D.name?!1:z[D.name]);c(D=>D||!!ee)},onBeforeRunShortcuts:()=>l(!1),onClose:z=>{l(!1)},onShow:()=>{l(!0)},modelKey:"FloatingContextMenu",autoFocusAfterBlur:!0}),(!s||r)&&he.default.createElement(g,{width:"100%",gap:.5,sx:{marginTop:"8px"}},he.default.createElement(g,{direction:"row",justifyContent:"flex-end",alignItems:"end",gap:1},he.default.createElement(g,{direction:"row",width:0,flex:1,alignItems:"center",spacing:1,justifyContent:"left",marginBottom:"4px",sx:{display:S?"none":"flex"}},r?he.default.createElement(he.default.Fragment,null,he.default.createElement(T,{fontSize:"16px",color:z=>z.palette.mode==="dark"?"rgba(255, 255, 255, 0.38)":"rgba(0, 0, 0, 0.38)"},o(mt?"client:floating_menu__input__running_placeholder":"client:floating_menu__input__reading_placeholder")),he.default.createElement(Ft,{size:"16px",sx:{color:z=>z.palette.mode==="dark"?"rgba(255, 255, 255, 0.38)":"rgba(0, 0, 0, 0.38)"}})):he.default.createElement(he.default.Fragment,null,he.default.createElement(TT,{minLine:1,maxHeight:Z.current.height?Z.current.height/2:void 0,stopPropagation:!0,autoFocus:y.open,onKeydownCapture:z=>y.open&&a.length?!1:z.key==="ArrowUp"||z.key==="ArrowDown"?(z.stopPropagation(),!0):!1,placeholder:Re,InputId:yi,sx:{border:"none","& > div":{"& > div":{p:0},"& > textarea":{p:0},"& > .max-ai-user-input__expand":{"&:has(> div)":{pr:1}}},borderRadius:0,minHeight:s?0:"24px",height:s?"0!important":"unset",visibility:s?"hidden":"visible"},onEnter:async()=>{a.length>0&&u==="list"||(m("list"),await R())},onControlledValueChange:(z,U)=>{U===yi&&z.length<1&&B.resetInputValue()}})),he.default.createElement(Hx,null)),!r&&he.default.createElement(he.default.Fragment,null,!S&&he.default.createElement(he.default.Fragment,null,y.open&&he.default.createElement(Bx,null),he.default.createElement(Lx,null)),he.default.createElement(ic,{value:{isVoiceInput:S,setIsVoiceInput:I,isUseInternalState:!1}},he.default.createElement(sc,{inputMediator:B,onClick:R,onSpeechToTextSuccess:z=>{B.updateInputValue(B.getInputValue()+z)},tooltipProps:{placement:"bottom"},disabled:i.length===0})))))),root:t})),a.length>0&&he.default.createElement($T,{showStateTrigger:y.open&&a.length>0,onClose:()=>{te()}}),he.default.createElement(jT,{showStateTrigger:y.open&&a.length>0&&a.some(z=>z.prompt_id===Bl.REPLACE_SELECTION)}),!r&&!s?he.default.createElement(he.default.Fragment,null,he.default.createElement(GT,{showStateTrigger:y.open&&!x&&!s&&a.length>0&&a.some(z=>z.prompt_id==="30f27496-1faf-4a00-87cf-b53926d35bfd")&&(C===""||i.length>0)&&q})):null,r?null:he.default.createElement(he.default.Fragment,null,he.default.createElement(WT,{showStateTrigger:y.open&&!!x&&x.type==="ai"})))};var Vx=v(A());var jo=v(A());var c7=v(A()),sV=e=>{let{sx:t,...o}=e;return c7.default.createElement(Ce,{sx:SC({transition:"all 0.15s",height:"32px",padding:"0px",minWidth:"initial",color:r=>r.palette.mode==="dark"?"#fff":"rgba(0, 0, 0, 0.6)","&:hover":{backgroundColor:r=>r.palette.mode==="dark"?"rgba(255, 255, 255, 0.08)":"rgba(0, 0, 0, 0.06)",color:r=>r.palette.mode==="dark"?"#fff":"rgba(0, 0, 0, 0.87)"}},t),...o},e.children)},ys=sV;var xi=v(A());var zx=v(A());var lV=e=>{let{sx:t,...o}=e,{t:r}=k(["client","common"]),{hideMenu:n}=Vl(),{updateAppSettings:i}=db(),a=c=>{c.stopPropagation(),Fa({key:"options",query:"?id=floating-image-mini-menu#/appearance"})},s=async c=>{c.stopPropagation();let p=await Jc.getAppSettings();await Jc.setAppSettings({floatingImageMiniMenu:{visibility:{...p.floatingImageMiniMenu.visibility,blacklist:[...p.floatingImageMiniMenu.visibility.blacklist,za()]}}}),i(),n()},l=async c=>{c.stopPropagation();let p=await Jc.getAppSettings();await Jc.setAppSettings({floatingImageMiniMenu:{visibility:{...p.floatingImageMiniMenu.visibility,isWhitelistMode:!0}}}),i(),n()};return zx.default.createElement(F,{sx:{marginLeft:"0px!important",color:"#fff",position:"absolute",top:"calc(100% - 6px)",left:"0px",...t},...o},zx.default.createElement(Ym,{sx:{marginTop:"10px"},hideThisSiteItemDataButtonClickedName:"max_ai__floating_image_menu__hide_menu__this_site",hideThisSiteItemText:r("client:floating_menu__mini_menu__image__close_item__hide_on_this_site"),hideThisSiteConfirmCardTitle:r("client:floating_menu__mini_menu__image__confirm_card__hide_this_site__title"),hideThisSiteConfirmCardOkText:r("client:floating_menu__mini_menu__image__close_item__hide_on_this_site"),hideThisSiteConfirmCardCancelText:r("common:cancel"),onHideThisSiteConfirmCardClickOk:s,onHideThisSiteConfirmCardClickCancel:()=>{},hideAllSitesItemDataButtonClickedName:"max_ai__floating_image_menu__hide_menu__all_sites",hideAllSitesItemText:r("client:floating_menu__mini_menu__image__close_item__hide_always"),hideAllSitesConfirmCardTitle:r("client:floating_menu__mini_menu__image__confirm_card__hide_all_sites__title"),hideAllSitesConfirmCardOkText:r("client:floating_menu__mini_menu__image__close_item__hide_always"),hideAllSitesConfirmCardCancelText:r("common:cancel"),onHideAllSitesConfirmCardClickOk:l,onHideAllSitesConfirmCardClickCancel:()=>{},openSettingsItemTextI18nKey:"client:floating_menu__mini_menu__image__close_item__settings_tips",onClickSettings:a}))},p7=lV;var cV=()=>{let{floatingImageMiniMenuKey:e}=(0,xi.useContext)(Ua),{t}=k(["client"]),{hideMenu:o}=Vl(),r=n=>{n.stopPropagation(),jm(e).disable=!0,o()};return xi.default.createElement(g,{sx:{flexDirection:"row",alignItems:"center","&:hover":{".maxai_close_button":{borderRadius:"6px"},".maxai_more_close_options":{margin:"0px",opacity:"1"}}}},xi.default.createElement(ve,{placement:"top",title:t("client:floating_menu__mini_menu__image__close_item__hide_until_next_visit")},xi.default.createElement("span",null,xi.default.createElement(ys,{onClick:r,className:"maxai_close_button",sx:{width:"32px",fontSize:"16px",borderRadius:"4px 16px 16px 4px",backgroundColor:n=>n.palette.mode==="dark"?"transparent":"#fff",zIndex:"1"}},xi.default.createElement(X,{size:18,icon:"Close"})))),xi.default.createElement(ys,{className:"maxai_more_close_options",sx:{marginLeft:"-32px",opacity:"0",width:"32px",fontSize:"16px",borderRadius:"4px 16px 16px 4px",backgroundColor:n=>n.palette.mode==="dark"?"transparent":"#fff","&:hover":{".maxai__floating_image_menu__close_menu":{transform:"scale(1)"}}},disableRipple:!0},xi.default.createElement(X,{icon:"Power"}),xi.default.createElement(p7,{className:"maxai__floating_image_menu__close_menu",sx:{zIndex:"1",transform:"scale(0)",transformOrigin:"left top"}})))},u7=cV;var pV=jo.default.forwardRef(function({sx:t,className:o},r){let{t:n}=k(["client"]);return jo.default.createElement(F,{sx:{overflow:"hidden",transition:"width 0.2s",marginLeft:"0px!important",...t||{}},ref:r,className:o},jo.default.createElement(F,{sx:{height:"100%",fontSize:"12px",fontWeight:"initial",color:i=>i.palette.mode==="dark"?"#fff":"rgba(0, 0, 0, 0.87)",lineHeight:"16px",overflow:"hidden",marginLeft:"0px!important",whiteSpace:"nowrap"}},n("client:floating_menu__mini_menu__image__menu_item__chat_with_image")))}),th=e=>{let{filterImage:t,dataTestId:o}=e,{floatingImageMiniMenuKey:r}=(0,jo.useContext)(Ua),n=Zt(Gm(r)),{showMenu:i,hideMenu:a}=Vl(),s=(0,jo.useRef)(null),l=jm(r),{hover:c,onMouseEnter:p,onMouseLeave:u}=$m(100);fb({filterImage:t}),(0,jo.useEffect)(()=>{c?(s.current&&clearTimeout(s.current),l.mouseInMenu=!0,i()):(l.mouseInMenu=!1,s.current=setTimeout(()=>{l.mouseInImage||a()},50))},[c]);let m=async()=>{a(),Wa()||ta(),gm("ContextMenuChatWithImage",{image:l.currentHoverImage,imageSrc:l.currentHoverImageSrc})};return jo.default.createElement(g,{className:"MAX_AI_FLOATING_IMAGE_MINI_MENU","data-testid":o,onMouseEnter:p,onMouseLeave:u,alignItems:"center",justifyContent:"center",sx:{boxSizing:"border-box",zIndex:2147483601,display:n.show?"flex":"none",cursor:"pointer",position:"fixed",top:`calc(${n.position.top} + 15px)`,left:`calc(${n.position.left} + 15px)`,...c&&{".max_ai_floating_image_dot_button":{opacity:"0",transform:"scale(5)"},".max_ai_floating_image_text_button":{opacity:"1",transform:"scale(1)"}}}},jo.default.createElement(g,{sx:{transition:"all 0.15s",justifyContent:"center",alignItems:"center",width:"16px",height:"16px",boxSizing:"border-box"}},jo.default.createElement(F,{className:"max_ai_floating_image_dot_button",sx:{width:"8px",height:"8px",borderRadius:"50%",backgroundColor:"rgba(144, 101, 176, 1)",border:"1px solid rgba(255, 255, 255, 0.08)",boxSizing:"border-box"}})),jo.default.createElement(g,{direction:"row",className:"max_ai_floating_image_text_button",sx:{opacity:"0",transform:"scale(0)",transformOrigin:"15px 15px",transition:"all 0.15s",position:"absolute",top:"0px",left:"0px",boxSizing:"border-box",alignItems:"center",padding:"2px",height:"36px",borderRadius:"18px",bgcolor:d=>d.palette.mode==="dark"?"rgba(44,44,44,0.95)":"#fff",backdropFilter:"blur(4px)",margin:"-8px",boxShadow:"0px 4px 8px 0px rgba(0, 0, 0, 0.12), 0px 0px 1px 0px rgba(0, 0, 0, 0.08)"}},jo.default.createElement(ys,{onClick:()=>m(),sx:{borderRadius:"16px 4px 4px 16px",padding:"0px 8px",[`.${Ta.startIcon}`]:{margin:"0px",marginRight:"8px"}},startIcon:jo.default.createElement(Ln,{sx:{boxSizing:"border-box",fontSize:"16px!important"}})},jo.default.createElement(pV,null)),jo.default.createElement(wt,{orientation:"vertical",sx:{height:"18px",mx:"4px"}}),jo.default.createElement(u7,null)))};var mV=()=>Vx.default.createElement(Ua.Provider,{value:{floatingImageMiniMenuKey:"ALL_IMAGE"}},Vx.default.createElement(th,{filterImage:e=>zl.commonFirstEnterImage!==e})),m7=mV;var $i=v(A());var ba=v(A());var Iu={sceneType:"FLOATING_IMAGE_MENU_BUTTON",id:"ONBOARDING_TOOLTIP__FLOATING_IMAGE_MENU_BUTTON",anchorElementSelectors:'[data-testid="maxai__floating_image_mini_menu__first_enter_image"]',CtaButtonClickedName:"Onboarding > ChatWithImage > Got it"},dV=e=>{let{showStateTrigger:t,onClosed:o,onOpened:r,...n}=e,{t:i}=k(),[a,s]=(0,ba.useState)(!1);return(0,ba.useEffect)(()=>{t?un(Iu.sceneType).then(l=>{l||zn(Iu.sceneType).then(()=>{s(!0),r?.()})}):s(!1)},[r,t]),ba.default.createElement(Et,{hideBackdrop:!0,sx:{visibility:"hidden"},placement:"bottom-start",fallbackPlacements:["top-start"],trigger:a,anchorElementSelectors:Iu.anchorElementSelectors,CtaButtonProps:{"data-button-clicked-name":Iu.CtaButtonClickedName},id:Iu.id,footerLeft:ba.default.createElement(Zm,null),onClose:o,...n},ba.default.createElement(g,{spacing:.5},ba.default.createElement(T,{fontSize:14,lineHeight:1.4,color:"text.primary",fontWeight:400,textAlign:"left"},i("onboarding:onboarding_tooltip__FLOATING_IMAGE_MENU_BUTTON__text"))))},d7=dV;var fV=()=>{let[e,t]=(0,$i.useState)(!1),o=Zt(Gm("ON_BOARDING"));(0,$i.useEffect)(()=>{o.show&&t(!0)},[o.show]);let r=()=>{zl.onboardingTooltipShowing=!1},n=()=>{zl.onboardingTooltipShowing=!0};return $i.default.createElement($i.default.Fragment,null,$i.default.createElement(Ua.Provider,{value:{floatingImageMiniMenuKey:"ON_BOARDING"}},$i.default.createElement(th,{dataTestId:"maxai__floating_image_mini_menu__first_enter_image",filterImage:i=>zl.commonFirstEnterImage===i})),o.show&&$i.default.createElement(d7,{showStateTrigger:e,onClosed:r,onOpened:n}))},f7=fV;var xt=v(A());var Xi=v(A());var vu={sceneType:"CONTEXT_MENU_CTA_MINI_ICON_BUTTON",id:"ONBOARDING_TOOLTIP__CONTEXT_MENU_CTA_MINI_ICON_BUTTON",anchorElementSelectors:"#max_ai__floating_context_menu__mini_hide_button",CtaButtonClickedName:"Onboarding > ContextMenu > MiniIconButton > Got it"},hV=e=>{let{showStateTrigger:t,...o}=e,{t:r}=k(),{chatBoxShortCutKey:n}=lp(),[i,a]=(0,Xi.useState)(!1);(0,Xi.useEffect)(()=>{t?un(vu.sceneType).then(l=>{l||zn(vu.sceneType).then(()=>{a(!0)})}):a(!1)},[t]);let s={bgcolor:l=>l.palette.mode==="dark"?"rgba(255, 255, 255, 0.16) !important":"rgba(0, 0, 0, 0.08) !important",color:l=>l.palette.mode==="dark"?"rgba(255, 255, 255, 0.7) !important":"rgba(0, 0, 0, 0.7) !important"};return Xi.default.createElement(Et,{hideBackdrop:!0,sx:{visibility:"hidden"},placement:"bottom-start",fallbackPlacements:["top-start"],trigger:i,anchorElementSelectors:vu.anchorElementSelectors,CtaButtonProps:{"data-button-clicked-name":vu.CtaButtonClickedName},id:vu.id,footerLeft:Xi.default.createElement(Zm,null),...o},Xi.default.createElement(g,{spacing:.5},Xi.default.createElement(T,{fontSize:14,lineHeight:1.4,color:"text.primary",fontWeight:400,textAlign:"left"},r("client:floating_menu__button__cta__tooltip")),n&&Xi.default.createElement(Ea,{sx:s},n)))},h7=hV;var gV={"top-start":[-3,0],"top-end":[-3,0],"bottom-start":[-3,0],"bottom-end":[-3,0]},g7=e=>gV[e]||[0,0];var Sa=v(A());var Rx=v(A()),xV=({showDivider:e=!0,boxSx:t,dividerProps:o})=>{let{orientation:r="vertical"}=o||{};return e?Rx.default.createElement(g,{flex:1,sx:{p:"7px 4px",...t}},Rx.default.createElement(wt,{orientation:r,...o})):null},wu=xV;var _V=e=>{let{placement:t,onClick:o,btnGroupSx:r}=e,{t:n}=k(["common","client","prompt"]),{contextMenuPath:i}=co(),{contextMenuSuggestions:a}=ni(i||"",3),s=a.sort((l,c)=>+!!c.prompt_icon-+!!l.prompt_icon);return Sa.default.createElement(Sa.default.Fragment,null,Sa.default.createElement(g,{direction:"row",alignItems:"center",className:"max-ai__click-menu-button--box","data-button-clicked-name":"max_ai__floating_context_menu__favorite_menu_group",sx:r},s?.map(l=>{let c=l.prompt_title,p=l.prompt_id.replace(ir,""),u=`prompt:${p}`;n(u)!==p&&(c=n(u));let m=String(c[0]||"").toUpperCase();return Sa.default.createElement(Wl,{TooltipProps:{floatingMenuTooltip:!0,placement:t||"bottom"},title:c,key:l.prompt_id,sx:{minWidth:"unset",p:l.prompt_icon?"8px!important":"6px!important"},onMouseUp:d=>{d.stopPropagation(),d.preventDefault()},onMouseDown:d=>{d.stopPropagation(),d.preventDefault()},onClick:async d=>{d.stopPropagation(),d.preventDefault(),await nt({emitEvent:!0})&&o?.(l)}},l.prompt_icon?Sa.default.createElement(X,{icon:l.prompt_icon,sx:{fontSize:"18px",color:"primary.main"}}):Sa.default.createElement(g,{className:"max-ai__click-menu-button--box__text-icon",alignItems:"center",justifyContent:"center",sx:{width:"16px",height:"16px",boxSizing:"border-box",borderRadius:"4px",bgcolor:d=>d.palette.mode==="dark"?"#4f4f4f":"#F5F6F7",color:d=>d.palette.mode==="dark"?"rgba(255,255,255,.87)":"rgba(0,0,0,.6)"}},Sa.default.createElement(T,{component:"span",fontSize:"13px",color:"inherit"},m)))})),s?.length>0&&Sa.default.createElement(wu,null))},x7=_V;var Ia=v(A());var Ux=v(A());var CV=e=>{let{parentX:t,parentY:o,sx:r,...n}=e,{t:i}=k(["common","client"]),{hideRangy:a}=oa(),{updateButtonSettingsWithDomain:s,toggleButtonSettings:l}=zm(),c=d=>{d.stopPropagation(),Fa({key:"options",query:"#/mini-menu"})},p=async()=>{await s("textSelectPopupButton")},u=async()=>{await l("textSelectPopupButton",!1)},m=t&&o&&t+zy+240>window.innerWidth;return Ux.default.createElement(F,{sx:{marginLeft:"0px!important",color:"#fff",position:"absolute",top:"calc(100% - 6px)",left:m?"auto":0,right:m?0:"auto",zIndex:2147483611,...r},...n},Ux.default.createElement(Ym,{sx:{marginTop:"10px"},hideThisSiteItemDataButtonClickedName:"max_ai__floating_context_menu__hide_menu__this_site",hideThisSiteItemText:i("client:floating_menu__button__hide_menu__this_site"),hideThisSiteConfirmCardTitle:i("client:floating_menu__button__hide_menu__this_site__tooltip__title"),hideThisSiteConfirmCardOkText:i("client:floating_menu__button__hide_menu__this_site__tooltip__confirm"),hideThisSiteConfirmCardCancelText:i("common:cancel"),onHideThisSiteConfirmCardClickOk:p,onHideThisSiteConfirmCardClickCancel:()=>a(),hideAllSitesItemDataButtonClickedName:"max_ai__floating_context_menu__hide_menu__all_sites",hideAllSitesItemText:i("client:floating_menu__button__hide_menu__all_sites"),hideAllSitesConfirmCardTitle:i("client:floating_menu__button__hide_menu__all_sites__tooltip__title"),hideAllSitesConfirmCardOkText:i("client:floating_menu__button__hide_menu__all_sites__tooltip__confirm"),hideAllSitesConfirmCardCancelText:i("common:cancel"),onHideAllSitesConfirmCardClickOk:u,onHideAllSitesConfirmCardClickCancel:()=>a(),openSettingsItemTextI18nKey:"client:floating_menu__button__menu_settings",onClickSettings:c}))},_7=CV;var yV=({parentX:e,parentY:t})=>{let{t:o}=k(["client"]),r=ro(Um),n=ro(ii),i=async()=>{n({open:!1,rootRect:null,showModelSelector:!1,miniMenuPlacement:null}),r(a=>({...a,closeBeforeRefresh:!0}))};return Ia.default.createElement(g,{component:"div",sx:{flexDirection:"row",alignItems:"center","&:hover":{".maxai_close_button":{borderRadius:"6px"},".maxai_more_close_options":{margin:"0px",opacity:"1"}}}},Ia.default.createElement(ve,{placement:"top",title:o("client:floating_menu__button__hide_menu__until_next_visit")},Ia.default.createElement("span",null,Ia.default.createElement(ys,{onClick:i,className:"maxai_close_button",sx:{width:"32px",fontSize:"16px",borderRadius:"4px 16px 16px 4px",backgroundColor:a=>a.palette.mode==="dark"?"transparent":"#fff",zIndex:"1"}},Ia.default.createElement(X,{size:18,icon:"Close"})))),Ia.default.createElement(ys,{className:"maxai_more_close_options",sx:{marginLeft:"-32px",opacity:"0",width:"32px",fontSize:"16px",borderRadius:"4px 16px 16px 4px",backgroundColor:a=>a.palette.mode==="dark"?"transparent":"#fff","&:hover":{".maxai__floating_mini_menu__close_menu":{transform:"scale(1)"}}},disableRipple:!0},Ia.default.createElement(X,{icon:"Power"}),Ia.default.createElement(_7,{parentX:e,parentY:t,className:"maxai__floating_mini_menu__close_menu",sx:{transform:"scale(0)",transformOrigin:"left top"}})))},C7=yV;var oh=v(A());var bV=e=>{let{placement:t,TooltipProps:o,selectionText:r,btnGroupSx:n}=e,{t:i}=k(["common","client"]),{hideRangy:a}=oa();return oh.default.createElement(g,{direction:"row",alignItems:"center",className:"max-ai__click-menu-button--box",sx:n},oh.default.createElement(Wl,{TooltipProps:{floatingMenuTooltip:!0,placement:t||"bottom",...o},id:"max_ai__floating_context_menu__ai_search_button",title:i("client:floating_menu__mini_menu__ai_search__button__tooltip"),sx:{minWidth:"unset",p:"8px!important"},onMouseUp:s=>{s.stopPropagation(),s.preventDefault()},onMouseDown:s=>{s.stopPropagation(),s.preventDefault()},onClick:async s=>{if(s.stopPropagation(),s.preventDefault(),!await nt({emitEvent:!0}))return;let l=window.getSelection()?.toString();a(),ta();for(let c=0;c<30&&(await b2(200),!Wa());c++);(l||r)&&gm("ContextMenuQuickSearchSelectedText",{question:l||r})}},oh.default.createElement(X,{icon:"Search",sx:{fontSize:"18px",color:s=>s.palette.mode==="dark"?"rgba(255,255,255,.87)":"rgba(0,0,0,.6)"}})))},y7=bV;var Wx={div:{display:"flex"},position:"relative",display:"flex",alignItems:"center",justifyContent:"center",bgcolor:"transparent","&:hover":{"&:has(button)&::after":{display:"none"}},"& button":{minWidth:"unset",padding:"7px 8px!important",boxSizing:"border-box",borderRadius:"6px","&:hover":{bgcolor:e=>e.palette.mode==="dark"?"rgba(255, 255, 255, 0.08)":"rgba(0, 0, 0, 0.06)"},"&:has(.max-ai__click-menu-button--box__text-icon)":{height:"32px",width:"34px"}}},SV=()=>{let{t:e}=k(["common","client"]),{tempSelection:t,lastMousePosition:o,show:r,hideRangy:n}=oa(),{chatBoxShortCutKey:i}=lp(),{buttonSettings:a}=zm(),s=(0,xt.useMemo)(()=>a?.textSelectPopupButton.visibility?n_(a.textSelectPopupButton.visibility):!0,[a?.textSelectPopupButton.visibility]),l=ro(ab),{conversationId:c}=ue(),p=ye(c),u=ro(Wm),{closeBeforeRefresh:m}=Zt(Um),{showFloatingContextMenu:d}=Ga(),[f,h]=bi(ii),C=(0,xt.useMemo)(()=>r&&s&&!m&&!f.open,[r,s,m,f.open]),{hover:x,onMouseEnter:_,onMouseLeave:y}=$m(100);(0,xt.useEffect)(()=>{y()},[s,y]),(0,xt.useEffect)(()=>{C||y()},[C,y]);let{scrollState:b,inParentScrollView:S}=B_(t?.activeElement??null,t,-1),I=j=>({name:"miniMiniMiddleware",fn:de=>{let{rects:re}=de,ce=re.reference,Te=[{placement:"top-start",x:ce.x,y:ce.y},{placement:"top-end",x:ce.x+ce.width,y:ce.y},{placement:"bottom-start",x:ce.x,y:ce.y+ce.height},{placement:"bottom-end",x:ce.x+ce.width,y:ce.y+ce.height}].filter(({x:te,y:z})=>!(te>window.innerWidth+window.scrollX||te<0||z>window.innerHeight+window.scrollY||z<0)).map(te=>({...te,distance:Math.pow(te.x-j.x,2)+Math.pow(te.y-j.y,2)})),Ie=IC(Te,te=>te.distance);if(!Ie)return{x:ce.x-Cr,y:ce.y+ce.height};let{placement:Pe,x:qe,y:$e}=Ie,Nt=qe-Cr<0,Re=qe+Cr>window.innerWidth+window.scrollX,mt=$e-Cr<0,B=$e+Cr>window.innerHeight+window.scrollY,R=()=>{let te={"top-start":{x:Nt?qe+12:qe-Cr*.5,y:mt?$e+12:$e-Cr*.5},"top-end":{x:Re?qe-Cr:qe,y:mt?$e+12:$e-Cr*.5},"bottom-start":{x:Nt?qe+12:qe-Cr*.5,y:B?$e-Cr:$e},"bottom-end":{x:Re?qe-Cr:qe,y:B?$e-Cr:$e}};return te[Pe]||te["bottom-start"]},{x:q,y:ne}=R();return{x:q,y:ne,reset:{placement:Pe}}}}),{x:w,y:E,strategy:O,refs:L,placement:G}=Da({placement:"bottom-start",middleware:o?[I(o)]:[]});(0,xt.useEffect)(()=>{C&&h(j=>({...j,miniMenuPlacement:G}))},[G,C]);let H=(0,xt.useRef)(null);(0,xt.useEffect)(()=>{if(!t?.selectionRect||!C){H.current?.remove(),H.current=null;return}let j=Uy(t.selectionRect);Zi||(H.current||(H.current=document.createElement("div"),H.current.style.position="absolute",H.current.style.zIndex="9999",H.current.style.pointerEvents="none",document.body.appendChild(H.current)),H.current.style.display=S?"block":"none",H.current.style.left=j.left+b.x+"px",H.current.style.top=j.top+window.scrollY+b.y+"px",H.current.style.width=j.width+"px",H.current.style.height=j.height+"px",H.current.style.border="2px solid red",H.current.style.zIndex="9999",H.current.style.pointerEvents="none"),L.setPositionReference({getBoundingClientRect(){return{...j,x:j.left,y:j.top}}})},[C,t,b,S]);let V=()=>{if(L.floating.current){if(getComputedStyle(L.floating.current).opacity==="0")return;n(),pb()}};(0,xt.useEffect)(()=>{let j=de=>{de.key==="Escape"&&V()};return document.addEventListener("keydown",j,!0),()=>{document.removeEventListener("keydown",j,!0)}},[]),(0,xt.useEffect)(()=>{p&&setTimeout(()=>{V()},1e3)},[p]),(0,xt.useEffect)(()=>{let j=()=>{y()};return window.addEventListener("blur",j),window.removeEventListener("blur",j)},[]);let W=j=>({popper:{modifiers:[{name:"offset",options:{offset:({placement:re})=>g7(re)}},{name:"flip",enabled:!0,options:{fallbackPlacements:j?["top","bottom-start","bottom"]:["top","bottom","bottom-start"]}}]}}),{contextMenuPath:N}=co(),{contextMenuSuggestions:Z}=ni(N||"",3),J=4*Cr+2*Gh,K=J+Z.length*Cr+Gh,Q=w+J>window.innerWidth+window.scrollX,M=w+K>window.innerWidth+window.scrollX,le=(0,xt.useRef)(null),ge=w+b.x,P=E+b.y,{open:$}=tm();return xt.default.createElement(F,{component:"div",ref:j=>{le.current=j,L.setFloating(j)},className:`max-ai__click-context-menu ${C?"open":"close"}`,sx:{zIndex:C?2147483600:-1,position:O,top:P||0,left:ge||0,cursor:"pointer"}},xt.default.createElement(F,{onMouseEnter:_,onMouseLeave:()=>{$||y()},sx:{position:"relative",overflow:"visible","&:hover":{".mini-icon-button":{visibility:"hidden",userSelect:"none",zIndex:-1}}}},C&&x&&xt.default.createElement(g,{className:"max_ai_floating_mini_menu_content",direction:"row",alignItems:"center",sx:{display:"flex",transformOrigin:"15px 15px",borderRadius:"18px",position:"absolute",left:0,top:0,margin:"-8px",boxShadow:"0px 4px 8px 0px rgba(0, 0, 0, 0.12), 0px 0px 1px 0px rgba(0, 0, 0, 0.08)",bgcolor:j=>j.palette.mode==="dark"?"rgba(44,44,44,0.95)":"#fff",backdropFilter:"blur(4px)",alignItems:"stretch",p:"2px"}},xt.default.createElement(F,{component:"div",sx:{...Wx,"&:first-of-type":{"& button":{borderRadius:Q?"16px":"16px 4px 4px 16px"}}}},xt.default.createElement(Wl,{TooltipProps:{floatingMenuTooltip:!0,placement:"top-start",description:i,sx:{maxWidth:340},slotProps:W(!0)},title:e("client:floating_menu__button__cta__tooltip"),className:"usechatgpt-ai__context-menu--handle-button",id:"max_ai__floating_context_menu__cta_button","data-testid":"max_ai__floating_context_menu__cta_button",size:"small",variant:"text",onMouseUp:j=>{j.stopPropagation(),j.preventDefault()},onMouseDown:j=>{j.stopPropagation(),j.preventDefault()},onClick:j=>{j.stopPropagation(),j.preventDefault();let de=window.getSelection()?.rangeCount;if(de&&de>0){let re=window.getSelection()?.getRangeAt(0)?.cloneRange();u({range:re||null,selectionText:window?.getSelection()?.toString()||""})}t&&d()}},xt.default.createElement(Ln,{sx:{fontSize:"18px"}}))),!Q&&xt.default.createElement(xt.default.Fragment,null,xt.default.createElement(wu,null),!M&&xt.default.createElement(x7,{btnGroupSx:Wx,placement:"top",onClick:j=>{l(de=>({...de,selectedContextMenuId:j.prompt_id})),t&&d({openAutoExecute:!0})}}),xt.default.createElement(y7,{btnGroupSx:Wx,placement:"top",selectionText:t?.selectionText,TooltipProps:{slotProps:W(!1)}}),xt.default.createElement(wu,null),xt.default.createElement(C7,{parentX:w??0,parentY:E??0}))),xt.default.createElement(g,{className:"mini-icon-button",sx:{top:2,left:2,position:"absolute",width:"16px",height:"16px",visibility:x?"hidden":"inherit",opacity:C&&S?1:0,transition:C?"opacity .25s":"none"},alignItems:"center",justifyContent:"center",id:"max_ai__floating_context_menu__mini_hide_button"},xt.default.createElement(F,{sx:{borderRadius:"50%",height:"8px",width:"8px",backgroundColor:"rgba(144, 101, 176, 1)"}}))),xt.default.createElement(h7,{showStateTrigger:C}))},b7=SV;var Yi=v(A()),v7=v(sl());var rh=v(A()),Gx=(0,rh.createContext)({caret:null,selection:null,focus:!1}),S7=()=>(0,rh.useContext)(Gx);var mr=v(A());var nh=class{constructor(){this._events=new Map}on(t,o){this._events.has(t)||this._events.set(t,[]),this._events.get(t).push(o)}off(t,o){let r=this._events.get(t);r&&r.length&&this._events.set(t,r.filter(n=>n!==o))}emit(t,...o){let r=this._events.get(t);r&&r.length&&r.forEach(n=>{n(...o)})}addListener(t,o){this.on(t,o)}removeListener(t,o){this.off(t,o)}removeAllListeners(t){t?this._events.delete(t):this._events.clear()}};var Qn=new om("ContextMenu/GoogleDocHelper");var ih=class extends nh{constructor(){super();this.disabled=!1;this.editable=!0;this.initialized=!1;this.lastCaret=null;this.lastSelection=null;this.observer=null;this.debounceCaretOrSelectionChange=kr(()=>{this.checkCaretChange(),this.checkSelectionChange()},20);this._onScroll=o=>{Qn.info("onScroll"),this.emit("scroll",o)};this._onMouseUp=o=>{Qn.info("onMouseUp"),o.MAX_AI_IGNORE=!0,this.emit("mouseup",o)};this.onKeyUp=o=>{Qn.info("onKeyUp"),o.MAX_AI_IGNORE=!0,this.emit("keyup",o)};this._onFocus=o=>{Qn.info("onFocus"),this.emit("focus",o)};this._onBlur=o=>{Qn.info("onBlur"),this.emit("blur",o)};this.disabled=!location.href.startsWith("https://docs.google.com/document"),this.editable=!!document.querySelector("#docs-insert-menu")}init(){this.disabled||this.initialized||(this.initElement(),this.initListener())}initElement(){this.editorElement=document.querySelector("div.kix-appview-editor"),this.scrollElement=document.querySelector("div.kix-scrollareadocumentplugin"),this.iframeElement=document.querySelector("iframe.docs-texteventtarget-iframe"),this.inputElement=this.iframeElement?.contentDocument?.querySelector('div[contenteditable="true"]'),this.caretElement=document.querySelector("#kix-current-user-cursor-caret")}initListener(){let o=document.querySelector("div.kix-cursor");this.observer=new MutationObserver(r=>{r.some(n=>n.target.classList?.contains("kix-cursor"))&&(Qn.info("\u5149\u6807\u79FB\u52A8"),this.debounceCaretOrSelectionChange())}),o&&this.observer.observe(o,{attributes:!0,attributeFilter:["style"],childList:!1,characterData:!1,subtree:!1}),this.editorElement?.addEventListener("scroll",this._onScroll),this.editorElement?.addEventListener("mouseup",this._onMouseUp),this.inputElement?.addEventListener("keyup",this.onKeyUp),this.inputElement?.addEventListener("focus",this._onFocus),this.inputElement?.addEventListener("blur",this._onBlur)}destroy(){this.initialized=!1,this.observer?.disconnect(),this.editorElement?.addEventListener("scroll",this._onScroll),this.editorElement?.removeEventListener("mouseup",this._onMouseUp),this.inputElement?.removeEventListener("keyup",this.onKeyUp),this.inputElement?.removeEventListener("focus",this._onFocus),this.inputElement?.removeEventListener("blur",this._onBlur),this.removeAllListeners()}isSelectionChange(o,r){return!(o===r||o&&r&&o.layouts.length===r.layouts.length&&o.layouts.every((n,i)=>!jh(n,r.layouts[i])))}isCaretChange(o,r){if(o===r)return!1;if(!(o&&r&&!jh(o.layout,r.layout)))return!0}isFocus(){return document.activeElement===this.iframeElement}checkSelectionChange(){let o=this.getCurrentSelection();this.isSelectionChange(o,this.lastSelection)&&(this.lastSelection=o,this.emit("selection-change",this.lastSelection))}checkCaretChange(){let o=this.getCurrentCaret();this.isCaretChange(o,this.lastCaret)&&(this.lastCaret=o,this.emit("caret-change",this.lastCaret))}calculateRelativeLayout(o){return this.scrollElement?jy(this.scrollElement?.getBoundingClientRect(),o):Wy}replaceSelection(o){Qn.info(o);let r=new DataTransfer;r.setData("text/plain",o),this.inputElement?.focus(),this.inputElement?.dispatchEvent(new ClipboardEvent("paste",{clipboardData:r,bubbles:!0,cancelable:!0}))}insertBelowSelection(o){if(Qn.info(o),this.inputElement?.focus(),this.lastSelection){let r={code:"ArrowRight",key:"ArrowRight",keyCode:39,bubbles:!0,repeat:!1};this.inputElement?.dispatchEvent(new KeyboardEvent("keydown",r))}this.replaceSelection(`
${o}`)}insertAboveSelection(o){if(Qn.info(o),this.inputElement?.focus(),this.lastSelection){let r={charCode:0,code:"ArrowLeft",key:"ArrowLeft",keyCode:37,bubbles:!0,repeat:!1};this.inputElement?.dispatchEvent(new KeyboardEvent("keydown",r))}this.replaceSelection(`${o}
`)}copySelection(o=!1){Qn.info(o),this.inputElement?.focus(),o?this.iframeElement?.contentDocument?.execCommand("copy"):this.inputElement?.dispatchEvent(new ClipboardEvent("copy",{bubbles:!0,cancelable:!0}));let r=this.inputElement?.innerText||"";return r.endsWith(`
`)?r.slice(0,-1):r}selectContent(o){if(!this.editorElement||!this.inputElement)return;let r=o<0?"ArrowLeft":"ArrowRight",n=o<0?37:39;this.inputElement.focus();for(let i=0;i<Math.abs(o);i++)this.inputElement.dispatchEvent(new KeyboardEvent("keydown",{charCode:0,code:r,key:r,keyCode:n,bubbles:!0,repeat:!1,shiftKey:!0}))}getCaretBeforeContent(o){if(!this.editorElement||!this.inputElement)return"";let r=o.rect.left+o.rect.width/2,n=o.rect.top+o.rect.height/2,i="";return this.getParagraphElements().sort((a,s)=>a.getBoundingClientRect().bottom-s.getBoundingClientRect().bottom).some(a=>{let s="",l=null;return this.getTextElements(a).some(c=>{let p=this.parseTextElement(c);if(p.rect.bottom<n||p.rect.top<n&&p.rect.right<r)l&&p.rect.top>=l.rect.bottom?s+=`
${p.content}`:s+=p.content,l=p;else if(sp(r,n,[p.rect])){let u=this.getCaretOffset(p,o.rect);if(u>0){let m=p.content.slice(0,u);s+=m}return!0}}),s&&(i?i+=`

${s}`:i=s),a.getBoundingClientRect().bottom>n}),i}getCaretAfterContent(o){if(!this.editorElement||!this.inputElement)return"";let r=o.rect.left+o.rect.width/2,n=o.rect.top+o.rect.height/2,i="";return this.getParagraphElements().sort((a,s)=>a.getBoundingClientRect().bottom-s.getBoundingClientRect().bottom).filter(a=>a.getBoundingClientRect().bottom>n).forEach(a=>{let s="",l=null;this.getTextElements(a).forEach(c=>{let p=this.parseTextElement(c);if(p.rect.top>n||p.rect.bottom>n&&p.rect.left>r)l&&p.rect.top>=l.rect.bottom?s+=`
${p.content}`:s+=p.content,l=p;else if(sp(r,n,[p.rect])){let u=this.getCaretOffset(p,o.rect);if(u>0){let m=p.content.slice(u);s+=m}return!0}}),s&&(i?i+=`

${s}`:i=s)}),i}async selectSelection(o){if(!this.editorElement||!this.scrollElement)return;let{layouts:r}=o,n=r[0],i=r[r.length-1],a=this.scrollElement.getBoundingClientRect(),s={bubbles:!0,clientX:a.left+n.left,clientY:a.top+n.top+n.height/2},l={bubbles:!0,clientX:a.left+i.right,clientY:a.top+i.top+i.height/2},c=Math.max(n.bottom,i.bottom),p=Math.max(n.top,i.top);if(this.editorElement.scrollTop+this.editorElement.offsetHeight<c)return this.editorElement.scrollTo({top:p,behavior:"auto"}),await new Promise(m=>setTimeout(m,50)),this.selectSelection(o);[new MouseEvent("click",s),new MouseEvent("mousedown",s),new MouseEvent("mousemove",l),new MouseEvent("mouseup",l)].forEach(m=>this.editorElement?.dispatchEvent(m)),await new Promise(m=>setTimeout(m,50)),this.inputElement?.dispatchEvent(new KeyboardEvent("keyup",{shiftKey:!0,key:"Shift",code:"ShiftLeft"}))}getCurrentSelection(){if(!this.editorElement)return null;let o=[],r=[],n=this.getSelectionElements();if(n.forEach(s=>{let l=s.getBoundingClientRect().toJSON();o.push(this.calculateRelativeLayout(l)),r.push(l)}),!n.length)return null;let i=this.getParagraphElements().filter(s=>r.some(l=>Gy(l,s.getBoundingClientRect()))).map(s=>this.parseParagraphElement(s)),a=this.copySelection();return Qn.info({paragraphs:i,rects:r,layouts:o,content:a}),{elements:n,rects:r,paragraphs:i,layouts:o,content:a}}getCurrentCaret(){if(!this.editorElement||!this.caretElement)return null;let o=this.caretElement,r=this.caretElement.getBoundingClientRect(),n=this.calculateRelativeLayout(r);return Qn.info({element:o,rect:r,layout:n}),{element:o,rect:r,layout:n}}getCaretOffset(o,r){let{left:n,top:i,width:a,height:s}=r,l=n+a/2,c=i+s/2;if(l<o.rect.left||c<o.rect.top)return 0;if(l>o.rect.right||c>o.rect.bottom)return o.content.length;let{element:p,content:u}=o,m=document.createTextNode(u),d=this.createTextOverlay(p,m);if(!d)return 0;let{width:f,left:h}=d.getBoundingClientRect(),C=document.createRange(),x=m.nodeValue?.length||0,_=f/x,y={},b=Math.floor((l-h)/_);for(;b<=x;){C.setStart(m,0),C.setEnd(m,b);let S=C.getClientRects()[0].toJSON(),I=y[b-1],w=I?I.right+(S.right-I.right)/2:S.left+S.width;if(l<w)if(I){b=Math.max(b-1,0);break}else{b--;continue}y[b]=S,b++}return d.remove(),b}parseTextElement(o){let r=o.getAttribute("aria-label")||"",n=o.getAttribute("data-font-css")||"",[i,a,s]=n.split(" "),l=o.getBoundingClientRect().toJSON(),c=this.calculateRelativeLayout(l);return{element:o,content:r,rect:l,layout:c,style:{top:c.top,left:c.left,width:c.width,height:c.height,fontWeight:i,fontSize:a,fontFamily:s?.replaceAll('"',"")}}}parseParagraphElement(o){let r=o.getBoundingClientRect().toJSON(),n=this.calculateRelativeLayout(r),i=this.getTextElements(o).map(a=>this.parseTextElement(a));return{element:o,rect:r,layout:n,texts:i,style:{top:n.top,left:n.left,width:n.width,height:n.height}}}getSelectionElements(){return this.editorElement?Array.from(this.editorElement.querySelectorAll(".kix-canvas-tile-selection rect")).filter(o=>o.parentElement?.tagName!=="clipPath"&&["rgba(118,167,250,0.5)","rgba(0,0,0,0.15)"].includes(o.getAttribute("fill")||"")):[]}getParagraphElements(){return this.editorElement?Array.from(this.editorElement.querySelectorAll('canvas ~ .kix-canvas-tile-content:not(.kix-canvas-tile-selection) g[role="paragraph"]')):[]}getTextElements(o){return o?Array.from(o.querySelectorAll("rect")).filter(r=>r.parentElement?.tagName!=="clipPath"):this.editorElement?Array.from(this.editorElement.querySelectorAll('canvas ~ .kix-canvas-tile-content:not(.kix-canvas-tile-selection) g[role="paragraph"] rect')).filter(r=>r.parentElement?.tagName!=="clipPath"):[]}getTextElementFromPoint(o,r){let n=this.getParagraphElements().find(i=>sp(o,r,[i.getBoundingClientRect()]));return n?this.getTextElements(n).find(i=>sp(o,r,[i.getBoundingClientRect()])):null}getElementFromPoint(o,r){this.styleElement||(this.styleElement=document.createElement("style"),this.styleElement.id="enable-pointer-events-on-rect",this.styleElement.textContent=[".kix-canvas-tile-content{pointer-events:none!important;}","#kix-current-user-cursor-caret{pointer-events:none!important;}",".kix-canvas-tile-content svg>g>rect{pointer-events:all!important; stroke-width:7px !important;}"].join(`
`),(document.head||document.documentElement).appendChild(this.styleElement)),this.styleElement.disabled=!1;let n=document.elementFromPoint(o,r);return this.styleElement.disabled=!0,n}createTextOverlay(o,r){if(!o||o.tagName!=="rect")return null;let n=document.createElementNS("http://www.w3.org/2000/svg","text"),i=o.getAttribute("transform")||"",a=o.getAttribute("data-font-css")||"";n.setAttribute("x",o.getAttribute("x")||""),n.setAttribute("y",o.getAttribute("y")||""),n.appendChild(r),n.style.setProperty("all","initial","important"),n.style.setProperty("transform",i,"important"),n.style.setProperty("font",a,"important"),n.style.setProperty("text-anchor","start","important"),o.parentNode?.appendChild(n);let s=o.getBoundingClientRect(),l=n.getBoundingClientRect(),c=(s.top-l.top+(s.bottom-l.bottom))*.5;return n.style.setProperty("transform",`translate(0px,${c}px) ${i}`,"important"),n}};var ah=rr(),vV=()=>{let{control:e,focus:t,caret:o,selection:r}=S7(),n=Zt(Nl),i=ro(ii),[a,s]=bi(rb),l=ro(Wm),c=(0,mr.useRef)({}),p=(0,mr.useRef)(null),u=(0,mr.useRef)(a);u.current=a;let m=(0,mr.useRef)(r);m.current=r;let d=(0,mr.useCallback)(()=>qh(Object.values(c.current).filter(Boolean).map(_=>_.getBoundingClientRect().toJSON())),[]),f=(0,mr.useCallback)(()=>p.current?.getBoundingClientRect().toJSON(),[]),h=(0,mr.useCallback)((_,y,b=y,S="")=>{window.postMessage({id:Sh,type:"iframeSelection",data:{virtual:!0,iframeId:ah,tagName:"",id:ah,className:"",windowRect:document.body.getBoundingClientRect().toJSON(),targetRect:_,selectionRect:_,iframeSelectionRect:_,iframePosition:[0,0],selectionText:y,selectionHTML:y,editableElementSelectionText:b,editableElementSelectionHTML:b,eventType:"keyup",isEmbedPage:!1,isEditableElement:!!e?.editable,caretOffset:1,startMarkerId:"",endMarkerId:"",relatedContent:S}},"*")},[]);(0,mr.useEffect)(()=>{if(!n){let _=[];return l(y=>(y.range&&_.push(setTimeout(()=>{let b=new KeyboardEvent("keyup",{key:" ",code:"Space",bubbles:!0,cancelable:!0});b.MAX_AI_IGNORE=!0,document.body.dispatchEvent(b)},1)),y)),e?.inputElement?.focus(),()=>{_.forEach(y=>clearTimeout(y))}}},[n]),(0,mr.useEffect)(()=>{if(!e)return;let _=kr(()=>{if((u.current.currentSelection?.selectionElement||u.current.tempSelection?.selectionElement)?.id!==ah)return;let b=m.current?.content?d():f();i(S=>({...S,rootRect:b})),s(S=>({...S,tempSelection:S.tempSelection?{...S.tempSelection,selectionRect:b}:S.tempSelection}))},200);return e.addListener("scroll",_),()=>{e.removeListener("scroll",_),_.cancel()}},[e]),(0,mr.useEffect)(()=>{if(!(!t||!e)){if(r&&r.content){let _="",y=r.rects[0],b=r.rects[r.rects.length-1],S=2e3;if(y&&b&&r.content.length<=S*.75){let I={element:null,rect:{...y,width:1,right:y.left+1},layout:{...y,width:1,right:y.left+1}},w={element:null,rect:{...b,width:1,left:b.right-1},layout:{...b,width:1,left:b.right-1}},E=e.getCaretBeforeContent(I),O=e.getCaretAfterContent(w),L=Math.ceil((S-r.content.length)/2),G=E.slice(-L),H=S-L,V=O.slice(0,H);_=`${G}${r.content}${V}`.trim()}h(qh(r.rects),r.content,r.content,_);return}if(o&&t&&e?.editable){h(o.rect,e?.getCaretBeforeContent(o)||"","");return}u.current.show&&(e?.editable||h(d(),"",""),s({show:!1,tempSelection:null,currentSelection:null,lastCursorPosition:null}))}},[r,o,t,e]),Fl(async(_,y,b)=>{if(_!=="Client_listenUpdateIframeInput"||y.id!==ah)return;let{type:S,value:I}=y;switch(S){case"INSERT_BELOW":e?.insertBelowSelection(I);break;case"INSERT":e?.replaceSelection(I);break;case"INSERT_ABOVE":e?.insertAboveSelection(I);break;case"REPLACE_SELECTION":e?.replaceSelection(I);break}});let C=Zi?0:1,x=Zi?-1:9999;return mr.default.createElement("div",{style:{opacity:C}},r?.layouts.map((_,y)=>mr.default.createElement("div",{ref:b=>{c.current[y]=b},key:y,style:{position:"absolute",border:Zi?void 0:"1px solid red",opacity:C,zIndex:x,..._}})),o&&mr.default.createElement("div",{ref:p,style:{position:"absolute",border:Zi?void 0:"1px solid blue",opacity:C,zIndex:x,...o.layout}}))},I7=vV;var wV=()=>{let e=(0,Yi.useMemo)(()=>new ih,[]),[t,o]=(0,Yi.useState)(e.lastCaret),[r,n]=(0,Yi.useState)(e.lastSelection),[i,a]=(0,Yi.useState)(!1);return Lr(()=>{if(e.init(),e.disabled)return;let s=u=>{n(u)},l=u=>{o(u)},c=()=>{a(!0)},p=()=>{a(!1)};return e.addListener("selection-change",s),e.addListener("caret-change",l),e.addListener("focus",c),e.addListener("blur",p),e.isFocus()&&(e.checkSelectionChange(),e.checkCaretChange(),a(!0)),()=>{e.removeListener("selection-change",s),e.removeListener("caret-change",l),e.removeListener("focus",c),e.removeListener("blur",p),e.destroy()}}),!e||!e.scrollElement||e.disabled?null:Yi.default.createElement(Gx.Provider,{value:{control:e,caret:t,selection:r,focus:i}},(0,v7.createPortal)(Yi.default.createElement(I7,null),e.scrollElement))},w7=Yi.default.memo(wV);var wo=v(A());var TV=e=>{let{...t}=e,{onResetConversation:o,onCreateConversation:r,onUpdateConversation:n,onSwitchConversation:i,onStopShortcutsActions:a,onRunShortcutsActions:s,onAskAIQuestion:l}=t,c=be(C=>C.setOnCreateConversation),p=be(C=>C.setOnUpdateConversation),u=be(C=>C.setOnSwitchConversation),m=be(C=>C.setOnResetConversation),d=be(C=>C.setOnAskAIQuestion),f=be(C=>C.setOnRunShortcutsActions),h=be(C=>C.setOnStopShortcutsActions);return(0,wo.useEffect)(()=>{r&&c(r)},[r]),(0,wo.useEffect)(()=>{n&&p(n)},[n]),(0,wo.useEffect)(()=>{i&&u(i)},[i]),(0,wo.useEffect)(()=>{o&&m(o)},[o]),(0,wo.useEffect)(()=>{l&&d(l)},[l]),(0,wo.useEffect)(()=>{s&&f(s)},[s]),(0,wo.useEffect)(()=>{a&&h(a)},[a]),MV(),wo.default.createElement(wo.default.Fragment,null)},T7=new Map,MV=()=>{let e=be(h=>h.conversationIds),{getConversation:t}=ct(),{addMessagesToPagination:o,syncLocalMessages:r,updateMessagesToPagination:n,removeMessagesToPagination:i}=Li(),[a,s]=(0,wo.useState)(e),{paywallShowDebounce:l}=vl();(0,wo.useEffect)(()=>{s(h=>o_(h.concat(e)))},[e]);let c=(0,wo.useRef)(null),p=gh(({set:h,snapshot:C})=>async(x,_)=>{c.current&&(clearTimeout(c.current),c.current=null);let y=await C.getPromise(zh(x));h(zh(x),_===null?null:qo([y,_]))}),u=gh(({set:h})=>(C,x)=>{h(vm(C),x)});(0,wo.useEffect)(()=>{a.length>0&&a.map(h=>{t(h)})},[a]);let{debounceRefreshModelUsage:m}=Oi();(0,wo.useEffect)(()=>{a.forEach(h=>{if(T7.has(h))return;let C=ri.getShortcutsEngine(h),x=async(_,y)=>{if(_==="shortcutsEngineStatus"&&((y.shortcutsEngine.status==="complete"||y.shortcutsEngine.status==="stop")&&(p(h,null),t(h)),u(h,y.shortcutsEngine.status)),_==="actionCustomEvent"&&y.actionCustomEventName==="updateWritingMessage"){let b=y.actionCustomEventData;b?p(h,{...b,conversationId:h}):c.current=setTimeout(()=>{p(h,null)},1e3)}if(_==="shortcutsExternalEngine"){if(y.shortcutsExternalEngineType==="shortcutsExternalEngineChatConversationService"){let{functionName:b,params:S}=y.shortcutsExternalEngineData;b==="addOrUpdateConversation"&&t(S[0])}if(y.shortcutsExternalEngineType==="shortcutsExternalEngineChatMessageService"){let{functionName:b,params:S}=y.shortcutsExternalEngineData;if(b==="addMessages"){let I=S[1].map(O=>O.messageId),w=await cn.getService().getMessagesByMessageIds(h,I),E=w.find(O=>Ji(O)&&O.meta.paywallData||ln(O)&&O.originalMessage?.metadata?.embeddedPaywall);if(E&&Ji(E)){let O=E.meta.paywallData;l({conversationId:h,paywallType:"response",paywallData:O}),ti.flush(),p(h,null)}E&&ln(E)&&(l({conversationId:h,paywallType:"response",paywallReason:"ProChat"}),ti.flush()),o(h,w),await r(h),t(h)}else if(b==="updateMessages"){let I=S[1].map(E=>E.messageId),w=await cn.getService().getMessagesByMessageIds(h,I);n(h,w),await r(h),t(h)}else if(b==="deleteMessages"){let I=S[1];i(h,I),await r(h),t(h)}}}(_==="afterRunAction"&&(y.currentAction?.type==="ASK_CHATGPT"||y.currentAction?.type==="MAXAI_RESPONSE_RELATED")&&y.currentAction?.status==="complete"||y.shortcutsEngine?.status==="stop")&&m()};T7.set(h,x),C.addListener(x)})},[a]);let{refreshChatAIModelSelector:d,refreshChatHubAIModelSelector:f}=Pl();(0,wo.useEffect)(()=>{d(),f()},[d,f])},M7=(0,wo.memo)(TV);var dr=v(A());var EV=()=>(am(),hm("floatingMenu"),dr.default.createElement(dr.default.Fragment,null,dr.default.createElement(AV,null))),AV=()=>{let{conversationType:e,setConversationIds:t,setConversationType:o}=be(_=>({conversationType:_.conversationType,setConversationIds:_.setConversationIds,setConversationType:_.setConversationType})),{appSettings:r}=Yr(),{betaSettings:n}=Yo(),{getLocalSettings:i,setLocalSettings:a}=lt(),{refreshModelUsageOnce:s}=Bm(),[l,c]=bi(nb),{createConversation:p,updateConversation:u,getConversation:m}=ct(),[d]=bi(ii),f=Xo(l),h=(0,dr.useRef)(f);h.current=f,(0,dr.useEffect)(()=>{r.userSettings&&(n?.appearance_v2_enabled?o("Chat"):o("ContextMenu"))},[r.userSettings,n?.appearance_v2_enabled]),(0,dr.useEffect)(()=>{l&&t([l])},[l]),(0,dr.useEffect)(()=>{d.open?(e==="Chat"&&wm("Chat").then(_=>{let y=_[0];h.current&&y&&h.current.meta.AIModel!==y.value&&u(h.current.id,{meta:{AIProvider:y.AIProvider,AIModel:y.value,maxTokens:y.maxTokens}},{syncToRemote:!1})}),s()):p(e,{reason:"initCreate",conversation:{meta:{isContextMenu:!0}}}).then(_=>{c(_[0]?.id||"")}).catch()},[e,d.open]),Cl(async()=>{if(l){let{sidebarSettings:_}=await i(),y=_?.contextMenu?.currentAIModel,b=await m(l);if(y&&b?.type==="ContextMenu"&&b?.meta.AIModel!==y){let S=$o(void 0,y);S&&await u(l,{meta:{AIProvider:S.AIProvider,AIModel:S.value,maxTokens:S.maxTokens}},{syncToRemote:!1})}}});let C=(0,dr.useCallback)(async _=>{let{sidebarSettings:y}=await i();if(_.type==="ContextMenu"){let b=y?.contextMenu?.currentAIModel;if(b){let S=$o(void 0,b);if(S)return{..._,meta:{..._.meta,AIProvider:S.AIProvider,AIModel:S.value,maxTokens:S.maxTokens}}}}return _},[i]),x=(0,dr.useCallback)(_=>{a({sidebarSettings:{contextMenu:{currentAIModel:_.meta.AIModel}}})},[a]);return dr.default.createElement(dr.default.Fragment,null,dr.default.createElement(M7,{onCreateConversation:C,onUpdateConversation:x}),d.open&&dr.default.createElement(d4,null))},E7=EV;var PV=()=>(hb(),Ar.default.createElement(_C,{containerId:Jx,wrapperId:e2},({rootContainer:e})=>Ar.default.createElement(j2,{shadowRootElement:e},Ar.default.createElement(Z_,{conversationType:"ContextMenu"},Ar.default.createElement(E7,null),Ar.default.createElement(IT,{variant:"custom",disableFileDrag:!0},Ar.default.createElement(wy,null,Ar.default.createElement(qa,{defaultContextMenuPath:"/rewrite"},Ar.default.createElement(l7,{root:e}),Ar.default.createElement(b7,null)),Ar.default.createElement(m7,null),Ar.default.createElement(f7,null),Ar.default.createElement(w7,null),Ar.default.createElement(vT,null))))))),A7=(0,Ar.memo)(PV);var lh=v(A());var O7=v(A());var kV={inviteLink:e=>(document.querySelector("#appMaxAIReferralShareOneClickText")?.innerText||"").trim()||`Sign up on MaxAI using my link and both of us will get a free week of MaxAI Pro rewards. It lets you use AI on any webpage with one click, powered by ChatGPT, Claude, Bard, and Bing AI. Here is my link: https://app.maxai.me?invite=${e}`},tl=kV;var jx=v(P7()),k7=v(Qx());var Uc=async(e,t,o="",r)=>{let n=await Ru.getUserInfo(),i=n?.user_id||"",a=n?.email||"",{getBrowser:s,getOS:l}=new jx.UAParser,c=s(),p=l(),u={env:Zi?"prod":"dev",type:e,app:"MAXAI",data:{title:t,message:o,...r},user_id:i,email:a,app_version:q2,browser:c.name,browser_version:c.version,platform:p.name,platform_version:p.version,languages:navigator.languages},m=x2(u,"MaxAI");return xb("https://api.extensions-hub.com/extensionhub/send_notification",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({msg:m})}).then().catch()},L7=async()=>{let{getBrowser:e,getOS:t}=new jx.UAParser;await k7.default.storage.local.set({MAXAI_BROWSER_INFO:JSON.stringify({browser:e(),os:t()})})};var LV=()=>{let{userInfo:e}=vt(),{conversationId:t}=ue(),{createConversation:o}=ct(),{askAIWithShortcuts:r}=ze(),n=ye(t);return{autoFacebookReferral:(0,O7.useCallback)(async()=>{if(!n){let a=tl.inviteLink(e?.referral_code||""),s=(u,m)=>{let d=m.currentAction;if(u==="afterRunAction"&&d?.type==="SET_VARIABLE"&&d.parameters?.VariableKey==="AutoTwitterReferralResult"){let f=d.parameters.WFFormValues?.Value===!0;Uc("REFERRAL",`[Referral] One-click button [Facebook] ${f?"Success":"Fail"}`,JSON.stringify({email:e?.email||"unknown",success:f},null,4),{uuid:"608156c7-e65d-4a69-a055-6c10a6ba7217"}).then().catch(),f&&Gl("/user/complete_referral",{referral_types:["FACEBOOK_SHARE"]}).then()}},c=(await o("Chat",{reason:"manualClick",syncToRemote:!1}))[0].id,p=ri.getShortcutsEngine(c);return p?.addListener(s),await r([{type:"OPEN_URLS",parameters:{URLActionURL:"https://www.facebook.com/sharer/sharer.php?u=https://app.maxai.me"}},{type:"SET_VARIABLE",parameters:{VariableKey:"OperationElementTabID"}},{type:"OPERATION_ELEMENT",parameters:{OperationElementConfig:{elementSelectors:["textarea[title]"],actionType:"insertText",actionExtraData:{clearBeforeInsertText:!0,text:tl.inviteLink(e?.referral_code||"")},beforeDelay:2e3}}},{type:"OPERATION_ELEMENT",parameters:{OperationElementConfig:{elementSelectors:['button[name="__CONFIRM__"]'],actionType:"click",afterDelay:3e3}}},{type:"CLOSE_URLS",parameters:{}},{type:"OPEN_URLS",parameters:{URLActionURL:"https://www.facebook.com/profile.php"}},{type:"SET_VARIABLE",parameters:{VariableKey:"OperationElementTabID"}},{type:"OPERATION_ELEMENT",parameters:{OperationElementConfig:{elementSelectors:['div[data-ad-preview="message"]','div[data-ad-comet-preview="message"]'],executeElementCount:10,actionType:"getText",beforeDelay:2e3}}},{type:"SCRIPTS_CONDITIONAL",parameters:{WFCondition:"Contains",WFMatchTextCaseSensitive:!1,WFFormValues:{Value:a.slice(0,10),WFSerializationType:"WFDictionaryFieldValue"},WFConditionalIfTrueActions:[{type:"SET_VARIABLE",parameters:{VariableKey:"AutoTwitterReferralResult",WFFormValues:{Value:!0,WFSerializationType:"WFDictionaryFieldValue"}}}],WFConditionalIfFalseActions:[{type:"SET_VARIABLE",parameters:{VariableKey:"AutoTwitterReferralResult",WFFormValues:{Value:!1,WFSerializationType:"WFDictionaryFieldValue"}}}]}},{type:"CLOSE_URLS",parameters:{}},{type:"OPEN_URLS",parameters:{URLActionURL:"current_page"}}],{conversationId:c}),p?.removeListener(s),!0}return!1},[n,r,e?.referral_code,e?.email]),autoFacebookReferralLoading:n}},B7=LV;var F7=v(A());var OV=()=>{let{userInfo:e}=vt(),{conversationId:t}=ue(),{createConversation:o}=ct(),{askAIWithShortcuts:r}=ze(),n=ye(t);return{autoLinkedinReferral:(0,F7.useCallback)(async()=>{if(!n){let a=tl.inviteLink(e?.referral_code||""),s="",l=(m,d)=>{let f=d.currentAction;if(m==="afterRunAction"&&f?.type==="SET_VARIABLE"){if(f.parameters?.VariableKey==="SHARE_POST_LINK")s=f.output;else if(f.parameters?.VariableKey==="AutoTwitterReferralResult"){let h=f.parameters.WFFormValues?.Value===!0;Uc("REFERRAL",`[Referral] One-click button [Linkedin] ${h?"Success":"Fail"}`,JSON.stringify({email:e?.email||"unknown",success:h,shareLink:`[ ${s} ]`},null,4),{uuid:"608156c7-e65d-4a69-a055-6c10a6ba7217"}).then().catch(),h&&Gl("/user/complete_referral",{referral_types:["LINKEDIN_SHARE"]})}}},p=(await o("Chat",{reason:"manualClick",syncToRemote:!1}))[0].id,u=ri.getShortcutsEngine(p);return u?.addListener(l),await r([{type:"OPEN_URLS",parameters:{URLActionURL:"https://www.linkedin.com/shareArticle/?url=https%3A%2F%2Fapp.maxai.me%3Finvite%3DIPn7Xnby"}},{type:"SET_VARIABLE",parameters:{VariableKey:"OperationElementTabID"}},{type:"OPERATION_ELEMENT",parameters:{OperationElementConfig:{elementSelectors:["button.artdeco-button"],actionType:"click",beforeDelay:2e3,afterDelay:2e3}}},{type:"OPERATION_ELEMENT",parameters:{OperationElementConfig:{elementSelectors:['div[contenteditable="true"]'],actionType:"insertText",actionExtraData:{clearBeforeInsertText:!0,text:a},afterDelay:1e3}}},{type:"OPERATION_ELEMENT",parameters:{OperationElementConfig:{elementSelectors:["button.share-actions__primary-action"],actionType:"click",afterDelay:3e3}}},{type:"OPERATION_ELEMENT",parameters:{OperationElementConfig:{elementSelectors:["a.inshare-success-state__view-btn"],actionType:"getLink"}}},{type:"SET_VARIABLE",parameters:{VariableKey:"SHARE_POST_LINK"}},{type:"OPERATION_ELEMENT",parameters:{OperationElementConfig:{elementSelectors:["a.inshare-success-state__continue-btn"],actionType:"getText"}}},{type:"SCRIPTS_CONDITIONAL",parameters:{WFCondition:"Contains",WFMatchTextCaseSensitive:!1,WFFormValues:{Value:"linkedin",WFSerializationType:"WFDictionaryFieldValue"},WFConditionalIfTrueActions:[{type:"SET_VARIABLE",parameters:{VariableKey:"AutoTwitterReferralResult",WFFormValues:{Value:!0,WFSerializationType:"WFDictionaryFieldValue"}}}],WFConditionalIfFalseActions:[{type:"SET_VARIABLE",parameters:{VariableKey:"AutoTwitterReferralResult",WFFormValues:{Value:!1,WFSerializationType:"WFDictionaryFieldValue"}}}]}},{type:"CLOSE_URLS",parameters:{}},{type:"OPEN_URLS",parameters:{URLActionURL:"current_page"}}],{conversationId:p}),u?.removeListener(l),!0}return!1},[r,n,e?.referral_code,e?.email]),autoLinkedinReferralLoading:n}},D7=OV;var H7=v(A());var BV=()=>{let{userInfo:e}=vt(),{conversationId:t}=ue(),{createConversation:o}=ct(),{askAIWithShortcuts:r}=ze(),n=ye(t);return{autoTwitterReferral:(0,H7.useCallback)(async()=>{if(!n){let a=tl.inviteLink(e?.referral_code||""),s="",l=(m,d)=>{let f=d?.currentAction;if(m==="afterRunAction"&&f?.type==="SET_VARIABLE"){if(f.parameters?.VariableKey==="SHARE_POST_LINK")s=f.output;else if(f.parameters?.VariableKey==="AutoTwitterReferralResult"){let h=f.parameters.WFFormValues?.Value===!0;Uc("REFERRAL",`[Referral] One-click button [Linkedin] ${h?"Success":"Fail"}`,JSON.stringify({email:e?.email||"unknown",success:h,shareLink:`[ ${s} ]`},null,4),{uuid:"608156c7-e65d-4a69-a055-6c10a6ba7217"}).then().catch(),h&&Gl("/user/complete_referral",{referral_types:["TWITTER_SHARE"]})}}},p=(await o("Chat",{reason:"manualClick",syncToRemote:!1}))[0].id,u=ri.getShortcutsEngine(p);return u?.addListener(l),await r([{type:"OPEN_URLS",parameters:{URLActionURL:`https://twitter.com/intent/tweet?text=${a}`}},{type:"SET_VARIABLE",parameters:{VariableKey:"OperationElementTabID"}},{type:"OPERATION_ELEMENT",parameters:{OperationElementConfig:{elementSelectors:['button[data-testid="tweetButton"]'],actionType:"click",beforeDelay:2e3,afterDelay:2e3}}},{type:"OPERATION_ELEMENT",parameters:{OperationElementConfig:{elementSelectors:['a[data-testid="AppTabBar_Profile_Link"]'],actionType:"click",afterDelay:2e3}}},{type:"OPERATION_ELEMENT",parameters:{OperationElementConfig:{elementSelectors:['article[data-testid="tweet"] div[data-testid="User-Name"] a[role="link"]'],actionType:"getLink"}}},{type:"SET_VARIABLE",parameters:{VariableKey:"SHARE_POST_LINK"}},{type:"OPERATION_ELEMENT",parameters:{OperationElementConfig:{elementSelectors:['div[data-testid="tweetText"]'],actionType:"getText",executeElementCount:10}}},{type:"SCRIPTS_CONDITIONAL",parameters:{WFCondition:"Contains",WFMatchTextCaseSensitive:!1,WFFormValues:{Value:a.slice(0,10),WFSerializationType:"WFDictionaryFieldValue"},WFConditionalIfTrueActions:[{type:"SET_VARIABLE",parameters:{VariableKey:"AutoTwitterReferralResult",WFFormValues:{Value:!0,WFSerializationType:"WFDictionaryFieldValue"}}},{type:"CLOSE_URLS",parameters:{}},{type:"OPEN_URLS",parameters:{URLActionURL:"https://twitter.com/MaxAI_HQ"}},{type:"SET_VARIABLE",parameters:{VariableKey:"OperationElementTabID"}},{type:"OPERATION_ELEMENT",parameters:{OperationElementConfig:{elementSelectors:['[data-testid="1667007582270296064-follow"]'],actionType:"click",beforeDelay:2e3,afterDelay:3e3}}}],WFConditionalIfFalseActions:[{type:"SET_VARIABLE",parameters:{VariableKey:"AutoTwitterReferralResult",WFFormValues:{Value:!1,WFSerializationType:"WFDictionaryFieldValue"}}}]}},{type:"CLOSE_URLS",parameters:{}},{type:"OPEN_URLS",parameters:{URLActionURL:"current_page"}}],{conversationId:p,isSaveLastRunShortcuts:!1}),u?.removeListener(l),!0}return!1},[n,r,e?.referral_code,e?.email]),autoTwitterReferralLoading:n}},N7=BV;var FV=()=>{let{autoTwitterReferral:e}=N7(),{autoFacebookReferral:t}=B7(),{autoLinkedinReferral:o}=D7(),r=(0,lh.useRef)({});(0,lh.useEffect)(()=>{r.current={twitter:e,linkedin:o,facebook:t}},[e,o,t]),Lr(()=>{qr&&location.href.includes(qr)&&setInterval(()=>{let i=document.querySelector("#appMaxAIReferralShareOneClickContainer"),a=document.querySelector("#appMaxAIReferralShareOneClickButton");if(i&&a){if(!i.classList.contains("loaded"))i.classList.add("loaded");else return;a.addEventListener("click",async()=>{let s=Array.from(document.querySelectorAll('.app-maxai-me__one-click-share-status-card[data-checked="true"]'));for(let p=0;p<s.length;p++){let m=s[p].getAttribute("data-name"),d=r.current?.[m];d&&await d()}await Is(3e3);let l=new URL(window.location.href),c=new URLSearchParams(l.search);c.set("show_completed","true"),l.search=c.toString(),window.location.href=l.toString()})}},1e3)})},z7=FV;var qx=v(Qx());var V7=async(e,t)=>{let{rootElementSelector:o,isShadowElement:r=!1,elementSelectors:n,beforeDelay:i=0,afterDelay:a=0,executeElementCount:s=1,durationTimes:l=30*1e3,rotationTimes:c=3e3,rotationInterval:p=1e3,actionType:u="click",actionExtraData:m}=t||{},d={success:!1,elementsInnerText:"",link:""},f=document,h=o?f.querySelector(o):f;if(r&&(h=h.shadowRoot),!n||n?.length===0||!h){qx.default.runtime.sendMessage({event:"ShortCuts_OperationPageElementResponse",data:{taskId:e,success:d.success,data:d}});return}if(h){let C=async()=>{await Is(i);let x=[],_=0;for(;x.length===0&&_<c;)x=bC(...n.map(y=>Array.from(h.querySelectorAll(y)))),x.length===0&&(_+=p,await Is(p));return x.length===0||(x=x.slice(0,s),x.forEach(y=>{switch(u){case"click":y.click();break;case"insertText":{let b=m?.text||m?.value.toString()||"";if(y.focus(),y.getAttribute("contenteditable")==="true"){let S=window.getSelection(),I=document.createRange();I.selectNodeContents(y),S?.removeAllRanges(),S?.addRange(I)}m?.clearBeforeInsertText&&(y.tagName==="INPUT"||y.tagName==="TEXTAREA")&&(y.select(),f.execCommand("Delete",!1,"")),f.execCommand("insertText",!1,b)}break;case"getText":{let b=y?.innerText||"";d.elementsInnerText+=b}break;case"getLink":y.tagName==="A"?(d.link&&(d.link+=","),d.link+=y.href):y.tagName==="IMG"||y.tagName==="VIDEO"||y.tagName==="IFRAME"||y.tagName==="EMBED"||y.tagName==="SOURCE"||y.tagName==="TRACK"?(d.link&&(d.link+=","),d.link+=y.src):(d.link&&(d.link+=","),d.link+=y?.innerText||"");break;default:break}}),d.success=!0,await Is(a)),d};await Promise.race([C(),Is(l)]),qx.default.runtime.sendMessage({event:"ShortCuts_OperationPageElementResponse",data:{taskId:e,data:{success:d.success,message:d.success?"ok":"error",data:d}}})}};var R7=()=>{Nm(async(e,t,o)=>{switch(e){case"ShortCuts_ClientExecuteOperationPageElement":{let{taskId:r,OperationElementConfig:n}=t;return r?(await V7(r,n),{success:!0,data:!0,message:"ok"}):{success:!1,message:"No taskId",data:null}}break;default:break}})};var ch=v(A());var U7=Jn({key:"HaveFilledOutSurveyAtom",default:{feedback:!1}}),W7=Jn({key:"firstFetchSurveyStatusLoadedAtom",default:!1}),NVe=Jn({key:"FunnelSurveyPopupOpenStateAtom",default:{}}),zVe=Jn({key:"FunnelSurveyPopupOpenTimerAtom",default:{}});var DV=()=>{let e=ro(U7),t=ro(W7),{isLogin:o}=Ko(),r=(0,ch.useRef)(!1),n=async(i=!1)=>{let a=await Cb(i);a&&Object.keys(a).length>0&&e(s=>({...s,...a}))};return(0,ch.useEffect)(()=>{r.current||o&&yb().then(i=>{n(!i).then(()=>{t(!0),r.current=!0})})},[o]),Fl(async(i,a)=>{if(r.current&&i==="Client_listenSurveyStatusUpdated"){let s=a;return e(l=>({...l,...s})),{success:!0,message:"ok",data:{}}}}),null},G7=DV;var HV=kr(()=>{if(za()==="youtube.com"){Wa()&&(document.body.style.position=""),document.documentElement.style.position==="relative"&&(document.documentElement.style.position="unset",document.querySelector(`#${dh}`)?.classList.replace("open","close"));let t=document.querySelector(`#${fh}`);t&&(t.style.display="none")}},100),NV=kr(()=>{if(za()==="youtube.com"){document.documentElement.style.position==="unset"&&(document.documentElement.style.position="relative",document.querySelector(`#${dh}`)?.classList.replace("close","open")),Wa()&&(document.body.style.position="relative");let t=document.querySelector(`#${fh}`);t&&(t.style.display=""),setTimeout(()=>{window.dispatchEvent(new Event("resize"))},300)}},100),zV=()=>{let e=za();Lr(()=>{if(e==="youtube.com"){let t=new MutationObserver(r=>{r.forEach(n=>{n.target&&(n.target.hasAttribute("scrolling")?HV():NV())})}),o=document.querySelector("ytd-app");o&&t.observe(o,{attributes:!0,childList:!1,subtree:!1})}})},j7=zV;var Wc=v(A());var VV=({children:e,...t})=>{let o=Wc.default.useRef(null);return Wc.default.createElement(l_,{maxSnack:3,preventDuplicate:!0,hideIconVariant:!0,autoHideDuration:3e3,ref:o,anchorOrigin:{vertical:"bottom",horizontal:"left"},action:r=>Wc.default.createElement("svg",{focusable:"false","aria-hidden":"true",viewBox:"0 0 24 24",style:{width:"1em",height:"1em",display:"inline-block",fill:"currentcolor",fontSize:18,cursor:"pointer"},onClick:()=>{if(o?.current){let n=o?.current;n.closeSnackbar&&n.closeSnackbar(r)}}},Wc.default.createElement("path",{d:"M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"})),...t},Wc.default.createElement(c_,null),e)},q7=VV;var Gc=v(A()),K7=v(J7());var RV="MAXAI_SNACKBAR_CONTAINER";var UV=()=>Gc.default.createElement(q7,{classes:{containerRoot:"maxai-snackbar-container-root"}},Gc.default.createElement("span",null)),$7=()=>{let e=document.createElement("div");e.id=RV,e.style.zIndex="21474836470",e.style.color="#fff",e.style.position="absolute",document.body.appendChild(e),(0,K7.createRoot)(e).render(Gc.default.createElement(Gc.default.StrictMode,null,Gc.default.createElement(UV,null)))};var WV=new om("AppInit"),GV=()=>window.location.host==="www.usechatgpt.ai"||window.location.host==="www.maxai.me"||window.location.host==="www.maxai.co"||window.location.host==="app.maxai.me"?fr.default.createElement(Ce,{onClick:()=>{Fa({key:"shortcuts"})},id:"usechatgpt-www-to-shortcuts",sx:{position:"absolute",width:1,height:1,zIndex:-1,opacity:0}}):fr.default.createElement(fr.default.Fragment,null),jV=()=>{let{setAppSettingsState:e}=Yr(),{getLocalSettings:t}=lt(),{isLogin:o}=Ko();return gb(),(0,fr.useEffect)(()=>{let r=async()=>{let n=await Dh();n&&(e({...n}),WV.info(" get appSettings",n)),t()};return r(),window.addEventListener("focus",r),()=>{window.removeEventListener("focus",r)}},[]),(0,fr.useEffect)(()=>{o&&setTimeout(()=>{Dh().then(r=>{r&&e({...r})})},1e3)},[o]),fr.default.createElement(fr.default.Fragment,null)},qV=()=>{let{syncUserInfo:e}=vt(),{fetchPlanPricing:t}=sm(!0);return Lr(()=>{if(e().then(),String(qr).includes(za())){let o=window.location.pathname;["/account/your-plan/","/pricing/","/account/get-started/","/payment/error/","/payment/success/"].includes(o)&&setTimeout(()=>{e(!0).then().catch()},500),["/account/your-plan/","/pricing/"].includes(o)&&setTimeout(()=>{t().then()},500)}}),null},KV=()=>{let e=ro($2),t=ro(K2),{syncUserInfo:o,setUserInfo:r}=vt();return Fl(async(n,i)=>{if(n==="Client_AuthMaxAITokenComplete"){if(i?.hasToken){let a=await Ma.getAuthTokens(),l=!(a?.refreshToken?Ma.isTokenExpired(a.refreshToken):!0)&&!!a;a&&l?(o(),t(c=>c.isLogin===l?c:{...c,isLogin:l,authTokens:a})):t(c=>c.isLogin===l?c:{...c,isLogin:!1,authTokens:null})}else t(a=>({...a,isLogin:!1,authTokens:null}));return e(!0),r(a=>({...a,user:null})),{success:!0,message:"ok",data:{}}}}),null},$V=()=>{j7(),D_(),_b(),eC(!1),J_(!1),Yl(),KV(),gS(),z_(),Lr(()=>{ap()&&ta(),$7(),R7(),L7().then().catch(),fS()}),z7(),G7(),x4(),hm(),G_(),am(),f4(),Sy(),Ny(),yy();let e=ap();return fr.default.createElement(fr.default.Fragment,null,fr.default.createElement(qV,null),!e&&fr.default.createElement(A7,null),fr.default.createElement(jV,null),fr.default.createElement(GV,null),fr.default.createElement(CC,null),fr.default.createElement(yC,null))},YRe=$V;export{bb as a,qa as b,id as c,Kb as d,a4 as e,d4 as f,f4 as g,_E as h,Yl as i,ck as j,FY as k,Rg as l,xc as m,v9 as n,T9 as o,B9 as p,Zw as q,fu as r,IT as s,zPe as t,AT as u,M7 as v,P7 as w,Uc as x,U7 as y,W7 as z,$7 as A,jV as B,YRe as C};
/*! Bundled license information:

chnl/dist/channel.cjs.js:
  (* chnl v1.2.0 by Vitaliy Potapov @preserve *)
*/
